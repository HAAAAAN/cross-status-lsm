[{"repo": "carrierwave", "type": "elite", "title": "", "number of text": 588, "text": "  This is not built-in and won't be a feature because it's definitely an edge case.\n\nI would recommend copying all your assets over to S3/CloudFiles or add a method to your model that generates the legacy path.\n  You need to update RubyGems. gem update --system\n  Pretty sure this was fixed in 0.6 - please upgrade and report back if it's still an issue.\n\nIf it is still an issue, please provide uploader code and a full stack trace so we have enough info to help.\n Upgrade to Rails 3.2 :)\n Really haven't ever heard of performance issues with CarrierWave. It's pretty much all based on your Internet connection speed - time spent in CarrierWave code is negligible in comparison to even the smallest file uploads.\n 0.9.0 sounds about right.\n\nI'm not at all surprised that fog 1.3.1 doesn't work with 0.5.8, there were lots of changes in both libraries.\n  Sounds like 2 workers checked for the existence of the same file/folder at the same time, both returned false, and one of them beat the other to the creation of the new file/folder. I think this should only happen if multiple workers are reprocessing the same carrierwave file -- is that what's going on? If so, you might want to take a look at Rack::Lock.\n Sorry - meant Resque::Lock.\n  Please post usage questions to Stack Overflow or to the Google Group.\n  This is not a CarrierWave issue. Post MiniMagick-specific issues to the probablycorey/mini_magick repo.\n  Please post usage questions to Stack Overflow or to the Google Group.\n  Yep I acknowledged the issue, but am essentially marking it \"wontfix\". Pull requests are welcome though if you want to tackle it!\n  Really not sure what to tell you.\n\nYou should be able to call `resume.cache!(File.open(...))` but you need to point to a file, can't assign it a string.\n\nI would recommend backing it by a model class, regardless of whether or not you persist it to DB so you can mount the uploader.\n  This isn't something we are planning to implement, but pull requests are always welcome. \n  I am unable to reproduce this issue. Check your params hash in your log when submitting the form, it will show what was submitted to the controller.\n  I would be fine with something like this, so long as it doesn't change existing API. Work up a pull request and I'll have a look!\n  Does it help if you call uploader.reload after storing but before testing the value?\n  Yes please do! It's been requested a number of times in the past. Just open a new pull request when it's ready. Thanks!\n No, nothing built-in. Why not just mount an uploader in each model?\n I would recommend using S3 instead of storing them on a utility server. You could then setup a worker task of some kind that fetches them from S3 to the utility server.\n\nYour app server receives the request -- CW can either store locally (:file) or on S3 (:fog).\n Assuming you're using S3 in the same region as your app servers, the time it takes to push the original straight to S3 is negligible in comparison to the time it takes to upload the file from client to app server. Then you can defer additional processing to the utility node(s).\n Just add a worker that calls MiniMagick/Rmagick directly and does whatever you need to do.\n\nIf you need further support, I recommend working with Engine Yard support or posting a question to Stack Overflow or to the CW Google Group.\n  Can you please squash this to a single commit?\n  Can you rebase to master (this does not apply cleanly) and squash to a single commit? Thanks!\n Nope - go ahead create a new pull request if that's easier for you.\n  Please post usage questions to Stack Overflow or to the Google Group. This is a problem with how you're handling the upload parameters, not a problem with CarrierWave itself. \n  Noticed that last night -- will take care of it when I have some time.\n Done.\n  This isn't a priority, but pull requests are welcome!\n  I don't see how this has anything to do with carrierwave. Your issue has to do with the ActiveRecord finder method that you're using when finding or building your object.\n\nYou also only provided a piece of the stack trace, which does not help.\n  Closed in favor of #686\n  Thanks for taking the time to rework it for 1.8.\n  It's just how it was designed. Pull requests are welcome!\n s3 storage was removed as of 0.6.0, fog is the way going forward.\n  Merged, thanks!\n Can you fix the build on 1.8.7/REE and submit another pull request?\n  This is a general Ruby question, unrelated to CarrierWave. You should start by calling `file.close` when you're done with the file.\n\nIf you have further questions about this, please ask on Stack Overflow.\n  Closed in favor of #686\n  Can you please try this on master to see if it was fixed by #686?\n :metal: Gem release coming shortly. \n  This should be fixed in 0.6.1. Can you try using that and report back?\n Marking a hack workaround as the answer on Stack Overflow just makes my life harder. We fixed the issue for you and released a patched version almost immediately.\n\nPulling crap like that is what drives people to stop helping with OSS.\n  Merged, thanks!\n  Not a fan of the endless chaining of gsub calls, but hey, what's one more?\n\nMerged, thanks!\n  Feel free to edit it! The Wiki is maintained by users.\n  The S3 backend is unsupported in 0.6.0 and beyond, use Fog instead.\n You need to delete anything that starts with `config.s3_`\n  Appears you are trying to recreate versions on objects that have no uploaded file.\n Because there is no file to recreate_versions! against. You should add the nil check in your code if you need it.\n That's not how you do it on an uploader that's mounted in a Rails app though - look just below that in the readme - Product.scoped.each {|p| p.avatar.recreate_versions! if p.avatar.present? } or something along those lines. \n The readme provides an accurate, generic example on how to recreate versions. Defining the scope and iterator - `Product.all` vs `Product.where(\"avatar IS NOT NULL\")` or the conditions within the block `if p.avatar.present?` is application specific.\n\nIt doesn't just say \"or\", it says \"or on a mounted uploader\" which is what you have in Rails.\n\nIf you'd like to submit a pull request that would make the readme clearer to everyone, I'm happy to merge it. I don't recall refusing anything.\n  Thanks, would you mind adding a test that fails without this?\n Sorry, I'm an idiot.\n Yep, good to go -- thanks!!\n  Pretty sure you cannot use `fog_public: false` along with CNAMES. Try making your images public...\n Talked with @hyperrjas offline and this was a cloudfront config issue, not an issue with CarrierWave or Fog.\n  You'll need to update Fog to 1.3.1. \n I've added notes to the Readme that specify the Fog version requirement df4b01af10636605128e574eb632dca084417a19 \n  Please create a sample app that shows this behavior.\n Are you using Rails 3.2? The serialization changes in 0.6.0 only work on 3.2+\n  Yeah reinstalling imagemagick often does the trick. Or switch to MiniMagick. \n  Can you update to the latest version of Rubygems locally and update to a newer version of REE on your production server and report back?\n\nI'm not sure about the Heroku issue, but let's start with the non-Heroku issues where we can control the environment.\n @MattHall supplied a gist that used 2011.03 version of REE.\n\n@resistorsoftware Yeah please let me know if that fixes things locally. Which stack are you using on Heroku?\n  Where was this test failing? Passes fine on MRI without this...\n Alrighty, sounds good to me.\n  This is outside the scope of CarrierWave. Handling Base64 encoded strings is app-specific and decoding is likely handled by your controller and passed as an IO object to CW.\n  @geemus See #592 for existing failures :)\n\nWould love some help on that if you have any time to look at those.\n Cool thanks again! I'll check it out.\n  You can't have any dots in your bucket name if you use the bucket name in the subdomain of your URLs because the AWS SSL certificate only covers *.s3.amazonaws.com.\n\nFog should handle this automatically with a regexp that checks the bucket name -- if it isn't checking for dots, it's a bug /cc @geemus \n Buckets that have dots are meant to be used for CNAME buckets where SSL is unsupported (assets.myapp.com - masks the fact that they are using S3). Outside of that use case, I'd say dots are a bad idea.\n  I'm not following here -- options are not ignored, they are called on super.\n Pretty sure you want `as_json` in this case, which supports `only` and `except`.\n Yeah that makes sense now.\n\nCan you try monkey patching it with this and see if that fixes things:\n\n``` ruby\ndef serializable_hash(options=nil)\n  hash = {}\n  self.class.uploaders.each do |column, uploader|\n   hash[column.to_s] = _mounter(:#{column}).uploader.serializable_hash\n  end\n  hash.merge(super(options))\nend\n```\n Fixed in master, thanks for the report!\n  @geemus Does anything come to mind that changed in 1.2.0 that might cause this?\n Working fine for me too.\n  Oh wonderful. Changed in master for 4.x?\n That's probably a good decision - thanks for the info!\n We'll cross this bridge when 4.0 is closer. It's just docs at this point anyway. \n  Zero is inaccurate when describing the file size of a non-existent file. An empty file can have a size of zero -- you should check to make sure the file exists before calling methods on it.\n  I would agree that it's logical for it to return nil if there is no upload. Care to work up a pull request (with tests)?\n  If you have some time to work up a pull request, you can see how the whitelist is done here: https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/extension_whitelist.rb\n\nWould be very similar.\n  When was after_commit introduced? I heard about it at one point, but haven't used it yet.\n\nI can't think of any downsides to this assuming it is supported in Rails 3.2 and beyond. Pull request welcome!\n  Please keep the conversation in #653, no need to open multiple issues.\n  That's a fog issue and I assume it's fixed in fog master (if not the latest point release).\n  Care to work up a pull request that words things in a way that would be helpful to a beginner?\n Why are you trying to put files in `lib/carrierwave/storage`? That's definitely the wrong place.\n\nJust put your config in `config/initializers/carrierwave.rb`.\n  This is already fixed in master. \n  Thanks for the contribution, @dimko. I'd like to stick to HTTP-only support for fetching files because it's the simplest approach and it just works.\n  Merged, thanks!\n @hyperrjas Please do not post the same question in multiple issues - I've responded to your question in #680\n  Merged, thanks!\n  I'm not following on what the problem is here...you can put configuration in config/initializers if you want it to apply to all environments or you can put it in each of the environment configs if it's vastly different in each env.\n  Please post usage issues to Stack Overflow or the Google Group.\n\nWhen doing so, I recommend including a full stack trace as well so people have enough info when working through your issue.\n  You can also use `config.fog_attributes` - something like `config.fog_attributes = { :acl => 'authenticated-read' }` for example.\n Just to clarify - you all are only having issues if setting a custom filename, correct?\n\nI want to make sure I'm narrowing this down correctly when figuring out what's wrong. \n  Fog checks your bucket name [here](https://github.com/fog/fog/blob/master/lib/fog/aws/requests/storage/get_object_https_url.rb#L14) and if it is an acceptable format for serving as a hostname with SSL, it will use it as a subdomain. Otherwise, it will specify the bucket in the path.\n  CW uses the combination of the filename and the settings specified in your uploader class to generate the proper URL. This allows you to easily swap out the storage backend without making any changes to your core application.\n\nThat said, you cannot store the full URL.\n  This doesn't provide any indication as to what you are fixing and the test doesn't test anything. Feel free to reopen with more info and valid tests.\n  Check out the imagemagick docs for this -- this is lower-level functionality and has nothing to do with carrierwave.\n  First class JSON/XML serialization support is implemented in master. Have not tried it with mongoid yet though.\n That's because the serialization goodies that make ActiveRecord handle it properly are done here:\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/orm/activerecord.rb#L46\n\nThe same needs to be done for mongo here:\nhttps://github.com/jnicklas/carrierwave-mongoid/blob/master/lib/carrierwave/mongoid.rb\n Given that mongoid is activemodel compliant, the `serializable_hash` method should be identical. Can you try forking carrierwave-mongoid and adding it?\n\nIt would be tough to monkey patch because it's a class_eval inside the mount_uploader method\n Nice, yeah that's exactly what it's supposed to do.\n\nYou can see what I did to test ActiveRecord starting on line 84 of activerecord_spec -- should be very similar:\nhttps://github.com/jnicklas/carrierwave/blob/master/spec/orm/activerecord_spec.rb#L84\n Are you still using and testing against CarrierWave from master?\n\nThat is defined here:\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/serialization.rb#L11\n  You just need to override the `store_dir` in your uploader. See the readme for details.\n  Here is the class declaration for `CarrierWave::Storage::Fog::File`:\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/storage/fog.rb#L110\n\nYou can call any of the methods there (perhaps use `path`) to extract the file extension.\n\nWe would welcome a pull request that adds a method for fetching the extension directly.\n  I'm not seeing an issue here that indicates a flaw in CarrierWave.\n\nrecerate_versions! should not apply any changes to the original image.\n  Can you upload a sample app that shows the issue?\n  Try using mini_magick. Rmagick is causing the segfault, not CarrierWave.\n  Like mini_magick or rmagick, the mime-types dependency is optional. It is not required for core CarrierWave operations.\n  @geemus Can you chime in here? What's the best way to specify AWS options available [here](https://github.com/fog/fog/blob/master/lib/fog/aws/requests/storage/put_object.rb#L12)?\n  Thanks for this -- would you mind adding rspec tests? While most of the current cucumber tests are valid, new features are being tested with RSpec. Thanks!\n One more request -- would you mind documenting this new feature in the README? This has been requested several times in previous issues, so docs would be great!\n Merged, thanks!\n Already fixed, no problem.\n Can you pull from master and get this working? I fixed one of the steps but still failing.\n\nYou'll need to open a new pull request since this one was already merged.  Thanks!\n Latest build is at: http://travis-ci.org/#!/jnicklas/carrierwave\n No, need to push another commit to re-run, but there's no reason to think that'll accomplish anything.\n\nI can't seem to get the error locally either.\n  So I don't forget...\n\nWrite an article that covers the basics of using CarrierWave with Rails 3.x and expands a bit on the EY article to:\n- Discuss more about the lifecycle of the file upload to crystalize the sequence of events that occur and give people a strong understanding of the library's approach.\n- Provide a reference app in github people can clone and deploy themselves to Heroku with minimal steps. The app might upload images to S3 as well as create a couple thumbnail versions of the image.\n- Utilize environment variables for config settings as is the Heroku approach.\n\nSee here for a recent article that dives a little bit into a reference application and explains some of the concepts behind the approach in addition to the standard howto language. http://devcenter.heroku.com/articles/cdn-asset-host-rails31\n\nWriting guide: http://cl.ly/D2ER\n  :metal:\n  There is not a built-in option for this. You could handle this any number of ways in your app though -- copy the file somewhere in a before_destroy callback, use versioning on S3, etc.\n It seems like a hack to me to orphan files by deleting their record without deleting the file itself. Another option would be to mark the record it as \"deleted\" in you app without actually deleting it.\n You can use `skip_callback` ([doc here](https://github.com/rails/rails/blob/dc826f9977650c105e9bfd308d6d4fc71bb6ec6e/activesupport/lib/active_support/callbacks.rb#L516)) on CarrierWave's `after_destroy :\"remove_#{column}!\"`: \n  While I completely agree with you that sanitization does not belong here, can you think of a way that we could fix this without breaking existing apps? Perhaps just specifically adding support for brackets?\n It depends on which release it is -- I avoid violating semver whenever possible.\n\nSo there was a patch submitted to ruby stdlib for URI that fixes bracket support and it was rejected? Lame sauce.\n\nCare to chime in @trevorturk? I agree that CW shouldn't be responsible for sanitizing, but it's already in there (yay code debt) and is easy enough to override per-uploader...\n Yeah my bad -- monkey patching is necessary to override.\n  CarrierWave doesn't officially support JRuby at this time. We would gladly accept patches though if this is something you'd be willing to work on!\n I can't be certain that it's a JRuby issue, but I do know that the CW specs do not pass on JRuby.\n  Is there a similar fix that you can come up with for `to_xml`? It took awhile to finally get the two serializers working consistently -- I want to make sure it stays that way. I see there is no `as_xml` in AS.\n Feel free to post follow-up commits here. I'd really like to consider XML/JSON serialization a single feature so they stay consistent from here on out.\n :metal:\n\nAwesome work, thanks for digging into this!\n  Is this fixed by #612?\n The next release (0.6.0) will support Rails 3.2 and later only. ActiveModel shouldn't be a dependency at all (I see it's in the latest gemspec but that's an error on my part), but ActiveSupport must be 3.2 or greater.\n  Can you provide your uploader code in a gist?\n  There must be a better way -- this fetches the file from the remote data store, it doesn't just check for its existence.\n\nI know Fog has a head_object method for AWS, not sure if it extends to other providers though.\n  Merged, thanks!\n Cherry-picked to 0.5-stable branch\n  Fog has a method for checking the existence of remote files -- I recommend using that.\n\nPatches are welcome though if you want to add this functionality.\n  Merged, thanks!\n  Try reinstalling imagemagick. Also I'm not sure if Rmagick plays nice with Ruby 1.9.  I personally always use MiniMagick.\n\nIn any case, this is not a CarrierWave issue.\n Rmagick is generally very frustrating. Unless you need to use it for some reason, I definitely recommend MiniMagick.\n  Please post any mongoid-specific issues to the carrierwave-mongoid repo. Mongoid support is no longer part of the main CarrierWave gem.\n Issue #505 is a mongoid-specific issue.\n  Use the carrierwave 0.5-stable branch for now with carrierwave-mongoid. I haven't looked at carrierwave-mongoid since I made last week's changes, but I'm sure it broke a few things - there were a few API changes. The priority was getting a consistent serialization for uploaders and making it compatible with Rails 3.2 and master. Now that we're there we can get the other ORMs working.\n\nPlease post mongoid-specific issues over on the carrierwave-mongoid repo in the future.\n  I need to finish up some documentation on the new serialization stuff, then we'll get 0.5.9 and 0.6.0 out shortly after.  Our releases aren't major enough to do pre/rc releases, you can just use the path to the git repo in your Gemfile if you want to live on the edge.\n  Please post usage questions to Stack Overflow or the Google Group.\n  Thanks - and really appreciate you including a test!\n  Looks good to me -- any objections @geemus?\n Are there any keys in the credentials hash that are consistent across all providers?\n Merged, thanks!\n  Does is_avatar? never get run or does it return false?\n What is your is_avatar code in the model?\n\nIt is likely that it just isn't true yet. Add logger output in the Carrierwave conditional to see its value when it runs. \n Closing due to inactivity.\n  Trying to get all the remote Fog specs passing, but running into a few failures due to file content_type coming back nil on AWS, differently than expected on RS, and I don't have a Google Storage account:\n\n```\n  2) CarrierWave::Storage::Fog with a valid File object it should behave like AWS storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: nil (using ==)\n     Shared Example Group: \"AWS storage\" called from ./spec/storage/fog_helper.rb:216\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n\n  3) CarrierWave::Storage::Fog with a valid path it should behave like AWS storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: nil (using ==)\n     Shared Example Group: \"AWS storage\" called from ./spec/storage/fog_helper.rb:225\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n\n  4) CarrierWave::Storage::Fog with a valid Pathname it should behave like AWS storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: nil (using ==)\n     Shared Example Group: \"AWS storage\" called from ./spec/storage/fog_helper.rb:234\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n\n  5) CarrierWave::Storage::Fog with a valid File object it should behave like Rackspace storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: \"text/html; charset=UTF-8\" (using ==)\n     Shared Example Group: \"Rackspace storage\" called from ./spec/storage/fog_helper.rb:216\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n\n  6) CarrierWave::Storage::Fog with a valid path it should behave like Rackspace storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: \"text/html; charset=UTF-8\" (using ==)\n     Shared Example Group: \"Rackspace storage\" called from ./spec/storage/fog_helper.rb:225\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n\n  7) CarrierWave::Storage::Fog with a valid Pathname it should behave like Rackspace storage#store! should have a content_type\n     Failure/Error: @fog_file.content_type.should == 'image/jpeg'\n       expected: \"image/jpeg\"\n            got: \"text/html; charset=UTF-8\" (using ==)\n     Shared Example Group: \"Rackspace storage\" called from ./spec/storage/fog_helper.rb:234\n     # ./spec/storage/fog_helper.rb:48:in `block (5 levels) in fog_tests'\n```\n\n@geemus Might you have some time to see what's going on here? Please work from 0.6-stable and ignore the failing specs surrounding XML serialization.\n\nThanks!\n Thanks!\n Awesome -- thanks for taking the time to do this!\n  This is definitely a known issue, it's annoying me too and I'm working on it.\n Yep - I hit up @josevalim about it the other day too because I am out of ideas. Serializers in ActiveSupport and ActiveModel are very inconsistent and pretty confusing. Hopefully we'll get it squared away soon!\n I tried playing with serializable_hash a bit, but didn't get anywhere.  I think there are really two issues here:\n\n1) ActiveModel/ActiveRecord handle to_xml and to_json differently. Perhaps this is fixed or improved with 3.2, but there is still as_json in the mix and I'm not sure where that comes in. CW adds an attribute to an AR class, but it returns an uploader object when calling the attribute - can't figure out how rails is designed to handle that when serializing. \n\n2) When not using active record, we should still have a consistent method of serializing uploader data. If this means using ActiveModel for all CW objects, that's no problem.\n\nMaking this a Rails 3.2 and newer fix is no problem at all. The next release of CW is focusing on 3.2 and rails master support. \n @josevalim Using `serializable_hash` did the trick!  I think the last time I tried it was on 3.1.x.  We're looking good now, thanks!\n  Another approach is to store the original height and width in the database then calculate the version size based on the constraints set on a given version.  This may be overkill in your case, but we have over 25 versions of photos in an app so shelling out to imagemagick is not efficient.\n\n``` ruby\n # Calculate width from a provided height based on the original image size\n def width_from_height(h)\n   ((width.to_f * h.to_f) / height.to_f).round\n end\n\n # Calculate height from a provided width based on the original image size\n def height_from_width(w)\n   ((height.to_f * w.to_f) / width.to_f).round\n end\n```\n  Please post usage related questions to the Google Group or to Stack Overflow.\n What does User.first have in its avatar column in the database?\n  Can you provide a test and/or a sample filename that demonstrates this issue?\n I'm able to reproduce the encoding issue, but am not familiar enough with ruby encodings to come up with a working fix.  Your patch to force the encoding does not pass specs when calling store! with a unicode file.\n\nIf you are able to come up with a patch that includes tests that clearly support storing unicode filenames, we'd appreciate it!\n  The latest CarrierWave (from git master) works with 3.2.0.rc2.  It does not work with rc1.\n Can you gist your Gemfile.lock?\n The rest would be helpful - mainly want to confirm that you are in fact running the latest Rails RC. \n The Rails commit here https://github.com/rails/rails/commit/c4a29de0e0706c7a8e7641f099eedaaf60c185ec should have fixed these issues and I've confirmed that it made it into RC2.  Will look into this further as soon as I can.\n I will look into this today.\n I'm unable to fully reproduce this issue.  I see that when looking in the console it doesn't show representation of the uploader object at first glance, but it still works:\n\n```\nLoading development environment (Rails 3.2.0)\n>> p = Person.first\n  Person Load (0.1ms)  SELECT \"people\".* FROM \"people\" LIMIT 1\n=> #<Person id: 1, name: \"James Miller\", avatar: \"ss.png\", created_at: \"2012-01-20 22:24:05\", updated_at: \"2012-01-20 22:24:05\">\n```\n\nMake sure it's an uploader object:\n\n```\n>> p.avatar\n=> /uploads/person/avatar/1/ss.png\n>> p.avatar.class\n=> GenericUploader\n```\n\nCheck available versions:\n\n```\n>> p.avatar.versions\n=> {:thumb=>/uploads/person/avatar/1/thumb_ss.png}\n>> p.avatar.thumb.url\n=> \"/uploads/person/avatar/1/thumb_ss.png\"\n```\n\nUsing the example from @johnbeynon, it seems that Rails 3.2 just doesn't display the details of a record the same way as it did before in the console.  But if you call `Photo.last.class`, I'm willing to bet it's `ImageUploader` and responds to all uploader methods.\n\nIf that's not the case, please upload a sample app that demonstrates the issue.\n In any case, uploader objects are responding like uploader objects in my tests.  If you have a sample app that demonstrates otherwise, I'm happy to take a look.\n Can someone please post a full sample app that demonstrates this -- I can't debug since I can't reproduce.\n @nixme Could you paste your Gemfile?  Just in case there's some other lib that's causing this somehow.\n\nI'm working with a clean Rails 3.2.0 app using the base Gemfile + carrierwave.\n Still waiting on someone to provide a sample app that demonstrates the issue.\n @nixme Any update?  A long Gemfile may actually help if this is caused by a dependency that you all happen to be using -- I'm pretty stumped as to what could possibly cause what you're seeing.  All the tests pass (including ActiveRecord tests) on all Ruby versions using only the required dependencies so I can't investigate further until one of you sends me something.\n @tpope Thank you!  That's definitely our common denominator here and I've confirmed that it breaks CarrierWave!\n\nIf anyone still encounters this issue after removing or bumping the kaminari version in your app, please post back here.\n Digging in further, this commit to Kaminari fixes the issue:\nhttps://github.com/amatsuda/kaminari/commit/5894d6805e31b856e5dd99a9013cc4a5cbf83ec1\n @leehanbley How about creating a fresh app and adding pieces to your user model one by one?\n  Can one of you provide a sample app that has this issue?  I'd like to be able to fire it up myself and see the logs.\n Closing in favor of #401, it is essentially the same issue.\n  Not with built-in functionality provided by CarrierWave.\n\nYour application could handle this in a number of ways.  You could, for example, force the filename to remain the same so the file on S3 gets replaced -- this would ensure that pictures work from old links and would even be up to date.\n  I've just pushed a test app of the latest CarrierWave gem using Fog to Heroku and had no issues.  If you have additional trouble, please post usage issues to Stack Overflow or the Google Group.\n  This is not present in CarrierWave and is by design.  All image manipulations are always taken from the original image to ensure integrity.  You would have to implement your own callback to handle manipulations based on another manipulation.\n  I'm getting a failure when running the test for this:\n\n```\n\n  2) CarrierWave::Uploader.process should successfully process a multi-page PDF when using RMagick\n     Failure/Error: @uploader.cache! File.open(file_path(\"multi_page.pdf\"))\n     CarrierWave::ProcessingError:\n       Failed to manipulate with rmagick, maybe it is not an image? Original Error: Postscript delegate failed `/Users/jkmiller/code/carrierwave/spec/public/uploads/tmp/20120114-1611-1549-2834/multi_page.pdf': No such file or directory @ error/pdf.c/ReadPDFImage/664\n     # ./lib/carrierwave/processing/rmagick.rb:269:in `rescue in manipulate!'\n     # ./lib/carrierwave/processing/rmagick.rb:247:in `manipulate!'\n     # ./lib/carrierwave/processing/rmagick.rb:113:in `convert'\n     # ./lib/carrierwave/uploader/processing.rb:85:in `block in process!'\n     # ./lib/carrierwave/uploader/processing.rb:81:in `each'\n     # ./lib/carrierwave/uploader/processing.rb:81:in `process!'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `block in with_callbacks'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `each'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `with_callbacks'\n     # ./lib/carrierwave/uploader/cache.rb:112:in `cache!'\n     # ./spec/uploader/processing_spec.rb:89:in `block (3 levels) in <top (required)>'\n```\n Appears I just needed ghostscript installed.\n  Please consider adding a wiki page about this -- issues is not the right place. \n  I tried to avoid putting a Padrino specific initializer, like we have for Sinatra, because I thought Padrino was built on Sinatra and should be compatible. I'm open to making changes to accomodate Padrino, though, so please do investigate!\n I don't think it's unreasonable to require that Padrino comes before CarrierWave in the Gemfile if that fixes the issue.  Easy enough to add a wiki page for Padrino instructions.\n\nPersonally, I always put my app framework at the top of the Gemfile.\n\nI'll wait for your response from the mailing list, but I think this is the best approach:\n\n``` ruby\nelsif defined?(Padrino)\n  CarrierWave.root = File.join(Padrino.root, \"public\")\nend\n```\n Accepted, thanks.\n  Looks good to me. Thank you!\n  We've got a couple failing on Travis CI: http://travis-ci.org/#!/jnicklas/carrierwave\n @bensie thanks for working on this stuff. I know it's extra tricky.\n\nAlso, I just merged a pull request where I'm seeing green locally, but not on Travis:\n\n```\n[1.9.3-p0@system][master] ~/code/carrierwave $ RBENV_VERSION=1.8.7-p352 bundle exec rake\n/Users/trevorturk/.rbenv/versions/1.8.7-p352/bin/ruby -S bundle exec rspec --color ./spec/compatibility/paperclip_spec.rb ./spec/mount_spec.rb ./spec/orm/activerecord_spec.rb ./spec/processing/mime_types_spec.rb ./spec/processing/mini_magick_spec.rb ./spec/processing/rmagick_spec.rb ./spec/sanitized_file_spec.rb ./spec/storage/cloudfiles_spec.rb ./spec/storage/fog_spec.rb ./spec/storage/s3_spec.rb ./spec/uploader/cache_spec.rb ./spec/uploader/callback_spec.rb ./spec/uploader/configuration_spec.rb ./spec/uploader/default_url_spec.rb ./spec/uploader/download_spec.rb ./spec/uploader/extension_whitelist_spec.rb ./spec/uploader/mountable_spec.rb ./spec/uploader/paths_spec.rb ./spec/uploader/processing_spec.rb ./spec/uploader/proxy_spec.rb ./spec/uploader/remove_spec.rb ./spec/uploader/store_spec.rb ./spec/uploader/url_spec.rb ./spec/uploader/versions_spec.rb\n...........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................\n\nFinished in 9.25 seconds\n843 examples, 0 failures\n/Users/trevorturk/.rbenv/versions/1.8.7-p352/bin/ruby -S bundle exec cucumber features --format progress\nUsing the default profile...\n...............................................................................................................................................................................................................................................................................................................................................................................................................................................................\n\n41 scenarios (41 passed)\n413 steps (413 passed)\n0m0.889s\n```\n  @jeroenhouben check out the bottom of the readme and you'll find instructions about how to run the \"remote\" tests. \n Closing for now. @jeroenhouben please feel free to submit a new pull request or to reopen with tests. Thank you!\n I'm confused -- this pull request is being closed in favor of which fix?\n @jeroenhouben if you look at the master branch, things should look a lot cleaner now. There are Fog tests only now for cloud storage, no separate S3 tests. Can you try and get a failing test added there?\n\nWhen you do, please open a separate pull request. Closing this one as it's mostly just confusing. \n  @meskyanichi I wonder if it'd be worth making a test that uses Excon (and/or fog) directly with a single file. Perhaps narrowing down the scope of the work being done would help pinpoint the problem. \n\nFWIW I've been working on some projects lately that upload many thousands of images/thumbnails to S3 using the old aws-s3 gem, and I see all kinds of errors on a regular basis. We regularly see and rescue/retry for errors like:\n\n`AWS::S3::RequestTimeout, Errno::ESTALE, Errno::ECONNRESET, Errno::EPIPE, Errno::ETIMEDOUT, Errno::EHOSTUNREACH`\n\n...part of me is wondering if this is just something that can't be avoided. The fact that you've been able to figure out a predictable pattern is really strange, though...\n Yeah, I think this may just be a case of remote web services having hiccups from time to time. It's weird that you've spotted this predictable pattern, though. Let's leave this issue open for a bit, and please do report back if you come up with anything else. I'm suspicious that we won't find a smoking gun here, though. One thing I've done in cases like this is to use Resque. In that way, you can control the number of workers and set up rescue/retry code paths. It sounds like you're looking for raw speed, so perhaps that wouldn't be ideal, but it's been good enough for me thus far. \n @meskyanichi I'm closing this for now. If you're up for it, please consider adding a summary of the problem and a link here to the \"known issues\" wiki page. If you come up with any other ideas, please continue posting here as well.  \n  What is this?\n Hmm I'm not sure how much I care about this. Maybe someone else can chime in if they do...\n  @eraserewind please try to make a failing test case and/or provide a sample application for us to look at. This smells like a mongoid problem, but it's hard to tell without more info. \n  Yes, please check the wiki for some options, and please use the Google Group for general questions in the future. Thank you!\n  I don't think we'll want to depend on your fork, even temporarily. If/when your patch makes it into fog, though, let us know and we can reevaluate this pull request. Thank you!\n Please submit a new pull request when your changes are released in gem form and then we'll review. \n  Is there a reason you need to call `cache_stored_file!` in your `encrypt` method? I think you're just supposed to return the processed file at the end of your custom method. \n Gotcha. Well, if you'd like to work up a pull request (with tests!) that demonstrates the problem with a proposed fix, that would be awesome!\n  I took a quick read through those issus, and it looks like we're still waiting for a new pull request. \n  I don't know of a reason. Please do consider working up a pull request (with tests!) and see if you run into any problems along the way. \n  cloudfiles is still in the gem -- just not the readme. Your feedback on the fog system would be most welcome, but I understand if you'd like to revert for now. \n  Hoping to get a gem release out in the next week or so. There are a few outstanding issues that need to be resolved before that release is tagged. \n  Ok we're looking much better with Rails 3-2-stable and master support.  Commit https://github.com/rails/rails/commit/2f8a7edadb2bd79580c0ca249b36451c767205a4 fixes the issues surrounding class_attribute.  We'll get a release out quickly after 3.2 is officially released.\n Yep.  Working on it.\n @farukca Have a look at issue #583 - you likely need to update your Kaminari version.\n  I've seen requests like this before. Search around and see if someone has figured it out. Otherwise, pull requests are always welcome!\n  :metal:\n\nI'm suspicious that the other remaining Rails 3.1 issues are going to be similar config things like this. If you have the time and inclination, would you mind looking through them? I haven't used CW with Rails 3.1, so don't really know what's up. \n Thanks, dude -- would appreciate the help, but no worries if don't get around to it ;)\n I'm not too religious about that stuff, but if anyone can come up with anything cleaner, I'm all ears. We could do some fancy conditional requires behind the scenes, I guess? I dunno. \n  Please take questions like this to the Google Group. Thanks!\n  If you'd like to suggest any changes, please consider working up a pull request. Otherwise, this kind of thing is great for the wiki, so please consider contributing to that!\n Thanks!\n  I'm wondering if you could simplify this pull request to just the change you need to make. Is there a reason you added this file method?\n Maybe let's just make that change alone and forget about the tests?\n Any chance you could merge these commits into one, or submit a new pull request? It just helps keep the project history more clean. \n I don't think this warrants a release, but @bensie can work it up if he disagrees :)\n  I believe this pull request aims to do that: https://github.com/jnicklas/carrierwave/pull/509\n  Any chance you could work up a pull request with tests? Would be much appreciated!\n Oops didn't mean to close the issue. Maybe you'll come up with an idea, or someone else might. \n Closing in favor of #523\n  @bensie can you take a look at this? \n\nhttp://travis-ci.org/#!/jnicklas/carrierwave/builds/285744\n\nI think we lost 1.8.7 compat, maybe with the that new feature about moving files instead of copying? Do you have time to have a look?\n I'll work up a release once this is fixed. \n Thanks, dude! I don't know why we didn't get a failure email from Travis. Maybe they made some changes there. Once we're green I'll work up a release. \n :heart:\n Yeah, I just tested as well. I'll hit up the Travis guys. I'll go ahead with the release anyway. You wanna work up the History or me?\n Merci. Are you set up for releasing the gem? If not, hit up @jnicklas and see if he can add you. Seems like you're the main maintainer nowadays anyways :)\n\n(ps thank you :)\n I dropped him a line in case he's ignoring all the noise here :)\n OK releasing\n Yeah, they said hop in #travis on IRC but I haven't had time to\ninvestigate. Feel free if you do, but I'm not too concerned to be honest.\n\nOn Wednesday, November 16, 2011, James Miller <\nreply@reply.github.com>\nwrote:\n\n> Any word from the travis guys?  Passing on 1.9.2, failing on 1.9.3,\n> passing on ruby-head.  Nice.\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/520#issuecomment-2770402\n  Please ask questions like this on the Google Group. Thanks!\n  If you think you've got this figured out, a pull request with tests would be most welcome!\n Unless someone has a solution to this, I'm thinking we should move it into the \"known issues\" wiki page soon. A pull request from someone would be most welcome, though! \n OK moving to known issues. \n Sorry, I don't know how exactly to go about this. Good luck to whoever decides to give it a shot! \n  Any help in tracking this down would be appreciated. It sounds like it may or may not be a problem with CarrierWave itself, but definitely worth looking into. \n I wouldn't think so, since the issue is still open here. \n Hang on a second -- is this covered in the \"Filenames and unicode chars\" section of the readme?\n Quintus, check out the readme and see if that helps. I think it should be a solved issue, but maybe not..?\n  Hmm I can imagine. A pull request that fixes this would be great, otherwise I'd suggest using a workaround in your app. I haven't heard anyone else requesting this before. \n If you manually save or save! then does it all work? I'm thinking the problem is limited to the dirty attribute stuff...?\n @aaronchi I just pushed a bare-minimum implementation for this. Let me know what you think. \n\n@bensie feedback more than welcome on that change. \n  We're going to need more detail to help. Check out the \"getting help\" section of the wiki. \n That's still not enough detail. Please re-read the \"getting help\" section of the wiki -- it explains what kind of information we need. \n Can you include the Model and Uploader as well? Also, are you just using carrierwave, or also carrierwave-mongoid or something? It looks like the Active Record ORM adapter should work, but...\n Thanks for the update @dotnil\n  I thought about this a bit and couldn't come up with anything better. WDYT @bensie?\n Sure, that sounds fine to me. @antonversal wdyt?\n  Can't you just use #model in the called method? It's just an instance method in the uploader, no? Also this breaks the existing API, so probably shouldn't be applied without some kind of backwards compatibility.\n  1) If you really need to do this, you can easily use manipulate! to get this very nicely in your application code. No problem, no need to include it in CarrierWave.\n2) Why would you _ever_ possibly want this?????\n  @tonycoco any chance you could work up a doc patch? If you have any ideas about fixing this in the code, that would be great, too. Maybe a comment in the upload generator at least?\n Closing in favor of #529\n  Imo, 0.4_stable should only receive critical bugfixes. This is more a feature.\n  This seems weird to me. Have you considered just having a file that's like 1 byte or something? I'm game for including this if you really think it's necessary, but seems strange at first glance. \n  @geemus, awesome! \n\nRemember, you can always use the latest fog with Bundler's git repo support. \n  This isn't really a bug. Please consider adding a wiki page about your findings, though. I think there may already be a similar page about random filenames. \n Right, there's no guarantee that this method will only be called once, so you need to keep that in mind. \n  @geemus would you mind reviewing this?\n Thanks for looking @geemus.\n\n@chrisdurtschi I'm getting lots of test failures. Did you run the full test suite with your changes? \n\n```\n     Failure/Error: @fog_file = @storage.store!(@file)\n     TypeError:\n       can't convert Tempfile into String\n```\n\nPlease re-open this pull request or open a new pull request if/when you have time to fix things. \n Thanks!\n  I'm not sure, but I think you have to change the name yourself. You can see the \"Using RMagick\" for an example. I think that should work, but I'm not sure. If you figure it out, please consider making a \"how to\" on the wiki. \n Sorry, I meant to type \"in the readme\" :)\n Maybe you can make a custom processor that does the renaming? \n Closing for now. @jgyllen please holler if you figure out how to accomplish what you wanted. \n  You can just use \"root_path\" or whatever if \"image_tag\" etc isn't working for you. If you want to propose some solution along the lines of fog_host, please consider working up a pull request.  \n  I wouldn't call it a bug -- maybe a missing feature. Maybe we need to support a lambda? I dunno -- if you (or someone else) wants to work up a pull request, it would be most welcome. \n As I said -- pull requests are most welcome! :)\n @SixArm thanks for the offer, but I'm not available at the moment. You could try elabs (where @jnicklas works) or ask around on the Google Group? I'm sure we'd accept a reasonable pull request with tests etc. \n  I don't think this is what we want.\n\n```\n  1) CarrierWave::ActiveRecord#mount_uploader#image should return valid JSON when to_json is called when image is present\n       {\"event6\"=>{\"textfile\"=>nil, \"id\"=>4, \"foo\"=>nil, \"image\"=>{\"url\"=>\"/uploads/test.jpeg\"}}}\n     # ./spec/orm/activerecord_spec.rb:93\n\n\n  2) CarrierWave::ActiveRecord#mount_uploader#image should return valid XML when to_xml is called when image is present\n       {\"event8\"=>{\"textfile\"=>nil, \"id\"=>5, \"foo\"=>nil, \"image\"=>\"test.jpeg\"}}\n     # ./spec/orm/activerecord_spec.rb:109\n```\n\nWe want these to match, and they don't with this pull request. It's arguably better than what we have now, but I don't want to support this going forward -- to_json and to_xml should match, so I think it's best for to_xml to return nil until we can get it right. \n\nThanks for looking at this, though. A working solution would most definitely be welcome!\n  @jcarlson would you mind pulling this work into a single, new commit and submitting a new pull request? I think that would be the cleanest thing to do. Thank you, and sorry about that -- I shouldn't have merged the pull request without running the tests first. \n  The s3 storage module has been deprecated in favor of the fog storage module. You can use fog_host there, I believe, to accomplish what you want. Please let me know if not. \n Not your fault, I haven't actually deprecated it, I'm just trying to push people to use fog and plan on removing it eventually. \n  Please consider submitting a pull request with the documentation fix. Thank you!\n  @bartt I'm seeing \"This pull request cannot be automatically merged.\" so you may need to rebase your commits in order for us to merge. I'd check with @jnicklas before doing more work, though -- I'm not clear on whether or not he's interested in merging. \n Merged -- thanks @bartt!\n  Caused test failures :(\n\nhttp://travis-ci.org/#!/jnicklas/carrierwave/\n Please just provide a new pull request if that's OK with you\n No, I think there was a failure: http://travis-ci.org/#!/jnicklas/carrierwave/builds/157662\n\nI think I tested locally, too. Sorry if I made a mistake, though. I was working late ;(\n yeah please do\n  Is this at odds with #445?\n I'm getting a few failures with the cucumber features. Can you please make sure the tests run cleanly and resubmit a new pull request? Thanks!\n  Is this at odds with #448? Also, I'm seeing \"This pull request cannot be automatically merged.\" so if we're going to merge, it would be nice to have a rebased version. \n  Thanks for working on this you guys. \n\nIn a general case with Rails, the form params will come along with the content_type of an uploaded file, which Carrierwave will be pass along to fog. Things can go wrong when the content_type is lost when a file is cached and then uploaded with fog. The caching process loses the content_type. \n\nThis commit reverts my lame attempt to fix that: https://github.com/jnicklas/carrierwave/commit/dfc97feb85d6afe3e47170181da3b0964b7aa39b\n\n...this new mime-types stuff is much better.\n\nSo, perhaps it's worth mentioning this typically only matters if you (a) care about the content_type, and that's usually when you're (b) uploading to a fog-backed storage service. \n\nAnyway, lemme know when you've updated this. I think adding info to the readme is definitely smart, but this could use a bit more clarification. \n I may trim this down eventually, but it's definitely good enough for now. Thanks for taking the time to work on this!\n  The s3 storage provider has been deprecated in favor of the fog storage provider. Please try to use that instead, and let me know if it doesn't meet your needs. I think the fog_host config option will be a good fit for your case. \n  Can you provide an example app? I don't quite understand what you mean. For example, I made this a while back to reproduce an issue: https://github.com/trevorturk/carrierwave-issue-381\n @ketanjm I'll close this issue for now. Please provide more detail if you're still having trouble. \n  Can you provide a sample app that uses the most recent version of CW? A full stack trace would help, too. Here's an example I made to track something down: https://github.com/trevorturk/carrierwave-issue-381\n @brewster1134 can you provide an example before/after?\n This seems to work for me. Maybe you'd be interested in making a wiki page about it?\n Forgot the link :) https://gist.github.com/5d66897d88d1b5dfbea5\n Yeah, pull requests and wiki pages would definitely help. I agree the docs need some work. It was hard for me to tell what was the \"right way\" to do this :)\n  @nahi thanks for looking at this. Do you know if there's any work being done to get sqlite3 working on jruby? I'd rather\u00a0not have this in CW but if it's necessary...?\n Merged, thanks!\n  0.5.8 should have this, you can also pull from the 0.5-stable branch\n Issue #401 has been the reason for holding back a gem release, but it seems the issue surrounding it has been around for awhile now and another gem release isn't going to hurt anyone. I'll get 0.6.0 and 0.5.9 out in the next few days.\n :sparkles: 0.6.0 is released! :sparkles:\n Wasn't planning on it - 0.5.x doesn't officially support Rails 3.2 because of some backward-incompatible changes in ActiveSupport. 0.6.0 requires ActiveSupport and ActiveModel 3.2.0 or greater, so cw-mongoid should probably do the same for a 0.2.0 release. I pushed cw-mongoid yesterday setting the dependency on CarrierWave to ~> 0.5.x.\n\nGlad to hear you're going to tackle the mongoid fixes!\n  There's a page in the wiki about how to accomplish this. \n Yup.\n\nOn Monday, August 15, 2011, bdclimber14 <\nreply@reply.github.com>\nwrote:\n\n> I'm guessing you're referring to this page:\n> https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Create-random-and-unique-filenames-for-all-versioned-files\n> ?\n> \n> I edited the page to set the instance variable @name instead of just\n> returning the random GUID. It seems to work now. Is this correct?\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/432#issuecomment-1812133\n  I don't think anyone with commit access to CW uses Windows, so this is very likely something that a new contributor will have to look into and fix. Pull requests are definitely welcome! I'll leave this open for a while, but if nobody comes around to offer a fix, then we'll have to relegate it to the \"known issues\" page in the wiki. \n  I think using this is recommended:\n\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/processing/mime_types.rb\n\nPerhaps we could use some better documentation? Pull requests welcome ;)\n If you have a suggested change to CW that you could turn into a pull request, that would be welcome. Otherwise your workaround may be the best solution, or else maybe you can use the new mime_types support. \n That's great -- thanks. Please add a \"how to\" to the wiki. \n Very cool!\n  Perhaps the problem is that the model doesn't have an id when you store! the file...? I think something like this would work as expected:\n\n```\n@post = Post.new(params[:post])\n@post.save\n\nif params[:post][:photos].blank?\n  @post = Post.new(params[:post])\n  @post.photo = File.open(\"#{Rails.root}/app/assets/images/rails.png\")\n  @post.save\nend\n```\n So then would you want:\n\n```\npost_photo = @post.photos.build\npost_photo.photo = File.open(\"#{Rails.root}/app/assets/images/rails.png\")\n```\n\n?\n Yeah, because I think in your example app the model.id wouldn't be set until you called save! so store! would have been before that, right?\n  @geemus, I'm seeing this:\n\n```\n[WARN] Fog::Storage::AWS::Files => #get_url is deprecated, use #get_https_url instead (/Users/trevor/.rvm/gems/ruby-1.9.2-p290/gems/fog-0.10.0/lib/fog/storage/models/aws/files.rb:10:in `<class:Files>')\n```\n\n...when running the tests with the latest fog. Is there a way to avoid the deprecation warnings without setting a minimum version for fog? Or do you think that would be smart in any case?\n Yeah... OK would you mind updating the gemspec to use the recommended version, fixing the deprecation warnings, and changing the text \"You don't have the 'fog' gem installed\" in fog.rb to suggest a minimum version? If it's possible to enforce a version there (or elsewhere), that would be nice. I don't want to add dependency in the gemspec because you should be able to sue CW without fog, but maybe there's a middle ground...? I'm not sure if there's a best way to do that. \n\nNo rush on any of this, but I'd appreciate your looking if you have time!\n Maybe worrying about the minimum version isn't even necessary. If you update the fog provider to use the new methods, then the older version won't work, and we can add a note to History.txt about raising the minimum required version and tell people in the Google Group or whatever. Probably not a big deal. \n Ah that's great. Let's just call this issue \"fixed\" then -- thanks for looking! I'm excited to see that EY blog post BTW! :)\n  Documentation improvements are most welcome! Please consider making a pull request and/or adding something to the wiki.\n  I'm not sure what you're talking about. Can you create a failing test case or publish a sample application demonstrating the problem? \n I'm not sure what you mean by \"fallback image\" -- do you mean the cached images are publicly accessible? The part in the read me that says \"Making uploads work across form redisplays\" or so? Perhaps you need to set the cache_dir to something public?\n Ah -- thanks @bensie -- OK we'll have a look when the release is finalized and fix things up. @fuksito please do provide a sample app if you have time. \n Sorry, but I haven't had a chance to play with Rails 3.1 + CarrierWave yet, so I'm no help. \n  Awesome!\n  Seems like you're onto something! Any chance you could try to work up a failing test case and pull request to fix it?\n I'm not sure about the name, but the last idea sounds best to me so far. Thanks for giving this so much attention. I really do appreciate the contribution, and I hope you're able to come up with something you like. \n  I'm not sure the config option is necessary. I can't see a reason this would be a problem. Maybe @bensie has an idea?\n  Should that \".\" be a \"_\" instead?\n  I thought someone submitted a pull request to change the default as you're describing, but I took a quick look and couldn't find it. Maybe you can dig around a bit and do better. Also, we have the new \"remove_previously_stored_files_after_update\" option that defaults to true. Maybe that's part (or all) of the problem?\n I lean toward having the default be as you've (unhappily) experienced. But let's not argue about it -- I'm hoping to move mongoid stuff here shortly: https://github.com/jnicklas/carrierwave/pull/414 -- so you can have the conversation over there eventually. Perhaps we need to make the change more clear in the History.txt file, though. I don't want anyone else getting bitten by this, so if you can hunt around and let me know what you find I'd really appreciate it. Thank you!\n OK that config option is documented well enough, I think. If you want to submit a pull request that improves things, please do! Thanks for checking into this and getting back to us. \n  Can you provide a small sample app or something? Is this an old Rails version? Maybe it doesn't support the \"dirty tracking\" features we assume to be present? CarrierWave is now Rails 3 only. \n Thanks for the info. I'm sorry to say, but I haven't heard of this issue before, so you may be the only person experiencing it. That means you may have to take it upon yourself to try and fix it, if you have the time and ability. I'll leave this issue open for now, but if you (or someone else) doesn't find a resolution, we'll document the problem in the \"known issues\" wiki page and leave it at that. I'm sorry for the problem. Good luck!\n I'm going to close this for now. Feel free to add an entry to the \"known issues\" wiki page and/or call for help on the Google Group. \n  Closing in favor of #414 -- sorry about the confusion with carrier wave and mongoid, and thanks for your contribution. Once we sort things out, please direct pull requests to the carrierwave-mongoid gem where possible. Thanks!\n  This has been discussed here: https://github.com/jnicklas/carrierwave/issues/388\n\nSee the other open issues, too -- we're planning to extract mongoid support into a separate gem sometime soon. \n  See also: https://github.com/jnicklas/carrierwave-mongoid/pull/2\n I don't think we support MongoMapper anymore. Maybe there's a gem already (check the wiki) if not, please feel free to make one and reference it from the wiki. \n  Cool idea, consider starting a discussion about it on the Google Group.  If you can take the time to work on it, we'd welcome the contribution!\n  XMLHttpRequest does not allow file uploads.  There are a number of workarounds for uploading files via AJAX, but by default Rails falls back to a standard POST request.\n That's outside the scope of what Carrierwave does -- check out plupload, uploadify, or search for other AJAX file upload javascript libraries.  It's a frontend browser issue, not something that can be implemented in the Ruby library.\n Check out Uploadify, Plupload, and other client side libs that support AJAX file uploads. \n  I would highly recommend MiniMagick over ImageScience, especially if you're going to Ruby 1.9 anytime soon.  ImageScience doesn't run on 1.9 and is no longer actively maintained.\n\nWe'll welcome any pull requests to fix the issue, but I'm personally not inclined to fight with ImageScience.\n  Thanks!\n  This looks good, though I don't like to encourage the use of methods like convert(\"png\", false).  Would you mind reworking to have the convert method take an options hash as its second argument?\n\nAlso, might you be up for tackling a test here?\nhttps://github.com/jnicklas/carrierwave/blob/master/spec/processing/rmagick_spec.rb#L23\n After testing this locally, I see it breaks a few specs because of `undefined local variable or method 'current_path'`\n\nFeel free to submit a new pull request that fixes this -- and make sure you run the specs and add any relevant tests for the changes you make!  Thanks!\n  As an avid user of MiniMagick, I agree.  Thanks.\n  OK I'm going to close this for now, then. \n Both Trevor and I asked for a sample app because we couldn't reproduce.  Time went by, you didn't send anything, so the issue was closed.\n\nWe don't leave issues open forever when they're waiting on more info.  When you can send a sample app that demonstrates the issue, open another issue and reference this one.  We'll get to it.\n Closed just means off our radar as something actionable until something changes, it's not deleted.\n\nIt can be reopened at any time if the conversation continues and we still get notifications when updates come in.\n @trevorturk keeps the :v:\n @larskuhnt is correct that using `@event.remove_image = true` followed by a save should do more of what you're expecting.\n\nI'm still trying to figure out why there are a bunch of similarly named remove methods that seem to do very different things.\n\n@bcardarella Thanks for posting your code and specs.\n Haha yeah I'd have to agree with you there. There are definitely issues surrounding removing images and I'd like to get these fixed before the next release.\n\nWould really appreciate any pull requests to help get this fixed, I probably won't be able to get to it for a few weeks.\n Closing in favor of #712 - please give it a try! Thanks @chopmo!\n  Can you resubmit this patch to work for current and future versions of Mongoid?  We can't merge this knowing it causes specs to fail and will break existing applications.\n  `config.load_paths` is removed in Rails 3.\n\nIn config/application.rb, try\n\n``` ruby\nconfig.autoload_paths += \"#{Rails.root}/app/uploaders\"\n```\n\nThat said, this shouldn't be necessary -- I have several apps working without autoloading uploaders.\n I'd still like to see a sample app -- autoloading shouldn't be needed.\n I just tried out @trbartel 's app and had no problem getting it running after changing the following:\n\nYou need to specify that it's a multipart form in /app/views/users/new.html.haml\n\n``` haml\n= form_for @user, :html => {:multipart => true} do |f|\n```\n\nThere's a typo in your User model that's making `image` not an accessible attribute via mass assignment...make sure there's a comma at the end of this line:\nhttps://github.com/trbartel/coaching_app/blob/master/app/models/user.rb#L45\n\nYou also have a duplicate migration file that I had to delete (the last one):\nhttps://github.com/trbartel/coaching_app/tree/master/db/migrate\n In case it wasn't clear, nowhere along the way did I get an `uninitialized constant User::ImageUploader` error and I had the config.autoload_paths declaration removed the entire time.\n All good here -- turned out to be an issue unrelated to CW.  Let us know if any of you find specific cases that cause this to happen.  Thanks!\n  Yes you're right I did add a dependency on ActiveSupport::Deprecation and forgot the require.\n\nThis was the best that I could come up with -- without the silence, this warning will be raised any time `class_inheritable_accessor` is called (running the tests or in logs) when using ActiveSupport 3.1.x.  `class_attribute` will be used whenever `class_inheritable_accessor` isn't available, but we can't depend on `class_attribute` having the needed `instance_reader: false` option until AS 3.0.10 (yet to be released), 3.1.0.rc5 (yet to be released), 3.2 and beyond -- this commit was applied to master, 3-1-stable, and 3-0-stable: https://github.com/rails/rails/commit/c533517362a8bc29b0b2295bee1685b3d8ea0929.\n\nI was aiming to eliminate deprecation warnings given that the issue is fixed.  Thoughts?\n  Confirmed:\n\nhttps://gist.github.com/1076543\n  I'm having trouble understanding what this fixes.  You said:\n\"When using \"normal\" callback definitions, the 'nil' returned by :store! did not halt the chain\"\n\nUnder what circumstance did it halt the chain?  Can you provide some sample code from your application to help me understand the use case?\n\nReturning `true` from that method if the uploader is blank seems counter-intuitive to me (and without any comments or tests the intent is unclear), but maybe further explanation can clear this up.\n I've been unable to reproduce this -- can you push a sample application to GitHub that contains the issue?\n Closing for now, pending further activity. \n  This commit bdc6788e3a1e4b777613a3fb54e9d3915fe51649 added this.  A failing test would be most welcome!\n @skyeagle Can you chime in on this issue?\n @ches, please do take up the issues in the carrierwave-mongoid repo. I don't have a strong opinion as I don't use Mongoid much. Thanks for testing this stuff out. I'll try to review and merge in the changes soon. \n  @clyfe Were you able to come up with a test case for a situation where `MIME::Types.of(File.basename(cache_path))[0].present?` evaluates false?\n I reverted the offending commit (sorry about that) since we can use CarrierWave::MimeTypes now (https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/processing/mime_types.rb) if we care about having the cached and then remote-uploaded file getting a content_type. \n  @iwasrobbed Can you post your uploader code so we can see a case where this happens?  Does it only happen when replacing an old image with a new one?  Or on new records as well?\n  It's alright, I'll take care of squashing this time.\n Squashed and committed here: 3850f67ce1b7d25db595c3e2ec28b81ac172467c\n Sounds good to me -- the only one that is up in the air is #381 - but I'm pretty sure this is fixed in master.  Hoping he'll report back soon.\n @did - nothing too crazy: `git merge did/mongoid --squash && git commit -m \"Commit message\" --author=your@email.com`\n  @jcarlson Were you able to update to master and test this?  We'd like to get a release out, but would like to get confirmation that this issue was fixed.  Thanks!\n Can you test with the latest master on the off chance that #423 impacts this?\n Yeah, this is still a problem. I made an example app:\n\nhttps://github.com/trevorturk/carrierwave-issue-381\n\nI'm going to try and work up a failing test and investigate from there. Any help would be much appreciated!\n OK I think the problem is that your uploader code was bad. I've updated the example repo above and things seem to work correctly now. Please confirm and let me know what you think. \n  Can you rebase and squash this to a single patch?\n  I'm interested to know any issues you're having with HEAD.  Will wait to merge until you try this with a real app.\n Cool -- merged!\n Soon!  Just waiting to hear confirmation that the last blocking issue was successfully fixed.\n The last blocking issue if you're wondering: https://github.com/jnicklas/carrierwave/issues/321\n  The readme includes instructions on how to handle this:\n\n``` ruby\nclass AvatarUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n\n  process :resize_to_fill => [200, 200]\n  process :convert => 'png'\n\n  def filename\n    super.chomp(File.extname(super)) + '.png'\n  end\nend\n```\n\nIf you can take the time to work up a pull request to get this feature added, we'll gladly merge it.  Thanks!\n  Yes, you can override this if you'd like to change the generated filename.\n  This is a question for the Google Group - http://groups.google.com/group/carrierwave\n\nWhen posting there, I'd recommend including your model, uploader code, and version info for everything your using.\n  @omargallob Please post this and other application-specific questions to the Google Group - http://groups.google.com/group/carrierwave.  The issues here are for reproducible bugs.\n\nYou'll also want to include code snippets from your app so we can better help you, not enough info here.\n  Just so I'm not missing something here -- are you having trouble with dev/test or production?  I don't see a `config.storage = :fog` in the `else` of your `Carrierwave.configure` block.\n  Merged, thanks!\n  I've reverted this commit -- appears it did in fact break a few existing specs.  Feel free to open another pull request if you want to take another crack at it.\n Fair enough - are you up for reworking the fix?  Don't want to apply failing specs to master without a patch.\n Adding failing specs makes things much more difficult for people who are cloning the repository and getting started on a fix/feature of their own -- everyone should start with a clean slate.  IMO, failing specs without a fix belong in a topic branch.\n  The markdown Readme file should still work in `s.extra_rdoc_files  = [ \"README.md\" ]`\n\nAny reason you took that out?\n Merged, thanks!\n  In the first commit you have a spec for \"returns nil if content_type has not been updated\" -- why wouldn't we always set an original_content_type?  Whether or not it gets updated, original_content_type by definition is whatever was there at the beginning.  I'm definitely on-board with merging this first commit, but just wanted to gather additional thoughts on this piece of it.\n\nI like the idea, but don't think CarrierWave::MimeTypes makes sense as a \"processor.\"  Processors manipulate images, whereas MIME::Types just does some work based on reading the file name.  Would make documentation for processors inconsistent.\n I've added a commit (f5344de26951af8a56089fc583b6bb4804f27abd) to allow overriding the content_type without the need for metaprogramming.  Even though it's a simple attr_writer method, it's fully defined for clarity.  Thinking about it more, I don't really care what the original content type was if I'm forcing a change, so I'm not sure the `original_content_type` code is even necessary.\n\nWe'll let @jnicklas weigh in on adding different processor types to core.  I think that while \"processors\" could mean anything to do with files, it currently only means image manipulation in Carrierwave.\n Yeah go ahead and make up a new pull request for the MIME::Types stuff and we'll get it merged.  Thanks!\n  Interesting....I'm seeing the same thing -- 1 folder for each assertion that involves setting a CW attribute.\n I've seen both in my app ./photos and ./public/photos (my upload folder is called photos) -- annoying and I have no idea what caused it\n Trying to get this fixed -- can you guys paste some code so I have details of how you're testing your CW uploads?\n @JangoSteve Do you have any tests in your app that test uploading files with CW?  Looking for the tests themselves.\n Thanks guys, I really just wanted to make sure it happens in all cases and not something very specific.  This is a tough one to track down.\n No update yet...patches or ideas are welcome if you have any clues to the cause.\n Can you come up with a pull request preferably with tests demonstrating what that fixes?  Seems like an odd fix to me...\n Sadly, yes it is.\n  Please post specific problems you're having in your app on the Google Group: http://groups.google.com/group/carrierwave\n  This appeases the tests, but didn't fix the in-place modification of version_names.  I've pushed a fix here: 5289df731a8edadf829dcbec0c71d38fd547c13c\n  We'd welcome a patch if you'd like to tackle this (as long as it doesn't change existing naming conventions).  You could also write up a Wiki article showing how you're handling the override.\n\nAlthough you can override filename within a version block, it doesn't mean you should...\n  Looks good and works well.  Thanks!\n  FYI I just pushed 6943676277b58af25cffd07486532c39a36671c4 a short while ago, which combines the 2 config options into the single `delete_tmp_file_after_storage` option.\n\n@chrisbloom7, 0.5.6 included #393, which should fix your issue.  If it doesn't please open a new issue with details.\n  Yeah this one is no fun -- `class_attribute` is definitely not a drop-in replacement for `class_inheritable_accessor`\n Yep I'm on it.\n I need another set of eyes on this.  I made a gist of a stripped down version of what carrierwave is doing, and it works as expected given instructions from @josevalim.  Plug this into processing.rb, I get the same issue as @slbug.\n\nhttps://gist.github.com/1012891\n @slbug I'm getting your expected behavior in https://gist.github.com/1012891, but the processors array is empty on an uploader class when dropping into Carrierwave (and running tests).\n Can you create a pull request and we'll get it merged?\n That's fine, take your time.  Just want to make sure you submit the final patch via pull request, not a diff.\n I've pushed your progress so far with storage and processors (1593fbe9b13bec00507b35bc6ea902fc5433f8ec and a880b0b00398a32b5196daa4da48e263374fd8c0).  If someone doesn't get to fixing versions in the next few days, we'd welcome another patch!\n I have to defer to the experts on this one, can't get class_attribute :versions working.\n\nGot this far (trying to follow instructions from @josevalim when it comes to in-place modification), but there are still about 50 tests failing with this :(\n\nhttps://gist.github.com/1015739\n @josevalim, Is there any way that I can override an instance reader with `class_attribute` (while also extending ActiveSupport::Concern? https://gist.github.com/1033533\n\nThe wall I'm hitting is that `class_inheritable_accessor` allowed disabling the instance reader (in addition to the writer), and it looks like the order that ActiveSupport::Concern does the mixing in is adding the `class_attribute` after the ClassMethod and InstanceMethod definitions.\n I submitted a Rails pull request to hopefully get this fixed: https://github.com/rails/rails/pull/1765\n Closed by 4e77a7fbd1e48ddc3ba06dc2a74caa6177e7977b - yay!  Thanks to @josevalim for accepting the Rails patch.\n  Yes, this has been discussed before. My concern is that we don't actually know what the cached directory was when the cache file was created, since the user can override it to whatever they want and we risk deleting directories which we might not actually want to delete, or changing the permissions of that directory behind the user's back.\n It's one of these issues that comes up again and again, yet no one wants to submit an actually working solution. Deleting the cache directories is stupidly simple in your own application, but since we don't know _anything_ about how your app works in CarrierWave, it's nearly impossible for us to solve. If you can come up with something, then please, submit a pull request, meanwhile, I'm with Trevor that there is no point in just letting issues lie around for years with no activity.\n This is the problem:\n\n```\ndef cache_dir\n  'I/can/change/this/to/whatever/I/want'\nend\n```\n\nPeople can put these cached files _anywhere_, and if we just randomly start deleting directories, well that's no good.\n @ened: that sounds sensible actually. Can't remember off the bat how this all fits together, but I think CW creates subdriectories within the cache_dir, but I'm not quite sure.\n Just dug through it, looks great.  Testing now and will merge in a bit...\n  I've tried a few things to get this working, unfortunately I don't have an answer.  You'll probably need to override to_xml so the mounted column gets skipped.  We would welcome a patch if you have any ideas!\n @trevorturk, would you mind reviewing the above patch before I merge it?  It disables uploader columns in serialization hashes and assumes that if you want to include something about uploader columns in your models, you need to override the method.\n Ok I'll go back to the drawing board.  I agree that there must be a better way, just not sure what it is -- ideas?\n @bensie I played around with a few things today, but didn't quite get it... yet... :)\n\nhttps://gist.github.com/409cb5a6dd917ed2b18d\n\nBasically, it looks like the \"as_json\" stuff is working for \"to_json\", but I can't find an \"as_xml\" for \"to_xml\" if you know what I mean. So, maybe we'll have to just remove the uploaders from the \"to_xml\" output (as you suggested) but this \"proc\" feature seems like a potential solution to get the xml output matching the json output. Maybe we could use \"serializable_hash\" somehow -- I'm not sure what that's for...\n\nAnyway -- I think this is a solvable thing, and we may be getting closer... :)\n\n(If anyone else is reading this -- suggestions are more than welcome!)\n Sorry, this is the best I could come up with :(\n\nI'm going to post a call for help to the Google Group -- maybe someone knows how to fix this issue properly. \n @scottwb looks better than nil to me. Wanna work up a pull request and fix the tests? I think we could get rid of the \"fixme\" comments honestly. If it works, it works ;)\n  I saw some weird edge cases with caching/memoization in place. If you guys can solve those then I'm all for it, but I'm not too worried about the performance implications of this.\n  I think this is quite an uncommon use case. You would still be able to do this through a callback or something, but I'm not sure it should be supported out of the box. As Trevor said, most likely your entire app should be running as the same user.\n  If you're storing your images outside the public directory, they will not be accessible without some additional work. That is after all the point of not storing them in the public directory, no? You'll need to set your application up to serve files from wherever you're storing them, and then generate a proper ID there. Search the mailing list archives, and try to figure this out on your own. If you're stuck, ask for help on the list.\n No, it's not a problem with CarrierWave, you're just not understanding how this works. Your web server can't serve files from whatever location on your hard drive, that would be a huge security hole.\n  Feel free to continue this discussion on the Google Group.  I'm sure this would be a welcome addition to New Relic, but isn't an outstanding issue with Carrierwave.\n  @jnicklas verdict on this?  I agree with @trevorturk that this belongs in the wiki.\n If it were up to me, each of those would be removed (except for the Rails railtie).  Yes, there's some old code in there that handles Merb (that Merb stuff is from mid-2009), that doesn't mean the design going forward is to add support for every micro-framework into core.  It's simple to make it work for a given framework with a few lines of code.  Adding something like this also creates the assumption that we test the library against Padrino, which we don't.\n  Looks like there are some goodies here: https://github.com/jnicklas/carrierwave-mongoid\n At this point I'm still merging mongoid pull requests into CW master -- what's the plan for officially extracting?\n Closing in favor of #414, which comes with https://github.com/jnicklas/carrierwave-mongoid/pull/2 and alleges to clean this all up. \n  I agree with @gucki that we should be able to store only the path. I'll merge this for now and we can keep working on improving this.\n  We did the extraction for two reasons:\n\n1) It's a pain to maintain so many ORM adapters, we're constantly fighting with the tests and new versions, and it's just annoying in general. Slimming down the main repo means it becomes easier for us as maintainers to work with CarrierWave.\n2) It's good to show other developers how to build a freestanding ORM adapter for CarrierWave.\n\nWe extracted Sequel and DataMapper because those to us seem like they are used the least. So in effect, yes, it is a prioritization of Mongoid and ActiveRecord. However thinking about this more, I'm starting to feel that maybe we should extract Mongoid into a separate gem as well. I have no doubt that ActiveRecord is the most commonly used ORM and I feel strongly that it should remain part of the main CarrierWave repository.\n @solnic: that's another reason for extracting them into gems, that way people who care about the adapters (I never use DataMapper nor Sequel) can easier take ownership over the gems and make them great. Looking forward to your contributions :)\n  Wow, why the hell would it do that? Looking at that code it seems like it's not doing anything particularly strange, why would the value of self carry over between different versions? Hmm\u2026 will need to investigate this.\n Can everyone try master (just pushed 4e77a7fbd1e48ddc3ba06dc2a74caa6177e7977b) and post back here if there are still issues?  This includes specs from @Eleo for nested versions.\n  You need to provide way more details than this, and please send questions to the mailing list.\n This is what you should provide in a bug report:\n1. What did you do?\n2. What did you expect to happen?\n3. What actually happened?\n4. Any relevant code\n5. A stack trace\n6. Version numbers of any library you're using (in this case, OS, Ruby, CarrierWave, ImageMagick, RMagick)\n\nNotice that out of those six items you should provide in a bug report, you only provided number 4, relevant code.\n\nAs I said, please post your question to the mailing list, with all of that information provided.\n\n/Jonas\n  This is breaking for me on master too :(\n Managed to fix this up (I think), and pushed it to master, good job!\n @ened: seems to work fine from what I can tell, but please pull it down and check, if you're still having problems, please create an issue.\n  Good job, merged!\n  No idea what you're doing but that doesn't look right at all. You can't assign an uploaded file to an association. Please ask questions on the mailing list, the issue tracker should only be used if you're fairly certain that you've encountered a bug.\n  I've noticed this too. I haven't been annoyed enough to fix it myself, but I'd really appreciate a pull request on this! :)\n  It's probably all the different pull requests being merged in the wrong order, but this seems to break for me know, could you check it against the latest master?\n Pushed.\n  Yeah, that would be awesome!\n  That sounds sensible to me.\n  I kind of dislike having yet another method which can be overridden. I do see the point, but is this really necessary? When would you have to override full_original_filename anyway? I'm cautiously -1 on this.\n After reviewing this, we found that the full_original_filename method only impacts the name of the cached files, never the stored files. It seems to me that those names are kind of unimportant and therefore, this change isn't necessary. I'm closing this for now, please elaborate if you still feel this is needed.\n  Can't you just _not_ process the original version? What's the point of this?\n Sorry to do a 180 on this, I know I originally said that I'd accept a patch for this, but after careful consideration and talking this through with Trevor I don't feel that this feature adds enough value to be worth it. You could simply create a new version for the watermarked image in the original discussion on the mailing list.\n\nI'm closing this. Sorry.\n  @fbjork is this a problem with carriewwave or carrierwave-mongoid? Can you make a failing test case and open an issue where appropriate? Thanks!\n  I tested it and was unable to replicate the problem, I'm closing this issue. If you're still having problems, please send a pull request with a failing spec.\n  Thanks for putting this together. I'm sorry, though -- it's a bit over my head. Can you please explain why you need this? Maybe that'll help me understand what's going on :)\n I see! So, have you looked into this on the master branch as well? I'm wondering if the same problem exists there. \n OK - thanks. I'm going to be very busy for a few days, but I'll get to this again ASAP. \n  I'm not sure what you mean.\n You might be using an older gem? That new config works with 0.5.3, which I just released. \n I'm not sure what to tell you -- maybe you're using \"storage :s3\" instead of \"storage :fog\" -- anyway, the new config works with the new gem, so you must be doing something wrong :)\n  Please open a pull request for this kind of thing. \n  Carrierwave does not support using the model id in the filename. Please see the wiki for some ideas about how to accomplish different naming schemes. If you have questions like this in the future, please use the Google Group.\n  I think you need to remove those comments, like \"# required\" -- give that a shot and please report back. Maybe I shouldn't have them in the readme. \n  I'm getting occasional intermittent errors like so:\n\nhttps://gist.github.com/0d746382d2f0b35dd9e2\n\n@geemus, can you please investigate? Let me know if there's anything I can do to help. I'm not sure how to troubleshoot, honestly... I can't seem to reproduce on demand. \n OK - I'll try that and report back. Thanks for looking at this -- sorry to be a bother. Please have fun on your day off! :)\n I'm in the same boat as @fbjork -- I was having this problem on Heroku, and only since upgrading to fog 0.7+ from what I can tell. It was happening intermittently, but not infrequently, and hasn't happened since I added \":persistent => false\" as suggested.\n\nPerhaps some recent change could have worsened the situation (on Heroku especially) or maybe \":persistent => false\" should be the default? I'm not sure. Thanks for looking at this. \n Awesome -- I'll give this a try and report back if I run into trouble again. \n\nCarrierwave only has a development dependency on fog, and that's set to 0.7.1 now, which has a dependency on excon >=0.5.7, so I think we're ok to leave things as-is.\n\nMaybe I'll post something to the Google Group once I test things out myself, just to give people a heads-up, though. \n\nThanks again for looking at this so quickly!\n  Please post questions like this to the Google Group in the future. \n\nI believe you can set the permissions of uploaded files with a Carrierwave config option, but you'll have to investigate for yourself. \n  Thanks for reporting this, but I'm honestly not sure what you're talking about :)\n\nCan you please elaborate, and maybe help me understand what the problem is, why it matters to you, and what we might consider doing about it? \n\nThank you!\n Thanks for the explanation. I'll run this by jnicklas to see what he thinks. It may conflict with another change we are thinking of making, but I'll keep this in mind. \n  Can you provide a bit more detail -- perhaps your Carrierwave config? I'm wondering if you're using authenticated urls or something...?\n Yeah, you can use the s3 storage for now -- I think there may be a problem with the authenticated url generation (when fog_public = false) -- hopefully @geemus can look into that soon. I thought he'd already solved the speed issue. \n  ok\n  Please read the \"getting help\" section of the wiki before creating issues. I think this may be for the Google Group, and I can't read the code you pasted anyway. \n  @geemus -- you can see the play-by-play here:\n\nhttps://gist.github.com/b52e4fa0ce26998244c5\n\nI run the tests with and without mocking with 0.6.0 and then with 0.7.0. \n\nEverything looks fine with 0.7.0 with mocking off, but with mocking on, I'm getting some Excon::Errors::NotFound errors. So, I think it's a problem with mocking, but I'm just guessing. \n\nCan you please take a look when you have time? Thank you!\n\nI made some changes to the way that tests work and I removed Gemfile.lock. So, you may have to run \"bundle install\" to start to make your Gemfile.lock, and then look at the readme (or my gist) to see how to run everything. It should be much easier to run all of the tests now -- at least that was the goal. \n No problem, no rush. Thanks for looking into it! \n Awesome - thank you! I'll try to work up a gem release today :D\n  Awesome - thanks for figuring that out -- I was getting occasional reports of problems on Windows with this, but it's hard to track down problems with Windows when you don't have it. Thanks again :)\n  This is a question for the Google Group. Please review the Wiki -- it has some example applications you can investigate. \n  I don't think this is the fault of fog (and would be the same with s3 and cloudfiles), but it's worth looking into. \n\nWhen working on this, we should also test if the content_type is set correctly after recreate_versions! is called -- I think this is a related problem that would be solved if we fix the first. \n I'm not sure, but I think this may require depending on the mime-types gem to determine the content_type of a file that's been cached...\n Hmm... maybe I was mistaken? I'll try to make a failing test case later today and report back. \n So, I'm not sure how best to proceed...\n\nJust to give you some background - here's how I came about this. If you want, you can reproduce with this app:\n\nhttps://github.com/trevorturk/carrierwave-heroku/commit/606f4b3064fb1e370d2a0eae26cba7dd11231294\n\nbundle install\n\ns3_access_key_id=xxx s3_secret_access_key=xxx s3_bucket=xxx rails s\n\nThen, you want to create a user with a name and an avatar. If you check out the content_type in the headers (I use http://ditchnet.org/httpclient/) of the uploaded file, you'll see it's whatever you expect (image/png for example). Then, if you create a user _without_ a name, but with an avatar, then you'll get a validation error. The uploaded file will be cached. Then, you add a name and save. Then, check the content_type header of the uploaded and you'll see it's empty. \n\nIt's not a huge problem, but the issue is that files without the right content_type header will be downloaded instead of displayed in the browser sometimes. \n\nSo, I think I've emulated the problem in the tests in the \"content_type\" branch on here. Basically, I think it comes down to retrieve_from_cache! not setting the content_type. I tried to set the @content_type in SatitizedFile, but I was having trouble there. So, I moved on to trying to set it in retrieve_from_cache! but I'm not sure if that's solving the root problem. You can see my efforts, but I'm not very happy with it. \n\nAnyway, please have a look at the \"content_type\" branch and let me know what you think. \n Hmm... I'm not sure if a global cache of content_types would work across processes, would it? I mean - if you have 5 instances Passenger up and running your app, could they all have access to the same in-memory hash? I've never tried to do anything like that! :)\n OK - I'll see if I can do any better and then merge into master. I'm thinking of pushing the mime-types stuff into the fog storage module because that's already relying on mime-types and that's the only area I'm concerned with for this issue. \n Yeah... I guess that's bad...? I'm not sure if it's worth relying on the mime-types gem for everything, though. What do you think?\n OK - I'll try to tidy this branch up and then merge. Thanks very much for your help reviewing!\n  Yes, I think this is a problem that's been discussed before:\n\nhttps://groups.google.com/d/topic/carrierwave/vOksM5vC6II/discussion\n\nI'm not 100% sure what the solution should be, although I've spent some time thinking about it. Suggestions are welcome. I'll leave this issue open because it should be addressed. \n So, I looked into this a bit more, and if you read the store_spec, you'll see that the filename is supposed to default to nil -- I suppose because it's mostly supposed to be overridden if necessary...?\n\nI'm not sure -- I'll leave this open and see if jnicklas has a comment. It might make sense to make that default to the original_filename or something. This seems confusing to me, but perhaps I'm missing something. \n Closing in favor of issue #249\n  I'm not sure, honestly -- I'd suggest using image_science that seems to be working for you. I'm going to close this issue b/c I believe others are using minimagick successfully. You might double-check by asking the Google Group if anyone is using minimagick, though, if you're so inclined. If it turns out to be a widespread problem we can investigate more deeply. \n Hmm... there are a few config options you might try. If you look in uploader/configuration.rb you'll see these:\n\n```\n    add_config :ignore_integrity_errors\n    add_config :ignore_processing_errors\n    add_config :validate_integrity\n    add_config :validate_processing\n```\n\nMaybe setting some of those to true/false would raise some errors. Might be worth a shot? Lemme know how it goes. \n FotoVerite, if that helps you, please consider updating the wiki with an example of how people can troubleshoot problems like this. Thanks!\n  Closed\n  If ActiveRecord is defined, is it not already loaded?\n Hmm... I guess I'm just not seeing the benefit -- why do you need this? Does it help if you're using Rails but not AR?\n Thanks for the explanation -- merged :)\n  I'm sorry, but can you please take a moment to carefully describe the what the problem you are having is? What are you trying to accomplish? What's getting in your way? I can't make sense of this as you've written it. \n Have you tried this with carrierwave master branch? I did something to help alleviate FormNotMultipart errors, but I have no idea if it would help in your case. \n\nI'm really not sure about how else we might change Carrierwave to accommodate your situation. Maybe someone else will chime in, otherwise it might be smart for you to work up a pull request with a proposed change because you might be the only person that's bothered. Failing that, maybe just document your workaround in the wiki. \n Umm... so I'm not sure what you're suggesting...?\n I'm sorry, but I'm still not clear on what action you are suggesting we take. \n Honestly, none of those sounds lik every appealing options. \n1. I'd guess that AR is doing that on purpose, but maybe not\n2. I'd prefer not to monkey-patch AR if at all possible\n3. Is this suggesting to always use the mount_on option, or just that if you use mount_on you must use a different key?\n Hmm... I think this sounds like something that jnicklas probably should look at. Maybe he'll have some ideas. \n I'm of the opinion that we should make the change if it's smart. CarrierWave is not yet 1.0, and asking everyone to run a migration / rename a column perhaps isn't too much to ask. If they think so, they can continue using an older version. \n\nI'd just suggest waiting until after we release 0.5.3 with fog support. Then we can move on to an 0.6 branch and note that there are breaking changes. \n\nSo, what if it defaulted like so:\n\nadd_column :users, :avatar_uploader, :string\nmount_uploader :avatar, AvatarUploader\n\nSo, the column would get _uploader added to it...?\n\nOh, also -- we could suggest that people use\n\nmount_uploader :avatar, AvatarUploader, :mount_on => :avatar\n\n...to retain the old behavior (and not raise an error) if they don't want to change their column names. \n\nThat way, we change the default, note that there was a breaking change, provide a simple fix (change your db column name), and provide an alternative (change the mount_on to use the old default) -- sounds fine to me.\n @sinsiliux it's not that nobody noticed, it's just that it's a major change, so we've been hesitant to make it. I think we may have to, though. \n  Please see the wiki for an idea about how to work around this lack. There's also a pull request open from josevalim that would address the issue. \n  Please upload this simple example app to github for me to test. This is impossible to read. \n I'm not sure what your issue might be, but I'm 99% sure that it's not related to a bug in carrierwave if you're only just trying to get started. \n\nPlease review the readme carefully and try to make your own small application. Then, read the \"getting help\" section in the wiki before creating a new issue if you think you've found a bug. If you just have questions about how to get started, try the Google Group instead.\n  From a quick glace, this looks pretty good. However, you need to provide at least one new test for this functionality in order for me to consider merging it. Good work so far!\n Looks good -- I'll review/test/merge ASAP and report back to this issue. Excellent work - thanks! :)\n So, I moved stuff around a little because I wanted to avoid having another method. \n\nI also removed the versions namespace in the hash, because I think it's more in keeping with the current API. For example User.last.avatar.thumb.url works whereas User.last.avatar.versions.thumb.url does not. \n\nLet me know what you think, and thanks for working on this!\n  I just tested, and in your case, I believe @user.to_json should work in the same way with/without carrierwave. So, @user.avatar.to_json only returns the url. Is that what you meant to say? \n\nI believe I implemented that as_json feature and wasn't sure what else people might want, so I only included the URL. \n\nSo, if @user.to_json only returns the avatar.url, that's a bug. I don't think that's happening, though, but maybe I'm wrong. \n\nIf @user.avatar.to_json doesn't return what you want, then we can discuss that. \n Hmm... I think something strange might be going on with your app...? I just tested this again and it's working as expected for me. (I have a Rails 3.0.5 app on Ruby 1.8.7 using carrierwave master, with a model called Attachment. When I do Attachment.last.to_json, I get more than just the attachment url.)\n\nSo, if you're having this problem, we'll need to dig deeper to figure out why. Can you provide more details -- your environment, maybe an example app that I can try, etc?\n Re: your other comment: I'm not sure what you mean. \n\nCan you please clarify what the problem is? \n Sorry, but I can't help unless I have more information. You might try to create a simple example application on github with a failing test for me to see. Otherwise, I think you may be on your own to try and figure it out. \n Just to clarify: do you mean @user.to_json or @user.avatar.to_json? Because I expect @user.to_json to include the id attribute etc. If it doesn't, that's a problem. \n\nIf you mean simply that @user.avatar.to_json doesn't include the urls of any versions you may have, that's more of a feature request than a bug/problem.\n\nI just want to make sure we're clear on that point before going ahead. \n OK - so your issue is that you want @user.avatar.to_json to include the urls of versions if they exist.\n\nI'm a bit behind on other issues at the moment, so I can't take this on myself. I'd definitely look at a pull request (with tests) if you want to put something together, though. \n Yeah, this isn't really a bug so much as a feature request. The way we defined as_json is pretty clear that it's only supplying the one url. If we want more, we'll have to add it. \n OK - good luck! :)\n  I'm adding a note to the wiki about this -- basically, it's a known issue. A pull request (with plenty of tests) would be welcome, but there are possible workarounds. See the wiki for details -- I'll link to the Google Groups thread about the issue. \n  Please ask questions like this on the Google Group. \n  Hmm... I don't. Can you test your app using the Carrierwave master branch, with the new fog storage module? I'm wondering if that will have the same problem. There are instructions in the readme, and the wiki has instructions about how to move to the fog storage module. \n I have no idea what that could be, sorry. Maybe @geemus will, though...? You can see if he responds here, or perhaps file something with the excon gem after a day or two. \n There are examples in the readme and on the wiki -- I'm not sure what you could be doing wrong. Perhaps you could upload a small sample application that demonstrates the problem? I can have a look at that. It's hard to tell what's going on from here. \n Everything works for me with:\n\n~/downloads/carrierwave-mysql-problem[mysql] > ruby -v\nruby 1.8.7 (2010-08-16 patchlevel 302) [i686-darwin10.4.0]\n\nand\n\n~/downloads/carrierwave-mysql-problem[mysql] > ruby -v\nruby 1.9.2p0 (2010-08-18 revision 29036) [x86_64-darwin10.4.0]\n\nSorry, but I think something fishy might be going on with your dev setup...?\n I'm really sorry I can't be of more help... is the problem narrowed down to excon v. mysql? Perhaps you could consider using postgres and the pg gem? Maybe @geemus has some ideas, but unfortunately, I'm fresh out. Sorry!\n I'd suggest not using \"master\" directly like that -- it's best to pick the latest revision with the \"ref\" key instead of the \"branch\" key (:ref => '3c4271528ee6b6772b02' for example)\n\nThat way you're not using a moving target. \n  I think the cron job is a good solution, but I'd be willing to review a pull request if you'd like to work one up. Failing that, you might consider adding a page to the wiki titled \"feature requests\" and adding this as the first. \n  @geemus - unfortunately, that last change around content_type has made things worse. Now, when I upload an image file through a Rails app, the content_type is coming up \"binary/octet-stream\" every time. \n\nI'm trying to work up some test cases, but stumbling a bit.\n So, I _think_ I figured something out. I pushed up a commit with an attempt at a fix, a test, and I've tested it in an app of mine. It seems to be working, but I have a failing test for Rackspace. I don't know if this is a problem with Rackspace or Carrierwave/fog, though...\n\nhttps://gist.github.com/72579c4b2a6f2ac03420\n\n@geemus can you have a look when you have a chance? I'm not 100% sure my change is the best way to do things, and I'm not sure about this Rackspace problem. \n Awesome - thank you! I'll look out for the next fog release and clean up these tickets. \n This is fixed by fog 0.7.0 -- I'm opening a new ticket, though -- I think there's some problems with mocking in 0.7.0. \n  I've upgraded to fog 0.6.0, but I'm still getting this test failure with FOG_MOCK=false:\n\nhttps://gist.github.com/589ff88a3b422f3dfdf3\n\n@geemus - I think you said this should be fixed in fog, but maybe the fix isn't released yet? I can try again with 0.6.1 or whatever gets released next. \n  What if you do:\n\nd.update_attributes(:file => nil)\ns.save!\n\n...?\n\nI think the remove_file thing might bypass the validations. \n Did you read the comments? I closed it because I suspect it's not an issue with Carrierwave itself. \n  Please upload a simple example app, and I can test for you, if you like. Also, please post the backtrace, ruby version, operating system, etc in a gist. \n I'm glad you figured it out! Please do consider adding a section to the wiki about your experiences. It's always helpful to others if you document something that took a while to figure out!\n  Please see the warning near the top of the readme on github -- the currently released gem doesn't have the fog provider, just the master branch, so that's why you're having problems. \n Can you please read the comments here, and the readme? There is a very clear answer to the question. \n  Please use http://gist.github.com for pasting code. This is impossible to read. \n\nI've been working with this redirection stuff lately, and I'm not sure what the best solution is. If you have an idea about what's going on and want to try to fix things for ruby 1.8 and 1.9, I'd love some help! I think that forking the repo and working up a pull request would be best. This is difficult to understand out of context. \n\nFailing that, I'd suggest trying to get the redirects out of the URL before giving it to Carrierwave so that you're giving Carrierwave something it knows how to work with. \n I'm not sure I consider this a \"bug\" so much as a limitation with open-uri. Like I said, I'd be happy to have some help from you, if you have some specific ideas. \n\nSo, a URL can redirect, but I guess just not from https->http. See here:\n\nhttps://gist.github.com/5dd4d959ef8c6fee53ff\n\nSo maybe you can gsub('https', 'http') on that URL before passing it to Carrierwave. \n OK - I'll close this for now. Please feel free to work on a pull request if you'd like to try fixing this in Carrierwave itself. Thanks!\n  Here's another small one that's probably worth looking into eventually:\n\nhttps://gist.github.com/c6a340773227d784d205\n\nI'm not sure what exactly we could do about it, but for a file that hasn't just been stored, the content_type will return nil until you read the file (or maybe do something else, but that gets the content_type set). \n Ooooooh - you're almost TOO fast! :)\n\nI'll test these changes out in my apps ASAP. \n\nThanks so much. \n  This is a funny one, but when trying to destroy a file that doesn't actually exist, I get this error:\n\nhttps://gist.github.com/bd35049432272c33854a\n\nI'm not sure what'll happen if we work around that error, but it's probably worth finding out. \n\n@geemus, if you want to have a look, please do. Otherwise I'll work on it ASAP. \n Yeah, if you work around that error, it'll still fail here:\n\nhttps://gist.github.com/36a71d991296d1e5c0aa\n\nI'm not sure -- I guess it's appropriate is a sense to raise an error when you're trying to destroy something that's not there. I can see the argument on the other side, though. \n\nAny thoughts?\n  Merged into 0.4-stable and master. Thanks!\n  Re: http://aws.typepad.com/aws/2011/03/now-open-aws-region-in-tokyo.html\n\nWe should add something about the option to the docs.\n\nI'm not sure if changes to fog are necessary for this, though. Perhaps geemus does...?\n Cool - I'll leave this open and update the docs after you release. I suppose we'll want to recommend a fog version, too, at least in the wiki. \n I added this to the docs. Thanks! :)\n  I can take care of the docs and/or testing if you guys like. \n\nOne thing, though -- what do you think about changing the config option to \"authenticated_url_expiry\" or \"authenticated_url_expiration\" -- the current name is a little confusing imo. \n\n[edit] I guess \"fog_authenticated_url_expiration\" to keep the namespace...?\n Hey, so I went ahead and renamed it \"fog_authenticated_url_expiration\" and added some documentation. Please feel free to make/suggest any changes. \n  I'm sorry, but I'm not clear on what this is fixing. Can you provide a failing test case or more detail? \n  Sorry, but I don't understand what the problem is here. Can you please provide a code example in a gist or something legible? Also, please describe what the problem you're having is in detail. \n  I pushed up a new branch here:\n\nhttps://github.com/jnicklas/carrierwave/compare/master...remove_previous_files\n\n...but I think there's a problem with the implementation -- unless I'm doing the testing wrong. There are a few pending/todo tests, but this one is failing already:\n\nbundle exec spec spec/orm/activerecord_spec.rb:431\n\nThere are comments in the code to explain what's going on. I think it's still possible to get this new feature working, but I think there's work left to be done. You can also see some progress that Didier and I made on this issue here:\n\nhttps://github.com/did/carrierwave/commit/b838220\n\n...that might point us in the right direction. I think a combination of the two techniques might be in order, but I'm not sure -- I might be missing something obvious. \n The dynamic path isn't stored in the database -- the filename is stored and the path is calculated on demand. So, yeah, we basically need some way to get the new and old paths so that we can compare them -- that's what my comments in the code are about, and you can see how Didier and I had thought to accomplish it in that commit I linked to. Maybe you've thought of an easier way, though? Please give it a shot based on this new branch, because the tests should help make sure everything is working as expected. I can fill in the pending tests, but I wanted to check in since I had a test failure along the way. \n Sorry it's taken me a while to get back to this. Your changes are causing test failures elsewhere, unfortunately:\n\nhttps://gist.github.com/571d4d2645a42447e58f\n\nI've pushed everything up to the remove_previous_files branch. You can see the comparison to master here:\n\nhttps://github.com/jnicklas/carrierwave/compare/master...remove_previous_files\n\nMaybe you want commit access to the repo, so you can work in this branch? If so, drop jnicklas a line. \n\nI'm thinking it might be smart to pull the #{column}_will_change! stuff into master while this keeps developing... if you're still interested in working on it -- there's a non-trivial about of work left to do, I think. \n FYI - I went ahead and manually pulled in the _will_change! stuff from this branch into master. Thanks for that!\n FYI - I spent some more time on this, and I pushed up my work in progress here: remove_previous_files_2\n\n...in case anyone is curious. My tests so far are passing. I'll keep writing more tests, make sure they all pass, and then eventually we can decide what to do about the implementation (e.g. make it orm agnostic if possible etc). I know it's not very good right now, but I'm just trying to do the minimal amount of impact to get things working, and it seems to be going well so far. \n\ntl;dr - I'm still working on this, and will continue as time allows :)\n  Any chance this is the same issue as #646?\n  One of the important things is to make sure that extension_white_list still works regardless of case. As long as all files were lower case it was never a problem, but case shouldn't matter when it comes to extensions, imo.\n @jameskilton: we just need to make sure extension_white_list still works as intended, and that should probably be part of the pull request, that's all I'm saying. I wasn't using that as an argument against this change ;)\n  mtmcfarl, please consider adding a section to the wiki about this. It may be helpful to other people.\n That's perfect -- thanks so much. \n  @nashbridges can you confirm that everything is working and try to help @korobkov please? \n  Actually, it should be resolved in the master branch on github now. Please give it a try and report back if you're still having problems. \n I think there are a few ways. The easiest way I know is to use bundler. Otherwise, you can vendor the gem in your app. Or you can wait until we release the next gem version, which will hopefully happen within the next week. \n  The \"remove_previous_files\" branch is going to attempt to add this feature. You can peruse that if you're interested. Otherwise, see the wiki for a potential easy workaround. \n @brandonbloom Yes - that's why it's listed as a known issue. \n  Pull requests are welcome!\n  @scomma please update the wiki!\n  I think you should generate a UUID and store that in the database.\n", "text_all_count": 20163, "text_word_token": ["This", "be", "not", "build", "in", "and", "won", "t", "be", "a", "feature", "because", "it", "s", "definitely", "an", "edge", "case", "NUMBER", "I", "would", "recommend", "copying", "all", "your", "assets", "over", "to", "S", "NUMBER", "CloudFiles", "or", "add", "a", "method", "to", "your", "model", "that", "generates", "the", "legacy", "path", "NUMBER", "You", "need", "to", "update", "RubyGems", "NUMBER", "gem", "update", "system", "Pretty", "sure", "this", "was", "fix", "in", "NUMBER", "please", "upgrade", "and", "report", "back", "if", "it", "s", "still", "an", "issue", "NUMBER", "If", "it", "be", "still", "an", "issue", "please", "provide", "uploader", "code", "and", "a", "full", "stack", "trace", "so", "we", "have", "enough", "info", "to", "help", "NUMBER", "Upgrade", "to", "Rails", "NUMBER", "Really", "haven", "t", "ever", "heard", "of", "performance", "issue", "with", "CarrierWave", "NUMBER", "It", "s", "pretty", "much", "all", "based", "on", "your", "Internet", "connection", "speed", "time", "spent", "in", "CarrierWave", "code", "be", "negligible", "in", "comparison", "to", "even", "the", "smallest", "file", "uploads", "NUMBER", "NUMBER", "sounds", "about", "right", "NUMBER", "I", "m", "not", "at", "all", "surprised", "that", "fog", "NUMBER", "doesn", "t", "work", "with", "NUMBER", "there", "were", "lots", "of", "change", "in", "both", "libraries", "NUMBER", "Sounds", "like", "NUMBER", "workers", "checked", "for", "the", "existence", "of", "the", "same", "file", "folder", "at", "the", "same", "time", "both", "returned", "false", "and", "one", "of", "them", "beat", "the", "other", "to", "the", "creation", "of", "the", "new", "file", "folder", "NUMBER", "I", "think", "this", "should", "only", "happen", "if", "multiple", "workers", "be", "reprocessing", "the", "same", "carrierwave", "file", "be", "that", "what", "s", "going", "on", "If", "so", "you", "might", "want", "to", "take", "a", "look", "at", "Rack", "Lock", "NUMBER", "Sorry", "meant", "Resque", "Lock", "NUMBER", "Please", "post", "usage", "question", "to", "Stack", "Overflow", "or", "to", "the", "Google", "Group", "NUMBER", "This", "be", "not", "a", "CarrierWave", "issue", "NUMBER", "Post", "MiniMagick", "specific", "issue", "to", "the", "probablycorey", "mini_magick", "repo", "NUMBER", "Please", "post", "usage", "question", "to", "Stack", "Overflow", "or", "to", "the", "Google", "Group", "NUMBER", "Yep", "I", "acknowledged", "the", "issue", "but", "be", "essentially", "marking", "it", "wontfix", "NUMBER", "Pull", "request", "be", "welcome", "though", "if", "you", "want", "to", "tackle", "it", "Really", "not", "sure", "what", "to", "tell", "you", "NUMBER", "You", "should", "be", "able", "to", "call", "resume", "NUMBER", "cache", "File", "NUMBER", "open", "NUMBER", "but", "you", "need", "to", "point", "to", "a", "file", "can", "t", "assign", "it", "a", "string", "NUMBER", "I", "would", "recommend", "backing", "it", "by", "a", "model", "class", "regardless", "of", "whether", "or", "not", "you", "persist", "it", "to", "DB", "so", "you", "can", "mount", "the", "uploader", "NUMBER", "This", "isn", "t", "something", "we", "be", "planning", "to", "implement", "but", "pull", "request", "be", "always", "welcome", "NUMBER", "I", "be", "unable", "to", "reproduce", "this", "issue", "NUMBER", "Check", "your", "params", "hash", "in", "your", "log", "when", "submit", "the", "form", "it", "will", "show", "what", "was", "submitted", "to", "the", "controller", "NUMBER", "I", "would", "be", "fine", "with", "something", "like", "this", "so", "long", "as", "it", "doesn", "t", "change", "exist", "API", "NUMBER", "Work", "up", "a", "pull", "request", "and", "I", "ll", "have", "a", "look", "Does", "it", "help", "if", "you", "call", "uploader", "NUMBER", "reload", "after", "storing", "but", "before", "test", "the", "value", "Yes", "please", "do", "It", "s", "be", "request", "a", "number", "of", "times", "in", "the", "past", "NUMBER", "Just", "open", "a", "new", "pull", "request", "when", "it", "s", "ready", "NUMBER", "Thanks", "No", "nothing", "build", "in", "NUMBER", "Why", "not", "just", "mount", "an", "uploader", "in", "each", "model", "I", "would", "recommend", "use", "S", "NUMBER", "instead", "of", "storing", "them", "on", "a", "utility", "server", "NUMBER", "You", "could", "then", "setup", "a", "worker", "task", "of", "some", "kind", "that", "fetches", "them", "from", "S", "NUMBER", "to", "the", "utility", "server", "NUMBER", "Your", "app", "server", "receives", "the", "request", "CW", "can", "either", "store", "locally", "file", "or", "on", "S", "NUMBER", "fog", "NUMBER", "Assuming", "you", "re", "use", "S", "NUMBER", "in", "the", "same", "region", "as", "your", "app", "servers", "the", "time", "it", "takes", "to", "push", "the", "original", "straight", "to", "S", "NUMBER", "be", "negligible", "in", "comparison", "to", "the", "time", "it", "takes", "to", "upload", "the", "file", "from", "client", "to", "app", "server", "NUMBER", "Then", "you", "can", "defer", "additional", "processing", "to", "the", "utility", "node", "s", "NUMBER", "Just", "add", "a", "worker", "that", "calls", "MiniMagick", "Rmagick", "directly", "and", "do", "whatever", "you", "need", "to", "do", "NUMBER", "If", "you", "need", "further", "support", "I", "recommend", "work", "with", "Engine", "Yard", "support", "or", "posting", "a", "question", "to", "Stack", "Overflow", "or", "to", "the", "CW", "Google", "Group", "NUMBER", "Can", "you", "please", "squash", "this", "to", "a", "single", "commit", "Can", "you", "rebase", "to", "master", "this", "do", "not", "apply", "cleanly", "and", "squash", "to", "a", "single", "commit", "Thanks", "Nope", "go", "ahead", "create", "a", "new", "pull", "request", "if", "that", "s", "easier", "for", "you", "NUMBER", "Please", "post", "usage", "question", "to", "Stack", "Overflow", "or", "to", "the", "Google", "Group", "NUMBER", "This", "be", "a", "problem", "with", "how", "you", "re", "handle", "the", "upload", "parameters", "not", "a", "problem", "with", "CarrierWave", "itself", "NUMBER", "Noticed", "that", "last", "night", "will", "take", "care", "of", "it", "when", "I", "have", "some", "time", "NUMBER", "Done", "NUMBER", "This", "isn", "t", "a", "priority", "but", "pull", "request", "be", "welcome", "I", "don", "t", "see", "how", "this", "has", "anything", "to", "do", "with", "carrierwave", "NUMBER", "Your", "issue", "has", "to", "do", "with", "the", "ActiveRecord", "finder", "method", "that", "you", "re", "use", "when", "finding", "or", "build", "your", "object", "NUMBER", "You", "also", "only", "provide", "a", "piece", "of", "the", "stack", "trace", "which", "do", "not", "help", "NUMBER", "Closed", "in", "favor", "of", "NUMBER", "Thanks", "for", "taking", "the", "time", "to", "rework", "it", "for", "NUMBER", "It", "s", "just", "how", "it", "was", "designed", "NUMBER", "Pull", "request", "be", "welcome", "s", "NUMBER", "storage", "was", "remove", "as", "of", "NUMBER", "fog", "be", "the", "way", "going", "forward", "NUMBER", "Merged", "thanks", "Can", "you", "fix", "the", "build", "on", "NUMBER", "REE", "and", "submit", "another", "pull", "request", "This", "be", "a", "general", "Ruby", "question", "unrelated", "to", "CarrierWave", "NUMBER", "You", "should", "start", "by", "calling", "file", "NUMBER", "close", "when", "you", "re", "do", "with", "the", "file", "NUMBER", "If", "you", "have", "further", "question", "about", "this", "please", "ask", "on", "Stack", "Overflow", "NUMBER", "Closed", "in", "favor", "of", "NUMBER", "Can", "you", "please", "try", "this", "on", "master", "to", "see", "if", "it", "was", "fix", "by", "NUMBER", "metal", "Gem", "release", "come", "shortly", "NUMBER", "This", "should", "be", "fix", "in", "NUMBER", "Can", "you", "try", "use", "that", "and", "report", "back", "Marking", "a", "hack", "workaround", "as", "the", "answer", "on", "Stack", "Overflow", "just", "makes", "my", "life", "harder", "NUMBER", "We", "fix", "the", "issue", "for", "you", "and", "release", "a", "patched", "version", "almost", "immediately", "NUMBER", "Pulling", "crap", "like", "that", "be", "what", "drives", "people", "to", "stop", "helping", "with", "OSS", "NUMBER", "Merged", "thanks", "Not", "a", "fan", "of", "the", "endless", "chaining", "of", "gsub", "calls", "but", "hey", "what", "s", "one", "more", "Merged", "thanks", "Feel", "free", "to", "edit", "it", "The", "Wiki", "be", "maintained", "by", "users", "NUMBER", "The", "S", "NUMBER", "backend", "be", "unsupported", "in", "NUMBER", "and", "beyond", "use", "Fog", "instead", "NUMBER", "You", "need", "to", "delete", "anything", "that", "starts", "with", "config", "NUMBER", "s", "NUMBER", "_", "Appears", "you", "be", "trying", "to", "recreate", "version", "on", "objects", "that", "have", "no", "uploaded", "file", "NUMBER", "Because", "there", "be", "no", "file", "to", "recreate_versions", "against", "NUMBER", "You", "should", "add", "the", "nil", "check", "in", "your", "code", "if", "you", "need", "it", "NUMBER", "That", "s", "not", "how", "you", "do", "it", "on", "an", "uploader", "that", "s", "mounted", "in", "a", "Rails", "app", "though", "look", "just", "below", "that", "in", "the", "readme", "Product", "NUMBER", "scoped", "NUMBER", "each", "p", "p", "NUMBER", "avatar", "NUMBER", "recreate_versions", "if", "p", "NUMBER", "avatar", "NUMBER", "present", "or", "something", "along", "those", "lines", "NUMBER", "The", "readme", "provides", "an", "accurate", "generic", "example", "on", "how", "to", "recreate", "version", "NUMBER", "Defining", "the", "scope", "and", "iterator", "Product", "NUMBER", "all", "vs", "Product", "NUMBER", "where", "avatar", "IS", "NOT", "NULL", "or", "the", "conditions", "within", "the", "block", "if", "p", "NUMBER", "avatar", "NUMBER", "present", "be", "application", "specific", "NUMBER", "It", "doesn", "t", "just", "say", "or", "it", "says", "or", "on", "a", "mounted", "uploader", "which", "be", "what", "you", "have", "in", "Rails", "NUMBER", "If", "you", "d", "like", "to", "submit", "a", "pull", "request", "that", "would", "make", "the", "readme", "clearer", "to", "everyone", "I", "m", "happy", "to", "merge", "it", "NUMBER", "I", "don", "t", "recall", "refusing", "anything", "NUMBER", "Thanks", "would", "you", "mind", "add", "a", "test", "that", "fail", "without", "this", "Sorry", "I", "m", "an", "idiot", "NUMBER", "Yep", "good", "to", "go", "thanks", "Pretty", "sure", "you", "cannot", "use", "fog_public", "false", "along", "with", "CNAMES", "NUMBER", "Try", "make", "your", "images", "public", "NUMBER", "Talked", "with", "hyperrjas", "offline", "and", "this", "was", "a", "cloudfront", "config", "issue", "not", "an", "issue", "with", "CarrierWave", "or", "Fog", "NUMBER", "You", "ll", "need", "to", "update", "Fog", "to", "NUMBER", "I", "ve", "add", "note", "to", "the", "Readme", "that", "specify", "the", "Fog", "version", "requirement", "df", "NUMBER", "b", "NUMBER", "af", "NUMBER", "e", "NUMBER", "eb", "NUMBER", "dca", "NUMBER", "a", "NUMBER", "Please", "create", "a", "sample", "app", "that", "shows", "this", "behavior", "NUMBER", "Are", "you", "use", "Rails", "NUMBER", "The", "serialization", "change", "in", "NUMBER", "only", "work", "on", "NUMBER", "Yeah", "reinstalling", "imagemagick", "often", "do", "the", "trick", "NUMBER", "Or", "switch", "to", "MiniMagick", "NUMBER", "Can", "you", "update", "to", "the", "latest", "version", "of", "Rubygems", "locally", "and", "update", "to", "a", "newer", "version", "of", "REE", "on", "your", "production", "server", "and", "report", "back", "I", "m", "not", "sure", "about", "the", "Heroku", "issue", "but", "let", "s", "start", "with", "the", "non", "Heroku", "issue", "where", "we", "can", "control", "the", "environment", "NUMBER", "MattHall", "supplied", "a", "gist", "that", "use", "NUMBER", "version", "of", "REE", "NUMBER", "resistorsoftware", "Yeah", "please", "let", "me", "know", "if", "that", "fix", "things", "locally", "NUMBER", "Which", "stack", "be", "you", "use", "on", "Heroku", "Where", "was", "this", "test", "fail", "Passes", "fine", "on", "MRI", "without", "this", "NUMBER", "Alrighty", "sounds", "good", "to", "me", "NUMBER", "This", "be", "outside", "the", "scope", "of", "CarrierWave", "NUMBER", "Handling", "Base", "NUMBER", "encoded", "strings", "be", "app", "specific", "and", "decoding", "be", "likely", "handle", "by", "your", "controller", "and", "pass", "as", "an", "IO", "object", "to", "CW", "NUMBER", "geemus", "See", "NUMBER", "for", "exist", "failures", "Would", "love", "some", "help", "on", "that", "if", "you", "have", "any", "time", "to", "look", "at", "those", "NUMBER", "Cool", "thanks", "again", "I", "ll", "check", "it", "out", "NUMBER", "You", "can", "t", "have", "any", "dots", "in", "your", "bucket", "name", "if", "you", "use", "the", "bucket", "name", "in", "the", "subdomain", "of", "your", "URLs", "because", "the", "AWS", "SSL", "certificate", "only", "covers", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "NUMBER", "Fog", "should", "handle", "this", "automatically", "with", "a", "regexp", "that", "checks", "the", "bucket", "name", "if", "it", "isn", "t", "checking", "for", "dots", "it", "s", "a", "bug", "cc", "geemus", "Buckets", "that", "have", "dots", "be", "meant", "to", "be", "use", "for", "CNAME", "buckets", "where", "SSL", "be", "unsupported", "assets", "NUMBER", "myapp", "NUMBER", "com", "masks", "the", "fact", "that", "they", "be", "use", "S", "NUMBER", "NUMBER", "Outside", "of", "that", "use", "case", "I", "d", "say", "dots", "be", "a", "bad", "idea", "NUMBER", "I", "m", "not", "following", "here", "options", "be", "not", "ignored", "they", "be", "call", "on", "super", "NUMBER", "Pretty", "sure", "you", "want", "as_json", "in", "this", "case", "which", "support", "only", "and", "except", "NUMBER", "Yeah", "that", "makes", "sense", "now", "NUMBER", "Can", "you", "try", "monkey", "patching", "it", "with", "this", "and", "see", "if", "that", "fix", "things", "ruby", "def", "serializable_hash", "options", "nil", "hash", "self", "NUMBER", "class", "NUMBER", "uploaders", "NUMBER", "each", "do", "column", "uploader", "hash", "column", "NUMBER", "to_s", "_mounter", "column", "NUMBER", "uploader", "NUMBER", "serializable_hash", "end", "hash", "NUMBER", "merge", "super", "options", "end", "Fixed", "in", "master", "thanks", "for", "the", "report", "geemus", "Does", "anything", "come", "to", "mind", "that", "change", "in", "NUMBER", "that", "might", "cause", "this", "Working", "fine", "for", "me", "too", "NUMBER", "Oh", "wonderful", "NUMBER", "Changed", "in", "master", "for", "NUMBER", "x", "That", "s", "probably", "a", "good", "decision", "thanks", "for", "the", "info", "We", "ll", "cross", "this", "bridge", "when", "NUMBER", "be", "closer", "NUMBER", "It", "s", "just", "docs", "at", "this", "point", "anyway", "NUMBER", "Zero", "be", "inaccurate", "when", "describing", "the", "file", "size", "of", "a", "non", "existent", "file", "NUMBER", "An", "empty", "file", "can", "have", "a", "size", "of", "zero", "you", "should", "check", "to", "make", "sure", "the", "file", "exists", "before", "calling", "methods", "on", "it", "NUMBER", "I", "would", "agree", "that", "it", "s", "logical", "for", "it", "to", "return", "nil", "if", "there", "be", "no", "upload", "NUMBER", "Care", "to", "work", "up", "a", "pull", "request", "with", "test", "If", "you", "have", "some", "time", "to", "work", "up", "a", "pull", "request", "you", "can", "see", "how", "the", "whitelist", "be", "do", "here", "LINK", "_whitelist", "NUMBER", "rb", "Would", "be", "very", "similar", "NUMBER", "When", "was", "after_commit", "introduce", "I", "heard", "about", "it", "at", "one", "point", "but", "haven", "t", "use", "it", "yet", "NUMBER", "I", "can", "t", "think", "of", "any", "downsides", "to", "this", "assuming", "it", "be", "support", "in", "Rails", "NUMBER", "and", "beyond", "NUMBER", "Pull", "request", "welcome", "Please", "keep", "the", "conversation", "in", "NUMBER", "no", "need", "to", "open", "multiple", "issue", "NUMBER", "That", "s", "a", "fog", "issue", "and", "I", "assume", "it", "s", "fix", "in", "fog", "master", "if", "not", "the", "latest", "point", "release", "NUMBER", "Care", "to", "work", "up", "a", "pull", "request", "that", "words", "things", "in", "a", "way", "that", "would", "be", "helpful", "to", "a", "beginner", "Why", "be", "you", "trying", "to", "put", "file", "in", "lib", "carrierwave", "storage", "That", "s", "definitely", "the", "wrong", "place", "NUMBER", "Just", "put", "your", "config", "in", "config", "initializers", "carrierwave", "NUMBER", "rb", "NUMBER", "This", "be", "already", "fix", "in", "master", "NUMBER", "Thanks", "for", "the", "contribution", "dimko", "NUMBER", "I", "d", "like", "to", "stick", "to", "HTTP", "only", "support", "for", "fetching", "file", "because", "it", "s", "the", "simplest", "approach", "and", "it", "just", "works", "NUMBER", "Merged", "thanks", "hyperrjas", "Please", "do", "not", "post", "the", "same", "question", "in", "multiple", "issue", "I", "ve", "responded", "to", "your", "question", "in", "NUMBER", "Merged", "thanks", "I", "m", "not", "following", "on", "what", "the", "problem", "be", "here", "NUMBER", "you", "can", "put", "configuration", "in", "config", "initializers", "if", "you", "want", "it", "to", "apply", "to", "all", "environments", "or", "you", "can", "put", "it", "in", "each", "of", "the", "environment", "configs", "if", "it", "s", "vastly", "different", "in", "each", "env", "NUMBER", "Please", "post", "usage", "issue", "to", "Stack", "Overflow", "or", "the", "Google", "Group", "NUMBER", "When", "doing", "so", "I", "recommend", "including", "a", "full", "stack", "trace", "as", "well", "so", "people", "have", "enough", "info", "when", "work", "through", "your", "issue", "NUMBER", "You", "can", "also", "use", "config", "NUMBER", "fog_attributes", "something", "like", "config", "NUMBER", "fog_attributes", "acl", "authenticated", "read", "for", "example", "NUMBER", "Just", "to", "clarify", "you", "all", "be", "only", "having", "issue", "if", "setting", "a", "custom", "filename", "correct", "I", "want", "to", "make", "sure", "I", "m", "narrowing", "this", "down", "correctly", "when", "figuring", "out", "what", "s", "wrong", "NUMBER", "Fog", "checks", "your", "bucket", "name", "here", "LINK", "_object_https_url", "NUMBER", "rb", "L", "NUMBER", "and", "if", "it", "be", "an", "acceptable", "format", "for", "serving", "as", "a", "hostname", "with", "SSL", "it", "will", "use", "it", "as", "a", "subdomain", "NUMBER", "Otherwise", "it", "will", "specify", "the", "bucket", "in", "the", "path", "NUMBER", "CW", "uses", "the", "combination", "of", "the", "filename", "and", "the", "settings", "specified", "in", "your", "uploader", "class", "to", "generate", "the", "proper", "URL", "NUMBER", "This", "allows", "you", "to", "easily", "swap", "out", "the", "storage", "backend", "without", "make", "any", "change", "to", "your", "core", "application", "NUMBER", "That", "said", "you", "cannot", "store", "the", "full", "URL", "NUMBER", "This", "doesn", "t", "provide", "any", "indication", "as", "to", "what", "you", "be", "fix", "and", "the", "test", "doesn", "t", "test", "anything", "NUMBER", "Feel", "free", "to", "reopen", "with", "more", "info", "and", "valid", "test", "NUMBER", "Check", "out", "the", "imagemagick", "docs", "for", "this", "this", "be", "lower", "level", "functionality", "and", "has", "nothing", "to", "do", "with", "carrierwave", "NUMBER", "First", "class", "JSON", "XML", "serialization", "support", "be", "implement", "in", "master", "NUMBER", "Have", "not", "tried", "it", "with", "mongoid", "yet", "though", "NUMBER", "That", "s", "because", "the", "serialization", "goodies", "that", "make", "ActiveRecord", "handle", "it", "properly", "be", "do", "here", "LINK", "L", "NUMBER", "The", "same", "needs", "to", "be", "do", "for", "mongo", "here", "LINK", "mongoid", "blob", "master", "lib", "carrierwave", "mongoid", "NUMBER", "rb", "Given", "that", "mongoid", "be", "activemodel", "compliant", "the", "serializable_hash", "method", "should", "be", "identical", "NUMBER", "Can", "you", "try", "forking", "carrierwave", "mongoid", "and", "add", "it", "It", "would", "be", "tough", "to", "monkey", "patch", "because", "it", "s", "a", "class_eval", "inside", "the", "mount_uploader", "method", "Nice", "yeah", "that", "s", "exactly", "what", "it", "s", "supposed", "to", "do", "NUMBER", "You", "can", "see", "what", "I", "did", "to", "test", "ActiveRecord", "starting", "on", "line", "NUMBER", "of", "activerecord_spec", "should", "be", "very", "similar", "LINK", "_spec", "NUMBER", "rb", "L", "NUMBER", "Are", "you", "still", "use", "and", "test", "against", "CarrierWave", "from", "master", "That", "be", "defined", "here", "LINK", "L", "NUMBER", "You", "just", "need", "to", "override", "the", "store_dir", "in", "your", "uploader", "NUMBER", "See", "the", "readme", "for", "details", "NUMBER", "Here", "be", "the", "class", "declaration", "for", "CarrierWave", "Storage", "Fog", "File", "LINK", "L", "NUMBER", "You", "can", "call", "any", "of", "the", "methods", "there", "perhaps", "use", "path", "to", "extract", "the", "file", "extension", "NUMBER", "We", "would", "welcome", "a", "pull", "request", "that", "add", "a", "method", "for", "fetching", "the", "extension", "directly", "NUMBER", "I", "m", "not", "seeing", "an", "issue", "here", "that", "indicates", "a", "flaw", "in", "CarrierWave", "NUMBER", "recerate_versions", "should", "not", "apply", "any", "change", "to", "the", "original", "image", "NUMBER", "Can", "you", "upload", "a", "sample", "app", "that", "shows", "the", "issue", "Try", "use", "mini_magick", "NUMBER", "Rmagick", "be", "cause", "the", "segfault", "not", "CarrierWave", "NUMBER", "Like", "mini_magick", "or", "rmagick", "the", "mime", "types", "dependency", "be", "optional", "NUMBER", "It", "be", "not", "required", "for", "core", "CarrierWave", "operations", "NUMBER", "geemus", "Can", "you", "chime", "in", "here", "What", "s", "the", "best", "way", "to", "specify", "AWS", "options", "available", "here", "LINK", "_object", "NUMBER", "rb", "L", "NUMBER", "Thanks", "for", "this", "would", "you", "mind", "add", "rspec", "test", "While", "most", "of", "the", "current", "cucumber", "test", "be", "valid", "new", "features", "be", "be", "test", "with", "RSpec", "NUMBER", "Thanks", "One", "more", "request", "would", "you", "mind", "documenting", "this", "new", "feature", "in", "the", "README", "This", "has", "be", "request", "several", "times", "in", "previous", "issue", "so", "docs", "would", "be", "great", "Merged", "thanks", "Already", "fix", "no", "problem", "NUMBER", "Can", "you", "pull", "from", "master", "and", "get", "this", "work", "I", "fix", "one", "of", "the", "steps", "but", "still", "fail", "NUMBER", "You", "ll", "need", "to", "open", "a", "new", "pull", "request", "since", "this", "one", "was", "already", "merge", "NUMBER", "Thanks", "Latest", "build", "be", "at", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "No", "need", "to", "push", "another", "commit", "to", "re", "run", "but", "there", "s", "no", "reason", "to", "think", "that", "ll", "accomplish", "anything", "NUMBER", "I", "can", "t", "seem", "to", "get", "the", "error", "locally", "either", "NUMBER", "So", "I", "don", "t", "forget", "NUMBER", "Write", "an", "article", "that", "covers", "the", "basics", "of", "use", "CarrierWave", "with", "Rails", "NUMBER", "x", "and", "expands", "a", "bit", "on", "the", "EY", "article", "to", "Discuss", "more", "about", "the", "lifecycle", "of", "the", "file", "upload", "to", "crystalize", "the", "sequence", "of", "events", "that", "occur", "and", "give", "people", "a", "strong", "understanding", "of", "the", "library", "s", "approach", "NUMBER", "Provide", "a", "reference", "app", "in", "github", "people", "can", "clone", "and", "deploy", "themselves", "to", "Heroku", "with", "minimal", "steps", "NUMBER", "The", "app", "might", "upload", "images", "to", "S", "NUMBER", "as", "well", "as", "create", "a", "couple", "thumbnail", "version", "of", "the", "image", "NUMBER", "Utilize", "environment", "variables", "for", "config", "settings", "as", "be", "the", "Heroku", "approach", "NUMBER", "See", "here", "for", "a", "recent", "article", "that", "dives", "a", "little", "bit", "into", "a", "reference", "application", "and", "explains", "some", "of", "the", "concepts", "behind", "the", "approach", "in", "addition", "to", "the", "standard", "howto", "language", "NUMBER", "LINK", "asset", "host", "rails", "NUMBER", "Writing", "guide", "LINK", "metal", "There", "be", "not", "a", "build", "in", "option", "for", "this", "NUMBER", "You", "could", "handle", "this", "any", "number", "of", "ways", "in", "your", "app", "though", "copy", "the", "file", "somewhere", "in", "a", "before_destroy", "callback", "use", "version", "on", "S", "NUMBER", "etc", "NUMBER", "It", "seems", "like", "a", "hack", "to", "me", "to", "orphan", "file", "by", "deleting", "their", "record", "without", "deleting", "the", "file", "itself", "NUMBER", "Another", "option", "would", "be", "to", "mark", "the", "record", "it", "as", "delete", "in", "you", "app", "without", "actually", "deleting", "it", "NUMBER", "You", "can", "use", "skip_callback", "doc", "here", "LINK", "_support", "callbacks", "NUMBER", "rb", "L", "NUMBER", "on", "CarrierWave", "s", "after_destroy", "remove_", "column", "While", "I", "completely", "agree", "with", "you", "that", "sanitization", "do", "not", "belong", "here", "can", "you", "think", "of", "a", "way", "that", "we", "could", "fix", "this", "without", "breaking", "exist", "apps", "Perhaps", "just", "specifically", "add", "support", "for", "brackets", "It", "depends", "on", "which", "release", "it", "be", "I", "avoid", "violating", "semver", "whenever", "possible", "NUMBER", "So", "there", "was", "a", "patch", "submitted", "to", "ruby", "stdlib", "for", "URI", "that", "fix", "bracket", "support", "and", "it", "was", "rejected", "Lame", "sauce", "NUMBER", "Care", "to", "chime", "in", "trevorturk", "I", "agree", "that", "CW", "shouldn", "t", "be", "responsible", "for", "sanitizing", "but", "it", "s", "already", "in", "there", "yay", "code", "debt", "and", "be", "easy", "enough", "to", "override", "per", "uploader", "NUMBER", "Yeah", "my", "bad", "monkey", "patching", "be", "necessary", "to", "override", "NUMBER", "CarrierWave", "doesn", "t", "officially", "support", "JRuby", "at", "this", "time", "NUMBER", "We", "would", "gladly", "accept", "patches", "though", "if", "this", "be", "something", "you", "d", "be", "willing", "to", "work", "on", "I", "can", "t", "be", "certain", "that", "it", "s", "a", "JRuby", "issue", "but", "I", "do", "know", "that", "the", "CW", "specs", "do", "not", "pass", "on", "JRuby", "NUMBER", "Is", "there", "a", "similar", "fix", "that", "you", "can", "come", "up", "with", "for", "to_xml", "It", "took", "awhile", "to", "finally", "get", "the", "two", "serializers", "work", "consistently", "I", "want", "to", "make", "sure", "it", "stays", "that", "way", "NUMBER", "I", "see", "there", "be", "no", "as_xml", "in", "AS", "NUMBER", "Feel", "free", "to", "post", "follow", "up", "commit", "here", "NUMBER", "I", "d", "really", "like", "to", "consider", "XML", "JSON", "serialization", "a", "single", "feature", "so", "they", "stay", "consistent", "from", "here", "on", "out", "NUMBER", "metal", "Awesome", "work", "thanks", "for", "digging", "into", "this", "Is", "this", "fix", "by", "NUMBER", "The", "next", "release", "NUMBER", "will", "support", "Rails", "NUMBER", "and", "later", "only", "NUMBER", "ActiveModel", "shouldn", "t", "be", "a", "dependency", "at", "all", "I", "see", "it", "s", "in", "the", "latest", "gemspec", "but", "that", "s", "an", "error", "on", "my", "part", "but", "ActiveSupport", "must", "be", "NUMBER", "or", "greater", "NUMBER", "Can", "you", "provide", "your", "uploader", "code", "in", "a", "gist", "There", "must", "be", "a", "better", "way", "this", "fetches", "the", "file", "from", "the", "remote", "data", "store", "it", "doesn", "t", "just", "check", "for", "its", "existence", "NUMBER", "I", "know", "Fog", "has", "a", "head_object", "method", "for", "AWS", "not", "sure", "if", "it", "extend", "to", "other", "providers", "though", "NUMBER", "Merged", "thanks", "Cherry", "pick", "to", "NUMBER", "stable", "branch", "Fog", "has", "a", "method", "for", "checking", "the", "existence", "of", "remote", "file", "I", "recommend", "use", "that", "NUMBER", "Patches", "be", "welcome", "though", "if", "you", "want", "to", "add", "this", "functionality", "NUMBER", "Merged", "thanks", "Try", "reinstalling", "imagemagick", "NUMBER", "Also", "I", "m", "not", "sure", "if", "Rmagick", "plays", "nice", "with", "Ruby", "NUMBER", "I", "personally", "always", "use", "MiniMagick", "NUMBER", "In", "any", "case", "this", "be", "not", "a", "CarrierWave", "issue", "NUMBER", "Rmagick", "be", "generally", "very", "frustrating", "NUMBER", "Unless", "you", "need", "to", "use", "it", "for", "some", "reason", "I", "definitely", "recommend", "MiniMagick", "NUMBER", "Please", "post", "any", "mongoid", "specific", "issue", "to", "the", "carrierwave", "mongoid", "repo", "NUMBER", "Mongoid", "support", "be", "no", "longer", "part", "of", "the", "main", "CarrierWave", "gem", "NUMBER", "Issue", "NUMBER", "be", "a", "mongoid", "specific", "issue", "NUMBER", "Use", "the", "carrierwave", "NUMBER", "stable", "branch", "for", "now", "with", "carrierwave", "mongoid", "NUMBER", "I", "haven", "t", "looked", "at", "carrierwave", "mongoid", "since", "I", "made", "last", "week", "s", "change", "but", "I", "m", "sure", "it", "broke", "a", "few", "things", "there", "were", "a", "few", "API", "change", "NUMBER", "The", "priority", "was", "get", "a", "consistent", "serialization", "for", "uploaders", "and", "make", "it", "compatible", "with", "Rails", "NUMBER", "and", "master", "NUMBER", "Now", "that", "we", "re", "there", "we", "can", "get", "the", "other", "ORMs", "work", "NUMBER", "Please", "post", "mongoid", "specific", "issue", "over", "on", "the", "carrierwave", "mongoid", "repo", "in", "the", "future", "NUMBER", "I", "need", "to", "finish", "up", "some", "documentation", "on", "the", "new", "serialization", "stuff", "then", "we", "ll", "get", "NUMBER", "and", "NUMBER", "out", "shortly", "after", "NUMBER", "Our", "release", "aren", "t", "major", "enough", "to", "do", "pre", "rc", "release", "you", "can", "just", "use", "the", "path", "to", "the", "git", "repo", "in", "your", "Gemfile", "if", "you", "want", "to", "live", "on", "the", "edge", "NUMBER", "Please", "post", "usage", "question", "to", "Stack", "Overflow", "or", "the", "Google", "Group", "NUMBER", "Thanks", "and", "really", "appreciate", "you", "including", "a", "test", "Looks", "good", "to", "me", "any", "objections", "geemus", "Are", "there", "any", "keys", "in", "the", "credentials", "hash", "that", "be", "consistent", "across", "all", "providers", "Merged", "thanks", "Does", "is_avatar", "never", "get", "run", "or", "do", "it", "return", "false", "What", "be", "your", "is_avatar", "code", "in", "the", "model", "It", "be", "likely", "that", "it", "just", "isn", "t", "true", "yet", "NUMBER", "Add", "logger", "output", "in", "the", "Carrierwave", "conditional", "to", "see", "its", "value", "when", "it", "runs", "NUMBER", "Closing", "due", "to", "inactivity", "NUMBER", "Trying", "to", "get", "all", "the", "remote", "Fog", "specs", "passing", "but", "run", "into", "a", "few", "failures", "due", "to", "file", "content_type", "come", "back", "nil", "on", "AWS", "differently", "than", "expected", "on", "RS", "and", "I", "don", "t", "have", "a", "Google", "Storage", "account", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "File", "object", "it", "should", "behave", "like", "AWS", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "nil", "use", "Shared", "Example", "Group", "AWS", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "path", "it", "should", "behave", "like", "AWS", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "nil", "use", "Shared", "Example", "Group", "AWS", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "Pathname", "it", "should", "behave", "like", "AWS", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "nil", "use", "Shared", "Example", "Group", "AWS", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "File", "object", "it", "should", "behave", "like", "Rackspace", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "text", "html", "charset", "UTF", "NUMBER", "use", "Shared", "Example", "Group", "Rackspace", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "path", "it", "should", "behave", "like", "Rackspace", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "text", "html", "charset", "UTF", "NUMBER", "use", "Shared", "Example", "Group", "Rackspace", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "NUMBER", "CarrierWave", "Storage", "Fog", "with", "a", "valid", "Pathname", "it", "should", "behave", "like", "Rackspace", "storage", "store", "should", "have", "a", "content_type", "Failure", "Error", "fog_file", "NUMBER", "content_type", "NUMBER", "should", "image", "jpeg", "expected", "image", "jpeg", "get", "text", "html", "charset", "UTF", "NUMBER", "use", "Shared", "Example", "Group", "Rackspace", "storage", "call", "from", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "NUMBER", "spec", "storage", "fog_helper", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "fog_tests", "geemus", "Might", "you", "have", "some", "time", "to", "see", "what", "s", "going", "on", "here", "Please", "work", "from", "NUMBER", "stable", "and", "ignore", "the", "fail", "specs", "surrounding", "XML", "serialization", "NUMBER", "Thanks", "Thanks", "Awesome", "thanks", "for", "taking", "the", "time", "to", "do", "this", "This", "be", "definitely", "a", "know", "issue", "it", "s", "annoying", "me", "too", "and", "I", "m", "work", "on", "it", "NUMBER", "Yep", "I", "hit", "up", "josevalim", "about", "it", "the", "other", "day", "too", "because", "I", "be", "out", "of", "ideas", "NUMBER", "Serializers", "in", "ActiveSupport", "and", "ActiveModel", "be", "very", "inconsistent", "and", "pretty", "confusing", "NUMBER", "Hopefully", "we", "ll", "get", "it", "squared", "away", "soon", "I", "tried", "playing", "with", "serializable_hash", "a", "bit", "but", "didn", "t", "get", "anywhere", "NUMBER", "I", "think", "there", "be", "really", "two", "issue", "here", "NUMBER", "ActiveModel", "ActiveRecord", "handle", "to_xml", "and", "to_json", "differently", "NUMBER", "Perhaps", "this", "be", "fix", "or", "improved", "with", "NUMBER", "but", "there", "be", "still", "as_json", "in", "the", "mix", "and", "I", "m", "not", "sure", "where", "that", "comes", "in", "NUMBER", "CW", "add", "an", "attribute", "to", "an", "AR", "class", "but", "it", "returns", "an", "uploader", "object", "when", "calling", "the", "attribute", "can", "t", "figure", "out", "how", "rails", "be", "designed", "to", "handle", "that", "when", "serializing", "NUMBER", "NUMBER", "When", "not", "use", "active", "record", "we", "should", "still", "have", "a", "consistent", "method", "of", "serializing", "uploader", "data", "NUMBER", "If", "this", "means", "use", "ActiveModel", "for", "all", "CW", "objects", "that", "s", "no", "problem", "NUMBER", "Making", "this", "a", "Rails", "NUMBER", "and", "newer", "fix", "be", "no", "problem", "at", "all", "NUMBER", "The", "next", "release", "of", "CW", "be", "focusing", "on", "NUMBER", "and", "rails", "master", "support", "NUMBER", "josevalim", "Using", "serializable_hash", "did", "the", "trick", "I", "think", "the", "last", "time", "I", "tried", "it", "was", "on", "NUMBER", "x", "NUMBER", "We", "re", "looking", "good", "now", "thanks", "Another", "approach", "be", "to", "store", "the", "original", "height", "and", "width", "in", "the", "database", "then", "calculate", "the", "version", "size", "based", "on", "the", "constraints", "set", "on", "a", "given", "version", "NUMBER", "This", "may", "be", "overkill", "in", "your", "case", "but", "we", "have", "over", "NUMBER", "version", "of", "photos", "in", "an", "app", "so", "shelling", "out", "to", "imagemagick", "be", "not", "efficient", "NUMBER", "ruby", "Calculate", "width", "from", "a", "provide", "height", "based", "on", "the", "original", "image", "size", "def", "width_from_height", "h", "width", "NUMBER", "to_f", "h", "NUMBER", "to_f", "height", "NUMBER", "to_f", "NUMBER", "round", "end", "Calculate", "height", "from", "a", "provide", "width", "based", "on", "the", "original", "image", "size", "def", "height_from_width", "w", "height", "NUMBER", "to_f", "w", "NUMBER", "to_f", "width", "NUMBER", "to_f", "NUMBER", "round", "end", "Please", "post", "usage", "relate", "question", "to", "the", "Google", "Group", "or", "to", "Stack", "Overflow", "NUMBER", "What", "do", "User", "NUMBER", "first", "have", "in", "its", "avatar", "column", "in", "the", "database", "Can", "you", "provide", "a", "test", "and", "or", "a", "sample", "filename", "that", "demonstrates", "this", "issue", "I", "m", "able", "to", "reproduce", "the", "encoding", "issue", "but", "be", "not", "familiar", "enough", "with", "ruby", "encodings", "to", "come", "up", "with", "a", "work", "fix", "NUMBER", "Your", "patch", "to", "force", "the", "encoding", "do", "not", "pass", "specs", "when", "calling", "store", "with", "a", "unicode", "file", "NUMBER", "If", "you", "be", "able", "to", "come", "up", "with", "a", "patch", "that", "include", "test", "that", "clearly", "support", "storing", "unicode", "filenames", "we", "d", "appreciate", "it", "The", "latest", "CarrierWave", "from", "git", "master", "works", "with", "NUMBER", "rc", "NUMBER", "It", "do", "not", "work", "with", "rc", "NUMBER", "Can", "you", "gist", "your", "Gemfile", "NUMBER", "lock", "The", "rest", "would", "be", "helpful", "mainly", "want", "to", "confirm", "that", "you", "be", "in", "fact", "run", "the", "latest", "Rails", "RC", "NUMBER", "The", "Rails", "commit", "here", "LINK", "should", "have", "fix", "these", "issue", "and", "I", "ve", "confirmed", "that", "it", "made", "it", "into", "RC", "NUMBER", "Will", "look", "into", "this", "further", "as", "soon", "as", "I", "can", "NUMBER", "I", "will", "look", "into", "this", "today", "NUMBER", "I", "m", "unable", "to", "fully", "reproduce", "this", "issue", "NUMBER", "I", "see", "that", "when", "looking", "in", "the", "console", "it", "doesn", "t", "show", "representation", "of", "the", "uploader", "object", "at", "first", "glance", "but", "it", "still", "works", "Loading", "development", "environment", "Rails", "NUMBER", "p", "Person", "NUMBER", "first", "Person", "Load", "NUMBER", "ms", "SELECT", "people", "NUMBER", "FROM", "people", "LIMIT", "NUMBER", "TAG", "Make", "sure", "it", "s", "an", "uploader", "object", "p", "NUMBER", "avatar", "uploads", "person", "avatar", "NUMBER", "ss", "NUMBER", "png", "p", "NUMBER", "avatar", "NUMBER", "class", "GenericUploader", "Check", "available", "version", "p", "NUMBER", "avatar", "NUMBER", "version", "thumb", "uploads", "person", "avatar", "NUMBER", "thumb_ss", "NUMBER", "png", "p", "NUMBER", "avatar", "NUMBER", "umb", "NUMBER", "url", "uploads", "person", "avatar", "NUMBER", "thumb_ss", "NUMBER", "png", "Using", "the", "example", "from", "johnbeynon", "it", "seems", "that", "Rails", "NUMBER", "just", "doesn", "t", "display", "the", "details", "of", "a", "record", "the", "same", "way", "as", "it", "did", "before", "in", "the", "console", "NUMBER", "But", "if", "you", "call", "Photo", "NUMBER", "last", "NUMBER", "class", "I", "m", "willing", "to", "bet", "it", "s", "ImageUploader", "and", "responds", "to", "all", "uploader", "methods", "NUMBER", "If", "that", "s", "not", "the", "case", "please", "upload", "a", "sample", "app", "that", "demonstrates", "the", "issue", "NUMBER", "In", "any", "case", "uploader", "objects", "be", "responding", "like", "uploader", "objects", "in", "my", "test", "NUMBER", "If", "you", "have", "a", "sample", "app", "that", "demonstrates", "otherwise", "I", "m", "happy", "to", "take", "a", "look", "NUMBER", "Can", "someone", "please", "post", "a", "full", "sample", "app", "that", "demonstrates", "this", "I", "can", "t", "debug", "since", "I", "can", "t", "reproduce", "NUMBER", "nixme", "Could", "you", "paste", "your", "Gemfile", "Just", "in", "case", "there", "s", "some", "other", "lib", "that", "s", "cause", "this", "somehow", "NUMBER", "I", "m", "work", "with", "a", "clean", "Rails", "NUMBER", "app", "use", "the", "base", "Gemfile", "carrierwave", "NUMBER", "Still", "waiting", "on", "someone", "to", "provide", "a", "sample", "app", "that", "demonstrates", "the", "issue", "NUMBER", "nixme", "Any", "update", "A", "long", "Gemfile", "may", "actually", "help", "if", "this", "be", "cause", "by", "a", "dependency", "that", "you", "all", "happen", "to", "be", "use", "I", "m", "pretty", "stumped", "as", "to", "what", "could", "possibly", "cause", "what", "you", "re", "seeing", "NUMBER", "All", "the", "test", "pass", "including", "ActiveRecord", "test", "on", "all", "Ruby", "version", "use", "only", "the", "required", "dependencies", "so", "I", "can", "t", "investigate", "further", "until", "one", "of", "you", "sends", "me", "something", "NUMBER", "tpope", "Thank", "you", "That", "s", "definitely", "our", "common", "denominator", "here", "and", "I", "ve", "confirmed", "that", "it", "breaks", "CarrierWave", "If", "anyone", "still", "encounters", "this", "issue", "after", "remove", "or", "bumping", "the", "kaminari", "version", "in", "your", "app", "please", "post", "back", "here", "NUMBER", "Digging", "in", "further", "this", "commit", "to", "Kaminari", "fix", "the", "issue", "LINK", "leehanbley", "How", "about", "creating", "a", "fresh", "app", "and", "add", "pieces", "to", "your", "user", "model", "one", "by", "one", "Can", "one", "of", "you", "provide", "a", "sample", "app", "that", "has", "this", "issue", "I", "d", "like", "to", "be", "able", "to", "fire", "it", "up", "myself", "and", "see", "the", "logs", "NUMBER", "Closing", "in", "favor", "of", "NUMBER", "it", "be", "essentially", "the", "same", "issue", "NUMBER", "Not", "with", "build", "in", "functionality", "provide", "by", "CarrierWave", "NUMBER", "Your", "application", "could", "handle", "this", "in", "a", "number", "of", "ways", "NUMBER", "You", "could", "for", "example", "force", "the", "filename", "to", "remain", "the", "same", "so", "the", "file", "on", "S", "NUMBER", "gets", "replaced", "this", "would", "ensure", "that", "pictures", "work", "from", "old", "links", "and", "would", "even", "be", "up", "to", "date", "NUMBER", "I", "ve", "just", "push", "a", "test", "app", "of", "the", "latest", "CarrierWave", "gem", "use", "Fog", "to", "Heroku", "and", "had", "no", "issue", "NUMBER", "If", "you", "have", "additional", "trouble", "please", "post", "usage", "issue", "to", "Stack", "Overflow", "or", "the", "Google", "Group", "NUMBER", "This", "be", "not", "present", "in", "CarrierWave", "and", "be", "by", "design", "NUMBER", "All", "image", "manipulations", "be", "always", "taken", "from", "the", "original", "image", "to", "ensure", "integrity", "NUMBER", "You", "would", "have", "to", "implement", "your", "own", "callback", "to", "handle", "manipulations", "based", "on", "another", "manipulation", "NUMBER", "I", "m", "get", "a", "failure", "when", "run", "the", "test", "for", "this", "NUMBER", "CarrierWave", "Uploader", "NUMBER", "process", "should", "successfully", "process", "a", "multi", "page", "PDF", "when", "use", "RMagick", "Failure", "Error", "uploader", "NUMBER", "cache", "File", "NUMBER", "open", "file_path", "multi_page", "NUMBER", "pdf", "CarrierWave", "ProcessingError", "Failed", "to", "manipulate", "with", "rmagick", "maybe", "it", "be", "not", "an", "image", "Original", "Error", "Postscript", "delegate", "fail", "Users", "jkmiller", "code", "carrierwave", "spec", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "multi_page", "NUMBER", "pdf", "No", "such", "file", "or", "directory", "error", "pdf", "NUMBER", "c", "ReadPDFImage", "NUMBER", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "rescue", "in", "manipulate", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "manipulate", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "convert", "NUMBER", "lib", "carrierwave", "uploader", "processing", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process", "NUMBER", "lib", "carrierwave", "uploader", "processing", "NUMBER", "rb", "NUMBER", "in", "each", "NUMBER", "lib", "carrierwave", "uploader", "processing", "NUMBER", "rb", "NUMBER", "in", "process", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_callbacks", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "each", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "NUMBER", "spec", "uploader", "processing_spec", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "TAG", "Appears", "I", "just", "needed", "ghostscript", "install", "NUMBER", "Please", "consider", "add", "a", "wiki", "page", "about", "this", "issue", "be", "not", "the", "right", "place", "NUMBER", "I", "tried", "to", "avoid", "putting", "a", "Padrino", "specific", "initializer", "like", "we", "have", "for", "Sinatra", "because", "I", "thought", "Padrino", "was", "build", "on", "Sinatra", "and", "should", "be", "compatible", "NUMBER", "I", "m", "open", "to", "make", "change", "to", "accomodate", "Padrino", "though", "so", "please", "do", "investigate", "I", "don", "t", "think", "it", "s", "unreasonable", "to", "require", "that", "Padrino", "comes", "before", "CarrierWave", "in", "the", "Gemfile", "if", "that", "fix", "the", "issue", "NUMBER", "Easy", "enough", "to", "add", "a", "wiki", "page", "for", "Padrino", "instructions", "NUMBER", "Personally", "I", "always", "put", "my", "app", "framework", "at", "the", "top", "of", "the", "Gemfile", "NUMBER", "I", "ll", "wait", "for", "your", "response", "from", "the", "mailing", "list", "but", "I", "think", "this", "be", "the", "best", "approach", "ruby", "elsif", "defined", "Padrino", "CarrierWave", "NUMBER", "root", "File", "NUMBER", "join", "Padrino", "NUMBER", "root", "public", "end", "Accepted", "thanks", "NUMBER", "Looks", "good", "to", "me", "NUMBER", "Thank", "you", "We", "ve", "get", "a", "couple", "fail", "on", "Travis", "CI", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "bensie", "thanks", "for", "work", "on", "this", "stuff", "NUMBER", "I", "know", "it", "s", "extra", "tricky", "NUMBER", "Also", "I", "just", "merge", "a", "pull", "request", "where", "I", "m", "seeing", "green", "locally", "but", "not", "on", "Travis", "NUMBER", "p", "NUMBER", "system", "master", "code", "carrierwave", "RBENV_VERSION", "NUMBER", "p", "NUMBER", "bundle", "exec", "rake", "Users", "trevorturk", "NUMBER", "rbenv", "version", "NUMBER", "p", "NUMBER", "bin", "ruby", "S", "bundle", "exec", "rspec", "color", "NUMBER", "spec", "compatibility", "paperclip_spec", "NUMBER", "rb", "NUMBER", "spec", "mount_spec", "NUMBER", "rb", "NUMBER", "spec", "orm", "activerecord_spec", "NUMBER", "rb", "NUMBER", "spec", "processing", "mime_types_spec", "NUMBER", "rb", "NUMBER", "spec", "processing", "mini_magick_spec", "NUMBER", "rb", "NUMBER", "spec", "processing", "rmagick_spec", "NUMBER", "rb", "NUMBER", "spec", "sanitized_file_spec", "NUMBER", "rb", "NUMBER", "spec", "storage", "cloudfiles_spec", "NUMBER", "rb", "NUMBER", "spec", "storage", "fog_spec", "NUMBER", "rb", "NUMBER", "spec", "storage", "s", "NUMBER", "_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "cache_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "callback_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "configuration_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "default_url_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "download_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "extension_whitelist_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "mountable_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "paths_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "processing_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "proxy_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "remove_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "store_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "url_spec", "NUMBER", "rb", "NUMBER", "spec", "uploader", "versions_spec", "NUMBER", "rb", "NUMBER", "Finished", "in", "NUMBER", "seconds", "NUMBER", "examples", "NUMBER", "failures", "Users", "trevorturk", "NUMBER", "rbenv", "version", "NUMBER", "p", "NUMBER", "bin", "ruby", "S", "bundle", "exec", "cucumber", "features", "format", "progress", "Using", "the", "default", "profile", "NUMBER", "NUMBER", "NUMBER", "scenarios", "NUMBER", "pass", "NUMBER", "steps", "NUMBER", "pass", "NUMBER", "m", "NUMBER", "s", "jeroenhouben", "check", "out", "the", "bottom", "of", "the", "readme", "and", "you", "ll", "find", "instructions", "about", "how", "to", "run", "the", "remote", "test", "NUMBER", "Closing", "for", "now", "NUMBER", "jeroenhouben", "please", "feel", "free", "to", "submit", "a", "new", "pull", "request", "or", "to", "reopen", "with", "test", "NUMBER", "Thank", "you", "I", "m", "confused", "this", "pull", "request", "be", "be", "close", "in", "favor", "of", "which", "fix", "jeroenhouben", "if", "you", "look", "at", "the", "master", "branch", "things", "should", "look", "a", "lot", "cleaner", "now", "NUMBER", "There", "be", "Fog", "test", "only", "now", "for", "cloud", "storage", "no", "separate", "S", "NUMBER", "test", "NUMBER", "Can", "you", "try", "and", "get", "a", "fail", "test", "add", "there", "When", "you", "do", "please", "open", "a", "separate", "pull", "request", "NUMBER", "Closing", "this", "one", "as", "it", "s", "mostly", "just", "confusing", "NUMBER", "meskyanichi", "I", "wonder", "if", "it", "d", "be", "worth", "make", "a", "test", "that", "uses", "Excon", "and", "or", "fog", "directly", "with", "a", "single", "file", "NUMBER", "Perhaps", "narrowing", "down", "the", "scope", "of", "the", "work", "be", "do", "would", "help", "pinpoint", "the", "problem", "NUMBER", "FWIW", "I", "ve", "be", "work", "on", "some", "projects", "lately", "that", "upload", "many", "thousands", "of", "images", "thumbnails", "to", "S", "NUMBER", "use", "the", "old", "aws", "s", "NUMBER", "gem", "and", "I", "see", "all", "kinds", "of", "error", "on", "a", "regular", "basis", "NUMBER", "We", "regularly", "see", "and", "rescue", "retry", "for", "error", "like", "AWS", "S", "NUMBER", "RequestTimeout", "Errno", "ESTALE", "Errno", "ECONNRESET", "Errno", "EPIPE", "Errno", "ETIMEDOUT", "Errno", "EHOSTUNREACH", "NUMBER", "part", "of", "me", "be", "wondering", "if", "this", "be", "just", "something", "that", "can", "t", "be", "avoided", "NUMBER", "The", "fact", "that", "you", "ve", "be", "able", "to", "figure", "out", "a", "predictable", "pattern", "be", "really", "strange", "though", "NUMBER", "Yeah", "I", "think", "this", "may", "just", "be", "a", "case", "of", "remote", "web", "services", "having", "hiccups", "from", "time", "to", "time", "NUMBER", "It", "s", "weird", "that", "you", "ve", "spotted", "this", "predictable", "pattern", "though", "NUMBER", "Let", "s", "leave", "this", "issue", "open", "for", "a", "bit", "and", "please", "do", "report", "back", "if", "you", "come", "up", "with", "anything", "else", "NUMBER", "I", "m", "suspicious", "that", "we", "won", "t", "find", "a", "smoking", "gun", "here", "though", "NUMBER", "One", "thing", "I", "ve", "do", "in", "cases", "like", "this", "be", "to", "use", "Resque", "NUMBER", "In", "that", "way", "you", "can", "control", "the", "number", "of", "workers", "and", "set", "up", "rescue", "retry", "code", "paths", "NUMBER", "It", "sounds", "like", "you", "re", "looking", "for", "raw", "speed", "so", "perhaps", "that", "wouldn", "t", "be", "ideal", "but", "it", "s", "be", "good", "enough", "for", "me", "thus", "far", "NUMBER", "meskyanichi", "I", "m", "closing", "this", "for", "now", "NUMBER", "If", "you", "re", "up", "for", "it", "please", "consider", "add", "a", "summary", "of", "the", "problem", "and", "a", "link", "here", "to", "the", "know", "issue", "wiki", "page", "NUMBER", "If", "you", "come", "up", "with", "any", "other", "ideas", "please", "continue", "posting", "here", "as", "well", "NUMBER", "What", "be", "this", "Hmm", "I", "m", "not", "sure", "how", "much", "I", "care", "about", "this", "NUMBER", "Maybe", "someone", "else", "can", "chime", "in", "if", "they", "do", "NUMBER", "eraserewind", "please", "try", "to", "make", "a", "fail", "test", "case", "and", "or", "provide", "a", "sample", "application", "for", "us", "to", "look", "at", "NUMBER", "This", "smells", "like", "a", "mongoid", "problem", "but", "it", "s", "hard", "to", "tell", "without", "more", "info", "NUMBER", "Yes", "please", "check", "the", "wiki", "for", "some", "options", "and", "please", "use", "the", "Google", "Group", "for", "general", "question", "in", "the", "future", "NUMBER", "Thank", "you", "I", "don", "t", "think", "we", "ll", "want", "to", "depend", "on", "your", "fork", "even", "temporarily", "NUMBER", "If", "when", "your", "patch", "makes", "it", "into", "fog", "though", "let", "us", "know", "and", "we", "can", "reevaluate", "this", "pull", "request", "NUMBER", "Thank", "you", "Please", "submit", "a", "new", "pull", "request", "when", "your", "change", "be", "release", "in", "gem", "form", "and", "then", "we", "ll", "review", "NUMBER", "Is", "there", "a", "reason", "you", "need", "to", "call", "cache_stored_file", "in", "your", "encrypt", "method", "I", "think", "you", "re", "just", "supposed", "to", "return", "the", "processed", "file", "at", "the", "end", "of", "your", "custom", "method", "NUMBER", "Gotcha", "NUMBER", "Well", "if", "you", "d", "like", "to", "work", "up", "a", "pull", "request", "with", "test", "that", "demonstrates", "the", "problem", "with", "a", "propose", "fix", "that", "would", "be", "awesome", "I", "took", "a", "quick", "read", "through", "those", "issus", "and", "it", "looks", "like", "we", "re", "still", "waiting", "for", "a", "new", "pull", "request", "NUMBER", "I", "don", "t", "know", "of", "a", "reason", "NUMBER", "Please", "do", "consider", "work", "up", "a", "pull", "request", "with", "test", "and", "see", "if", "you", "run", "into", "any", "problem", "along", "the", "way", "NUMBER", "cloudfiles", "be", "still", "in", "the", "gem", "just", "not", "the", "readme", "NUMBER", "Your", "feedback", "on", "the", "fog", "system", "would", "be", "most", "welcome", "but", "I", "understand", "if", "you", "d", "like", "to", "revert", "for", "now", "NUMBER", "Hoping", "to", "get", "a", "gem", "release", "out", "in", "the", "next", "week", "or", "so", "NUMBER", "There", "be", "a", "few", "outstanding", "issue", "that", "need", "to", "be", "resolve", "before", "that", "release", "be", "tag", "NUMBER", "Ok", "we", "re", "looking", "much", "better", "with", "Rails", "NUMBER", "NUMBER", "stable", "and", "master", "support", "NUMBER", "Commit", "LINK", "fix", "the", "issue", "surrounding", "class_attribute", "NUMBER", "We", "ll", "get", "a", "release", "out", "quickly", "after", "NUMBER", "be", "officially", "release", "NUMBER", "Yep", "NUMBER", "Working", "on", "it", "NUMBER", "farukca", "Have", "a", "look", "at", "issue", "NUMBER", "you", "likely", "need", "to", "update", "your", "Kaminari", "version", "NUMBER", "I", "ve", "seen", "request", "like", "this", "before", "NUMBER", "Search", "around", "and", "see", "if", "someone", "has", "figured", "it", "out", "NUMBER", "Otherwise", "pull", "request", "be", "always", "welcome", "metal", "I", "m", "suspicious", "that", "the", "other", "remaining", "Rails", "NUMBER", "issue", "be", "going", "to", "be", "similar", "config", "things", "like", "this", "NUMBER", "If", "you", "have", "the", "time", "and", "inclination", "would", "you", "mind", "looking", "through", "them", "I", "haven", "t", "use", "CW", "with", "Rails", "NUMBER", "so", "don", "t", "really", "know", "what", "s", "up", "NUMBER", "Thanks", "dude", "would", "appreciate", "the", "help", "but", "no", "worries", "if", "don", "t", "get", "around", "to", "it", "I", "m", "not", "too", "religious", "about", "that", "stuff", "but", "if", "anyone", "can", "come", "up", "with", "anything", "cleaner", "I", "m", "all", "ears", "NUMBER", "We", "could", "do", "some", "fancy", "conditional", "requires", "behind", "the", "scenes", "I", "guess", "I", "dunno", "NUMBER", "Please", "take", "question", "like", "this", "to", "the", "Google", "Group", "NUMBER", "Thanks", "If", "you", "d", "like", "to", "suggest", "any", "change", "please", "consider", "work", "up", "a", "pull", "request", "NUMBER", "Otherwise", "this", "kind", "of", "thing", "be", "great", "for", "the", "wiki", "so", "please", "consider", "contribute", "to", "that", "Thanks", "I", "m", "wondering", "if", "you", "could", "simplify", "this", "pull", "request", "to", "just", "the", "change", "you", "need", "to", "make", "NUMBER", "Is", "there", "a", "reason", "you", "add", "this", "file", "method", "Maybe", "let", "s", "just", "make", "that", "change", "alone", "and", "forget", "about", "the", "test", "Any", "chance", "you", "could", "merge", "these", "commit", "into", "one", "or", "submit", "a", "new", "pull", "request", "It", "just", "helps", "keep", "the", "project", "history", "more", "clean", "NUMBER", "I", "don", "t", "think", "this", "warrants", "a", "release", "but", "bensie", "can", "work", "it", "up", "if", "he", "disagrees", "I", "believe", "this", "pull", "request", "aims", "to", "do", "that", "LINK", "Any", "chance", "you", "could", "work", "up", "a", "pull", "request", "with", "test", "Would", "be", "much", "appreciated", "Oops", "didn", "t", "mean", "to", "close", "the", "issue", "NUMBER", "Maybe", "you", "ll", "come", "up", "with", "an", "idea", "or", "someone", "else", "might", "NUMBER", "Closing", "in", "favor", "of", "NUMBER", "bensie", "can", "you", "take", "a", "look", "at", "this", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "build", "NUMBER", "I", "think", "we", "lost", "NUMBER", "compat", "maybe", "with", "the", "that", "new", "feature", "about", "moving", "file", "instead", "of", "copying", "Do", "you", "have", "time", "to", "have", "a", "look", "I", "ll", "work", "up", "a", "release", "once", "this", "be", "fix", "NUMBER", "Thanks", "dude", "I", "don", "t", "know", "why", "we", "didn", "t", "get", "a", "failure", "email", "from", "Travis", "NUMBER", "Maybe", "they", "made", "some", "change", "there", "NUMBER", "Once", "we", "re", "green", "I", "ll", "work", "up", "a", "release", "NUMBER", "heart", "Yeah", "I", "just", "test", "as", "well", "NUMBER", "I", "ll", "hit", "up", "the", "Travis", "guys", "NUMBER", "I", "ll", "go", "ahead", "with", "the", "release", "anyway", "NUMBER", "You", "wanna", "work", "up", "the", "History", "or", "me", "Merci", "NUMBER", "Are", "you", "set", "up", "for", "release", "the", "gem", "If", "not", "hit", "up", "jnicklas", "and", "see", "if", "he", "can", "add", "you", "NUMBER", "Seems", "like", "you", "re", "the", "main", "maintainer", "nowadays", "anyways", "ps", "thank", "you", "I", "drop", "him", "a", "line", "in", "case", "he", "s", "ignoring", "all", "the", "noise", "here", "OK", "release", "Yeah", "they", "said", "hop", "in", "travis", "on", "IRC", "but", "I", "haven", "t", "had", "time", "to", "investigate", "NUMBER", "Feel", "free", "if", "you", "do", "but", "I", "m", "not", "too", "concerned", "to", "be", "honest", "NUMBER", "On", "Wednesday", "November", "NUMBER", "NUMBER", "James", "Miller", "TAG", "write", "Any", "word", "from", "the", "travis", "guys", "Passing", "on", "NUMBER", "fail", "on", "NUMBER", "passing", "on", "ruby", "head", "NUMBER", "Nice", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Please", "ask", "question", "like", "this", "on", "the", "Google", "Group", "NUMBER", "Thanks", "If", "you", "think", "you", "ve", "get", "this", "figured", "out", "a", "pull", "request", "with", "test", "would", "be", "most", "welcome", "Unless", "someone", "has", "a", "solution", "to", "this", "I", "m", "thinking", "we", "should", "move", "it", "into", "the", "know", "issue", "wiki", "page", "soon", "NUMBER", "A", "pull", "request", "from", "someone", "would", "be", "most", "welcome", "though", "OK", "moving", "to", "know", "issue", "NUMBER", "Sorry", "I", "don", "t", "know", "how", "exactly", "to", "go", "about", "this", "NUMBER", "Good", "luck", "to", "whoever", "decides", "to", "give", "it", "a", "shot", "Any", "help", "in", "track", "this", "down", "would", "be", "appreciated", "NUMBER", "It", "sounds", "like", "it", "may", "or", "may", "not", "be", "a", "problem", "with", "CarrierWave", "itself", "but", "definitely", "worth", "looking", "into", "NUMBER", "I", "wouldn", "t", "think", "so", "since", "the", "issue", "be", "still", "open", "here", "NUMBER", "Hang", "on", "a", "second", "be", "this", "covered", "in", "the", "Filenames", "and", "unicode", "chars", "section", "of", "the", "readme", "Quintus", "check", "out", "the", "readme", "and", "see", "if", "that", "helps", "NUMBER", "I", "think", "it", "should", "be", "a", "solve", "issue", "but", "maybe", "not", "NUMBER", "Hmm", "I", "can", "imagine", "NUMBER", "A", "pull", "request", "that", "fix", "this", "would", "be", "great", "otherwise", "I", "d", "suggest", "use", "a", "workaround", "in", "your", "app", "NUMBER", "I", "haven", "t", "heard", "anyone", "else", "request", "this", "before", "NUMBER", "If", "you", "manually", "save", "or", "save", "then", "do", "it", "all", "work", "I", "m", "thinking", "the", "problem", "be", "limited", "to", "the", "dirty", "attribute", "stuff", "NUMBER", "aaronchi", "I", "just", "push", "a", "bare", "minimum", "implementation", "for", "this", "NUMBER", "Let", "me", "know", "what", "you", "think", "NUMBER", "bensie", "feedback", "more", "than", "welcome", "on", "that", "change", "NUMBER", "We", "re", "going", "to", "need", "more", "detail", "to", "help", "NUMBER", "Check", "out", "the", "get", "help", "section", "of", "the", "wiki", "NUMBER", "That", "s", "still", "not", "enough", "detail", "NUMBER", "Please", "re", "read", "the", "get", "help", "section", "of", "the", "wiki", "it", "explains", "what", "kind", "of", "information", "we", "need", "NUMBER", "Can", "you", "include", "the", "Model", "and", "Uploader", "as", "well", "Also", "be", "you", "just", "use", "carrierwave", "or", "also", "carrierwave", "mongoid", "or", "something", "It", "looks", "like", "the", "Active", "Record", "ORM", "adapter", "should", "work", "but", "NUMBER", "Thanks", "for", "the", "update", "dotnil", "I", "thought", "about", "this", "a", "bit", "and", "couldn", "t", "come", "up", "with", "anything", "better", "NUMBER", "WDYT", "bensie", "Sure", "that", "sounds", "fine", "to", "me", "NUMBER", "antonversal", "wdyt", "Can", "t", "you", "just", "use", "model", "in", "the", "call", "method", "It", "s", "just", "an", "instance", "method", "in", "the", "uploader", "no", "Also", "this", "breaks", "the", "exist", "API", "so", "probably", "shouldn", "t", "be", "applied", "without", "some", "kind", "of", "backwards", "compatibility", "NUMBER", "NUMBER", "If", "you", "really", "need", "to", "do", "this", "you", "can", "easily", "use", "manipulate", "to", "get", "this", "very", "nicely", "in", "your", "application", "code", "NUMBER", "No", "problem", "no", "need", "to", "include", "it", "in", "CarrierWave", "NUMBER", "NUMBER", "Why", "would", "you", "_ever_", "possibly", "want", "this", "tonycoco", "any", "chance", "you", "could", "work", "up", "a", "doc", "patch", "If", "you", "have", "any", "ideas", "about", "fix", "this", "in", "the", "code", "that", "would", "be", "great", "too", "NUMBER", "Maybe", "a", "comment", "in", "the", "upload", "generator", "at", "least", "Closing", "in", "favor", "of", "NUMBER", "Imo", "NUMBER", "_stable", "should", "only", "receive", "critical", "bugfixes", "NUMBER", "This", "be", "more", "a", "feature", "NUMBER", "This", "seems", "weird", "to", "me", "NUMBER", "Have", "you", "considered", "just", "having", "a", "file", "that", "s", "like", "NUMBER", "byte", "or", "something", "I", "m", "game", "for", "including", "this", "if", "you", "really", "think", "it", "s", "necessary", "but", "seems", "strange", "at", "first", "glance", "NUMBER", "geemus", "awesome", "Remember", "you", "can", "always", "use", "the", "latest", "fog", "with", "Bundler", "s", "git", "repo", "support", "NUMBER", "This", "isn", "t", "really", "a", "bug", "NUMBER", "Please", "consider", "add", "a", "wiki", "page", "about", "your", "findings", "though", "NUMBER", "I", "think", "there", "may", "already", "be", "a", "similar", "page", "about", "random", "filenames", "NUMBER", "Right", "there", "s", "no", "guarantee", "that", "this", "method", "will", "only", "be", "call", "once", "so", "you", "need", "to", "keep", "that", "in", "mind", "NUMBER", "geemus", "would", "you", "mind", "reviewing", "this", "Thanks", "for", "looking", "geemus", "NUMBER", "chrisdurtschi", "I", "m", "get", "lots", "of", "test", "failures", "NUMBER", "Did", "you", "run", "the", "full", "test", "suite", "with", "your", "change", "Failure", "Error", "fog_file", "storage", "NUMBER", "ore", "file", "TypeError", "can", "t", "convert", "Tempfile", "into", "String", "Please", "re", "open", "this", "pull", "request", "or", "open", "a", "new", "pull", "request", "if", "when", "you", "have", "time", "to", "fix", "things", "NUMBER", "Thanks", "I", "m", "not", "sure", "but", "I", "think", "you", "have", "to", "change", "the", "name", "yourself", "NUMBER", "You", "can", "see", "the", "Using", "RMagick", "for", "an", "example", "NUMBER", "I", "think", "that", "should", "work", "but", "I", "m", "not", "sure", "NUMBER", "If", "you", "figure", "it", "out", "please", "consider", "make", "a", "how", "to", "on", "the", "wiki", "NUMBER", "Sorry", "I", "meant", "to", "type", "in", "the", "readme", "Maybe", "you", "can", "make", "a", "custom", "processor", "that", "do", "the", "renaming", "Closing", "for", "now", "NUMBER", "jgyllen", "please", "holler", "if", "you", "figure", "out", "how", "to", "accomplish", "what", "you", "wanted", "NUMBER", "You", "can", "just", "use", "root_path", "or", "whatever", "if", "image_tag", "etc", "isn", "t", "work", "for", "you", "NUMBER", "If", "you", "want", "to", "propose", "some", "solution", "along", "the", "lines", "of", "fog_host", "please", "consider", "work", "up", "a", "pull", "request", "NUMBER", "I", "wouldn", "t", "call", "it", "a", "bug", "maybe", "a", "miss", "feature", "NUMBER", "Maybe", "we", "need", "to", "support", "a", "lambda", "I", "dunno", "if", "you", "or", "someone", "else", "wants", "to", "work", "up", "a", "pull", "request", "it", "would", "be", "most", "welcome", "NUMBER", "As", "I", "said", "pull", "request", "be", "most", "welcome", "SixArm", "thanks", "for", "the", "offer", "but", "I", "m", "not", "available", "at", "the", "moment", "NUMBER", "You", "could", "try", "elabs", "where", "jnicklas", "works", "or", "ask", "around", "on", "the", "Google", "Group", "I", "m", "sure", "we", "d", "accept", "a", "reasonable", "pull", "request", "with", "test", "etc", "NUMBER", "I", "don", "t", "think", "this", "be", "what", "we", "want", "NUMBER", "NUMBER", "CarrierWave", "ActiveRecord", "mount_uploader", "image", "should", "return", "valid", "JSON", "when", "to_json", "be", "call", "when", "image", "be", "present", "event", "NUMBER", "textfile", "nil", "id", "NUMBER", "foo", "nil", "image", "url", "uploads", "test", "NUMBER", "jpeg", "NUMBER", "spec", "orm", "activerecord_spec", "NUMBER", "rb", "NUMBER", "NUMBER", "CarrierWave", "ActiveRecord", "mount_uploader", "image", "should", "return", "valid", "XML", "when", "to_xml", "be", "call", "when", "image", "be", "present", "event", "NUMBER", "textfile", "nil", "id", "NUMBER", "foo", "nil", "image", "test", "NUMBER", "jpeg", "NUMBER", "spec", "orm", "activerecord_spec", "NUMBER", "rb", "NUMBER", "We", "want", "these", "to", "match", "and", "they", "don", "t", "with", "this", "pull", "request", "NUMBER", "It", "s", "arguably", "better", "than", "what", "we", "have", "now", "but", "I", "don", "t", "want", "to", "support", "this", "going", "forward", "to_json", "and", "to_xml", "should", "match", "so", "I", "think", "it", "s", "best", "for", "to_xml", "to", "return", "nil", "until", "we", "can", "get", "it", "right", "NUMBER", "Thanks", "for", "looking", "at", "this", "though", "NUMBER", "A", "work", "solution", "would", "most", "definitely", "be", "welcome", "jcarlson", "would", "you", "mind", "pulling", "this", "work", "into", "a", "single", "new", "commit", "and", "submit", "a", "new", "pull", "request", "I", "think", "that", "would", "be", "the", "cleanest", "thing", "to", "do", "NUMBER", "Thank", "you", "and", "sorry", "about", "that", "I", "shouldn", "t", "have", "merge", "the", "pull", "request", "without", "run", "the", "test", "first", "NUMBER", "The", "s", "NUMBER", "storage", "module", "has", "be", "deprecate", "in", "favor", "of", "the", "fog", "storage", "module", "NUMBER", "You", "can", "use", "fog_host", "there", "I", "believe", "to", "accomplish", "what", "you", "want", "NUMBER", "Please", "let", "me", "know", "if", "not", "NUMBER", "Not", "your", "fault", "I", "haven", "t", "actually", "deprecate", "it", "I", "m", "just", "trying", "to", "push", "people", "to", "use", "fog", "and", "plan", "on", "remove", "it", "eventually", "NUMBER", "Please", "consider", "submit", "a", "pull", "request", "with", "the", "documentation", "fix", "NUMBER", "Thank", "you", "bartt", "I", "m", "seeing", "This", "pull", "request", "cannot", "be", "automatically", "merge", "NUMBER", "so", "you", "may", "need", "to", "rebase", "your", "commit", "in", "order", "for", "us", "to", "merge", "NUMBER", "I", "d", "check", "with", "jnicklas", "before", "doing", "more", "work", "though", "I", "m", "not", "clear", "on", "whether", "or", "not", "he", "s", "interested", "in", "merge", "NUMBER", "Merged", "thanks", "bartt", "Caused", "test", "failures", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "Please", "just", "provide", "a", "new", "pull", "request", "if", "that", "s", "OK", "with", "you", "No", "I", "think", "there", "was", "a", "failure", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "build", "NUMBER", "I", "think", "I", "test", "locally", "too", "NUMBER", "Sorry", "if", "I", "made", "a", "mistake", "though", "NUMBER", "I", "was", "work", "late", "yeah", "please", "do", "Is", "this", "at", "odds", "with", "NUMBER", "I", "m", "get", "a", "few", "failures", "with", "the", "cucumber", "features", "NUMBER", "Can", "you", "please", "make", "sure", "the", "test", "run", "cleanly", "and", "resubmit", "a", "new", "pull", "request", "Thanks", "Is", "this", "at", "odds", "with", "NUMBER", "Also", "I", "m", "seeing", "This", "pull", "request", "cannot", "be", "automatically", "merge", "NUMBER", "so", "if", "we", "re", "going", "to", "merge", "it", "would", "be", "nice", "to", "have", "a", "rebased", "version", "NUMBER", "Thanks", "for", "work", "on", "this", "you", "guys", "NUMBER", "In", "a", "general", "case", "with", "Rails", "the", "form", "params", "will", "come", "along", "with", "the", "content_type", "of", "an", "uploaded", "file", "which", "Carrierwave", "will", "be", "pass", "along", "to", "fog", "NUMBER", "Things", "can", "go", "wrong", "when", "the", "content_type", "be", "lost", "when", "a", "file", "be", "cached", "and", "then", "uploaded", "with", "fog", "NUMBER", "The", "caching", "process", "loses", "the", "content_type", "NUMBER", "This", "commit", "revert", "my", "lame", "attempt", "to", "fix", "that", "LINK", "NUMBER", "be", "new", "mime", "types", "stuff", "be", "much", "better", "NUMBER", "So", "perhaps", "it", "s", "worth", "mentioning", "this", "typically", "only", "matters", "if", "you", "a", "care", "about", "the", "content_type", "and", "that", "s", "usually", "when", "you", "re", "b", "uploading", "to", "a", "fog", "backed", "storage", "service", "NUMBER", "Anyway", "lemme", "know", "when", "you", "ve", "update", "this", "NUMBER", "I", "think", "add", "info", "to", "the", "readme", "be", "definitely", "smart", "but", "this", "could", "use", "a", "bit", "more", "clarification", "NUMBER", "I", "may", "trim", "this", "down", "eventually", "but", "it", "s", "definitely", "good", "enough", "for", "now", "NUMBER", "Thanks", "for", "taking", "the", "time", "to", "work", "on", "this", "The", "s", "NUMBER", "storage", "provider", "has", "be", "deprecate", "in", "favor", "of", "the", "fog", "storage", "provider", "NUMBER", "Please", "try", "to", "use", "that", "instead", "and", "let", "me", "know", "if", "it", "doesn", "t", "meet", "your", "needs", "NUMBER", "I", "think", "the", "fog_host", "config", "option", "will", "be", "a", "good", "fit", "for", "your", "case", "NUMBER", "Can", "you", "provide", "an", "example", "app", "I", "don", "t", "quite", "understand", "what", "you", "mean", "NUMBER", "For", "example", "I", "made", "this", "a", "while", "back", "to", "reproduce", "an", "issue", "LINK", "issue", "NUMBER", "ketanjm", "I", "ll", "close", "this", "issue", "for", "now", "NUMBER", "Please", "provide", "more", "detail", "if", "you", "re", "still", "having", "trouble", "NUMBER", "Can", "you", "provide", "a", "sample", "app", "that", "uses", "the", "most", "recent", "version", "of", "CW", "A", "full", "stack", "trace", "would", "help", "too", "NUMBER", "Here", "s", "an", "example", "I", "made", "to", "track", "something", "down", "LINK", "issue", "NUMBER", "brewster", "NUMBER", "can", "you", "provide", "an", "example", "before", "after", "This", "seems", "to", "work", "for", "me", "NUMBER", "Maybe", "you", "d", "be", "interested", "in", "make", "a", "wiki", "page", "about", "it", "Forgot", "the", "link", "LINK", "Yeah", "pull", "request", "and", "wiki", "pages", "would", "definitely", "help", "NUMBER", "I", "agree", "the", "docs", "need", "some", "work", "NUMBER", "It", "was", "hard", "for", "me", "to", "tell", "what", "was", "the", "right", "way", "to", "do", "this", "nahi", "thanks", "for", "looking", "at", "this", "NUMBER", "Do", "you", "know", "if", "there", "s", "any", "work", "be", "do", "to", "get", "sqlite", "NUMBER", "work", "on", "jruby", "I", "d", "rather", "not", "have", "this", "in", "CW", "but", "if", "it", "s", "necessary", "NUMBER", "Merged", "thanks", "NUMBER", "should", "have", "this", "you", "can", "also", "pull", "from", "the", "NUMBER", "stable", "branch", "Issue", "NUMBER", "has", "be", "the", "reason", "for", "holding", "back", "a", "gem", "release", "but", "it", "seems", "the", "issue", "surrounding", "it", "has", "be", "around", "for", "awhile", "now", "and", "another", "gem", "release", "isn", "t", "going", "to", "hurt", "anyone", "NUMBER", "I", "ll", "get", "NUMBER", "and", "NUMBER", "out", "in", "the", "next", "few", "days", "NUMBER", "sparkles", "NUMBER", "be", "release", "sparkles", "Wasn", "t", "planning", "on", "it", "NUMBER", "x", "doesn", "t", "officially", "support", "Rails", "NUMBER", "because", "of", "some", "backward", "incompatible", "change", "in", "ActiveSupport", "NUMBER", "NUMBER", "requires", "ActiveSupport", "and", "ActiveModel", "NUMBER", "or", "greater", "so", "cw", "mongoid", "should", "probably", "do", "the", "same", "for", "a", "NUMBER", "release", "NUMBER", "I", "push", "cw", "mongoid", "yesterday", "setting", "the", "dependency", "on", "CarrierWave", "to", "NUMBER", "x", "NUMBER", "Glad", "to", "hear", "you", "re", "going", "to", "tackle", "the", "mongoid", "fix", "There", "s", "a", "page", "in", "the", "wiki", "about", "how", "to", "accomplish", "this", "NUMBER", "Yup", "NUMBER", "On", "Monday", "August", "NUMBER", "NUMBER", "bdclimber", "NUMBER", "TAG", "write", "I", "m", "guessing", "you", "re", "referring", "to", "this", "page", "LINK", "to", "NUMBER", "A", "Create", "random", "and", "unique", "filenames", "for", "all", "version", "file", "I", "edit", "the", "page", "to", "set", "the", "instance", "variable", "name", "instead", "of", "just", "returning", "the", "random", "GUID", "NUMBER", "It", "seems", "to", "work", "now", "NUMBER", "Is", "this", "correct", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "I", "don", "t", "think", "anyone", "with", "commit", "access", "to", "CW", "uses", "Windows", "so", "this", "be", "very", "likely", "something", "that", "a", "new", "contributor", "will", "have", "to", "look", "into", "and", "fix", "NUMBER", "Pull", "request", "be", "definitely", "welcome", "I", "ll", "leave", "this", "open", "for", "a", "while", "but", "if", "nobody", "comes", "around", "to", "offer", "a", "fix", "then", "we", "ll", "have", "to", "relegate", "it", "to", "the", "know", "issue", "page", "in", "the", "wiki", "NUMBER", "I", "think", "use", "this", "be", "recommended", "LINK", "_types", "NUMBER", "rb", "Perhaps", "we", "could", "use", "some", "better", "documentation", "Pull", "request", "welcome", "If", "you", "have", "a", "suggested", "change", "to", "CW", "that", "you", "could", "turn", "into", "a", "pull", "request", "that", "would", "be", "welcome", "NUMBER", "Otherwise", "your", "workaround", "may", "be", "the", "best", "solution", "or", "else", "maybe", "you", "can", "use", "the", "new", "mime_types", "support", "NUMBER", "That", "s", "great", "thanks", "NUMBER", "Please", "add", "a", "how", "to", "to", "the", "wiki", "NUMBER", "Very", "cool", "Perhaps", "the", "problem", "be", "that", "the", "model", "doesn", "t", "have", "an", "id", "when", "you", "store", "the", "file", "NUMBER", "I", "think", "something", "like", "this", "would", "work", "as", "expected", "post", "Post", "NUMBER", "new", "params", "post", "post", "NUMBER", "save", "if", "params", "post", "photos", "NUMBER", "blank", "post", "Post", "NUMBER", "new", "params", "post", "post", "NUMBER", "photo", "File", "NUMBER", "open", "Rails", "NUMBER", "root", "app", "assets", "images", "rails", "NUMBER", "png", "post", "NUMBER", "save", "end", "So", "then", "would", "you", "want", "post_photo", "post", "NUMBER", "photos", "NUMBER", "build", "post_photo", "NUMBER", "photo", "File", "NUMBER", "open", "Rails", "NUMBER", "root", "app", "assets", "images", "rails", "NUMBER", "png", "Yeah", "because", "I", "think", "in", "your", "example", "app", "the", "model", "NUMBER", "id", "wouldn", "t", "be", "set", "until", "you", "call", "save", "so", "store", "would", "have", "be", "before", "that", "right", "geemus", "I", "m", "seeing", "this", "WARN", "Fog", "Storage", "AWS", "Files", "get_url", "be", "deprecate", "use", "get_https_url", "instead", "Users", "trevor", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "file", "NUMBER", "rb", "NUMBER", "in", "TAG", "NUMBER", "when", "run", "the", "test", "with", "the", "latest", "fog", "NUMBER", "Is", "there", "a", "way", "to", "avoid", "the", "deprecation", "warnings", "without", "setting", "a", "minimum", "version", "for", "fog", "Or", "do", "you", "think", "that", "would", "be", "smart", "in", "any", "case", "Yeah", "NUMBER", "OK", "would", "you", "mind", "update", "the", "gemspec", "to", "use", "the", "recommended", "version", "fix", "the", "deprecation", "warnings", "and", "change", "the", "text", "You", "don", "t", "have", "the", "fog", "gem", "install", "in", "fog", "NUMBER", "rb", "to", "suggest", "a", "minimum", "version", "If", "it", "s", "possible", "to", "enforce", "a", "version", "there", "or", "elsewhere", "that", "would", "be", "nice", "NUMBER", "I", "don", "t", "want", "to", "add", "dependency", "in", "the", "gemspec", "because", "you", "should", "be", "able", "to", "sue", "CW", "without", "fog", "but", "maybe", "there", "s", "a", "middle", "ground", "NUMBER", "I", "m", "not", "sure", "if", "there", "s", "a", "best", "way", "to", "do", "that", "NUMBER", "No", "rush", "on", "any", "of", "this", "but", "I", "d", "appreciate", "your", "looking", "if", "you", "have", "time", "Maybe", "worrying", "about", "the", "minimum", "version", "isn", "t", "even", "necessary", "NUMBER", "If", "you", "update", "the", "fog", "provider", "to", "use", "the", "new", "methods", "then", "the", "older", "version", "won", "t", "work", "and", "we", "can", "add", "a", "note", "to", "History", "NUMBER", "txt", "about", "raising", "the", "minimum", "required", "version", "and", "tell", "people", "in", "the", "Google", "Group", "or", "whatever", "NUMBER", "Probably", "not", "a", "big", "deal", "NUMBER", "Ah", "that", "s", "great", "NUMBER", "Let", "s", "just", "call", "this", "issue", "fix", "then", "thanks", "for", "looking", "I", "m", "excited", "to", "see", "that", "EY", "blog", "post", "BTW", "Documentation", "improvement", "be", "most", "welcome", "Please", "consider", "make", "a", "pull", "request", "and", "or", "add", "something", "to", "the", "wiki", "NUMBER", "I", "m", "not", "sure", "what", "you", "re", "talking", "about", "NUMBER", "Can", "you", "create", "a", "fail", "test", "case", "or", "publish", "a", "sample", "application", "demonstrating", "the", "problem", "I", "m", "not", "sure", "what", "you", "mean", "by", "fallback", "image", "do", "you", "mean", "the", "cached", "images", "be", "publicly", "accessible", "The", "part", "in", "the", "read", "me", "that", "says", "Making", "uploads", "work", "across", "form", "redisplays", "or", "so", "Perhaps", "you", "need", "to", "set", "the", "cache_dir", "to", "something", "public", "Ah", "thanks", "bensie", "OK", "we", "ll", "have", "a", "look", "when", "the", "release", "be", "finalized", "and", "fix", "things", "up", "NUMBER", "fuksito", "please", "do", "provide", "a", "sample", "app", "if", "you", "have", "time", "NUMBER", "Sorry", "but", "I", "haven", "t", "had", "a", "chance", "to", "play", "with", "Rails", "NUMBER", "CarrierWave", "yet", "so", "I", "m", "no", "help", "NUMBER", "Awesome", "Seems", "like", "you", "re", "onto", "something", "Any", "chance", "you", "could", "try", "to", "work", "up", "a", "fail", "test", "case", "and", "pull", "request", "to", "fix", "it", "I", "m", "not", "sure", "about", "the", "name", "but", "the", "last", "idea", "sounds", "best", "to", "me", "so", "far", "NUMBER", "Thanks", "for", "giving", "this", "so", "much", "attention", "NUMBER", "I", "really", "do", "appreciate", "the", "contribution", "and", "I", "hope", "you", "re", "able", "to", "come", "up", "with", "something", "you", "like", "NUMBER", "I", "m", "not", "sure", "the", "config", "option", "be", "necessary", "NUMBER", "I", "can", "t", "see", "a", "reason", "this", "would", "be", "a", "problem", "NUMBER", "Maybe", "bensie", "has", "an", "idea", "Should", "that", "NUMBER", "be", "a", "_", "instead", "I", "thought", "someone", "submitted", "a", "pull", "request", "to", "change", "the", "default", "as", "you", "re", "describing", "but", "I", "took", "a", "quick", "look", "and", "couldn", "t", "find", "it", "NUMBER", "Maybe", "you", "can", "dig", "around", "a", "bit", "and", "do", "better", "NUMBER", "Also", "we", "have", "the", "new", "remove_previously_stored_files_after_update", "option", "that", "defaults", "to", "true", "NUMBER", "Maybe", "that", "s", "part", "or", "all", "of", "the", "problem", "I", "lean", "toward", "having", "the", "default", "be", "as", "you", "ve", "unhappily", "experienced", "NUMBER", "But", "let", "s", "not", "argue", "about", "it", "I", "m", "hoping", "to", "move", "mongoid", "stuff", "here", "shortly", "LINK", "so", "you", "can", "have", "the", "conversation", "over", "there", "eventually", "NUMBER", "Perhaps", "we", "need", "to", "make", "the", "change", "more", "clear", "in", "the", "History", "NUMBER", "txt", "file", "though", "NUMBER", "I", "don", "t", "want", "anyone", "else", "get", "bitten", "by", "this", "so", "if", "you", "can", "hunt", "around", "and", "let", "me", "know", "what", "you", "find", "I", "d", "really", "appreciate", "it", "NUMBER", "Thank", "you", "OK", "that", "config", "option", "be", "documented", "well", "enough", "I", "think", "NUMBER", "If", "you", "want", "to", "submit", "a", "pull", "request", "that", "improves", "things", "please", "do", "Thanks", "for", "checking", "into", "this", "and", "get", "back", "to", "us", "NUMBER", "Can", "you", "provide", "a", "small", "sample", "app", "or", "something", "Is", "this", "an", "old", "Rails", "version", "Maybe", "it", "doesn", "t", "support", "the", "dirty", "track", "features", "we", "assume", "to", "be", "present", "CarrierWave", "be", "now", "Rails", "NUMBER", "only", "NUMBER", "Thanks", "for", "the", "info", "NUMBER", "I", "m", "sorry", "to", "say", "but", "I", "haven", "t", "heard", "of", "this", "issue", "before", "so", "you", "may", "be", "the", "only", "person", "experience", "it", "NUMBER", "That", "means", "you", "may", "have", "to", "take", "it", "upon", "yourself", "to", "try", "and", "fix", "it", "if", "you", "have", "the", "time", "and", "ability", "NUMBER", "I", "ll", "leave", "this", "issue", "open", "for", "now", "but", "if", "you", "or", "someone", "else", "doesn", "t", "find", "a", "resolution", "we", "ll", "document", "the", "problem", "in", "the", "know", "issue", "wiki", "page", "and", "leave", "it", "at", "that", "NUMBER", "I", "m", "sorry", "for", "the", "problem", "NUMBER", "Good", "luck", "I", "m", "going", "to", "close", "this", "for", "now", "NUMBER", "Feel", "free", "to", "add", "an", "entry", "to", "the", "know", "issue", "wiki", "page", "and", "or", "call", "for", "help", "on", "the", "Google", "Group", "NUMBER", "Closing", "in", "favor", "of", "NUMBER", "sorry", "about", "the", "confusion", "with", "carrier", "wave", "and", "mongoid", "and", "thanks", "for", "your", "contribution", "NUMBER", "Once", "we", "sort", "things", "out", "please", "direct", "pull", "request", "to", "the", "carrierwave", "mongoid", "gem", "where", "possible", "NUMBER", "Thanks", "This", "has", "be", "discussed", "here", "LINK", "See", "the", "other", "open", "issue", "too", "we", "re", "planning", "to", "extract", "mongoid", "support", "into", "a", "separate", "gem", "sometime", "soon", "NUMBER", "See", "also", "LINK", "mongoid", "pull", "NUMBER", "I", "don", "t", "think", "we", "support", "MongoMapper", "anymore", "NUMBER", "Maybe", "there", "s", "a", "gem", "already", "check", "the", "wiki", "if", "not", "please", "feel", "free", "to", "make", "one", "and", "reference", "it", "from", "the", "wiki", "NUMBER", "Cool", "idea", "consider", "starting", "a", "discussion", "about", "it", "on", "the", "Google", "Group", "NUMBER", "If", "you", "can", "take", "the", "time", "to", "work", "on", "it", "we", "d", "welcome", "the", "contribution", "XMLHttpRequest", "do", "not", "allow", "file", "uploads", "NUMBER", "There", "be", "a", "number", "of", "workarounds", "for", "uploading", "file", "via", "AJAX", "but", "by", "default", "Rails", "falls", "back", "to", "a", "standard", "POST", "request", "NUMBER", "That", "s", "outside", "the", "scope", "of", "what", "Carrierwave", "do", "check", "out", "plupload", "uploadify", "or", "search", "for", "other", "AJAX", "file", "upload", "javascript", "libraries", "NUMBER", "It", "s", "a", "frontend", "browser", "issue", "not", "something", "that", "can", "be", "implement", "in", "the", "Ruby", "library", "NUMBER", "Check", "out", "Uploadify", "Plupload", "and", "other", "client", "side", "libs", "that", "support", "AJAX", "file", "uploads", "NUMBER", "I", "would", "highly", "recommend", "MiniMagick", "over", "ImageScience", "especially", "if", "you", "re", "going", "to", "Ruby", "NUMBER", "anytime", "soon", "NUMBER", "ImageScience", "doesn", "t", "run", "on", "NUMBER", "and", "be", "no", "longer", "actively", "maintained", "NUMBER", "We", "ll", "welcome", "any", "pull", "request", "to", "fix", "the", "issue", "but", "I", "m", "personally", "not", "inclined", "to", "fight", "with", "ImageScience", "NUMBER", "Thanks", "This", "looks", "good", "though", "I", "don", "t", "like", "to", "encourage", "the", "use", "of", "methods", "like", "convert", "png", "false", "NUMBER", "Would", "you", "mind", "reworking", "to", "have", "the", "convert", "method", "take", "an", "options", "hash", "as", "its", "second", "argument", "Also", "might", "you", "be", "up", "for", "tackling", "a", "test", "here", "LINK", "_spec", "NUMBER", "rb", "L", "NUMBER", "After", "test", "this", "locally", "I", "see", "it", "breaks", "a", "few", "specs", "because", "of", "undefined", "local", "variable", "or", "method", "current_path", "Feel", "free", "to", "submit", "a", "new", "pull", "request", "that", "fix", "this", "and", "make", "sure", "you", "run", "the", "specs", "and", "add", "any", "relevant", "test", "for", "the", "change", "you", "make", "Thanks", "As", "an", "avid", "user", "of", "MiniMagick", "I", "agree", "NUMBER", "Thanks", "NUMBER", "OK", "I", "m", "going", "to", "close", "this", "for", "now", "then", "NUMBER", "Both", "Trevor", "and", "I", "asked", "for", "a", "sample", "app", "because", "we", "couldn", "t", "reproduce", "NUMBER", "Time", "went", "by", "you", "didn", "t", "send", "anything", "so", "the", "issue", "was", "close", "NUMBER", "We", "don", "t", "leave", "issue", "open", "forever", "when", "they", "re", "waiting", "on", "more", "info", "NUMBER", "When", "you", "can", "send", "a", "sample", "app", "that", "demonstrates", "the", "issue", "open", "another", "issue", "and", "reference", "this", "one", "NUMBER", "We", "ll", "get", "to", "it", "NUMBER", "Closed", "just", "means", "off", "our", "radar", "as", "something", "actionable", "until", "something", "change", "it", "s", "not", "delete", "NUMBER", "It", "can", "be", "reopened", "at", "any", "time", "if", "the", "conversation", "continues", "and", "we", "still", "get", "notifications", "when", "update", "come", "in", "NUMBER", "trevorturk", "keep", "the", "v", "larskuhnt", "be", "correct", "that", "use", "event", "NUMBER", "remove_image", "true", "followed", "by", "a", "save", "should", "do", "more", "of", "what", "you", "re", "expecting", "NUMBER", "I", "m", "still", "trying", "to", "figure", "out", "why", "there", "be", "a", "bunch", "of", "similarly", "named", "remove", "methods", "that", "seem", "to", "do", "very", "different", "things", "NUMBER", "bcardarella", "Thanks", "for", "posting", "your", "code", "and", "specs", "NUMBER", "Haha", "yeah", "I", "d", "have", "to", "agree", "with", "you", "there", "NUMBER", "There", "be", "definitely", "issue", "surrounding", "remove", "images", "and", "I", "d", "like", "to", "get", "these", "fix", "before", "the", "next", "release", "NUMBER", "Would", "really", "appreciate", "any", "pull", "request", "to", "help", "get", "this", "fix", "I", "probably", "won", "t", "be", "able", "to", "get", "to", "it", "for", "a", "few", "weeks", "NUMBER", "Closing", "in", "favor", "of", "NUMBER", "please", "give", "it", "a", "try", "Thanks", "chopmo", "Can", "you", "resubmit", "this", "patch", "to", "work", "for", "current", "and", "future", "version", "of", "Mongoid", "We", "can", "t", "merge", "this", "knowing", "it", "causes", "specs", "to", "fail", "and", "will", "break", "exist", "applications", "NUMBER", "config", "NUMBER", "load_paths", "be", "remove", "in", "Rails", "NUMBER", "In", "config", "application", "NUMBER", "rb", "try", "ruby", "config", "NUMBER", "autoload_paths", "Rails", "NUMBER", "root", "app", "uploaders", "That", "said", "this", "shouldn", "t", "be", "necessary", "I", "have", "several", "apps", "work", "without", "autoloading", "uploaders", "NUMBER", "I", "d", "still", "like", "to", "see", "a", "sample", "app", "autoloading", "shouldn", "t", "be", "needed", "NUMBER", "I", "just", "tried", "out", "trbartel", "s", "app", "and", "had", "no", "problem", "get", "it", "run", "after", "change", "the", "following", "You", "need", "to", "specify", "that", "it", "s", "a", "multipart", "form", "in", "app", "views", "users", "new", "NUMBER", "html", "NUMBER", "haml", "haml", "form_for", "user", "html", "multipart", "true", "do", "f", "There", "s", "a", "typo", "in", "your", "User", "model", "that", "s", "make", "image", "not", "an", "accessible", "attribute", "via", "mass", "assignment", "NUMBER", "make", "sure", "there", "s", "a", "comma", "at", "the", "end", "of", "this", "line", "LINK", "_app", "blob", "master", "app", "models", "user", "NUMBER", "rb", "L", "NUMBER", "You", "also", "have", "a", "duplicate", "migration", "file", "that", "I", "had", "to", "delete", "the", "last", "one", "LINK", "_app", "tree", "master", "db", "migrate", "In", "case", "it", "wasn", "t", "clear", "nowhere", "along", "the", "way", "did", "I", "get", "an", "uninitialized", "constant", "User", "ImageUploader", "error", "and", "I", "had", "the", "config", "NUMBER", "autoload_paths", "declaration", "remove", "the", "entire", "time", "NUMBER", "All", "good", "here", "turned", "out", "to", "be", "an", "issue", "unrelated", "to", "CW", "NUMBER", "Let", "us", "know", "if", "any", "of", "you", "find", "specific", "cases", "that", "cause", "this", "to", "happen", "NUMBER", "Thanks", "Yes", "you", "re", "right", "I", "did", "add", "a", "dependency", "on", "ActiveSupport", "Deprecation", "and", "forgot", "the", "require", "NUMBER", "This", "was", "the", "best", "that", "I", "could", "come", "up", "with", "without", "the", "silence", "this", "warning", "will", "be", "raise", "any", "time", "class_inheritable_accessor", "be", "call", "run", "the", "test", "or", "in", "logs", "when", "use", "ActiveSupport", "NUMBER", "x", "NUMBER", "class_attribute", "will", "be", "use", "whenever", "class_inheritable_accessor", "isn", "t", "available", "but", "we", "can", "t", "depend", "on", "class_attribute", "having", "the", "needed", "instance_reader", "false", "option", "until", "AS", "NUMBER", "yet", "to", "be", "release", "NUMBER", "rc", "NUMBER", "yet", "to", "be", "release", "NUMBER", "and", "beyond", "this", "commit", "was", "applied", "to", "master", "NUMBER", "NUMBER", "stable", "and", "NUMBER", "NUMBER", "stable", "LINK", "I", "was", "aiming", "to", "eliminate", "deprecation", "warnings", "given", "that", "the", "issue", "be", "fix", "NUMBER", "Thoughts", "Confirmed", "LINK", "I", "m", "having", "trouble", "understanding", "what", "this", "fix", "NUMBER", "You", "said", "When", "use", "normal", "callback", "definitions", "the", "nil", "returned", "by", "store", "did", "not", "halt", "the", "chain", "Under", "what", "circumstance", "did", "it", "halt", "the", "chain", "Can", "you", "provide", "some", "sample", "code", "from", "your", "application", "to", "help", "me", "understand", "the", "use", "case", "Returning", "true", "from", "that", "method", "if", "the", "uploader", "be", "blank", "seems", "counter", "intuitive", "to", "me", "and", "without", "any", "comments", "or", "test", "the", "intent", "be", "unclear", "but", "maybe", "further", "explanation", "can", "clear", "this", "up", "NUMBER", "I", "ve", "be", "unable", "to", "reproduce", "this", "can", "you", "push", "a", "sample", "application", "to", "GitHub", "that", "contains", "the", "issue", "Closing", "for", "now", "pending", "further", "activity", "NUMBER", "This", "commit", "bdc", "NUMBER", "e", "NUMBER", "a", "NUMBER", "e", "NUMBER", "b", "NUMBER", "a", "NUMBER", "fb", "NUMBER", "e", "NUMBER", "d", "NUMBER", "fe", "NUMBER", "add", "this", "NUMBER", "A", "fail", "test", "would", "be", "most", "welcome", "skyeagle", "Can", "you", "chime", "in", "on", "this", "issue", "ches", "please", "do", "take", "up", "the", "issue", "in", "the", "carrierwave", "mongoid", "repo", "NUMBER", "I", "don", "t", "have", "a", "strong", "opinion", "as", "I", "don", "t", "use", "Mongoid", "much", "NUMBER", "Thanks", "for", "test", "this", "stuff", "out", "NUMBER", "I", "ll", "try", "to", "review", "and", "merge", "in", "the", "change", "soon", "NUMBER", "clyfe", "Were", "you", "able", "to", "come", "up", "with", "a", "test", "case", "for", "a", "situation", "where", "MIME", "Types", "NUMBER", "of", "File", "NUMBER", "basename", "cache_path", "NUMBER", "NUMBER", "present", "evaluates", "false", "I", "revert", "the", "offending", "commit", "sorry", "about", "that", "since", "we", "can", "use", "CarrierWave", "MimeTypes", "now", "LINK", "_types", "NUMBER", "rb", "if", "we", "care", "about", "having", "the", "cached", "and", "then", "remote", "uploaded", "file", "get", "a", "content_type", "NUMBER", "iwasrobbed", "Can", "you", "post", "your", "uploader", "code", "so", "we", "can", "see", "a", "case", "where", "this", "happens", "Does", "it", "only", "happen", "when", "replacing", "an", "old", "image", "with", "a", "new", "one", "Or", "on", "new", "records", "as", "well", "It", "s", "alright", "I", "ll", "take", "care", "of", "squashing", "this", "time", "NUMBER", "Squashed", "and", "commit", "here", "NUMBER", "f", "NUMBER", "ce", "NUMBER", "b", "NUMBER", "d", "NUMBER", "db", "NUMBER", "c", "NUMBER", "e", "NUMBER", "ec", "NUMBER", "b", "NUMBER", "ac", "NUMBER", "c", "Sounds", "good", "to", "me", "the", "only", "one", "that", "be", "up", "in", "the", "air", "be", "NUMBER", "but", "I", "m", "pretty", "sure", "this", "be", "fix", "in", "master", "NUMBER", "Hoping", "he", "ll", "report", "back", "soon", "NUMBER", "did", "nothing", "too", "crazy", "git", "merge", "did", "mongoid", "squash", "git", "commit", "m", "Commit", "message", "author", "your", "email", "NUMBER", "com", "jcarlson", "Were", "you", "able", "to", "update", "to", "master", "and", "test", "this", "We", "d", "like", "to", "get", "a", "release", "out", "but", "would", "like", "to", "get", "confirmation", "that", "this", "issue", "was", "fix", "NUMBER", "Thanks", "Can", "you", "test", "with", "the", "latest", "master", "on", "the", "off", "chance", "that", "NUMBER", "impacts", "this", "Yeah", "this", "be", "still", "a", "problem", "NUMBER", "I", "made", "an", "example", "app", "LINK", "issue", "NUMBER", "I", "m", "going", "to", "try", "and", "work", "up", "a", "fail", "test", "and", "investigate", "from", "there", "NUMBER", "Any", "help", "would", "be", "much", "appreciated", "OK", "I", "think", "the", "problem", "be", "that", "your", "uploader", "code", "was", "bad", "NUMBER", "I", "ve", "update", "the", "example", "repo", "above", "and", "things", "seem", "to", "work", "correctly", "now", "NUMBER", "Please", "confirm", "and", "let", "me", "know", "what", "you", "think", "NUMBER", "Can", "you", "rebase", "and", "squash", "this", "to", "a", "single", "patch", "I", "m", "interested", "to", "know", "any", "issue", "you", "re", "having", "with", "HEAD", "NUMBER", "Will", "wait", "to", "merge", "until", "you", "try", "this", "with", "a", "real", "app", "NUMBER", "Cool", "merge", "Soon", "Just", "waiting", "to", "hear", "confirmation", "that", "the", "last", "blocking", "issue", "was", "successfully", "fix", "NUMBER", "The", "last", "blocking", "issue", "if", "you", "re", "wondering", "LINK", "The", "readme", "include", "instructions", "on", "how", "to", "handle", "this", "ruby", "class", "AvatarUploader", "TAG", "NUMBER", "NUMBER", "process", "convert", "png", "def", "filename", "super", "NUMBER", "chomp", "File", "NUMBER", "extname", "super", "NUMBER", "png", "end", "end", "If", "you", "can", "take", "the", "time", "to", "work", "up", "a", "pull", "request", "to", "get", "this", "feature", "add", "we", "ll", "gladly", "merge", "it", "NUMBER", "Thanks", "Yes", "you", "can", "override", "this", "if", "you", "d", "like", "to", "change", "the", "generate", "filename", "NUMBER", "This", "be", "a", "question", "for", "the", "Google", "Group", "LINK", "When", "posting", "there", "I", "d", "recommend", "including", "your", "model", "uploader", "code", "and", "version", "info", "for", "everything", "your", "use", "NUMBER", "omargallob", "Please", "post", "this", "and", "other", "application", "specific", "question", "to", "the", "Google", "Group", "LINK", "The", "issue", "here", "be", "for", "reproducible", "bug", "NUMBER", "You", "ll", "also", "want", "to", "include", "code", "snippets", "from", "your", "app", "so", "we", "can", "better", "help", "you", "not", "enough", "info", "here", "NUMBER", "Just", "so", "I", "m", "not", "miss", "something", "here", "be", "you", "having", "trouble", "with", "dev", "test", "or", "production", "I", "don", "t", "see", "a", "config", "NUMBER", "orage", "fog", "in", "the", "else", "of", "your", "Carrierwave", "NUMBER", "configure", "block", "NUMBER", "Merged", "thanks", "I", "ve", "revert", "this", "commit", "appears", "it", "did", "in", "fact", "break", "a", "few", "exist", "specs", "NUMBER", "Feel", "free", "to", "open", "another", "pull", "request", "if", "you", "want", "to", "take", "another", "crack", "at", "it", "NUMBER", "Fair", "enough", "be", "you", "up", "for", "reworking", "the", "fix", "Don", "t", "want", "to", "apply", "fail", "specs", "to", "master", "without", "a", "patch", "NUMBER", "Adding", "fail", "specs", "makes", "things", "much", "more", "difficult", "for", "people", "who", "be", "cloning", "the", "repository", "and", "get", "start", "on", "a", "fix", "feature", "of", "their", "own", "everyone", "should", "start", "with", "a", "clean", "slate", "NUMBER", "IMO", "fail", "specs", "without", "a", "fix", "belong", "in", "a", "topic", "branch", "NUMBER", "The", "markdown", "Readme", "file", "should", "still", "work", "in", "s", "NUMBER", "extra_rdoc_files", "README", "NUMBER", "md", "Any", "reason", "you", "took", "that", "out", "Merged", "thanks", "In", "the", "first", "commit", "you", "have", "a", "spec", "for", "returns", "nil", "if", "content_type", "has", "not", "be", "update", "why", "wouldn", "t", "we", "always", "set", "an", "original_content_type", "Whether", "or", "not", "it", "gets", "update", "original_content_type", "by", "definition", "be", "whatever", "was", "there", "at", "the", "beginning", "NUMBER", "I", "m", "definitely", "on", "board", "with", "merge", "this", "first", "commit", "but", "just", "wanted", "to", "gather", "additional", "thoughts", "on", "this", "piece", "of", "it", "NUMBER", "I", "like", "the", "idea", "but", "don", "t", "think", "CarrierWave", "MimeTypes", "makes", "sense", "as", "a", "processor", "NUMBER", "Processors", "manipulate", "images", "whereas", "MIME", "Types", "just", "do", "some", "work", "based", "on", "reading", "the", "file", "name", "NUMBER", "Would", "make", "documentation", "for", "processors", "inconsistent", "NUMBER", "I", "ve", "add", "a", "commit", "f", "NUMBER", "de", "NUMBER", "af", "NUMBER", "a", "NUMBER", "fc", "NUMBER", "b", "NUMBER", "bb", "NUMBER", "f", "NUMBER", "abd", "to", "allow", "overriding", "the", "content_type", "without", "the", "need", "for", "metaprogramming", "NUMBER", "Even", "though", "it", "s", "a", "simple", "attr_writer", "method", "it", "s", "fully", "defined", "for", "clarity", "NUMBER", "Thinking", "about", "it", "more", "I", "don", "t", "really", "care", "what", "the", "original", "content", "type", "was", "if", "I", "m", "forcing", "a", "change", "so", "I", "m", "not", "sure", "the", "original_content_type", "code", "be", "even", "necessary", "NUMBER", "We", "ll", "let", "jnicklas", "weigh", "in", "on", "add", "different", "processor", "types", "to", "core", "NUMBER", "I", "think", "that", "while", "processors", "could", "mean", "anything", "to", "do", "with", "file", "it", "currently", "only", "means", "image", "manipulation", "in", "Carrierwave", "NUMBER", "Yeah", "go", "ahead", "and", "make", "up", "a", "new", "pull", "request", "for", "the", "MIME", "Types", "stuff", "and", "we", "ll", "get", "it", "merge", "NUMBER", "Thanks", "Interesting", "NUMBER", "I", "m", "seeing", "the", "same", "thing", "NUMBER", "folder", "for", "each", "assertion", "that", "involves", "setting", "a", "CW", "attribute", "NUMBER", "I", "ve", "seen", "both", "in", "my", "app", "NUMBER", "photos", "and", "NUMBER", "public", "photos", "my", "upload", "folder", "be", "call", "photos", "annoying", "and", "I", "have", "no", "idea", "what", "cause", "it", "Trying", "to", "get", "this", "fix", "can", "you", "guys", "paste", "some", "code", "so", "I", "have", "details", "of", "how", "you", "re", "test", "your", "CW", "uploads", "JangoSteve", "Do", "you", "have", "any", "test", "in", "your", "app", "that", "test", "uploading", "file", "with", "CW", "Looking", "for", "the", "test", "themselves", "NUMBER", "Thanks", "guys", "I", "really", "just", "wanted", "to", "make", "sure", "it", "happens", "in", "all", "cases", "and", "not", "something", "very", "specific", "NUMBER", "This", "be", "a", "tough", "one", "to", "track", "down", "NUMBER", "No", "update", "yet", "NUMBER", "patches", "or", "ideas", "be", "welcome", "if", "you", "have", "any", "clues", "to", "the", "cause", "NUMBER", "Can", "you", "come", "up", "with", "a", "pull", "request", "preferably", "with", "test", "demonstrating", "what", "that", "fix", "Seems", "like", "an", "odd", "fix", "to", "me", "NUMBER", "Sadly", "yes", "it", "be", "NUMBER", "Please", "post", "specific", "problem", "you", "re", "having", "in", "your", "app", "on", "the", "Google", "Group", "LINK", "This", "appeases", "the", "test", "but", "didn", "t", "fix", "the", "in", "place", "modification", "of", "version_names", "NUMBER", "I", "ve", "push", "a", "fix", "here", "NUMBER", "df", "NUMBER", "a", "NUMBER", "edadf", "NUMBER", "dcbec", "NUMBER", "c", "NUMBER", "d", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "c", "We", "d", "welcome", "a", "patch", "if", "you", "d", "like", "to", "tackle", "this", "as", "long", "as", "it", "doesn", "t", "change", "exist", "naming", "conventions", "NUMBER", "You", "could", "also", "write", "up", "a", "Wiki", "article", "showing", "how", "you", "re", "handle", "the", "override", "NUMBER", "Although", "you", "can", "override", "filename", "within", "a", "version", "block", "it", "doesn", "t", "mean", "you", "should", "NUMBER", "Looks", "good", "and", "works", "well", "NUMBER", "Thanks", "FYI", "I", "just", "push", "NUMBER", "b", "NUMBER", "af", "NUMBER", "cffd", "NUMBER", "c", "NUMBER", "a", "NUMBER", "c", "NUMBER", "a", "short", "while", "ago", "which", "combines", "the", "NUMBER", "config", "options", "into", "the", "single", "delete_tmp_file_after_storage", "option", "NUMBER", "chrisbloom", "NUMBER", "NUMBER", "include", "NUMBER", "which", "should", "fix", "your", "issue", "NUMBER", "If", "it", "doesn", "t", "please", "open", "a", "new", "issue", "with", "details", "NUMBER", "Yeah", "this", "one", "be", "no", "fun", "class_attribute", "be", "definitely", "not", "a", "drop", "in", "replacement", "for", "class_inheritable_accessor", "Yep", "I", "m", "on", "it", "NUMBER", "I", "need", "another", "set", "of", "eyes", "on", "this", "NUMBER", "I", "made", "a", "gist", "of", "a", "stripped", "down", "version", "of", "what", "carrierwave", "be", "doing", "and", "it", "works", "as", "expected", "given", "instructions", "from", "josevalim", "NUMBER", "Plug", "this", "into", "processing", "NUMBER", "rb", "I", "get", "the", "same", "issue", "as", "slbug", "NUMBER", "LINK", "slbug", "I", "m", "get", "your", "expected", "behavior", "in", "LINK", "but", "the", "processors", "array", "be", "empty", "on", "an", "uploader", "class", "when", "dropping", "into", "Carrierwave", "and", "run", "test", "NUMBER", "Can", "you", "create", "a", "pull", "request", "and", "we", "ll", "get", "it", "merge", "That", "s", "fine", "take", "your", "time", "NUMBER", "Just", "want", "to", "make", "sure", "you", "submit", "the", "final", "patch", "via", "pull", "request", "not", "a", "diff", "NUMBER", "I", "ve", "push", "your", "progress", "so", "far", "with", "storage", "and", "processors", "NUMBER", "fbe", "NUMBER", "b", "NUMBER", "bec", "NUMBER", "b", "NUMBER", "bc", "NUMBER", "ea", "NUMBER", "fc", "NUMBER", "f", "NUMBER", "ec", "and", "a", "NUMBER", "b", "NUMBER", "b", "NUMBER", "a", "NUMBER", "b", "NUMBER", "daa", "NUMBER", "da", "NUMBER", "e", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "NUMBER", "If", "someone", "doesn", "t", "get", "to", "fix", "version", "in", "the", "next", "few", "days", "we", "d", "welcome", "another", "patch", "I", "have", "to", "defer", "to", "the", "experts", "on", "this", "one", "can", "t", "get", "class_attribute", "version", "work", "NUMBER", "Got", "this", "far", "trying", "to", "follow", "instructions", "from", "josevalim", "when", "it", "comes", "to", "in", "place", "modification", "but", "there", "be", "still", "about", "NUMBER", "test", "fail", "with", "this", "LINK", "josevalim", "Is", "there", "any", "way", "that", "I", "can", "override", "an", "instance", "reader", "with", "class_attribute", "while", "also", "extending", "ActiveSupport", "Concern", "LINK", "The", "wall", "I", "m", "hitting", "be", "that", "class_inheritable_accessor", "allow", "disabling", "the", "instance", "reader", "in", "addition", "to", "the", "writer", "and", "it", "looks", "like", "the", "order", "that", "ActiveSupport", "Concern", "do", "the", "mixing", "in", "be", "add", "the", "class_attribute", "after", "the", "ClassMethod", "and", "InstanceMethod", "definitions", "NUMBER", "I", "submitted", "a", "Rails", "pull", "request", "to", "hopefully", "get", "this", "fix", "LINK", "Closed", "by", "NUMBER", "e", "NUMBER", "a", "NUMBER", "fbd", "NUMBER", "e", "NUMBER", "ddc", "NUMBER", "ba", "NUMBER", "dc", "NUMBER", "a", "NUMBER", "caa", "NUMBER", "e", "NUMBER", "b", "yay", "Thanks", "to", "josevalim", "for", "accepting", "the", "Rails", "patch", "NUMBER", "Yes", "this", "has", "be", "discussed", "before", "NUMBER", "My", "concern", "be", "that", "we", "don", "t", "actually", "know", "what", "the", "cached", "directory", "was", "when", "the", "cache", "file", "was", "created", "since", "the", "user", "can", "override", "it", "to", "whatever", "they", "want", "and", "we", "risk", "deleting", "directories", "which", "we", "might", "not", "actually", "want", "to", "delete", "or", "change", "the", "permissions", "of", "that", "directory", "behind", "the", "user", "s", "back", "NUMBER", "It", "s", "one", "of", "these", "issue", "that", "comes", "up", "again", "and", "again", "yet", "no", "one", "wants", "to", "submit", "an", "actually", "work", "solution", "NUMBER", "Deleting", "the", "cache", "directories", "be", "stupidly", "simple", "in", "your", "own", "application", "but", "since", "we", "don", "t", "know", "_anything_", "about", "how", "your", "app", "works", "in", "CarrierWave", "it", "s", "nearly", "impossible", "for", "us", "to", "solve", "NUMBER", "If", "you", "can", "come", "up", "with", "something", "then", "please", "submit", "a", "pull", "request", "meanwhile", "I", "m", "with", "Trevor", "that", "there", "be", "no", "point", "in", "just", "letting", "issue", "lie", "around", "for", "years", "with", "no", "activity", "NUMBER", "This", "be", "the", "problem", "def", "cache_dir", "I", "can", "change", "this", "to", "whatever", "I", "want", "end", "People", "can", "put", "these", "cached", "file", "_anywhere_", "and", "if", "we", "just", "randomly", "start", "deleting", "directories", "well", "that", "s", "no", "good", "NUMBER", "ened", "that", "sounds", "sensible", "actually", "NUMBER", "Can", "t", "remember", "off", "the", "bat", "how", "this", "all", "fits", "together", "but", "I", "think", "CW", "creates", "subdriectories", "within", "the", "cache_dir", "but", "I", "m", "not", "quite", "sure", "NUMBER", "Just", "dug", "through", "it", "looks", "great", "NUMBER", "Testing", "now", "and", "will", "merge", "in", "a", "bit", "NUMBER", "I", "ve", "tried", "a", "few", "things", "to", "get", "this", "work", "unfortunately", "I", "don", "t", "have", "an", "answer", "NUMBER", "You", "ll", "probably", "need", "to", "override", "to_xml", "so", "the", "mounted", "column", "gets", "skipped", "NUMBER", "We", "would", "welcome", "a", "patch", "if", "you", "have", "any", "ideas", "trevorturk", "would", "you", "mind", "reviewing", "the", "above", "patch", "before", "I", "merge", "it", "It", "disables", "uploader", "columns", "in", "serialization", "hashes", "and", "assumes", "that", "if", "you", "want", "to", "include", "something", "about", "uploader", "columns", "in", "your", "models", "you", "need", "to", "override", "the", "method", "NUMBER", "Ok", "I", "ll", "go", "back", "to", "the", "drawing", "board", "NUMBER", "I", "agree", "that", "there", "must", "be", "a", "better", "way", "just", "not", "sure", "what", "it", "be", "ideas", "bensie", "I", "played", "around", "with", "a", "few", "things", "today", "but", "didn", "t", "quite", "get", "it", "NUMBER", "yet", "NUMBER", "LINK", "Basically", "it", "looks", "like", "the", "as_json", "stuff", "be", "work", "for", "to_json", "but", "I", "can", "t", "find", "an", "as_xml", "for", "to_xml", "if", "you", "know", "what", "I", "mean", "NUMBER", "So", "maybe", "we", "ll", "have", "to", "just", "remove", "the", "uploaders", "from", "the", "to_xml", "output", "as", "you", "suggested", "but", "this", "proc", "feature", "seems", "like", "a", "potential", "solution", "to", "get", "the", "xml", "output", "matching", "the", "json", "output", "NUMBER", "Maybe", "we", "could", "use", "serializable_hash", "somehow", "I", "m", "not", "sure", "what", "that", "s", "for", "NUMBER", "Anyway", "I", "think", "this", "be", "a", "solvable", "thing", "and", "we", "may", "be", "get", "closer", "NUMBER", "If", "anyone", "else", "be", "reading", "this", "suggestions", "be", "more", "than", "welcome", "Sorry", "this", "be", "the", "best", "I", "could", "come", "up", "with", "I", "m", "going", "to", "post", "a", "call", "for", "help", "to", "the", "Google", "Group", "maybe", "someone", "knows", "how", "to", "fix", "this", "issue", "properly", "NUMBER", "scottwb", "looks", "better", "than", "nil", "to", "me", "NUMBER", "Wanna", "work", "up", "a", "pull", "request", "and", "fix", "the", "test", "I", "think", "we", "could", "get", "rid", "of", "the", "fixme", "comments", "honestly", "NUMBER", "If", "it", "works", "it", "works", "I", "saw", "some", "weird", "edge", "cases", "with", "caching", "memoization", "in", "place", "NUMBER", "If", "you", "guys", "can", "solve", "those", "then", "I", "m", "all", "for", "it", "but", "I", "m", "not", "too", "worried", "about", "the", "performance", "implications", "of", "this", "NUMBER", "I", "think", "this", "be", "quite", "an", "uncommon", "use", "case", "NUMBER", "You", "would", "still", "be", "able", "to", "do", "this", "through", "a", "callback", "or", "something", "but", "I", "m", "not", "sure", "it", "should", "be", "support", "out", "of", "the", "box", "NUMBER", "As", "Trevor", "said", "most", "likely", "your", "entire", "app", "should", "be", "run", "as", "the", "same", "user", "NUMBER", "If", "you", "re", "storing", "your", "images", "outside", "the", "public", "directory", "they", "will", "not", "be", "accessible", "without", "some", "additional", "work", "NUMBER", "That", "be", "after", "all", "the", "point", "of", "not", "storing", "them", "in", "the", "public", "directory", "no", "You", "ll", "need", "to", "set", "your", "application", "up", "to", "serve", "file", "from", "wherever", "you", "re", "storing", "them", "and", "then", "generate", "a", "proper", "ID", "there", "NUMBER", "Search", "the", "mailing", "list", "archives", "and", "try", "to", "figure", "this", "out", "on", "your", "own", "NUMBER", "If", "you", "re", "stuck", "ask", "for", "help", "on", "the", "list", "NUMBER", "No", "it", "s", "not", "a", "problem", "with", "CarrierWave", "you", "re", "just", "not", "understanding", "how", "this", "works", "NUMBER", "Your", "web", "server", "can", "t", "serve", "file", "from", "whatever", "location", "on", "your", "hard", "drive", "that", "would", "be", "a", "huge", "security", "hole", "NUMBER", "Feel", "free", "to", "continue", "this", "discussion", "on", "the", "Google", "Group", "NUMBER", "I", "m", "sure", "this", "would", "be", "a", "welcome", "addition", "to", "New", "Relic", "but", "isn", "t", "an", "outstanding", "issue", "with", "Carrierwave", "NUMBER", "jnicklas", "verdict", "on", "this", "I", "agree", "with", "trevorturk", "that", "this", "belongs", "in", "the", "wiki", "NUMBER", "If", "it", "were", "up", "to", "me", "each", "of", "those", "would", "be", "remove", "except", "for", "the", "Rails", "railtie", "NUMBER", "Yes", "there", "s", "some", "old", "code", "in", "there", "that", "handles", "Merb", "that", "Merb", "stuff", "be", "from", "mid", "NUMBER", "that", "doesn", "t", "mean", "the", "design", "going", "forward", "be", "to", "add", "support", "for", "every", "micro", "framework", "into", "core", "NUMBER", "It", "s", "simple", "to", "make", "it", "work", "for", "a", "given", "framework", "with", "a", "few", "lines", "of", "code", "NUMBER", "Adding", "something", "like", "this", "also", "creates", "the", "assumption", "that", "we", "test", "the", "library", "against", "Padrino", "which", "we", "don", "t", "NUMBER", "Looks", "like", "there", "be", "some", "goodies", "here", "LINK", "mongoid", "At", "this", "point", "I", "m", "still", "merge", "mongoid", "pull", "request", "into", "CW", "master", "what", "s", "the", "plan", "for", "officially", "extracting", "Closing", "in", "favor", "of", "NUMBER", "which", "comes", "with", "LINK", "mongoid", "pull", "NUMBER", "and", "alleges", "to", "clean", "this", "all", "up", "NUMBER", "I", "agree", "with", "gucki", "that", "we", "should", "be", "able", "to", "store", "only", "the", "path", "NUMBER", "I", "ll", "merge", "this", "for", "now", "and", "we", "can", "keep", "work", "on", "improving", "this", "NUMBER", "We", "did", "the", "extraction", "for", "two", "reasons", "NUMBER", "It", "s", "a", "pain", "to", "maintain", "so", "many", "ORM", "adapters", "we", "re", "constantly", "fighting", "with", "the", "test", "and", "new", "version", "and", "it", "s", "just", "annoying", "in", "general", "NUMBER", "Slimming", "down", "the", "main", "repo", "means", "it", "becomes", "easier", "for", "us", "as", "maintainers", "to", "work", "with", "CarrierWave", "NUMBER", "NUMBER", "It", "s", "good", "to", "show", "other", "developers", "how", "to", "build", "a", "freestanding", "ORM", "adapter", "for", "CarrierWave", "NUMBER", "We", "extracted", "Sequel", "and", "DataMapper", "because", "those", "to", "us", "seem", "like", "they", "be", "use", "the", "least", "NUMBER", "So", "in", "effect", "yes", "it", "be", "a", "prioritization", "of", "Mongoid", "and", "ActiveRecord", "NUMBER", "However", "thinking", "about", "this", "more", "I", "m", "starting", "to", "feel", "that", "maybe", "we", "should", "extract", "Mongoid", "into", "a", "separate", "gem", "as", "well", "NUMBER", "I", "have", "no", "doubt", "that", "ActiveRecord", "be", "the", "most", "commonly", "use", "ORM", "and", "I", "feel", "strongly", "that", "it", "should", "remain", "part", "of", "the", "main", "CarrierWave", "repository", "NUMBER", "solnic", "that", "s", "another", "reason", "for", "extracting", "them", "into", "gems", "that", "way", "people", "who", "care", "about", "the", "adapters", "I", "never", "use", "DataMapper", "nor", "Sequel", "can", "easier", "take", "ownership", "over", "the", "gems", "and", "make", "them", "great", "NUMBER", "Looking", "forward", "to", "your", "contributions", "Wow", "why", "the", "hell", "would", "it", "do", "that", "Looking", "at", "that", "code", "it", "seems", "like", "it", "s", "not", "doing", "anything", "particularly", "strange", "why", "would", "the", "value", "of", "self", "carry", "over", "between", "different", "version", "Hmm", "will", "need", "to", "investigate", "this", "NUMBER", "Can", "everyone", "try", "master", "just", "push", "NUMBER", "e", "NUMBER", "a", "NUMBER", "fbd", "NUMBER", "e", "NUMBER", "ddc", "NUMBER", "ba", "NUMBER", "dc", "NUMBER", "a", "NUMBER", "caa", "NUMBER", "e", "NUMBER", "b", "and", "post", "back", "here", "if", "there", "be", "still", "issue", "This", "include", "specs", "from", "Eleo", "for", "nested", "version", "NUMBER", "You", "need", "to", "provide", "way", "more", "details", "than", "this", "and", "please", "send", "question", "to", "the", "mailing", "list", "NUMBER", "This", "be", "what", "you", "should", "provide", "in", "a", "bug", "report", "NUMBER", "What", "did", "you", "do", "NUMBER", "What", "did", "you", "expect", "to", "happen", "NUMBER", "What", "actually", "happened", "NUMBER", "Any", "relevant", "code", "NUMBER", "A", "stack", "trace", "NUMBER", "Version", "numbers", "of", "any", "library", "you", "re", "use", "in", "this", "case", "OS", "Ruby", "CarrierWave", "ImageMagick", "RMagick", "Notice", "that", "out", "of", "those", "six", "items", "you", "should", "provide", "in", "a", "bug", "report", "you", "only", "provide", "number", "NUMBER", "relevant", "code", "NUMBER", "As", "I", "said", "please", "post", "your", "question", "to", "the", "mailing", "list", "with", "all", "of", "that", "information", "provide", "NUMBER", "Jonas", "This", "be", "breaking", "for", "me", "on", "master", "too", "Managed", "to", "fix", "this", "up", "I", "think", "and", "push", "it", "to", "master", "good", "job", "ened", "seems", "to", "work", "fine", "from", "what", "I", "can", "tell", "but", "please", "pull", "it", "down", "and", "check", "if", "you", "re", "still", "having", "problem", "please", "create", "an", "issue", "NUMBER", "Good", "job", "merge", "No", "idea", "what", "you", "re", "doing", "but", "that", "doesn", "t", "look", "right", "at", "all", "NUMBER", "You", "can", "t", "assign", "an", "uploaded", "file", "to", "an", "association", "NUMBER", "Please", "ask", "question", "on", "the", "mailing", "list", "the", "issue", "tracker", "should", "only", "be", "use", "if", "you", "re", "fairly", "certain", "that", "you", "ve", "encountered", "a", "bug", "NUMBER", "I", "ve", "notice", "this", "too", "NUMBER", "I", "haven", "t", "be", "annoyed", "enough", "to", "fix", "it", "myself", "but", "I", "d", "really", "appreciate", "a", "pull", "request", "on", "this", "It", "s", "probably", "all", "the", "different", "pull", "request", "be", "merge", "in", "the", "wrong", "order", "but", "this", "seems", "to", "break", "for", "me", "know", "could", "you", "check", "it", "against", "the", "latest", "master", "Pushed", "NUMBER", "Yeah", "that", "would", "be", "awesome", "That", "sounds", "sensible", "to", "me", "NUMBER", "I", "kind", "of", "dislike", "having", "yet", "another", "method", "which", "can", "be", "overridden", "NUMBER", "I", "do", "see", "the", "point", "but", "be", "this", "really", "necessary", "When", "would", "you", "have", "to", "override", "full_original_filename", "anyway", "I", "m", "cautiously", "NUMBER", "on", "this", "NUMBER", "After", "reviewing", "this", "we", "find", "that", "the", "full_original_filename", "method", "only", "impacts", "the", "name", "of", "the", "cached", "file", "never", "the", "stored", "file", "NUMBER", "It", "seems", "to", "me", "that", "those", "names", "be", "kind", "of", "unimportant", "and", "therefore", "this", "change", "isn", "t", "necessary", "NUMBER", "I", "m", "closing", "this", "for", "now", "please", "elaborate", "if", "you", "still", "feel", "this", "be", "needed", "NUMBER", "Can", "t", "you", "just", "_not_", "process", "the", "original", "version", "What", "s", "the", "point", "of", "this", "Sorry", "to", "do", "a", "NUMBER", "on", "this", "I", "know", "I", "originally", "said", "that", "I", "d", "accept", "a", "patch", "for", "this", "but", "after", "careful", "consideration", "and", "talking", "this", "through", "with", "Trevor", "I", "don", "t", "feel", "that", "this", "feature", "add", "enough", "value", "to", "be", "worth", "it", "NUMBER", "You", "could", "simply", "create", "a", "new", "version", "for", "the", "watermarked", "image", "in", "the", "original", "discussion", "on", "the", "mailing", "list", "NUMBER", "I", "m", "closing", "this", "NUMBER", "Sorry", "NUMBER", "fbjork", "be", "this", "a", "problem", "with", "carriewwave", "or", "carrierwave", "mongoid", "Can", "you", "make", "a", "fail", "test", "case", "and", "open", "an", "issue", "where", "appropriate", "Thanks", "I", "test", "it", "and", "was", "unable", "to", "replicate", "the", "problem", "I", "m", "closing", "this", "issue", "NUMBER", "If", "you", "re", "still", "having", "problem", "please", "send", "a", "pull", "request", "with", "a", "fail", "spec", "NUMBER", "Thanks", "for", "putting", "this", "together", "NUMBER", "I", "m", "sorry", "though", "it", "s", "a", "bit", "over", "my", "head", "NUMBER", "Can", "you", "please", "explain", "why", "you", "need", "this", "Maybe", "that", "ll", "help", "me", "understand", "what", "s", "going", "on", "I", "see", "So", "have", "you", "looked", "into", "this", "on", "the", "master", "branch", "as", "well", "I", "m", "wondering", "if", "the", "same", "problem", "exists", "there", "NUMBER", "OK", "thanks", "NUMBER", "I", "m", "going", "to", "be", "very", "busy", "for", "a", "few", "days", "but", "I", "ll", "get", "to", "this", "again", "ASAP", "NUMBER", "I", "m", "not", "sure", "what", "you", "mean", "NUMBER", "You", "might", "be", "use", "an", "older", "gem", "That", "new", "config", "works", "with", "NUMBER", "which", "I", "just", "release", "NUMBER", "I", "m", "not", "sure", "what", "to", "tell", "you", "maybe", "you", "re", "use", "storage", "s", "NUMBER", "instead", "of", "storage", "fog", "anyway", "the", "new", "config", "works", "with", "the", "new", "gem", "so", "you", "must", "be", "doing", "something", "wrong", "Please", "open", "a", "pull", "request", "for", "this", "kind", "of", "thing", "NUMBER", "Carrierwave", "do", "not", "support", "use", "the", "model", "id", "in", "the", "filename", "NUMBER", "Please", "see", "the", "wiki", "for", "some", "ideas", "about", "how", "to", "accomplish", "different", "naming", "schemes", "NUMBER", "If", "you", "have", "question", "like", "this", "in", "the", "future", "please", "use", "the", "Google", "Group", "NUMBER", "I", "think", "you", "need", "to", "remove", "those", "comments", "like", "required", "give", "that", "a", "shot", "and", "please", "report", "back", "NUMBER", "Maybe", "I", "shouldn", "t", "have", "them", "in", "the", "readme", "NUMBER", "I", "m", "get", "occasional", "intermittent", "error", "like", "so", "LINK", "geemus", "can", "you", "please", "investigate", "Let", "me", "know", "if", "there", "s", "anything", "I", "can", "do", "to", "help", "NUMBER", "I", "m", "not", "sure", "how", "to", "troubleshoot", "honestly", "NUMBER", "I", "can", "t", "seem", "to", "reproduce", "on", "demand", "NUMBER", "OK", "I", "ll", "try", "that", "and", "report", "back", "NUMBER", "Thanks", "for", "looking", "at", "this", "sorry", "to", "be", "a", "bother", "NUMBER", "Please", "have", "fun", "on", "your", "day", "off", "I", "m", "in", "the", "same", "boat", "as", "fbjork", "I", "was", "having", "this", "problem", "on", "Heroku", "and", "only", "since", "upgrading", "to", "fog", "NUMBER", "from", "what", "I", "can", "tell", "NUMBER", "It", "was", "happening", "intermittently", "but", "not", "infrequently", "and", "hasn", "t", "happened", "since", "I", "add", "persistent", "false", "as", "suggested", "NUMBER", "Perhaps", "some", "recent", "change", "could", "have", "worsened", "the", "situation", "on", "Heroku", "especially", "or", "maybe", "persistent", "false", "should", "be", "the", "default", "I", "m", "not", "sure", "NUMBER", "Thanks", "for", "looking", "at", "this", "NUMBER", "Awesome", "I", "ll", "give", "this", "a", "try", "and", "report", "back", "if", "I", "run", "into", "trouble", "again", "NUMBER", "Carrierwave", "only", "has", "a", "development", "dependency", "on", "fog", "and", "that", "s", "set", "to", "NUMBER", "now", "which", "has", "a", "dependency", "on", "excon", "NUMBER", "so", "I", "think", "we", "re", "ok", "to", "leave", "things", "as", "be", "NUMBER", "Maybe", "I", "ll", "post", "something", "to", "the", "Google", "Group", "once", "I", "test", "things", "out", "myself", "just", "to", "give", "people", "a", "heads", "up", "though", "NUMBER", "Thanks", "again", "for", "looking", "at", "this", "so", "quickly", "Please", "post", "question", "like", "this", "to", "the", "Google", "Group", "in", "the", "future", "NUMBER", "I", "believe", "you", "can", "set", "the", "permissions", "of", "uploaded", "file", "with", "a", "Carrierwave", "config", "option", "but", "you", "ll", "have", "to", "investigate", "for", "yourself", "NUMBER", "Thanks", "for", "report", "this", "but", "I", "m", "honestly", "not", "sure", "what", "you", "re", "talking", "about", "Can", "you", "please", "elaborate", "and", "maybe", "help", "me", "understand", "what", "the", "problem", "be", "why", "it", "matters", "to", "you", "and", "what", "we", "might", "consider", "doing", "about", "it", "Thank", "you", "Thanks", "for", "the", "explanation", "NUMBER", "I", "ll", "run", "this", "by", "jnicklas", "to", "see", "what", "he", "thinks", "NUMBER", "It", "may", "conflict", "with", "another", "change", "we", "be", "thinking", "of", "make", "but", "I", "ll", "keep", "this", "in", "mind", "NUMBER", "Can", "you", "provide", "a", "bit", "more", "detail", "perhaps", "your", "Carrierwave", "config", "I", "m", "wondering", "if", "you", "re", "use", "authenticated", "urls", "or", "something", "NUMBER", "Yeah", "you", "can", "use", "the", "s", "NUMBER", "storage", "for", "now", "I", "think", "there", "may", "be", "a", "problem", "with", "the", "authenticated", "url", "generation", "when", "fog_public", "false", "hopefully", "geemus", "can", "look", "into", "that", "soon", "NUMBER", "I", "thought", "he", "d", "already", "solve", "the", "speed", "issue", "NUMBER", "ok", "Please", "read", "the", "get", "help", "section", "of", "the", "wiki", "before", "creating", "issue", "NUMBER", "I", "think", "this", "may", "be", "for", "the", "Google", "Group", "and", "I", "can", "t", "read", "the", "code", "you", "pasted", "anyway", "NUMBER", "geemus", "you", "can", "see", "the", "play", "by", "play", "here", "LINK", "I", "run", "the", "test", "with", "and", "without", "mocking", "with", "NUMBER", "and", "then", "with", "NUMBER", "Everything", "looks", "fine", "with", "NUMBER", "with", "mocking", "off", "but", "with", "mocking", "on", "I", "m", "get", "some", "Excon", "Errors", "NotFound", "error", "NUMBER", "So", "I", "think", "it", "s", "a", "problem", "with", "mocking", "but", "I", "m", "just", "guessing", "NUMBER", "Can", "you", "please", "take", "a", "look", "when", "you", "have", "time", "Thank", "you", "I", "made", "some", "change", "to", "the", "way", "that", "test", "work", "and", "I", "remove", "Gemfile", "NUMBER", "lock", "NUMBER", "So", "you", "may", "have", "to", "run", "bundle", "install", "to", "start", "to", "make", "your", "Gemfile", "NUMBER", "lock", "and", "then", "look", "at", "the", "readme", "or", "my", "gist", "to", "see", "how", "to", "run", "everything", "NUMBER", "It", "should", "be", "much", "easier", "to", "run", "all", "of", "the", "test", "now", "at", "least", "that", "was", "the", "goal", "NUMBER", "No", "problem", "no", "rush", "NUMBER", "Thanks", "for", "looking", "into", "it", "Awesome", "thank", "you", "I", "ll", "try", "to", "work", "up", "a", "gem", "release", "today", "D", "Awesome", "thanks", "for", "figuring", "that", "out", "I", "was", "get", "occasional", "report", "of", "problem", "on", "Windows", "with", "this", "but", "it", "s", "hard", "to", "track", "down", "problem", "with", "Windows", "when", "you", "don", "t", "have", "it", "NUMBER", "Thanks", "again", "This", "be", "a", "question", "for", "the", "Google", "Group", "NUMBER", "Please", "review", "the", "Wiki", "it", "has", "some", "example", "applications", "you", "can", "investigate", "NUMBER", "I", "don", "t", "think", "this", "be", "the", "fault", "of", "fog", "and", "would", "be", "the", "same", "with", "s", "NUMBER", "and", "cloudfiles", "but", "it", "s", "worth", "looking", "into", "NUMBER", "When", "work", "on", "this", "we", "should", "also", "test", "if", "the", "content_type", "be", "set", "correctly", "after", "recreate_versions", "be", "call", "I", "think", "this", "be", "a", "relate", "problem", "that", "would", "be", "solve", "if", "we", "fix", "the", "first", "NUMBER", "I", "m", "not", "sure", "but", "I", "think", "this", "may", "require", "depending", "on", "the", "mime", "types", "gem", "to", "determine", "the", "content_type", "of", "a", "file", "that", "s", "be", "cached", "NUMBER", "Hmm", "NUMBER", "maybe", "I", "was", "mistaken", "I", "ll", "try", "to", "make", "a", "fail", "test", "case", "later", "today", "and", "report", "back", "NUMBER", "So", "I", "m", "not", "sure", "how", "best", "to", "proceed", "NUMBER", "Just", "to", "give", "you", "some", "background", "here", "s", "how", "I", "came", "about", "this", "NUMBER", "If", "you", "want", "you", "can", "reproduce", "with", "this", "app", "LINK", "heroku", "commit", "NUMBER", "f", "NUMBER", "b", "NUMBER", "fb", "NUMBER", "e", "NUMBER", "d", "NUMBER", "a", "NUMBER", "eae", "NUMBER", "cba", "NUMBER", "dd", "NUMBER", "bundle", "install", "s", "NUMBER", "_access_key_id", "xxx", "s", "NUMBER", "_secret_access_key", "xxx", "s", "NUMBER", "_bucket", "xxx", "rails", "s", "Then", "you", "want", "to", "create", "a", "user", "with", "a", "name", "and", "an", "avatar", "NUMBER", "If", "you", "check", "out", "the", "content_type", "in", "the", "headers", "I", "use", "LINK", "of", "the", "uploaded", "file", "you", "ll", "see", "it", "s", "whatever", "you", "expect", "image", "png", "for", "example", "NUMBER", "Then", "if", "you", "create", "a", "user", "_without_", "a", "name", "but", "with", "an", "avatar", "then", "you", "ll", "get", "a", "validation", "error", "NUMBER", "The", "uploaded", "file", "will", "be", "cached", "NUMBER", "Then", "you", "add", "a", "name", "and", "save", "NUMBER", "Then", "check", "the", "content_type", "header", "of", "the", "uploaded", "and", "you", "ll", "see", "it", "s", "empty", "NUMBER", "It", "s", "not", "a", "huge", "problem", "but", "the", "issue", "be", "that", "file", "without", "the", "right", "content_type", "header", "will", "be", "downloaded", "instead", "of", "display", "in", "the", "browser", "sometimes", "NUMBER", "So", "I", "think", "I", "ve", "emulated", "the", "problem", "in", "the", "test", "in", "the", "content_type", "branch", "on", "here", "NUMBER", "Basically", "I", "think", "it", "comes", "down", "to", "retrieve_from_cache", "not", "setting", "the", "content_type", "NUMBER", "I", "tried", "to", "set", "the", "content_type", "in", "SatitizedFile", "but", "I", "was", "having", "trouble", "there", "NUMBER", "So", "I", "moved", "on", "to", "trying", "to", "set", "it", "in", "retrieve_from_cache", "but", "I", "m", "not", "sure", "if", "that", "s", "solving", "the", "root", "problem", "NUMBER", "You", "can", "see", "my", "efforts", "but", "I", "m", "not", "very", "happy", "with", "it", "NUMBER", "Anyway", "please", "have", "a", "look", "at", "the", "content_type", "branch", "and", "let", "me", "know", "what", "you", "think", "NUMBER", "Hmm", "NUMBER", "I", "m", "not", "sure", "if", "a", "global", "cache", "of", "content_types", "would", "work", "across", "processes", "would", "it", "I", "mean", "if", "you", "have", "NUMBER", "instances", "Passenger", "up", "and", "run", "your", "app", "could", "they", "all", "have", "access", "to", "the", "same", "in", "memory", "hash", "I", "ve", "never", "tried", "to", "do", "anything", "like", "that", "OK", "I", "ll", "see", "if", "I", "can", "do", "any", "better", "and", "then", "merge", "into", "master", "NUMBER", "I", "m", "thinking", "of", "push", "the", "mime", "types", "stuff", "into", "the", "fog", "storage", "module", "because", "that", "s", "already", "relying", "on", "mime", "types", "and", "that", "s", "the", "only", "area", "I", "m", "concerned", "with", "for", "this", "issue", "NUMBER", "Yeah", "NUMBER", "I", "guess", "that", "s", "bad", "NUMBER", "I", "m", "not", "sure", "if", "it", "s", "worth", "relying", "on", "the", "mime", "types", "gem", "for", "everything", "though", "NUMBER", "What", "do", "you", "think", "OK", "I", "ll", "try", "to", "tidy", "this", "branch", "up", "and", "then", "merge", "NUMBER", "Thanks", "very", "much", "for", "your", "help", "reviewing", "Yes", "I", "think", "this", "be", "a", "problem", "that", "s", "be", "discussed", "before", "LINK", "I", "m", "not", "NUMBER", "sure", "what", "the", "solution", "should", "be", "although", "I", "ve", "spent", "some", "time", "thinking", "about", "it", "NUMBER", "Suggestions", "be", "welcome", "NUMBER", "I", "ll", "leave", "this", "issue", "open", "because", "it", "should", "be", "address", "NUMBER", "So", "I", "looked", "into", "this", "a", "bit", "more", "and", "if", "you", "read", "the", "store_spec", "you", "ll", "see", "that", "the", "filename", "be", "supposed", "to", "default", "to", "nil", "I", "suppose", "because", "it", "s", "mostly", "supposed", "to", "be", "overridden", "if", "necessary", "NUMBER", "I", "m", "not", "sure", "I", "ll", "leave", "this", "open", "and", "see", "if", "jnicklas", "has", "a", "comment", "NUMBER", "It", "might", "make", "sense", "to", "make", "that", "default", "to", "the", "original_filename", "or", "something", "NUMBER", "This", "seems", "confusing", "to", "me", "but", "perhaps", "I", "m", "miss", "something", "NUMBER", "Closing", "in", "favor", "of", "issue", "NUMBER", "I", "m", "not", "sure", "honestly", "I", "d", "suggest", "use", "image_science", "that", "seems", "to", "be", "work", "for", "you", "NUMBER", "I", "m", "going", "to", "close", "this", "issue", "b", "c", "I", "believe", "others", "be", "use", "minimagick", "successfully", "NUMBER", "You", "might", "double", "check", "by", "ask", "the", "Google", "Group", "if", "anyone", "be", "use", "minimagick", "though", "if", "you", "re", "so", "inclined", "NUMBER", "If", "it", "turns", "out", "to", "be", "a", "widespread", "problem", "we", "can", "investigate", "more", "deeply", "NUMBER", "Hmm", "NUMBER", "there", "be", "a", "few", "config", "options", "you", "might", "try", "NUMBER", "If", "you", "look", "in", "uploader", "configuration", "NUMBER", "rb", "you", "ll", "see", "these", "add_config", "ignore_integrity_errors", "add_config", "ignore_processing_errors", "add_config", "validate_integrity", "add_config", "validate_processing", "Maybe", "setting", "some", "of", "those", "to", "true", "false", "would", "raise", "some", "error", "NUMBER", "Might", "be", "worth", "a", "shot", "Lemme", "know", "how", "it", "goes", "NUMBER", "FotoVerite", "if", "that", "helps", "you", "please", "consider", "update", "the", "wiki", "with", "an", "example", "of", "how", "people", "can", "troubleshoot", "problem", "like", "this", "NUMBER", "Thanks", "Closed", "If", "ActiveRecord", "be", "defined", "be", "it", "not", "already", "loaded", "Hmm", "NUMBER", "I", "guess", "I", "m", "just", "not", "seeing", "the", "benefit", "why", "do", "you", "need", "this", "Does", "it", "help", "if", "you", "re", "use", "Rails", "but", "not", "AR", "Thanks", "for", "the", "explanation", "merge", "I", "m", "sorry", "but", "can", "you", "please", "take", "a", "moment", "to", "carefully", "describe", "the", "what", "the", "problem", "you", "be", "having", "be", "What", "be", "you", "trying", "to", "accomplish", "What", "s", "get", "in", "your", "way", "I", "can", "t", "make", "sense", "of", "this", "as", "you", "ve", "write", "it", "NUMBER", "Have", "you", "tried", "this", "with", "carrierwave", "master", "branch", "I", "did", "something", "to", "help", "alleviate", "FormNotMultipart", "error", "but", "I", "have", "no", "idea", "if", "it", "would", "help", "in", "your", "case", "NUMBER", "I", "m", "really", "not", "sure", "about", "how", "else", "we", "might", "change", "Carrierwave", "to", "accommodate", "your", "situation", "NUMBER", "Maybe", "someone", "else", "will", "chime", "in", "otherwise", "it", "might", "be", "smart", "for", "you", "to", "work", "up", "a", "pull", "request", "with", "a", "propose", "change", "because", "you", "might", "be", "the", "only", "person", "that", "s", "bothered", "NUMBER", "Failing", "that", "maybe", "just", "document", "your", "workaround", "in", "the", "wiki", "NUMBER", "Umm", "NUMBER", "so", "I", "m", "not", "sure", "what", "you", "re", "suggesting", "NUMBER", "I", "m", "sorry", "but", "I", "m", "still", "not", "clear", "on", "what", "action", "you", "be", "suggesting", "we", "take", "NUMBER", "Honestly", "none", "of", "those", "sounds", "lik", "every", "appealing", "options", "NUMBER", "NUMBER", "I", "d", "guess", "that", "AR", "be", "doing", "that", "on", "purpose", "but", "maybe", "not", "NUMBER", "I", "d", "prefer", "not", "to", "monkey", "patch", "AR", "if", "at", "all", "possible", "NUMBER", "Is", "this", "suggesting", "to", "always", "use", "the", "mount_on", "option", "or", "just", "that", "if", "you", "use", "mount_on", "you", "must", "use", "a", "different", "key", "Hmm", "NUMBER", "I", "think", "this", "sounds", "like", "something", "that", "jnicklas", "probably", "should", "look", "at", "NUMBER", "Maybe", "he", "ll", "have", "some", "ideas", "NUMBER", "I", "m", "of", "the", "opinion", "that", "we", "should", "make", "the", "change", "if", "it", "s", "smart", "NUMBER", "CarrierWave", "be", "not", "yet", "NUMBER", "and", "ask", "everyone", "to", "run", "a", "migration", "rename", "a", "column", "perhaps", "isn", "t", "too", "much", "to", "ask", "NUMBER", "If", "they", "think", "so", "they", "can", "continue", "use", "an", "older", "version", "NUMBER", "I", "d", "just", "suggest", "waiting", "until", "after", "we", "release", "NUMBER", "with", "fog", "support", "NUMBER", "Then", "we", "can", "move", "on", "to", "an", "NUMBER", "branch", "and", "note", "that", "there", "be", "breaking", "change", "NUMBER", "So", "what", "if", "it", "defaulted", "like", "so", "add_column", "users", "avatar_uploader", "string", "mount_uploader", "avatar", "AvatarUploader", "So", "the", "column", "would", "get", "_uploader", "add", "to", "it", "NUMBER", "Oh", "also", "we", "could", "suggest", "that", "people", "use", "mount_uploader", "avatar", "AvatarUploader", "mount_on", "avatar", "NUMBER", "to", "retain", "the", "old", "behavior", "and", "not", "raise", "an", "error", "if", "they", "don", "t", "want", "to", "change", "their", "column", "names", "NUMBER", "That", "way", "we", "change", "the", "default", "note", "that", "there", "was", "a", "breaking", "change", "provide", "a", "simple", "fix", "change", "your", "db", "column", "name", "and", "provide", "an", "alternative", "change", "the", "mount_on", "to", "use", "the", "old", "default", "sounds", "fine", "to", "me", "NUMBER", "sinsiliux", "it", "s", "not", "that", "nobody", "notice", "it", "s", "just", "that", "it", "s", "a", "major", "change", "so", "we", "ve", "be", "hesitant", "to", "make", "it", "NUMBER", "I", "think", "we", "may", "have", "to", "though", "NUMBER", "Please", "see", "the", "wiki", "for", "an", "idea", "about", "how", "to", "work", "around", "this", "lack", "NUMBER", "There", "s", "also", "a", "pull", "request", "open", "from", "josevalim", "that", "would", "address", "the", "issue", "NUMBER", "Please", "upload", "this", "simple", "example", "app", "to", "github", "for", "me", "to", "test", "NUMBER", "This", "be", "impossible", "to", "read", "NUMBER", "I", "m", "not", "sure", "what", "your", "issue", "might", "be", "but", "I", "m", "NUMBER", "sure", "that", "it", "s", "not", "relate", "to", "a", "bug", "in", "carrierwave", "if", "you", "re", "only", "just", "trying", "to", "get", "start", "NUMBER", "Please", "review", "the", "readme", "carefully", "and", "try", "to", "make", "your", "own", "small", "application", "NUMBER", "Then", "read", "the", "get", "help", "section", "in", "the", "wiki", "before", "creating", "a", "new", "issue", "if", "you", "think", "you", "ve", "find", "a", "bug", "NUMBER", "If", "you", "just", "have", "question", "about", "how", "to", "get", "start", "try", "the", "Google", "Group", "instead", "NUMBER", "From", "a", "quick", "glace", "this", "looks", "pretty", "good", "NUMBER", "However", "you", "need", "to", "provide", "at", "least", "one", "new", "test", "for", "this", "functionality", "in", "order", "for", "me", "to", "consider", "merge", "it", "NUMBER", "Good", "work", "so", "far", "Looks", "good", "I", "ll", "review", "test", "merge", "ASAP", "and", "report", "back", "to", "this", "issue", "NUMBER", "Excellent", "work", "thanks", "So", "I", "moved", "stuff", "around", "a", "little", "because", "I", "wanted", "to", "avoid", "having", "another", "method", "NUMBER", "I", "also", "remove", "the", "version", "namespace", "in", "the", "hash", "because", "I", "think", "it", "s", "more", "in", "keep", "with", "the", "current", "API", "NUMBER", "For", "example", "User", "NUMBER", "last", "NUMBER", "avatar", "NUMBER", "umb", "NUMBER", "url", "works", "whereas", "User", "NUMBER", "last", "NUMBER", "avatar", "NUMBER", "version", "NUMBER", "umb", "NUMBER", "url", "do", "not", "NUMBER", "Let", "me", "know", "what", "you", "think", "and", "thanks", "for", "work", "on", "this", "I", "just", "test", "and", "in", "your", "case", "I", "believe", "user", "NUMBER", "to_json", "should", "work", "in", "the", "same", "way", "with", "without", "carrierwave", "NUMBER", "So", "user", "NUMBER", "avatar", "NUMBER", "to_json", "only", "returns", "the", "url", "NUMBER", "Is", "that", "what", "you", "meant", "to", "say", "I", "believe", "I", "implement", "that", "as_json", "feature", "and", "wasn", "t", "sure", "what", "else", "people", "might", "want", "so", "I", "only", "include", "the", "URL", "NUMBER", "So", "if", "user", "NUMBER", "to_json", "only", "returns", "the", "avatar", "NUMBER", "url", "that", "s", "a", "bug", "NUMBER", "I", "don", "t", "think", "that", "s", "happening", "though", "but", "maybe", "I", "m", "wrong", "NUMBER", "If", "user", "NUMBER", "avatar", "NUMBER", "to_json", "doesn", "t", "return", "what", "you", "want", "then", "we", "can", "discuss", "that", "NUMBER", "Hmm", "NUMBER", "I", "think", "something", "strange", "might", "be", "going", "on", "with", "your", "app", "NUMBER", "I", "just", "test", "this", "again", "and", "it", "s", "work", "as", "expected", "for", "me", "NUMBER", "I", "have", "a", "Rails", "NUMBER", "app", "on", "Ruby", "NUMBER", "use", "carrierwave", "master", "with", "a", "model", "call", "Attachment", "NUMBER", "When", "I", "do", "Attachment", "NUMBER", "last", "NUMBER", "to_json", "I", "get", "more", "than", "just", "the", "attachment", "url", "NUMBER", "So", "if", "you", "re", "having", "this", "problem", "we", "ll", "need", "to", "dig", "deeper", "to", "figure", "out", "why", "NUMBER", "Can", "you", "provide", "more", "details", "your", "environment", "maybe", "an", "example", "app", "that", "I", "can", "try", "etc", "Re", "your", "other", "comment", "I", "m", "not", "sure", "what", "you", "mean", "NUMBER", "Can", "you", "please", "clarify", "what", "the", "problem", "be", "Sorry", "but", "I", "can", "t", "help", "unless", "I", "have", "more", "information", "NUMBER", "You", "might", "try", "to", "create", "a", "simple", "example", "application", "on", "github", "with", "a", "fail", "test", "for", "me", "to", "see", "NUMBER", "Otherwise", "I", "think", "you", "may", "be", "on", "your", "own", "to", "try", "and", "figure", "it", "out", "NUMBER", "Just", "to", "clarify", "do", "you", "mean", "user", "NUMBER", "to_json", "or", "user", "NUMBER", "avatar", "NUMBER", "to_json", "Because", "I", "expect", "user", "NUMBER", "to_json", "to", "include", "the", "id", "attribute", "etc", "NUMBER", "If", "it", "doesn", "t", "that", "s", "a", "problem", "NUMBER", "If", "you", "mean", "simply", "that", "user", "NUMBER", "avatar", "NUMBER", "to_json", "doesn", "t", "include", "the", "urls", "of", "any", "version", "you", "may", "have", "that", "s", "more", "of", "a", "feature", "request", "than", "a", "bug", "problem", "NUMBER", "I", "just", "want", "to", "make", "sure", "we", "re", "clear", "on", "that", "point", "before", "going", "ahead", "NUMBER", "OK", "so", "your", "issue", "be", "that", "you", "want", "user", "NUMBER", "avatar", "NUMBER", "to_json", "to", "include", "the", "urls", "of", "version", "if", "they", "exist", "NUMBER", "I", "m", "a", "bit", "behind", "on", "other", "issue", "at", "the", "moment", "so", "I", "can", "t", "take", "this", "on", "myself", "NUMBER", "I", "d", "definitely", "look", "at", "a", "pull", "request", "with", "test", "if", "you", "want", "to", "put", "something", "together", "though", "NUMBER", "Yeah", "this", "isn", "t", "really", "a", "bug", "so", "much", "as", "a", "feature", "request", "NUMBER", "The", "way", "we", "defined", "as_json", "be", "pretty", "clear", "that", "it", "s", "only", "supplying", "the", "one", "url", "NUMBER", "If", "we", "want", "more", "we", "ll", "have", "to", "add", "it", "NUMBER", "OK", "good", "luck", "I", "m", "add", "a", "note", "to", "the", "wiki", "about", "this", "basically", "it", "s", "a", "know", "issue", "NUMBER", "A", "pull", "request", "with", "plenty", "of", "test", "would", "be", "welcome", "but", "there", "be", "possible", "workarounds", "NUMBER", "See", "the", "wiki", "for", "details", "I", "ll", "link", "to", "the", "Google", "Groups", "thread", "about", "the", "issue", "NUMBER", "Please", "ask", "question", "like", "this", "on", "the", "Google", "Group", "NUMBER", "Hmm", "NUMBER", "I", "don", "t", "NUMBER", "Can", "you", "test", "your", "app", "use", "the", "Carrierwave", "master", "branch", "with", "the", "new", "fog", "storage", "module", "I", "m", "wondering", "if", "that", "will", "have", "the", "same", "problem", "NUMBER", "There", "be", "instructions", "in", "the", "readme", "and", "the", "wiki", "has", "instructions", "about", "how", "to", "move", "to", "the", "fog", "storage", "module", "NUMBER", "I", "have", "no", "idea", "what", "that", "could", "be", "sorry", "NUMBER", "Maybe", "geemus", "will", "though", "NUMBER", "You", "can", "see", "if", "he", "responds", "here", "or", "perhaps", "file", "something", "with", "the", "excon", "gem", "after", "a", "day", "or", "two", "NUMBER", "There", "be", "examples", "in", "the", "readme", "and", "on", "the", "wiki", "I", "m", "not", "sure", "what", "you", "could", "be", "doing", "wrong", "NUMBER", "Perhaps", "you", "could", "upload", "a", "small", "sample", "application", "that", "demonstrates", "the", "problem", "I", "can", "have", "a", "look", "at", "that", "NUMBER", "It", "s", "hard", "to", "tell", "what", "s", "going", "on", "from", "here", "NUMBER", "Everything", "works", "for", "me", "with", "downloads", "carrierwave", "mysql", "problem", "mysql", "ruby", "v", "ruby", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "patchlevel", "NUMBER", "i", "NUMBER", "darwin", "NUMBER", "and", "downloads", "carrierwave", "mysql", "problem", "mysql", "ruby", "v", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "Sorry", "but", "I", "think", "something", "fishy", "might", "be", "going", "on", "with", "your", "dev", "setup", "NUMBER", "I", "m", "really", "sorry", "I", "can", "t", "be", "of", "more", "help", "NUMBER", "be", "the", "problem", "narrowed", "down", "to", "excon", "v", "NUMBER", "mysql", "Perhaps", "you", "could", "consider", "use", "postgres", "and", "the", "pg", "gem", "Maybe", "geemus", "has", "some", "ideas", "but", "unfortunately", "I", "m", "fresh", "out", "NUMBER", "Sorry", "I", "d", "suggest", "not", "use", "master", "directly", "like", "that", "it", "s", "best", "to", "pick", "the", "latest", "revision", "with", "the", "ref", "key", "instead", "of", "the", "branch", "key", "ref", "NUMBER", "c", "NUMBER", "ee", "NUMBER", "b", "NUMBER", "b", "NUMBER", "for", "example", "That", "way", "you", "re", "not", "use", "a", "moving", "target", "NUMBER", "I", "think", "the", "cron", "job", "be", "a", "good", "solution", "but", "I", "d", "be", "willing", "to", "review", "a", "pull", "request", "if", "you", "d", "like", "to", "work", "one", "up", "NUMBER", "Failing", "that", "you", "might", "consider", "add", "a", "page", "to", "the", "wiki", "titled", "feature", "request", "and", "add", "this", "as", "the", "first", "NUMBER", "geemus", "unfortunately", "that", "last", "change", "around", "content_type", "has", "made", "things", "worse", "NUMBER", "Now", "when", "I", "upload", "an", "image", "file", "through", "a", "Rails", "app", "the", "content_type", "be", "come", "up", "binary", "octet", "stream", "every", "time", "NUMBER", "I", "m", "trying", "to", "work", "up", "some", "test", "cases", "but", "stumbling", "a", "bit", "NUMBER", "So", "I", "_think_", "I", "figured", "something", "out", "NUMBER", "I", "push", "up", "a", "commit", "with", "an", "attempt", "at", "a", "fix", "a", "test", "and", "I", "ve", "test", "it", "in", "an", "app", "of", "mine", "NUMBER", "It", "seems", "to", "be", "work", "but", "I", "have", "a", "fail", "test", "for", "Rackspace", "NUMBER", "I", "don", "t", "know", "if", "this", "be", "a", "problem", "with", "Rackspace", "or", "Carrierwave", "fog", "though", "NUMBER", "LINK", "geemus", "can", "you", "have", "a", "look", "when", "you", "have", "a", "chance", "I", "m", "not", "NUMBER", "sure", "my", "change", "be", "the", "best", "way", "to", "do", "things", "and", "I", "m", "not", "sure", "about", "this", "Rackspace", "problem", "NUMBER", "Awesome", "thank", "you", "I", "ll", "look", "out", "for", "the", "next", "fog", "release", "and", "clean", "up", "these", "tickets", "NUMBER", "This", "be", "fix", "by", "fog", "NUMBER", "I", "m", "open", "a", "new", "ticket", "though", "I", "think", "there", "s", "some", "problem", "with", "mocking", "in", "NUMBER", "I", "ve", "upgrade", "to", "fog", "NUMBER", "but", "I", "m", "still", "get", "this", "test", "failure", "with", "FOG_MOCK", "false", "LINK", "geemus", "I", "think", "you", "said", "this", "should", "be", "fix", "in", "fog", "but", "maybe", "the", "fix", "isn", "t", "release", "yet", "I", "can", "try", "again", "with", "NUMBER", "or", "whatever", "gets", "release", "next", "NUMBER", "What", "if", "you", "do", "d", "NUMBER", "update_attributes", "file", "nil", "s", "NUMBER", "save", "NUMBER", "I", "think", "the", "remove_file", "thing", "might", "bypass", "the", "validations", "NUMBER", "Did", "you", "read", "the", "comments", "I", "close", "it", "because", "I", "suspect", "it", "s", "not", "an", "issue", "with", "Carrierwave", "itself", "NUMBER", "Please", "upload", "a", "simple", "example", "app", "and", "I", "can", "test", "for", "you", "if", "you", "like", "NUMBER", "Also", "please", "post", "the", "backtrace", "ruby", "version", "operate", "system", "etc", "in", "a", "gist", "NUMBER", "I", "m", "glad", "you", "figured", "it", "out", "Please", "do", "consider", "add", "a", "section", "to", "the", "wiki", "about", "your", "experiences", "NUMBER", "It", "s", "always", "helpful", "to", "others", "if", "you", "document", "something", "that", "took", "a", "while", "to", "figure", "out", "Please", "see", "the", "warning", "near", "the", "top", "of", "the", "readme", "on", "github", "the", "currently", "release", "gem", "doesn", "t", "have", "the", "fog", "provider", "just", "the", "master", "branch", "so", "that", "s", "why", "you", "re", "having", "problem", "NUMBER", "Can", "you", "please", "read", "the", "comments", "here", "and", "the", "readme", "There", "be", "a", "very", "clear", "answer", "to", "the", "question", "NUMBER", "Please", "use", "LINK", "for", "pasting", "code", "NUMBER", "This", "be", "impossible", "to", "read", "NUMBER", "I", "ve", "be", "work", "with", "this", "redirection", "stuff", "lately", "and", "I", "m", "not", "sure", "what", "the", "best", "solution", "be", "NUMBER", "If", "you", "have", "an", "idea", "about", "what", "s", "going", "on", "and", "want", "to", "try", "to", "fix", "things", "for", "ruby", "NUMBER", "and", "NUMBER", "I", "d", "love", "some", "help", "I", "think", "that", "forking", "the", "repo", "and", "work", "up", "a", "pull", "request", "would", "be", "best", "NUMBER", "This", "be", "difficult", "to", "understand", "out", "of", "context", "NUMBER", "Failing", "that", "I", "d", "suggest", "trying", "to", "get", "the", "redirects", "out", "of", "the", "URL", "before", "giving", "it", "to", "Carrierwave", "so", "that", "you", "re", "giving", "Carrierwave", "something", "it", "knows", "how", "to", "work", "with", "NUMBER", "I", "m", "not", "sure", "I", "consider", "this", "a", "bug", "so", "much", "as", "a", "limitation", "with", "open", "uri", "NUMBER", "Like", "I", "said", "I", "d", "be", "happy", "to", "have", "some", "help", "from", "you", "if", "you", "have", "some", "specific", "ideas", "NUMBER", "So", "a", "URL", "can", "redirect", "but", "I", "guess", "just", "not", "from", "https", "http", "NUMBER", "See", "here", "LINK", "So", "maybe", "you", "can", "gsub", "https", "http", "on", "that", "URL", "before", "passing", "it", "to", "Carrierwave", "NUMBER", "OK", "I", "ll", "close", "this", "for", "now", "NUMBER", "Please", "feel", "free", "to", "work", "on", "a", "pull", "request", "if", "you", "d", "like", "to", "try", "fix", "this", "in", "Carrierwave", "itself", "NUMBER", "Thanks", "Here", "s", "another", "small", "one", "that", "s", "probably", "worth", "looking", "into", "eventually", "LINK", "I", "m", "not", "sure", "what", "exactly", "we", "could", "do", "about", "it", "but", "for", "a", "file", "that", "hasn", "t", "just", "be", "stored", "the", "content_type", "will", "return", "nil", "until", "you", "read", "the", "file", "or", "maybe", "do", "something", "else", "but", "that", "gets", "the", "content_type", "set", "NUMBER", "Ooooooh", "you", "re", "almost", "TOO", "fast", "I", "ll", "test", "these", "change", "out", "in", "my", "apps", "ASAP", "NUMBER", "Thanks", "so", "much", "NUMBER", "This", "be", "a", "funny", "one", "but", "when", "trying", "to", "destroy", "a", "file", "that", "doesn", "t", "actually", "exist", "I", "get", "this", "error", "LINK", "I", "m", "not", "sure", "what", "ll", "happen", "if", "we", "work", "around", "that", "error", "but", "it", "s", "probably", "worth", "finding", "out", "NUMBER", "geemus", "if", "you", "want", "to", "have", "a", "look", "please", "do", "NUMBER", "Otherwise", "I", "ll", "work", "on", "it", "ASAP", "NUMBER", "Yeah", "if", "you", "work", "around", "that", "error", "it", "ll", "still", "fail", "here", "LINK", "I", "m", "not", "sure", "I", "guess", "it", "s", "appropriate", "be", "a", "sense", "to", "raise", "an", "error", "when", "you", "re", "trying", "to", "destroy", "something", "that", "s", "not", "there", "NUMBER", "I", "can", "see", "the", "argument", "on", "the", "other", "side", "though", "NUMBER", "Any", "thoughts", "Merged", "into", "NUMBER", "stable", "and", "master", "NUMBER", "Thanks", "Re", "LINK", "open", "aws", "region", "in", "tokyo", "NUMBER", "html", "We", "should", "add", "something", "about", "the", "option", "to", "the", "docs", "NUMBER", "I", "m", "not", "sure", "if", "change", "to", "fog", "be", "necessary", "for", "this", "though", "NUMBER", "Perhaps", "geemus", "do", "NUMBER", "Cool", "I", "ll", "leave", "this", "open", "and", "update", "the", "docs", "after", "you", "release", "NUMBER", "I", "suppose", "we", "ll", "want", "to", "recommend", "a", "fog", "version", "too", "at", "least", "in", "the", "wiki", "NUMBER", "I", "add", "this", "to", "the", "docs", "NUMBER", "Thanks", "I", "can", "take", "care", "of", "the", "docs", "and", "or", "test", "if", "you", "guys", "like", "NUMBER", "One", "thing", "though", "what", "do", "you", "think", "about", "change", "the", "config", "option", "to", "authenticated_url_expiry", "or", "authenticated_url_expiration", "the", "current", "name", "be", "a", "little", "confusing", "imo", "NUMBER", "edit", "I", "guess", "fog_authenticated_url_expiration", "to", "keep", "the", "namespace", "NUMBER", "Hey", "so", "I", "went", "ahead", "and", "renamed", "it", "fog_authenticated_url_expiration", "and", "add", "some", "documentation", "NUMBER", "Please", "feel", "free", "to", "make", "suggest", "any", "change", "NUMBER", "I", "m", "sorry", "but", "I", "m", "not", "clear", "on", "what", "this", "be", "fix", "NUMBER", "Can", "you", "provide", "a", "fail", "test", "case", "or", "more", "detail", "Sorry", "but", "I", "don", "t", "understand", "what", "the", "problem", "be", "here", "NUMBER", "Can", "you", "please", "provide", "a", "code", "example", "in", "a", "gist", "or", "something", "legible", "Also", "please", "describe", "what", "the", "problem", "you", "re", "having", "be", "in", "detail", "NUMBER", "I", "push", "up", "a", "new", "branch", "here", "LINK", "_previous_files", "NUMBER", "but", "I", "think", "there", "s", "a", "problem", "with", "the", "implementation", "unless", "I", "m", "doing", "the", "test", "wrong", "NUMBER", "There", "be", "a", "few", "pending", "todo", "test", "but", "this", "one", "be", "fail", "already", "bundle", "exec", "spec", "spec", "orm", "activerecord_spec", "NUMBER", "rb", "NUMBER", "There", "be", "comments", "in", "the", "code", "to", "explain", "what", "s", "going", "on", "NUMBER", "I", "think", "it", "s", "still", "possible", "to", "get", "this", "new", "feature", "work", "but", "I", "think", "there", "s", "work", "left", "to", "be", "do", "NUMBER", "You", "can", "also", "see", "some", "progress", "that", "Didier", "and", "I", "made", "on", "this", "issue", "here", "LINK", "NUMBER", "at", "might", "point", "us", "in", "the", "right", "direction", "NUMBER", "I", "think", "a", "combination", "of", "the", "two", "techniques", "might", "be", "in", "order", "but", "I", "m", "not", "sure", "I", "might", "be", "miss", "something", "obvious", "NUMBER", "The", "dynamic", "path", "isn", "t", "stored", "in", "the", "database", "the", "filename", "be", "stored", "and", "the", "path", "be", "calculated", "on", "demand", "NUMBER", "So", "yeah", "we", "basically", "need", "some", "way", "to", "get", "the", "new", "and", "old", "paths", "so", "that", "we", "can", "compare", "them", "that", "s", "what", "my", "comments", "in", "the", "code", "be", "about", "and", "you", "can", "see", "how", "Didier", "and", "I", "had", "thought", "to", "accomplish", "it", "in", "that", "commit", "I", "linked", "to", "NUMBER", "Maybe", "you", "ve", "thought", "of", "an", "easier", "way", "though", "Please", "give", "it", "a", "shot", "based", "on", "this", "new", "branch", "because", "the", "test", "should", "help", "make", "sure", "everything", "be", "work", "as", "expected", "NUMBER", "I", "can", "fill", "in", "the", "pending", "test", "but", "I", "wanted", "to", "check", "in", "since", "I", "had", "a", "test", "failure", "along", "the", "way", "NUMBER", "Sorry", "it", "s", "taken", "me", "a", "while", "to", "get", "back", "to", "this", "NUMBER", "Your", "change", "be", "cause", "test", "failures", "elsewhere", "unfortunately", "LINK", "I", "ve", "push", "everything", "up", "to", "the", "remove_previous_files", "branch", "NUMBER", "You", "can", "see", "the", "comparison", "to", "master", "here", "LINK", "_previous_files", "Maybe", "you", "want", "commit", "access", "to", "the", "repo", "so", "you", "can", "work", "in", "this", "branch", "If", "so", "drop", "jnicklas", "a", "line", "NUMBER", "I", "m", "thinking", "it", "might", "be", "smart", "to", "pull", "the", "column", "_will_change", "stuff", "into", "master", "while", "this", "keep", "developing", "NUMBER", "if", "you", "re", "still", "interested", "in", "work", "on", "it", "there", "s", "a", "non", "trivial", "about", "of", "work", "left", "to", "do", "I", "think", "NUMBER", "FYI", "I", "went", "ahead", "and", "manually", "pull", "in", "the", "_will_change", "stuff", "from", "this", "branch", "into", "master", "NUMBER", "Thanks", "for", "that", "FYI", "I", "spent", "some", "more", "time", "on", "this", "and", "I", "push", "up", "my", "work", "in", "progress", "here", "remove_previous_files_", "NUMBER", "NUMBER", "in", "case", "anyone", "be", "curious", "NUMBER", "My", "test", "so", "far", "be", "passing", "NUMBER", "I", "ll", "keep", "write", "more", "test", "make", "sure", "they", "all", "pass", "and", "then", "eventually", "we", "can", "decide", "what", "to", "do", "about", "the", "implementation", "e", "NUMBER", "g", "NUMBER", "make", "it", "orm", "agnostic", "if", "possible", "etc", "NUMBER", "I", "know", "it", "s", "not", "very", "good", "right", "now", "but", "I", "m", "just", "trying", "to", "do", "the", "minimal", "amount", "of", "impact", "to", "get", "things", "work", "and", "it", "seems", "to", "be", "going", "well", "so", "far", "NUMBER", "tl", "dr", "I", "m", "still", "work", "on", "this", "and", "will", "continue", "as", "time", "allows", "Any", "chance", "this", "be", "the", "same", "issue", "as", "NUMBER", "One", "of", "the", "important", "things", "be", "to", "make", "sure", "that", "extension_white_list", "still", "works", "regardless", "of", "case", "NUMBER", "As", "long", "as", "all", "file", "were", "lower", "case", "it", "was", "never", "a", "problem", "but", "case", "shouldn", "t", "matter", "when", "it", "comes", "to", "extensions", "imo", "NUMBER", "jameskilton", "we", "just", "need", "to", "make", "sure", "extension_white_list", "still", "works", "as", "intended", "and", "that", "should", "probably", "be", "part", "of", "the", "pull", "request", "that", "s", "all", "I", "m", "saying", "NUMBER", "I", "wasn", "t", "use", "that", "as", "an", "argument", "against", "this", "change", "mtmcfarl", "please", "consider", "add", "a", "section", "to", "the", "wiki", "about", "this", "NUMBER", "It", "may", "be", "helpful", "to", "other", "people", "NUMBER", "That", "s", "perfect", "thanks", "so", "much", "NUMBER", "nashbridges", "can", "you", "confirm", "that", "everything", "be", "work", "and", "try", "to", "help", "korobkov", "please", "Actually", "it", "should", "be", "resolve", "in", "the", "master", "branch", "on", "github", "now", "NUMBER", "Please", "give", "it", "a", "try", "and", "report", "back", "if", "you", "re", "still", "having", "problem", "NUMBER", "I", "think", "there", "be", "a", "few", "ways", "NUMBER", "The", "easiest", "way", "I", "know", "be", "to", "use", "bundler", "NUMBER", "Otherwise", "you", "can", "vendor", "the", "gem", "in", "your", "app", "NUMBER", "Or", "you", "can", "wait", "until", "we", "release", "the", "next", "gem", "version", "which", "will", "hopefully", "happen", "within", "the", "next", "week", "NUMBER", "The", "remove_previous_files", "branch", "be", "going", "to", "attempt", "to", "add", "this", "feature", "NUMBER", "You", "can", "peruse", "that", "if", "you", "re", "interested", "NUMBER", "Otherwise", "see", "the", "wiki", "for", "a", "potential", "easy", "workaround", "NUMBER", "brandonbloom", "Yes", "that", "s", "why", "it", "s", "listed", "as", "a", "know", "issue", "NUMBER", "Pull", "request", "be", "welcome", "scomma", "please", "update", "the", "wiki", "I", "think", "you", "should", "generate", "a", "UUID", "and", "store", "that", "in", "the", "database", "NUMBER"], "text_count": [0, 8775, 2474, 1161, 483, 109, 938, 10, 32, 1312, 1205, 2134, 1128, 964, 964, 302, 0, 0, 0, 0, 2599, 782, 339, 356, 427, 364, 0, 0, 0, 0, 4732, 3127, 1646, 48, 768, 376, 0, 0, 0, 0, 5727, 13, 2309, 2118, 1468, 0, 0, 0, 0, 0, 1550, 697, 643, 538, 783, 338, 679, 0, 0, 0, 3645, 334, 2845, 219, 0, 0, 0, 0, 0, 0, 2969, 244, 2298, 1031, 297, 0, 0, 0, 0, 0, 5494, 2550, 529, 2168, 307, 243, 0, 0, 0, 0, 299, 1808, 180, 0, 0, 0, 0, 0, 0, 0, 4762, 1148, 2784, 954, 0, 0, 0, 0, 0, 0, 7482, 14996, 269, 769, 278, 332, 0, 0, 0, 0, 21230, 94, 16253, 216, 3855, 4368]}, {"repo": "carrierwave", "type": "nonelite", "title": "", "number of text": 1422, "text": "  Hello,\nI used storage: file for a while and now I am switching to fog. Is it possible to keep the existing files on my file storage and generate correct url for both storage types with just one uploader class?\n\nThanks!\n Is there a way to override the host name in the uploader class like\n  def store_dir or def file_name ?\n  Hi, i've just tried to install carrierwave with Bundler version 1.0.10 and I get these messages:\n\nWARNING:  #<ArgumentError: Illformed requirement [\"#<YAML::Syck::DefaultKey:0x10e3e14f8> 1.1.4\"]>\n# -_\\- encoding: utf-8 -_-\n\nGem::Specification.new do |s|\n  s.name = %q{carrierwave}\n  s.version = \"0.6.2\"\n\n  s.required_rubygems_version = Gem::Requirement.new(\">= 0\") if s.respond_to? :required_rubygems_version=\n  s.authors = [\"Jonas Nicklas\"]\n  s.date = %q{2012-04-12}\n  s.description = %q{Upload files in your Ruby applications, map them to a range of ORMs, store them on different backends.}\n  s.email = [\"jonas.nicklas@gmail.com\"]\n  s.extra_rdoc_files = [\"README.md\"]\n  s.files = [\"lib/carrierwave/compatibility/paperclip.rb\", \"lib/carrierwave/locale/en.yml\", \"lib/carrierwave/mount.rb\", \"lib/carrierwave/orm/activerecord.rb\", \"lib/carrierwave/processing/mime_types.rb\", \"lib/carrierwave/processing/mini_magick.rb\", \"lib/carrierwave/processing/rmagick.rb\", \"lib/carrierwave/sanitized_file.rb\", \"lib/carrierwave/storage/abstract.rb\", \"lib/carrierwave/storage/file.rb\", \"lib/carrierwave/storage/fog.rb\", \"lib/carrierwave/test/matchers.rb\", \"lib/carrierwave/uploader/cache.rb\", \"lib/carrierwave/uploader/callbacks.rb\", \"lib/carrierwave/uploader/configuration.rb\", \"lib/carrierwave/uploader/default_url.rb\", \"lib/carrierwave/uploader/download.rb\", \"lib/carrierwave/uploader/extension_whitelist.rb\", \"lib/carrierwave/uploader/mountable.rb\", \"lib/carrierwave/uploader/processing.rb\", \"lib/carrierwave/uploader/proxy.rb\", \"lib/carrierwave/uploader/remove.rb\", \"lib/carrierwave/uploader/serialization.rb\", \"lib/carrierwave/uploader/store.rb\", \"lib/carrierwave/uploader/url.rb\", \"lib/carrierwave/uploader/versions.rb\", \"lib/carrierwave/uploader.rb\", \"lib/carrierwave/validations/active_model.rb\", \"lib/carrierwave/version.rb\", \"lib/carrierwave.rb\", \"lib/generators/templates/uploader.rb\", \"lib/generators/uploader_generator.rb\", \"README.md\"]\n  s.homepage = %q{https://github.com/jnicklas/carrierwave}\n  s.rdoc_options = [\"--main\"]\n  s.require_paths = [\"lib\"]\n  s.rubyforge_project = %q{carrierwave}\n  s.rubygems_version = %q{1.3.7}\n  s.summary = %q{Ruby file upload library}\n\n  if s.respond_to? :specification_version then\n    current_version = Gem::Specification::CURRENT_SPECIFICATION_VERSION\n    s.specification_version = 3\n\n```\nif Gem::Version.new(Gem::VERSION) >= Gem::Version.new('1.2.0') then\n  s.add_runtime_dependency(%q<activesupport>, [\">= 3.2.0\"])\n  s.add_runtime_dependency(%q<activemodel>, [\">= 3.2.0\"])\n  s.add_development_dependency(%q<mysql2>, [\">= 0\"])\n  s.add_development_dependency(%q<rails>, [\">= 3.2.0\"])\n  s.add_development_dependency(%q<cucumber>, [\"#<YAML::Syck::DefaultKey:0x10e3e14f8> 1.1.4\"])\n  s.add_development_dependency(%q<json>, [\">= 0\"])\n  s.add_development_dependency(%q<rspec>, [\"~> 2.0\"])\n  s.add_development_dependency(%q<sham_rack>, [\">= 0\"])\n  s.add_development_dependency(%q<timecop>, [\">= 0\"])\n  s.add_development_dependency(%q<fog>, [\">= 1.3.1\"])\n  s.add_development_dependency(%q<mini_magick>, [\">= 0\"])\n  s.add_development_dependency(%q<rmagick>, [\">= 0\"])\nelse\n  s.add_dependency(%q<activesupport>, [\">= 3.2.0\"])\n  s.add_dependency(%q<activemodel>, [\">= 3.2.0\"])\n  s.add_dependency(%q<mysql2>, [\">= 0\"])\n  s.add_dependency(%q<rails>, [\">= 3.2.0\"])\n  s.add_dependency(%q<cucumber>, [\"#<YAML::Syck::DefaultKey:0x10e3e14f8> 1.1.4\"])\n  s.add_dependency(%q<json>, [\">= 0\"])\n  s.add_dependency(%q<rspec>, [\"~> 2.0\"])\n  s.add_dependency(%q<sham_rack>, [\">= 0\"])\n  s.add_dependency(%q<timecop>, [\">= 0\"])\n  s.add_dependency(%q<fog>, [\">= 1.3.1\"])\n  s.add_dependency(%q<mini_magick>, [\">= 0\"])\n  s.add_dependency(%q<rmagick>, [\">= 0\"])\nend\n```\n\n  else\n    s.add_dependency(%q<activesupport>, [\">= 3.2.0\"])\n    s.add_dependency(%q<activemodel>, [\">= 3.2.0\"])\n    s.add_dependency(%q<mysql2>, [\">= 0\"])\n    s.add_dependency(%q<rails>, [\">= 3.2.0\"])\n    s.add_dependency(%q<cucumber>, [\"#YAML::Syck::DefaultKey:0x10e3e14f8 1.1.4\"])\n    s.add_dependency(%q<json>, [\">= 0\"])\n    s.add_dependency(%q<rspec>, [\"~> 2.0\"])\n    s.add_dependency(%q<sham_rack>, [\">= 0\"])\n    s.add_dependency(%q<timecop>, [\">= 0\"])\n    s.add_dependency(%q<fog>, [\">= 1.3.1\"])\n    s.add_dependency(%q<mini_magick>, [\">= 0\"])\n    s.add_dependency(%q<rmagick>, [\">= 0\"])\n  end\nend\nWARNING:  Invalid .gemspec format in '/Library/Ruby/Gems/1.8/specifications/carrierwave-0.6.2.gemspec'\nCould not find carrierwave-0.6.2 in any of the sources\n\nThis is my list of gemfiles:\n\nUsing rake (0.9.2.2) \nUsing i18n (0.6.0) \nUsing multi_json (1.2.0) \nUsing activesupport (3.2.1) \nUsing builder (3.0.0) \nUsing activemodel (3.2.1) \nUsing erubis (2.7.0) \nUsing journey (1.0.3) \nUsing rack (1.4.1) \nUsing rack-cache (1.2) \nUsing rack-test (0.6.1) \nUsing hike (1.2.1) \nUsing tilt (1.3.3) \nUsing sprockets (2.1.2) \nUsing actionpack (3.2.1) \nUsing mime-types (1.18) \nUsing polyglot (0.3.3) \nUsing treetop (1.4.10) \nUsing mail (2.4.4) \nUsing actionmailer (3.2.1) \nUsing arel (3.0.2) \nUsing tzinfo (0.3.33) \nUsing activerecord (3.2.1) \nUsing activeresource (3.2.1) \nUsing bcrypt-ruby (3.0.1) \nUsing bundler (1.0.10) \nUsing cancan (1.6.7) \nInstalling carrierwave (0.6.2) \nUsing coffee-script-source (1.2.0) \nUsing execjs (1.3.0) \nUsing coffee-script (2.2.0) \nUsing rack-ssl (1.3.2) \nUsing json (1.6.6) \nUsing rdoc (3.12) \nUsing thor (0.14.6) \nUsing railties (3.2.1) \nUsing coffee-rails (3.2.2) \nUsing orm_adapter (0.0.7) \nUsing warden (1.1.1) \nUsing devise (2.0.4) \nUsing gli (1.6.0) \nUsing jquery-rails (2.0.2) \nUsing rest-client (1.6.7) \nUsing ya2yaml (0.31) \nUsing localeapp (0.4.3) \nUsing mysql (2.8.1) \nUsing rails (3.2.1) \nUsing rails-i18n (0.6.2) \nUsing sass (3.1.15) \nUsing sass-rails (3.2.5) \nUsing sqlite3 (1.3.5) \nUsing uglifier (1.2.4) \nUsing web-app-theme (0.8.0) from git://github.com/pilu/web-app-theme.git (at master) \n- ruby --version\n  ruby 1.8.7 (2010-01-10 patchlevel 249) [universal-darwin10.0]\n  Getting this error on uploading a file with 0.5.8 and fog 1.3.1  Any ideas?\n Hey man,  I'm on rails 3.0.9 app and not sure it will allow me to upgrade to 0.6.0.  Can you give a suggestion for doing so?\n Can't right now.  Would like to but don't have the time or money.  I have spent a bunch of time upgrading to carrier wave from paperclip and doing multiple file uploads.  The performance is really really bad.  I'm talking 50-100 seconds to upload about 8 MB of files.  I can't figure out and hoped an upgraded version of carrier wave would work.  was there any issues that you can recall from 0.5.8?\n Going to try a few things here and will let you know if i come up with anything :)  Thanks ...been a long week.\n btw..do you know what the version of fog is to be used with 0.5.8.  0.9.0 works well but 1.3.1 throws that to_file error\n cool thanks.  going to upgrade soon but wanted to get past this stuff first\n  Hello. We are getting an issue where ReprocessJobs are failing with a File Exists error. Setup is Heroku App with Resque running the image process jobs, but the error is coming from Carrierwave. I'm assuming there might be an issue with running these jobs in parallel. It seems to happen more since upgrading from 0.5.9, I cannot confirm or deny claims it was happening prior to last week when the upgrade was performed.\n\nIs it not recommended to run multiple reprocess jobs on the same machine or is there a configuration/code step I am missing to safely have run these reprocess jobs in parallel?\n\nWe are using carrierwave 0.6.2 and carrierwave-mongoid 0.2.0 with Fog S3 configuration. Let me know if there are any other configuration elements that would help diagnose. I will carry on looking into it on our app. \n\n```\nFile exists - /app/public/uploads\n/usr/local/lib/ruby/1.9.1/fileutils.rb:243:in `mkdir'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:243:in `fu_mkdir'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:217:in `block (2 levels) in mkdir_p'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:215:in `reverse_each'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:215:in `block in mkdir_p'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:201:in `each'\n/usr/local/lib/ruby/1.9.1/fileutils.rb:201:in `mkdir_p'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:282:in `mkdir!'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/sanitized_file.rb:203:in `copy_to'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/uploader/cache.rb:121:in `block in cache!'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/uploader/cache.rb:112:in `cache!'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/uploader/cache.rb:76:in `cache_stored_file!'\n/app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.6.2/lib/carrierwave/uploader/versions.rb:174:in `recreate_versions!'\n/app/vendor/our_app/app/jobs/image_reprocess_job.rb:8:in `perform'\n```\n  I would like to manually set the location of an asset, ie. http://example.com/example.png, and save the model, without carrierwave downloading the image. \n\nThe reason is that the image is already stored in my own S3 bucket, and I'm already using the same S3 bucket with my carrierwave upload and fog, so all it is doing is downloading it and then uploading it again. Also, I'm not performing any post-upload processing of the file, so downloading really is unnecessary. So, I only have 1 version of the file, and it's already in a location where carrierwave/fog can fetch it. I would, however, like to continue to use carrierwave/fog because it offers nice getter methods for my assets from S3.\n\nI am using the remote_path_url method to set the url, but I know that carrierwave fetches the image before uploading it/storing it. Of course it makes sense that carrierwave should do that 99% of the time, but this is the 1%. \n\nI have  tried overwriting the setter method in the model, but that didn't seem to persist for some reason. Is there a way to easily do this with carrierwave that you can think of?\n  I just noticed that the quality of the thumbnails generated in my case is really bad. After playing with the settings of my uploader, it seems that the only thing that fixes it is making sure to use ImageMagick instead of GraphicsMagick.\n\nAny ideas why that would be? Could it be a problem with MiniMagick?\n Opened the issue here https://github.com/probablycorey/mini_magick/issues/83\n  i have tried this receipt\n- https://github.com/jnicklas/carrierwave/wiki/How-to:-Delete-cache-garbage-directories (first one)\n\nbut temp folders were not deleted by FileUtils.rm_rf.\nif i change it to Dir.delete i have an error - specified directory doesn't exist\n\ni think it happens because  @cache_id_was = cache_id var doesn't define correctly\n\nany suggestions, fixes? maybe i miss something?\n\nthanks in advance\n  Making sure #586 is not forgotten. Its pull request was closed because the fix wasn't comprehensive but the issue itself remains and bensie was able to reproduce it.\n\nRunning under rails 3.0.10 and with carrierwave 0.5.6 I wasn't experiencing that problem with german umlauts. Now with rails 3.2.2 and carrierwave 0.6.1 I get that mini_magick_processing_error as well. Using mini_magick 3.4 in both cases.\n  Hi,\n\nRunning rails 2.3.8 app here, so needed to use this branch.  I'm trying to save a file and getting this error:\n\nCarrierWave::FormNotMultipart (You tried to assign a String or a Pathname to an uploader, for security reasons, this is not allowed.\n\n If this is a file upload, please check that your upload form is multipart encoded.)\n\nHere's the params list:\n\n``` ruby\n{\"convicted_of_mis\"=>\"no\",\n \"multipart\"=>\"true\",\n \"commit\"=>\"Continue\",\n \"authenticity_token\"=>\"Jk7fNxop7nFG+oHaJiIcBxgWIjpC8eltNGhKvUh8AGw=\",\n \"employed\"=>\"not previously employed\",\n \"disciplined_or_investigated\"=>\"No\",\n \"id\"=>\"application_form\",\n \"legal_to_work_in_usa\"=>\"yes\",\n \"sixteen_or_older\"=>\"yes\",\n \"email\"=>{\"uploaded_data\"=>\"Comcast_Business_Solutions_.pdf\",\n \"employer3_telephone\"=>\"\",\n \"employer3_start_date\"=>\"\",\n \"phone1\"=>\"7152204400\"}\n```\n\nand so on.\n\nIt's a huge form that is not connected to a model.  The client wanted an online job application, but didn't want to save anything.  So, the app grabs all the values, puts them into an email, and sends them along.  Now they want to have to ability to have a job applicant upload a resume.  Here's the top of the form_tag:\n\n``` erb\n<% form_tag(:controller => 'emailer', :action => 'sendmail', :id => 'application_form', :multipart => true ) do  -%>\n```\n\nIn my controller I have:\n\n``` ruby\n resume   = ResumeUploader.new \n      #resume  = File.open(File.join(Rails.root,\"tmp/#{email['uploaded_data']}\"))\n      resume.cache!(email[\"uploaded_data\"])\n```\n\nI've tried resume.save!() as well, and got the same error.  I read somewhere online that using the File.join commented out line will help with automated tests, so I gave it a try and said it can't find the file, which I guess makes sense if it's not getting uploaded.  Here is part of my uploader.rb file:\n\n``` ruby\nstorage :file\n  #     storage :s3\n  def cache_dir\n    \"#{RAILS_ROOT}/tmp\"\n  end\n\n  # Override the directory where uploaded files will be stored\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    #\"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n    \"#{RAILS_ROOT}/tmp/\"\n  end\n```\n\nI love this gem, but have never needed to make it do what I'm trying to do in this case.  Any help / advice would be appreciated.  Is there a way to disable the error method?\n\nThanks.\n  what about ftp storage like in paperclip: https://github.com/cdamian/paperclipftp\n\nlooks not so complicated: https://github.com/cdamian/paperclipftp/blob/master/lib/paperclipftp.rb\n  Hi. \n\nI have noticed that the order that fields appear in on a form can affect whether the field values are set in the model variable that is accessible in the uploader.\n\nto reproduce:\nput a field w/ carrierwave on a model. create a form field like so. in this case a Doc object \n\n``` ruby\n\n= form_for(@doc, :html => {:multipart => true, :class => 'form-vertical'}) do |f|\n  %fieldset\n    -if @doc.errors.any?\n      .alert.alert-block.alert-error\n        %h4.alert-heading\n          = \"#{pluralize(@doc.errors.count, \"error\")} prohibited this doc from being saved:\"\n        %ul\n          - @doc.errors.full_messages.each do |msg|\n            %li= msg\n    .control-group\n      = f.label :name, :class => 'control-label'\n      .controls\n        = f.text_field :name\n    .control-group\n      =f.label :filetype, :class => 'control-label'\n      =f.select :filetype, Doc::FILE_TYPE\n    .control-group\n      =f.label :file, 'URL or upload file', :class => 'control-label'\n      .controls\n        =f.text_field :remote_file_url, :class => 'input', :placeholder => 'http://example.com/doc.pdf'\n        or\n        =f.file_field :file, :class => 'input-small'\n    .control-group\n      =f.label :state, :class => 'control-label'\n      =f.select :state, us_states, :include_blank => 'None'\n    .control-group\n      = f.label :description, :class => 'control-label'\n      .controls\n        = f.text_area :description, :class => 'input-xlarge', :rows => '5'\n\n    = f.submit 'Save', :class => 'btn btn-primary'\n```\n\ncreate the following function in the uploader to read out the model variables\n\n``` ruby\n\n  def create_pdf_version\n    puts \"============== #{model.filetype}====== #{model.name}========= #{model.state}=====#{model.description}\"\n    #some code that creates a pdf file in different ways based on the model.filetype\n  end\n\n  version :pdf do\n    process :create_pdf_version\n  end\n```\n\nyou'll notice that all the attributes in the form above the file field is set (and prints out in the puts line) but all the attributes below the file field (in this case state, description) are not set.\n\nyou can change what gets set by moving the file field higher or lower on the form.\n\nruby 1.9.3 rails 3.2.3\n  As discussed at https://groups.google.com/forum/?fromgroups#!topic/carrierwave/AYd-n3DrJKU\n To summarize the mailing list discussion, the problem here is that CW writes the images with no options **after** the user may have written it in the block to `manipulate!`. \n\nHere is an example from the wiki (https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Specify-the-image-quality ):\n\n```\n  manipulate! do |img|\n    img.write(current_path){ self.quality = percentage } unless img.quality == percentage\n    img = yield(img) if block_given?\n    img\n  end\n```\n\nAfter `manipulate!` has yielded to the code block, it writes the image again (lib/carrierwave/processing/rmagick.rb:269)\n\n```\n  if options[:format]\n    frames.write(\"#{options[:format]}:#{current_path}\", &write_block)\n  else\n    frames.write(current_path, &write_block)\n  end\n```\n\nThis is not a problem for the \"quality\" attribute, but the interlace option is not carried on between write calls. \n\nSo maybe the user should be allowed to pass options back to the write call? Here is one idea for how this could look: \n\n```\n  @instance.manipulate! do |img, index, options|\n    options[:write] = {\n      :quality => 50,\n      :depth => 8\n    }\n    img\n  end\n```\n\nThoughts? \n  I'm trying to us an uploader directly, without being mounted into a model to upload a generated image:\n\n``` ruby\n\nfile = image.write \"tmp/#{figure.id}.jpg\"\n\nuploader = FigureUploader.new project\nuploader.store! file\n\nputs uploader.url\n\n```\n\nThe uploader-url is always nil then, both with storage :fog and storage :file. \n\nDoes this work asynchronous? Magically? This only happens in a spec, when I switch to the console and test the uploader manually, the url is filled and points to the right file. Is Fog.mock!ed by default in tests?! \n  The idea I had was to have an extension black list to eliminate files that you wouldn't want to have uploaded, Say like an .eml, .tmp, .jar, .zip file uploaded.  I might try to add this if anyone thinks it is a great idea and would want to include it.  Thanks!\n Hey James. Is there anyway to unmount and remount an uploader. Wanted\nto migrate data to a new model and then mount the uploader and\nrecreate versions.\n\nBrian Bokor\nSent from my iPhone\n\nOn Apr 18, 2012, at 4:04 PM, James Miller\nreply@reply.github.com\nwrote:\n\n> Yes please do! It's been requested a number of times in the past. Just open a new pull request when it's ready. Thanks!\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/709#issuecomment-5207412\n I have put the mount on my model but I wanted to move my images from one model to another.  I was hoping to move the image field (filename) from one field to the next without having the uploader then add the uploader and recreate_versions after that was done.  If I do the following it won't migrate\n\n``` ruby\nmount_uploader :avatar, AvatarUploader\n```\n\nif I do the following it will move the field and I can reprocess all images.  Thinking it might be a bug but not sure yet\n\n``` ruby\nmount_uploader :avatar, AvatarUploader, :mount_on => :image\n```\n Figured out what I needed for the migration\n\n``` ruby\n      photo = Photo.create(:attachable => object) #Polymorphic\n      photo.write_uploader(:image, object.photo)\n      photo.save!\n```\n James,\n\n```\nI'm working with Engine Yard and my environment has a App server, DB Server and Utility Server.  I would like to store cache files on the utility server.  Do you know how I might go about customizing Carrierwave to do this?  I'm really in a bad spot now and would appreciate any guidance on this...thank you so much!\n```\n\nBrian Bokor \nOwner :: Designwaves, LLC\n919-341-9583\nhttp://www.designwaves.com \n\nOn Apr 18, 2012, at 4:04 PM, James Miller wrote:\n\nYes please do! It's been requested a number of times in the past. Just open a new pull request when it's ready. Thanks!\n\n---\n\nReply to this email directly or view it on GitHub:\nhttps://github.com/jnicklas/carrierwave/issues/709#issuecomment-5207412\n Thanks...using S3 already but wanted to do background jobs for the processing and storing.  Carrierwave-backgrounder works well but not for an environment like i have now.  Can't access the files on the application server\n Oh that might work.  How would I defer the processing to the utility server for the additional processing?  I think that is what I'm really trying to do.\n James thank you so much!  I really really appreciate you helping me on this.  I'm working for a non-profit and really could use another developer or two.  I'm trying to do so much myself and can't always get everything done myself.  You have been more than helpful.  Means a lot to me :)\n  This add a new uploader configuration option :directory_permissions\nwhich allows to set the permissions of directories created by the\nuploader.\n\nThis does NOT modify the permissions of existing directories cause\nthat could be potentially harmful.\n\nI've also added and fixed relevant specs.\n\nI needed this for a project were both a rails app and a daemon are using the same uploader but are running under different users of the same group.\n\nThe changes are a bit too much repetitive for my taste, so I'm open for suggestions on how to do it better without breaking backwards compatibility.\n I also fixed a few specs that set Uploader config.permission to 777 decimal, when 0777 was the intended setting.\n @bensie done.\n This pull request [passes](http://travis-ci.org/jnicklas/carrierwave/builds/1168277) (merged 26a4d343 into b038398b).\n Thanks!\n  Hi,\n\nI was trying out the `remote_url` functionality in my app when I realized there were no validation errors for downloads. Here's a patch that includes a `DownloadError` validation for remote files, in the same vein as the existing `ProcessingError` and `IntegrityError` validations. It works out of the box, with no additional configuration necessary.\n\nOne conscious design decision was to attach the error messages to the original column rather than the `remote_url` column. If the error is attached on the `remote_url` column, the original column could still show other validation errors (eg. 'cant be blank' w/ `validates_presence_of`). On one hand, it's nice to see the error on the field that caused it, on the other it's nice not to have two messages for the same error. Couldn't decide, so I chose the latter.\n This pull request [passes](http://travis-ci.org/jnicklas/carrierwave/builds/1168128) (merged 758b669a into 574e79c8).\n Squashed all the commits into one, but for some reason it's including a whole bunch of other prior commits as part of the pull request. Might have been caused by a '''git push -f''' on my end. Does this merge cleanly for you?\n  Hello,\n\nI am using jQuery File Upload together with Carrierwave for uploading images.\n\nI managed to make it working by following this manual and it works perfectly well for uploading single images, but once I add HTML5 multiple attribute to allow uploading multiple images at once and select multiple images, I get following error on each request.\n\nNoMethodError in Advertiser::MediaController#create\nundefined method `[]' for nil:NilClass\n\nEvery request seems absolutely same to me and I can't seem to figure out why it can't upload multiple images but can upload single images, please note that if I have multiple attribute enabled, I can't even upload a single image but once I take it off, uploading works once again. jQuery File Upload is perfectly capable of uploading multiple images and you can check it out in their demo.\n\nAny hints on where to dig would be very much appreciated.\n\nThank you in advance.\n  Most of the releases are tagged, but release `v0.6.2` is not.\n\nSome of the releases are tagged with the format `vX.Y.Z`, but most are tagged with the format `X.Y.Z`.\n\nAll releases should be tagged - including `v0.6.2` - and they should all be tagged in the same format - conventionally `vX.Y.Z` with the `v` prefix.\n Thanks!\n  I have a requirement to dynamically set the FOG bucket within carrierwave based on the logged in user.  At this point, I have not seen a way to do this and wanted to see if this could be included in a roadmap? \n  Consider a model with the following default scope:\n\n```\nclass Task < ActiveRecord::Base\n    default_scope where(active: true)\nend\n```\n\nIf I try and run a file upload on an object with active = false I get the following error:\n\n```\nCouldn't find Task with id=137 [WHERE \"tasks\".\"active\" = 't']\n....\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:245:in `find_previous_model_for_card_image'\ncarrierwave (0.5.8) lib/carrierwave/mount.rb:240:in `store_previous_model_for_card_image'\n```\n bensie,  Sorry I wasn't more clear.  This only happens when there is a file upload through carrierwave.  A normal update of any other fields in the model works fine.\n\nThe issue is in this bit of code in lib/carrierwave/mount.rb\n\n```\n def find_previous_model_for_#{column}\n     self.class.find(to_key.first)\n end\n```\n\nWhen an object is outside of the self.class default scope, this line can't find it.\n\nI did a fork and a quick hack to \n\n```\n def find_previous_model_for_#{column}\n     self.class.unscoped.find(to_key.first)\n end\n```\n\nAnd it works. I'm not sure this is the best way to fix it, but the problem is definitely down to this block of code.\n  Starting with version 0.6.0, if you use an cache with versions when you go to save the object carrier wave can't find the versions.\n\nIn version 0.5.8 all the versions are placed in the same temporary folder.  Starting in version 0.6.0 it puts the versions in separate temporary folders.\n I assume this refers to #686 but there is no response.\n I will have to pull the fix and see.  What I noticed was with version 0.5.8 each version is stored in the same temporary directory.\n\nAfter 0.6.0 it stores each version is a separate directory each with a unique name.  It seems to find the version when I go to display it, but it is expecting to find all the versions in the folder the base file was in rather than all the separate folders.  \n\nNot even sure how it would know about all the separate folders on resubmit since each is a random based on timestamp.\n\nThis problem manifests itself when you implement the example where it saves the file on form submit and you have any versions defined, so it should be pretty easy to get a test case.\n I've tried the fix and it seems to work perfectly :)\n\nMany thanks!\n I verified this pull request will fix this issue as well\n  Hi James,\n\nThis is the follow up to https://github.com/jnicklas/carrierwave/pull/691.\n No problem, thanks for merging. Code got a lot messier, made me appreciate how much has improved in 1.9.\n  I was seeing the problem where all of my uploaded S3 assets were using https in the urls.  Looking at the code it seems that when no host is specified the url is always going to be https.\n\n``` ruby\n        def public_url\n          if host = @uploader.fog_host\n            if host.respond_to? :call\n              \"#{host.call(self)}/#{path}\"\n            else\n              \"#{host}/#{path}\"\n            end\n          else\n            # AWS/Google optimized for speed over correctness\n            case @uploader.fog_credentials[:provider]\n            when 'AWS'\n              # if directory is a valid subdomain, use that style for access\n              if @uploader.fog_directory.to_s =~ /^(?:[a-z]|\\d(?!\\d{0,2}(?:\\d{1,3}){3}$))(?:[a-z0-9]|(?![\\-])|\\-(?![\\.])){1,61}[a-z0-9]$/\n                \"https://#{@uploader.fog_directory}.s3.amazonaws.com/#{path}\"\n              else\n                # directory is not a valid subdomain, so use path style for access\n                \"https://s3.amazonaws.com/#{@uploader.fog_directory}/#{path}\"\n              end\n            when 'Google'\n              \"https://commondatastorage.googleapis.com/#{@uploader.fog_directory}/#{path}\"\n            else\n              # avoid a get by just using local reference\n              directory.files.new(:key => path).public_url\n            end\n          end\n        end\n```\n\nIs there any reason why the public url is using always https?  I would think that http would be a more reasonable default?\n Ok, cool.  Just wanted to make sure that there wasn't some other good reason for using https over http that I was not aware of.  I'll fork and put in a pull request.\n As a side note, what was really confusing when debugging this was that the above code was in storage/fog.rb and there is also a storage/s3.rb.\n\nIn s3.rb, the public_url looks like:\n\n``` ruby\ndef public_url\n          scheme = use_ssl? ? 'https' : 'http'\n          if cnamed?\n            [\"#{scheme}://#{bucket}\", path].compact.join('/')\n          else\n            [\"#{scheme}://#{bucket}.s3.amazonaws.com\", path].compact.join('/')\n          end\n        end\n```\n\nSo apparently there are 2 implementations of s3 storage, one in fog.rb and one in s3.rb.  The s3.rb implementation checks for the config option s3_use_ssl, whereas the fog.rb ignores this option.  This was very confusing since I was setting s3_use_ssl to false and not seeing any result.\n\nSo I'm thinking of changing the fog.rb implementation to also check s3_use_ssl. I'll send a pull request when ready.\n  Hi,\n\nI needed a way to extract the cover of a PDF as a separate version. \n\nUnfortunately, the current multi-page PDF support in the RMagick processor lets you either generate all pages as separate images or one vertically-joined image. \n\nThis patch allows you to accept an additional parameter, zero-indexed page number, from the `manipulate!` block. \n\nYou can then write a custom processor like this:\n\n``` ruby\ndef cover \n  manipulate! do |frame, index|\n    frame if index.zero?\n  end\nend\n```\n\nSingle page PDFs and regular images will receive `index = 0`, and existing processors can ignore the index parameter. This patch should also work for other multi-frame files, such as animated GIFs.\n  I have a rails app which uploads some images to S3. My user is able to export all his pictures to a zip. In order to achieve this I first have to download all images and later zip them up.\n\nWhen I run this routine however:\n\n``` ruby\nphotos.each do |photo|\n  path = photo.photo.path\n  file_path = zip_path + \"/\" + path\n  FileUtils.mkdir_p(File.dirname(file_path))\n  File.open(file_path, 'wb') do |file|\n    file.write photo.photo.file.read\n  end\nend\n```\n\nMy application experiences an incredible increase in memory usage. Is there a way to prevent this?\n\nPhoto is a active record class with a PhotoUploader mounted.\n  When using avatar_cache in order to display the uploaded file in case of a form redisplay, if a validation error actually occurs, the temporary file is displayed correctly.\n\nAfter the form is submitted again and the model is now valid and gets saved, though, only a copy of the original file is saved; not all the versions i created.\n\nTo make an example, i only have\n\n```\npublic/system/user/avatar/3/20120331_172312.jpg\n```\n\nwhile I would expect to have\n\n```\npublic/system/user/avatar/3/medium_20120331_172312.jpg\npublic/system/user/avatar/3/thumb_20120331_172312.jpg\npublic/system/user/avatar/3/list_20120331_172312.jpg\n```\n\nThis is my AvatarUploader\n\n```\n# encoding: utf-8\nclass AvatarUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n  include Sprockets::Helpers::RailsHelper\n  include Sprockets::Helpers::IsolatedHelper\n\n  storage :file\n\n  def store_dir\n    \"system/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  def default_url\n    asset_path(\"avatar-#{version_name}-default.jpg\")\n  end\n\n  version :medium do\n    process :resize_to_fill => [200, 200]\n  end\n\n  version :thumb, :from_version => :medium do\n    process :resize_to_fill => [80, 80]\n  end\n\n  version :list, :from_version => :thumb do\n    process :resize_to_fill => [32, 32]\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n```\n I have the exact same problem, I'm uploading images as nested resources and using image_cache to retain uploads on validation errors on the parent resource: After fixing validation errors on the parent and saving I end up with no versions although the nested image is saved.\n\nI also noted that other processing hooks are also skipped, eg. I have:\n\n```\nprocess :update_checksum\ndef update_checksum\n  model.checksum = crc32\nend\n```\n\nAnd this code is not called, if the image is instantiated from image_cache (crc32 is a method on the ImageUploader that calculates crc32 using Zlib).\n\nI'm using carrierwave 0.6.0 with rails 3.2.3.\n Update: This problem is fixed by gh-686\n  This issue happens only when I set **\"storage :fog\"** in my Uploader class. When \"storage :file\" is set, everything goes fine.\n\nI have a form with a \"two-step submission\" where the first step handles the image upload and the second one handles image cropping. I'm using `image_cache` as a hidden_field in my form in order to achieve that.\n\nI also set `config.delete_tmp_file_after_storage = false` in my fog.rb initializer to see what's going on with the temp files:\n\n In the first submission, CW caches the files in the following directories:\n\n```\n.../public/uploads/tmp/20120409-1646-23999-2221/medium_IMG.JPG\n.../public/uploads/tmp/20120409-1646-23999-9408/IMG.JPG\n```\n\nBut, in the second submission, it tries to get the \"medium_IMG.JPG\" file from the wrong directory (please see full trace below). Actually, when `storage :file` is set, CW caches another two files (because of the second step form submission) and everything works. But with `storage :fog`, CW doesn't cache the files again.\n\n```\nErrno::ENOENT in AvatarsController#update\n\nNo such file or directory - .../public/uploads/tmp/20120409-1646-23999-9408/medium_IMG.JPG\n\ncarrierwave (0.6.1) lib/carrierwave/sanitized_file.rb:157:in `initialize'\ncarrierwave (0.6.1) lib/carrierwave/sanitized_file.rb:157:in `open'\ncarrierwave (0.6.1) lib/carrierwave/sanitized_file.rb:157:in `read'\ncarrierwave (0.6.1) lib/carrierwave/storage/fog.rb:251:in `store'\ncarrierwave (0.6.1) lib/carrierwave/storage/fog.rb:84:in `store!'\ncarrierwave (0.6.1) lib/carrierwave/uploader/store.rb:59:in `block in store!'\ncarrierwave (0.6.1) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\ncarrierwave (0.6.1) lib/carrierwave/uploader/store.rb:58:in `store!'\ncarrierwave (0.6.1) lib/carrierwave/uploader/versions.rb:237:in `block in store_versions!'\ncarrierwave (0.6.1) lib/carrierwave/uploader/versions.rb:237:in `each'\ncarrierwave (0.6.1) lib/carrierwave/uploader/versions.rb:237:in `store_versions!'\ncarrierwave (0.6.1) lib/carrierwave/uploader/callbacks.rb:18:in `block in with_callbacks'\ncarrierwave (0.6.1) lib/carrierwave/uploader/callbacks.rb:18:in `each'\ncarrierwave (0.6.1) lib/carrierwave/uploader/callbacks.rb:18:in `with_callbacks'\ncarrierwave (0.6.1) lib/carrierwave/uploader/store.rb:58:in `store!'\ncarrierwave (0.6.1) lib/carrierwave/mount.rb:345:in `store!'\ncarrierwave (0.6.1) lib/carrierwave/mount.rb:217:in `store_image!'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:427:in `_run__767968874__save__101160981__callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactiverecord (3.2.1) lib/active_record/callbacks.rb:264:in `create_or_update'\nactiverecord (3.2.1) lib/active_record/persistence.rb:84:in `save'\nactiverecord (3.2.1) lib/active_record/validations.rb:50:in `save'\nactiverecord (3.2.1) lib/active_record/attribute_methods/dirty.rb:22:in `save'\nactiverecord (3.2.1) lib/active_record/transactions.rb:241:in `block (2 levels) in save'\nactiverecord (3.2.1) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'\nactiverecord (3.2.1) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.2.1) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.2.1) lib/active_record/transactions.rb:241:in `block in save'\nactiverecord (3.2.1) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'\nactiverecord (3.2.1) lib/active_record/transactions.rb:240:in `save'\nactiverecord (3.2.1) lib/active_record/persistence.rb:213:in `block in update_attributes'\nactiverecord (3.2.1) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nactiverecord (3.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'\nactiverecord (3.2.1) lib/active_record/transactions.rb:208:in `transaction'\nactiverecord (3.2.1) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nactiverecord (3.2.1) lib/active_record/persistence.rb:211:in `update_attributes'\napp/controllers/avatars_controller.rb:31:in `update'\nactionpack (3.2.1) lib/action_controller/metal/implicit_render.rb:4:in `send_action'\nactionpack (3.2.1) lib/abstract_controller/base.rb:167:in `process_action'\nactionpack (3.2.1) lib/action_controller/metal/rendering.rb:10:in `process_action'\nactionpack (3.2.1) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:436:in `_run__278112054__process_action__317663717__callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.1) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.2.1) lib/action_controller/metal/rescue.rb:29:in `process_action'\nactionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.2.1) lib/active_support/notifications.rb:123:in `block in instrument'\nactivesupport (3.2.1) lib/active_support/notifications/instrumenter.rb:20:in `instrument'\nactivesupport (3.2.1) lib/active_support/notifications.rb:123:in `instrument'\nactionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.2.1) lib/action_controller/metal/params_wrapper.rb:205:in `process_action'\nactiverecord (3.2.1) lib/active_record/railties/controller_runtime.rb:18:in `process_action'\nactionpack (3.2.1) lib/abstract_controller/base.rb:121:in `process'\nactionpack (3.2.1) lib/abstract_controller/rendering.rb:45:in `process'\nactionpack (3.2.1) lib/action_controller/metal.rb:203:in `dispatch'\nactionpack (3.2.1) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.2.1) lib/action_controller/metal.rb:246:in `block in action'\nactionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `call'\nactionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `dispatch'\nactionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:30:in `call'\njourney (1.0.1) lib/journey/router.rb:68:in `block in call'\njourney (1.0.1) lib/journey/router.rb:56:in `each'\njourney (1.0.1) lib/journey/router.rb:56:in `call'\nactionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:589:in `call'\nwarden (1.1.0) lib/warden/manager.rb:35:in `block in call'\nwarden (1.1.0) lib/warden/manager.rb:34:in `catch'\nwarden (1.1.0) lib/warden/manager.rb:34:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nrack (1.4.1) lib/rack/etag.rb:23:in `call'\nrack (1.4.1) lib/rack/conditionalget.rb:35:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/head.rb:14:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/flash.rb:242:in `call'\nrack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'\nrack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/cookies.rb:338:in `call'\nactiverecord (3.2.1) lib/active_record/query_cache.rb:64:in `call'\nactiverecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:405:in `_run__846527525__call__101160981__callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'\nactivesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'\nactionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:27:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/reloader.rb:65:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'\nrailties (3.2.1) lib/rails/rack/logger.rb:26:in `call_app'\nrailties (3.2.1) lib/rails/rack/logger.rb:16:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/request_id.rb:22:in `call'\nrack (1.4.1) lib/rack/methodoverride.rb:21:in `call'\nrack (1.4.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.2.1) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.4.1) lib/rack/lock.rb:15:in `call'\nactionpack (3.2.1) lib/action_dispatch/middleware/static.rb:53:in `call'\nrailties (3.2.1) lib/rails/engine.rb:479:in `call'\nrailties (3.2.1) lib/rails/application.rb:220:in `call'\nrack (1.4.1) lib/rack/content_length.rb:14:in `call'\nrailties (3.2.1) lib/rails/rack/log_tailer.rb:14:in `call'\nrack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'\n/home/rafael/.rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/home/rafael/.rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n/home/rafael/.rvm/rubies/ruby-1.9.2-p318/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n```\n\nParameters:\n\n```\n{\"utf8\"=>\"\u2713\",\n \"_method\"=>\"put\",\n \"authenticity_token\"=>\"GOWxcQqMOvkPyyZNU8xF/Fx2TMIHXU6TgGCvjPpJ4eg=\",\n \"avatar\"=>{\"image_cache\"=>\"20120409-1646-23999-9408/IMG.JPG\",\n \"crop_x\"=>\"0\",\n \"crop_y\"=>\"0\",\n \"crop_w\"=>\"470\",\n \"crop_h\"=>\"470\"},\n \"commit\"=>\"Update\",\n \"locale\"=>\"en\",\n \"user_id\"=>\"2\"}\n```\n\napp/uploaders/image_uploader.rb\n\n``` ruby\nclass ImageUploader < CarrierWave::Uploader::Base\n\n  include CarrierWave::RMagick\n\n  storage :fog\n  #storage :file\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process :scale => [470, nil]\n\n  def scale(width, height)\n    resize_to_limit(width, height) if model.valid?\n  end\n\n  version :medium do\n    process :crop\n    resize_to_fill(150,150)\n  end\n\n  def crop\n    if model.crop_x.present?\n      resize_to_limit(470, nil)\n      manipulate! do |img|\n        x = model.crop_x.to_i\n        y = model.crop_y.to_i\n        w = model.crop_w.to_i\n        h = model.crop_h.to_i\n        img.crop!(x, y, w, h)\n      end\n    end\n  end\n\n  def extension_white_list\n     %w(jpg jpeg gif png)\n  end\n\nend\n```\n\n/app/models/avatar.rb\n\n``` ruby\nclass Avatar < ActiveRecord::Base\n\n  mount_uploader :image, ImageUploader\n\n  belongs_to  :avatarable, :polymorphic => true\n\n  attr_accessor :crop_x, :crop_y, :crop_w, :crop_h\n\n  after_save :crop_image\n\n  def crop_image\n    image.recreate_versions! if crop_x.present?\n  end\n\nend\n```\n\nI tried to investigate further but I'm not too experienced with Rails/Ruby...\n I've got this exact same issue. I'm trying out master right now to see if it works.\n Yep, that worked.\n I digged in the code and figured out a solution. The code above is a simplified version of the one I'm working on, which generates versions conditionally when the second submission occurs using `recreate_versions!`. I guess this is related to #571. So, I applied two modifications regarding:\n\n1) `store!` in Fog class tries to store files that are not cached (that's why I was getting the Errno::ENOENT error)\n2) `cache_stored_file!` may raise \"TypeError Exception: can't convert File into String\" if storage is set to Fog \n\nAs I'm not much experienced, I don't feel comfortable to evaluate if this solution is reasonable (probably is not an elegant one), but it seems to work here. I will let the issue opened if someone would like to comment something...\n\n``` ruby\nmodule CarrierWave\n  module Storage\n    class Fog < Abstract\n      def store!(file)\n        f = CarrierWave::Storage::Fog::File.new(uploader, self, uploader.store_path)\n        f.store(file) if file.size > 0\n        f\n      end\n    end\n  end\n\n  module Uploader\n    module Cache\n      def cache_stored_file!\n        opened_file = file.read.is_a?(String) ? file : File.open(file.read)\n        sanitized = SanitizedFile.new :tempfile => StringIO.new(opened_file.read),\n                                      :filename => File.basename(path),\n                                      :content_type => file.content_type\n        cache! sanitized\n      end\n    end\n  end\nend\n```\n @bensie you were pretty fast handling the issue! lol #686 didn't worked for me, maybe because of my conditional versions... But thanks anyway!\n I had a similar issue with model validation errors, fog storage, and the cache files. With the recent gem updates, things seem to be working ok even after a validation error. However, some process methods weren't being called/reprocessed. Had to do the following to reprocess things after a validation error and when the file is already cached:\n\n```\nafter :retrieve_from_cache, :do_something_to_model\n```\n  I recently ran into a problem when trying to add both [Carrierwave](https://github.com/jnicklas/carrierwave) and [Tire](https://github.com/karmi/tire) to one of my models. The problem seems to be caused by the `serializable_hash` method which is used by both gems. I have included a link to the related SO post:\n\nhttp://stackoverflow.com/questions/9961477/carrierwave-tire-conflicting\n   It's worth to be mentioned what that bug makes impossible to retrieve cached versions if instance saving failed.\n +1 This fixes the problem for me.\n +1 Please pull this change, versions 0.6.x are broken pretty badly without it IMO\n  If there's a plus in, say, an S3 signed request generated by fog, and it gets unescaped, you'll get a 403 when you try and hit it.\n\nI was getting similar symptoms to #294 whenever my signed requests to S3 had a plus in them - this fixes that. I'd like to make sure it doesn't break urls for folks if there's a plus in the non-params.\n\nAnother possibility (and one that I'm actually doing on my side of things) is to get smarter about how params are handled in a remote_url. I'm having to explicitly strip off params in [my fork of carrierwave_direct](https://github.com/adrianpike/carrierwave_direct/blob/c73c79344444a65f7adffa034b8696d8fa5c36e0/lib/carrierwave_direct/uploader.rb#L94), otherwise my generated versions have the params included in their name. This is on my list of things to investigate post-launch, whether this is cw-direct or cw's responsibility.\n\nThanks!\n  Not sure which version of carrierwave makes these instructions obsolete (otherwise I would edit this wiki page myself), but with the latest version of carrierwave (0.6.1), you can simply call recreate_versions!  just like with non-fog storage. \n\nhttps://github.com/jnicklas/carrierwave/wiki/How-to%3A-Recreate-and-reprocess-your-files-stored-on-fog\n Can we add a note saying \"for carrierwave version 0.X and lower\u2026\" ?\n  After using 0.5.8 successfully, and running \"bundle update\" I now get this 500 error after deploy:\n\n```\n    Installed New Relic Browser Monitoring middleware\n    /data/foobackend/releases/20120404173923/config/initializers/carrierwave.rb:8:in `block in <top (required)>': undefined method `s3_access_key_id=' for CarrierWave::Uploader::Base:Class (NoMethodError)\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/carrierwave-0.6.1/lib/carrierwave/uploader/configuration.rb:97:in `configure'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/carrierwave-0.6.1/lib/carrierwave.rb:15:in `configure'\n    from /data/foobackend/releases/20120404173923/config/initializers/carrierwave.rb:1:in `<top (required)>'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:245:in `load'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:245:in `block in load'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:245:in `load'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:588:in `block (2 levels) in <class:Engine>'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:587:in `each'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/engine.rb:587:in `block in <class:Engine>'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:30:in `instance_exec'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:30:in `run'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:55:in `block in run_initializers'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:54:in `each'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/initializable.rb:54:in `run_initializers'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application.rb:136:in `initialize!'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/railtie/configurable.rb:30:in `method_missing'\n    from /data/foobackend/releases/20120404173923/config/environment.rb:4:in `<top (required)>'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `block in require'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:236:in `load_dependency'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/activesupport-3.2.0/lib/active_support/dependencies.rb:251:in `require'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/application.rb:103:in `require_environment!'\n    from /data/foobackend/shared/bundled_gems/ruby/1.9.1/gems/railties-3.2.0/lib/rails/commands.rb:40:in `<top (required)>'\n    from script/rails:6:in `require'\n    from script/rails:6:in `<main>'\n```\n I am using Fog. Here is my carrierwave.rb file:\n\n```\n    CarrierWave.configure do |config|\n\n      # S3 doesn't allow for \"+\" or \"-\"...\n      CarrierWave::SanitizedFile.sanitize_regexp = /[^[:word:]\\.]/\n\n      config.root = Rails.root.join('tmp')\n      config.cache_dir = 'carrierwave'\n      config.s3_access_key_id = ENV['XXXXXXX']\n      config.s3_secret_access_key = ENV['XXXXXXX']\n      config.fog_credentials = {\n        :provider               => 'AWS',       \n        :aws_access_key_id      => 'XXXXXXXXX',       \n        :aws_secret_access_key  => 'XXXXXX',\n        :region                 => 'eu-west-1'\n      }\n\n      if Rails.env.production?\n        config.s3_bucket = ENV['foo-production']\n        config.fog_directory  = 'foo-production'\n      elsif Rails.env.staging?\n        config.s3_bucket = ENV['foo-staging']\n        config.fog_directory  = 'foo-staging'\n      else\n        config.s3_bucket = ENV['foo-development']\n        config.fog_directory  = 'foo-development'\n      end\n    end\n```\n Thanks very much!\n  <pre>Loading development environment (Rails 3.2.3)\n>> ProductImageUploader.new.recreate_versions!\nNoMethodError: undefined method `read' for nil:NilClass\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/carrierwave-0.6.1/lib/carrierwave/uploader/cache.rb:73:in `cache_stored_file!'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/carrierwave-0.6.1/lib/carrierwave/uploader/versions.rb:174:in `recreate_versions!'\n        from (irb):1\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'\n        from script/rails:6:in `require'\n        from script/rails:6:in `<main>'\n>> Product.all.each { |p| p.image.recreate_versions! }\n  Product Load (10.3ms)  SELECT `products`.* FROM `products` ORDER BY `products`.`name`\nNoMethodError: undefined method `read' for nil:NilClass\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/carrierwave-0.6.1/lib/carrierwave/uploader/cache.rb:73:in `cache_stored_file!'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/carrierwave-0.6.1/lib/carrierwave/uploader/versions.rb:174:in `recreate_versions!'\n        from (irb):2:in `block in irb_binding'\n        from (irb):2:in `each'\n        from (irb):2\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'\n        from /Users/sekrett/.rvm/gems/ruby-1.9.3-p125-perf/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'\n        from script/rails:6:in `require'\n        from script/rails:6:in `<main>'\n</pre>\n The same error even without paperclip compatibility.\n Yes, you are right. But I wonder why the first way to recreate versions does not work. It is easy to add `return if file.nil?`\n Ok, but please explain, how one could test against `nil` in this piece of code:\n\n<pre>instance = MyUploader.new\ninstance.recreate_versions!</pre>\n\nIt is from your documentation.\n I will never understand that. If documentation is \"not how you do it\", then what's the use of mentioning that? I don't see below in readme what you say. Very mystic thing. There is a word \"or\", which means both ways should be good, but the first is not what I should do, the second needs patching to work. You refuse to patch the plugin or to correct the readme. Impossible to understand for me.\n\nNow I know how to deal with this, but other people should read this closed issue to understand?\n I see another solution. Since methods with bang should raise exception on failure, the behavior is correct. Maybe it would be nice to add `recreate_version` without bang which returns true/false. In case one does not care, he can use this approach instead. And only after that some additions to readme would be nice. What do you think about this? I could write a pull request next week.\n  This fixes a bug I hit using Tire\nwhich also makes use of #serializable_hash\n\nSpecifically the current implementation breaks if we call\n`record.serializable_hash`\n\nI have also rewritten the method to function more like ActiveRecord's implementation.\n\nNamely it now uses Array.wrap\nand changes everything to strings.\n ha,\nall these tests fail without it.\n\nFirstly if there is no options provided it will fail\nSecondly if the option is not provided as an array it will also fail\n  I have this Domain Name point to s3 bucket:\n\n```\n  da33ii2cvf53u.cloudfront.net\n```\n\nwith 4 CNAMES:\n\n```\npinscdn0.pintureka.com\npinscdn2.pintureka.com\npinscdn1.pintureka.com\npinscdn3.pintureka.com\n```\n\nand my image working fine if I write:\n\n```\n http://da33ii2cvf53u.cloudfront.net/uploads/pins/medium_dc1accba-ed7d-4a3f-9a43-e7e79da8dcdd.jpg\n```\n\nand if I write:\n\n```\nhttp://pin-pro.s3.amazonaws.com/uploads/pins/medium_dc1accba-ed7d-4a3f-9a43-e7e79da8dcdd.jpg\n```\n\nbut the image is not found fine if I write:\n\n http://pinscdn2.pintureka.com/uploads/pins/medium_dc1accba-ed7d-4a3f-9a43-e7e79da8dcdd.jpg\n\nMy cnames working fine with assets in production mode, you can see e.g. my js asset:\n\n```\nhttp://pinscdn3.pintureka.com/assets/application-7efb73ccac0241b88251381101bbdcd5.js\n```\n\nWhy does not works fine my CNAMES with carrierwave?\n Thank you, for me its the same result with  fog_public: false that fog_public: true. You can see the problem in \n\nhttp://stackoverflow.com/questions/9975696/cdns-not-working-for-me-with-config-fog-public-true-with-carrierwave\n\nI don't know how fix this problem :(\n  Hi, Rails 3.2.1, carrierwave 0.6.0, fog 0.9.0\nEverything works fine with local storage and S3 with \"config.fog_public  = true\", as soon as I set \"config.fog_public = false\" I get this on the view display:\n\nArgumentError: wrong number of arguments (2 for 1)\n\nThis is in my view:\n<%= image_tag current_user.profile.picture_url %>   (User has_one Profile,  field is picture)\n\nUploader:\n  class PictureUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n  storage :fog\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n  process :resize_to_limit => [200, 200]\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n\ninitializer:\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n  :provider               => 'AWS',       # required\n  :aws_access_key_id      => 'xxx',       # required\n  :aws_secret_access_key  => 'yyy',       # required\n  :region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n }\n config.fog_directory  = 'attachprod'                     # required\n config.fog_public     = false                                   # optional, defaults to true\nend\n\nNow, I have been able to fix this by changing line 126 in /fog-0.9.0/lib/fog/storage/models/aws/file.rb to:\n  \"def url(expires, x)\"       instead of    \"def url(expires)\"\nbut that seems weird and not sure if that will break something else; it appears to work fine now.\n\nHere's my full stack of the error:\nArgumentError: wrong number of arguments (2 for 1)  \nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/fog-0.9.0/lib/fog/storage/models/aws/file.rb:126:in `url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/storage/fog.rb:148:in`authenticated_url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/storage/fog.rb:307:in `url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/uploader/url.rb:19:in`url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/uploader/versions.rb:159:in `url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/uploader/default_url.rb:8:in`url'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/uploader/url.rb:27:in `to_s'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands/console.rb:47:in`start'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands/console.rb:8:in `start'\nfrom /Users/boudewijnvandongen/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.1/lib/rails/commands.rb:41:in`<top (required)>'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in`<main>'\n\nThis a bug in Fog or am I doing something wrong???\nmany thanks\n Thanks, upgrading Fog solved the issue.\n\nOn 2 April 2012 16:45, James Miller <\nreply@reply.github.com\n\n> wrote:\n> \n> I've added notes to the Readme that specify the Fog version requirement\n> df4b01af10636605128e574eb632dca084417a19\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/679#issuecomment-4881210\n  I haven't been able to isolate this precisely\nbut performing an update from 0.5.8 -> 0.6.0 gives unexplained errors in my factories.\n\nThe code works fine\nbut the factories break.\n\nAnyone experiencing something similar?\n\nI can build a new project and try to recreate it.\n hmm, I've tried creating a sample app\nno problems.\n\nWill have to experiment some more\nwork out the problem.\n ok, I've found the real issue.\nit is with #serializable_hash\n\nwill post a new issue in a minute\n the issue is coming,\njust pushing my fix.\n  I am running ruby 1.9.2 via rvm, Rails 3.2.3 and carrierwave gem + rmagick and for this code:\n\n```\nversion :thumb do\n  process :resize_to_fit => [200, 200]\nend\n```\n\nI get this error: \n\n```\n/Users/vestimir/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/processing/rmagick.rb:161:in `resize_to_fit'\n/Users/vestimir/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/processing/rmagick.rb:248:in `manipulate!'\n/Users/vestimir/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.6.0/lib/carrierwave/processing/rmagick.rb:248:in `read'\n```\n\n\u00a0 \u00a0\u00a0\n    -- C level backtrace information -------------------------------------------\n\u00a0 \u00a0\u00a0\n    [NOTE]\n    You may have encountered a bug in the Ruby interpreter or extension libraries.\n    Bug reports are welcome.\n    For details: http://www.ruby-lang.org/bugreport.html\n\u00a0 \u00a0\u00a0\n    Abort trap: 6\n\nThen the server is shut down, and image is not resized. Installed imagick via homebrew and it's working fine from the console. \n reinstalling imagemagick on mac os x with this line\n\n```\nbrew install -f imagemagick --disable-openmp\n```\n\nfixed the problem\n  I am seeing a recent deploy of 0.6.0 on heroku completely blow up when bundler tries to install it. Tons of errors due to gemspec. Not sure what is wrong there, but downgrading to 0.5.8 and everything worked perfect. Is there an issue with the 0.6.0 version??? I see nothing here about it.. just wondering what that might be from/caused by.\n Please provide more details -- for example, the errors you see.\n Here is a gist with some of the log results... \nhttps://gist.github.com/2230940\n I too am seeing problems, though my app isn't on Heroku. Getting the following output when running the precompile rake task on deploy:\n\nhttps://gist.github.com/2238668\n Sorry.. I have not used REE in a long time. I do use 1.9.2 and on occasion 1.9.3. I just updated to 1.8.21 for rubygems.. will see what happens.. \n Bamboo MRI-1.9.2\n Just submitted pr #703 to fix this.\n Hopefully fixed by https://github.com/jnicklas/carrierwave/pull/703\n I've tested this with my fork on github and rubygems 1.3.7 and after that the generated gemspec looked fine.\n   Any chance of providing some context and tests here? I'm not sure what this is trying to accomplish. \n i'm using ruby 1.9.3p0,  Rails 3.2.2, rspec 2.8.0 and carrierwave-0.5.8. \nMy test looks like this:\n\n```\nit \"should make the image readable only to the owner and not executable\" do\n   @uploader.should have_permissions(0600)\nend\n```\n\nwhen file premissions are not 600,expected rspec error message is\n`\"expected path/to/file to have permissions 600, but they were 644\"`, but it fails with error `'TypeError: can't convert nil into String'`\n\nIf you look into lib/carrierwave/test/matchers.rb , you can notice that method failure_message in all classes except HavePermissions uses `@actual.current_path.inspect` for retriving filename, and in HavePermissions class  method looks like:\n\n```\ndef failure_message\n    \"expected #{@actual.inspect} to have permissions #{@expected.to_s(8)}, but they were #{(File.stat(@actual.path).mode & 0777).to_s(8)}\"\nend\n```\n\n`@actual.inspect` raises this error and should be fixed\n Thanks @syzspectroom -- love that avatar, BTW :)\n  Hello:\n\nI don't know if this is the right place, but I have a suggestion: Allow Base64 encoded strings for uploads. This feature alone would open up whole new doors for Carrierwave as it would allow for easy API support. For instance, a simple POST request could be made with a JSON body that Carrierwave would then convert whatever field is designated as the Uploader back into the file and then continue processing it.\n\nI've been trying to hack my way through adding this feature to my API but haven't really made any progress, so I thought I would suggest it as I'm sure others have tried to do it as well. \n\nThanks!\n  I'm using https://github.com/blueimp/jQuery-File-Upload with carrierwave. Determining file sizes on S3 via fog is really slow. It seems to be proportionate to the size of the file. \n\nFor example, determining that a file is 50 MB can take the page 5 or 6 seconds to render, while a 20 KB will be pretty quick. \n\nWhen I used storage :s3 directly, the file size didn't slow render speed at all.\n Any ideas about this one, @geemus?\n @trevorturk - not sure off hand, could use a bit more info/context.\n\n@cyrusstoller - what method or methods are you using to do the size lookup?  A gist or paste of a short example could help a lot toward tracking this down.  Thanks!\n I have a `DataFile` model with a `FileUploader`. Sorry I should have included this earlier. Thanks for looking into this.\n\n```\n<table class=\"condensed-table zebra-striped\">       \n  <thead>\n    <tr><th>filename</th><th>size</th></tr>     \n  </thead>      \n  <tbody>       \n    <% data_files.each do |d| %>        \n      <tr>\n       <td class=\"break-all\"><%= link_to d.file_identifier, d.file.url, :target => \"_blank\" %></td>\n       <td class=\"file_size_width\"><%= number_to_human_size d.file.size %></td>\n     </tr>\n   <% end %>\n   <% if data_files.empty? %>\n     <tr>\n       <td colspan=2><i>None have been added</i></td>\n     </tr>\n   <% end %>\n </tbody>\n</table>\n```\n @cyrusstoller - thanks for the extra info.  Not having much luck figuring out the problem though.  Carrierwave appears to be using content_length, which should be available without needing to pull the actual body, as you can see here:\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/storage/fog.rb#L228\nIs the performance different if you leave the rest but omit the d.file.size line?  I'm wondering if it is that specifically or if it is actually part of a larger issues somehow.  Thanks!\n @geemus I only noticed the issue after uploading a 50 MB file. I'm wondering whether Rails is downloading the file into the cache or something before reporting the file size because I don't see see `content_length` as a field in my `DataFile` model.\n\nWhen I get rid of the `d.file.size` line I don't experience any slow down. \n\nIn case this helps, I'm running `carrierwave (0.5.8)` and `fog (1.3.0)`\n @cyrusstoller - interesting, thanks for the info.  I think I might have some insight into a fix from that.\n\n@trevorturk - I suspect that https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/storage/fog.rb#L350 the `#get` could/should be changed to `#head`.  If you want the actual body back it will require an extra request that way, but I think most people are going to be accessing via url, so that using head (which is faster) to just get the url and stuff would be better.  I didn't have much luck getting a setup on my machine where I could get the existing test suite passing though, let alone one with changes.  Mind taking that change and trying it out?  Thanks!\n @bensie done, thanks for the reminder.\n @trevorturk - making the change I mentioned above should speed it up (I believe) and all tests pass with it.  I'm not sure if the coverage is complete though in the tests and I'm not actively using carrierwave, so I'm reticent to try this change on my own.  Could you help me figure out how to make sure that this change wouldn't have more far reaching impact?  Thanks!\n\n@bensie - ditto ^\n Hmm, confusing!  Sorry about that, I pushed a fix, but it is on the fog-head branch (not master).  So it isn't really closed yet.  I wanted to leave it there so you guys could check it out.  I'm going to release fog and bump the dep here now so that you can have passing specs.\n  I'm getting SSL Error when try to access S3 hosted files.\n\nChrome:  \"This is probably not the site you are looking for!\"\nFirefox: \"This Connection is Untrusted\"\n\nMy carrierwave initializer has region \"sa-east-1\" - S\u00e3o Paulo, Brazil.\nI notice my bucket name are in subdomain on the url created by carrierwave.\nhttps://my.bucket.name.s3.amazonaws.com/my/store/dir/file.xxx\n\nThe AWS Management Console shows me the following url to my files.\nhttps://s3-sa-east-1.amazonaws.com/my.bucket.name/path/to/my/file.xxx\n @bensie I went back and forth related to this with some people prior to the last release.  You are correct about the certificate I believe, but \"https://s3-sa-east-1.amazonaws.com\" also doesn't match *.s3.amazonaws.com.  I think if you use the the path version it just redirects to this version.  Unless I just misunderstood something there didn't seem to be a good way to actually get this working on non-default regions.  It is certainly possible that I misunderstood though.\n @bensie I replace the dots by hyphens and work fine. Thanks!\n @bensie hmm.  Do you know what you are supposed to do with buckets that have dots then?  Like I said, I don't think path style will work outside us-east.  Just tell people not to do it?\n @bensie thanks for the info I'll keep that in mind in case it comes up again over on fog.\n  The eval'd `serializable_hash` that is injected in the ActiveRecord ORM adapter ignores any options that are passed. There can be a significant penalty in serialization if you aren't asking for the mounted uploader and you have multiple versions stored in a private bucket on S3 (like we do).\n\n``` ruby\ndef serializable_hash(options=nil)\n  hash = {}\n  self.class.uploaders.each do |column, uploader|\n   hash[column.to_s] = _mounter(:#{column}).uploader.serializable_hash\n  end\n  super(options).merge(hash)\nend\n```\n\nI don't have MySQL installed but will look into supplying a patch when I can.\n Say you have a user model that has an `email` column and a mounted avatar:\n\n``` ruby\nclass User < ActiveRecord::Base\n  mount_uploader :avatar\nend\n```\n\nIf I want to serialize the user and exclude the avatar I _should_ be able to do this:\n\n``` ruby\nuser.to_json(only: [:email])\n```\n\nBut this won't respect the `only` directive, it still includes the `avatar`, something like:\n\n``` json\n{ \"avatar\": { ... }, \"email\": \"somebody@example.com\" }\n```\n\nI would expect that `only` or `except` options were respected before automatically including the mounted uploaders.\n Yeah, sorry, I changed my example after I had chosen to syntax highlight the output as json instead of ruby. I did mean `as_json`, and that is where I'm seeing the behavior.\n Just to note: I've worked around the issue in the meantime by overriding the method in any classes with mounters where I'm serializing:\n\n``` ruby\ndef serializable_hash(options = nil)\n  super(options)\nend\n```\n Nope.\n\n``` ruby\nu.as_json(only: [:email])\n# {\"avatar\"=>{\"url\"=>\"/assets/avatar_default.png\"}}, \"email\"=>\"...\"}\n```\n  Since I update fog to 1.2.0, I can't access to my upload file with carrierwave.\nImages are upload on S3 but i can't asses with url AWSAccessKeyId and signature\n\nurl sample:\nhttps://viarezo-upload.s3.amazonaws.com/uploads/picture/image/1/TinyGrab_Screen_Shot_22-02-12_12.39.47.jpg?AWSAccessKeyId=AKIAJD6FPWEX5NI3HJ4Q&Signature=8CwjLUPqd1nG7q9s3yo%2BiipzPjw%3D&Expires=1332338050\n\nreturn code:\n<Code>SignatureDoesNotMatch</Code>\n<Message>\nThe request signature we calculated does not match the signature you provided. Check your key and signing method.\n</Message>\n\nI downgrade fog to 1.1.2 and upload working.\n\nAny idea why fog 1.2 not working\n @bensie - I think it might be subdomain vs path inclusion of the bucket.  It is working ok for me though with my directories/files.\n\n@menkel - Are the files in us-east?  Can you include a sample of what the working URLs look like for comparison?  Thanks, just hoping to narrow things down a bit to make it easier to fix up.\n @bensie - I think it might have to do with the `-` in the bucket name, but not certain.\n @geemus  the files are in eu-west-1\n\nurl generated with fog 1.2.0\nhttps://viarezo-upload.s3.amazonaws.com/uploads/picture/image/3/thumb_TinyGrab_Screen_Shot_22-02-12_12.39.47.jpg?AWSAccessKeyId=AKIAJD6FPWEX5NI3HJ4Q&Signature=jR%2FRQz%2FUoWQ1LlOdeUjJM3kcLh4%3D&Expires=1332366364\n\nurl generated with fog 1.1.2\nhttps://s3-eu-west-1.amazonaws.com/viarezo-upload/uploads/picture/image/3/TinyGrab_Screen_Shot_22-02-12_12.39.47.jpg?AWSAccessKeyId=AKIAJD6FPWEX5NI3HJ4Q&Signature=WeFrRDh8sRbXV0%2B9%2Fu5qCOCNsPo%3D&Expires=1332366780\n\nThank you for your help\n @menkel thanks for the clarification and urls, that actually made it super clear what was going on.  While trying to fix some issues related to this we accidentally hardcoded the host to use the us-east region.  I just pushed a fix to fog here:\nhttps://github.com/fog/fog/commit/f78afe98242a60ae4dbbfcd8c5ab67ba71c6d773\nI also released v1.3.0 which should have that fix.  Let me know if you run into any other problems though.  Thanks!\n It's work :)\n@geemus Thank you for the rapid fix !\n @menkel awesome, great to hear.  Like I said, once I knew about the region difference and saw the urls it was pretty clear exactly what the problem was.  Glad to help out.  Thanks!\n  NameError: uninitialized constant Sprockets::Helpers\n\nIt should be Sprockets::Rails::Helpers\n Yes, because there is no integrated sprockets in rails anymore. It's sprockets-rails gem now.\n  CarrierWave::Storage::Fog::File.size changed  to return zero size when file physically does not exist. \n\nSo that I will not get strange error like this: \n\n> undefined method `content_length' for nil:NilClass\n> carrierwave-789a8b952764/lib/carrierwave/storage/fog.rb:228:in`size'\n  We're using carrier wave with this Mongomapper ORM - https://github.com/brandonhilkert/carrierwave-mongomapper.\n\nHere's our setup: https://gist.github.com/2066122\n\nWe are using ElasticSearch and awesome_print. For users that have a photo uploaded, all is fine. But for those that done, when getting the uploader column, it returns nothing in the console. The class is correct, but because the output is Nothing, awesome_print breaks, which caused me to have to hack awesome_print here: https://github.com/brandonhilkert/awesome_print. ElasticSearch also won't index it because of this as well.\n\nSeems logical that the photo attribute should just return nil for those that haven't uploaded a photo, no?\n\nHere's some hopefully helpful debug:\n\n``` Ruby\nirb(main):024:0> User.brandon.photo\n=> \nirb(main):001:0> User.brandon.photo?\n=> false\nirb(main):002:0> User.brandon.photo.nil?\n=> false\nirb(main):003:0> User.brandon.photo == \"\"\n=> false\nirb(main):025:0> User.brandon.photo.class\n=> PhotoUploader\nirb(main):026:0> User.chris.photo\n=> https://[redacted]/IMG_1160_2_bigger.jpg\nirb(main):027:0> User.chris.photo.class\n=> PhotoUploader\n\n```\n\nI made this change on a fork and it resolved the issue, but this seems kind of like a hack.\n\nhttps://github.com/brandonhilkert/carrierwave/commit/f14b9451ea912d5390a95f83cad9aed3131ddf4b\n We moved to Paperclip as a result, so it probably wouldn't be anytime soon. However, if I find some time, I'll take a stab at it.\n  It would be ideal to have, much like the `extension_white_list` method, a `extension_black_list` method.  I want to allow users to upload any files they want for storage, but I want to block out potentially dangerous filetypes, such as .exe, .js, etc.\n  I think a better behaviour will be to define :\"remove_#{column}!\" as an after_commit callback (defined only on destroy),\nnot as an after_destroy, because callbacks may raise rollback, and the DB will no longer reflect the FS data consistently.\n\nExample:\n\n```\nclass Document < ActiveRecord::Base\n  mount_uploader :file, FileUploader\n\n  after_destroy do\n    raise ActiveRecord::Rollback\n  end\nend\n\n\nclass FileUploader < CarrierWave::Uploader::Base\n  storage :file\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n```\n\nI am using carrierwave 0.5.8 and Rails 3.2.2 with Mysql\nIf I do the following in console:\n\n```\n1: irb(main):001:0>Document.create(:name => \"name\", :file => File.open(File.join(Rails.root, \"public/404.html\")))\n\n   (0.1ms)  BEGIN\n  SQL (0.2ms)  INSERT INTO `documents` (`created_at`, `file`, `name`, `updated_at`) VALUES ('2012-03-14 12:30:40', '404.html', 'name', '2012-03-14 12:30:40')\n   (57.3ms)  COMMIT\n=> #<Document id: 6, name: \"name\", file: \"404.html\", created_at: \"2012-03-14 12:30:40\", updated_at: \"2012-03-14 12:30:40\">\n```\n\nThe document model is saved, and the file is uploaded\n\n```\n2: irb(main):002:0> Document.last.destroy\n  Document Load (0.3ms)  SELECT `documents`.* FROM `documents` ORDER BY `documents`.`id` DESC LIMIT 1\n   (0.1ms)  BEGIN\n  SQL (0.2ms)  DELETE FROM `documents` WHERE `documents`.`id` = 6\n   (56.2ms)  ROLLBACK\n=> nil\n```\n\nRollback is triggered by the after_destroy callback from Document model.\nAlthough the model is not deleted from DB, the document is destroyed from FS\n(The file destruction is done by the callback after_destroy :\"remove_#{column}!\" defined in carrierwave in lib/carrierwave/orm/activerecord.rb on line 29).\n\nLet me know if you want me to make a pull request.\n  I'm building an app using Rails 3.2 - https://github.com/jvenator/wallet (it will remain public for about another week)\n\nI created a directory to match the README instructions at lib/carrierwave/storage/  and placed the fog.rb file there.\n\nAfter re-starting my local server I got the following routing error:\n`uninitialized constant CarrierWave::Storage::Fog`\n\nMoving the fog.rb file into the config/initializers/  directory and re-starting the server fixed things. I went back and forth several times to confirm the behavior. Am not sure if this is something unique to my app or not. the  [Engine Yard doc](http://docs.engineyard.com/use-carrierwave-and-optionally-fog-to-upload-and-store-files.html#update3) also says to place the file in the initializers directory.\n Apologies. Since the other issue was about updating the README only, I thought it should be separated.\n  I think that a region is missing. There a S3 in S\u00e3o Paulo, Brazil - South America.\nSo please, include that. \n You're right!\nFor others who want the S\u00e3o Paulo's code:   sa-east-1\n  **UPDATED**\nI'm building an app using Rails 3.2 - https://github.com/jvenator/wallet (it will remain public for about another week)\n\nI created a directory to match the README instructions at lib/carrierwave/storage/  and placed the fog.rb file there.\n\nAfter re-starting my local server I got the following routing error:\n`uninitialized constant CarrierWave::Storage::Fog`\n\nMoving the fog.rb file into the config/initializers/  directory and re-starting the server fixed things. I went back and forth several times to confirm the behavior. Am not sure if this is something unique to my app or not. the  [Engine Yard doc](http://docs.engineyard.com/use-carrierwave-and-optionally-fog-to-upload-and-store-files.html#update3) also says to place the file in the initializers directory.\n\nORIGINAL ISSUE:\nI implemented Fog/AWS per your README instructions and got a nil class error when reloading the index view for the related resource class (I have a class called Document that Carrierwave is attaching files to). After googling around I found this [Engine Yard doc](http://docs.engineyard.com/use-carrierwave-and-optionally-fog-to-upload-and-store-files.html#update3) that suggested putting the fog.rb file directly into the config/initializers directory. At the same time I re-started my local dev server. Everything immediately started working, which I attributed to the change in location for the fog.rb file. However, after moving it back to the original location everything still worked.\n\nSo... it seems you just need to re-start your server. This may be painfully obvious to even a modestly competent dev, but as a beginner it got me. Perhaps a footnote reminding people to do this would be a helpful addition. (I've never revised or suggested changes to a README before, so feel free to direct me to instruction on how to do this in a more appropriate easy-for-you manner).\n\nAlso, thank you so much for the work you've done on this gem. I'm in NYC and every available worthwhile dev class sells out immediately (especially for Ruby/RoR). Easy to use and effective tools like CarrierWave mean a lot to those of us that are new to programming!\n  ```\nDEPRECATION WARNING: ActiveSupport::Memoizable is deprecated and will be removed in future releases,simply use Ruby memoization pattern instead. (called from <top (required)> at /home/adrian/example/config/environment.rb:5)\n```\n    Added to allow for choosing from a set of asset hosts. This is useful for alleviating the bottleneck that can occur from requesting a bunch of static assets up front.\n I'm trying to use s3, and cloudfront to serve a lot of images.  I'm struggling with getting the urls to round robin/be random.. is that what this is intended for?\n Yep. This allows you to do something like:\n\n```\nconfig.fog_host = proc { \"http://assets#{(rand * 5).ceil}.myhost.com\" }\n```\n\nDoing it this way makes it simple enough that if you just need a shuffling of asset hosts you can use the rand example above, but flexible enough that if you needed a _true_ round-robin approach you can just code it in.\n\nEDIT: added 'http://' to the example\n dude, worked perfectly.. thanks!\n\n+1\n For me not working I have in **fog.rb:**\n\n```\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',\n    :aws_access_key_id      => 'key',\n    :aws_secret_access_key  => key',\n    :region                 => 'eu-west-1'\n  }\n  config.fog_directory = 'pro'\n  config.fog_host = proc { \"http://objectcdn#{(rand * 4).ceil}.domain.com\" }\n  config.fog_public = false\n  config.fog_attributes = {'Cache-Control' => 'max-age=315576000'} \nend\n```\n\nBut I see the images routes to `https://s3-eu-west-1.amazonaws.com/pro...`\n\nHowever my assets **js**, **css**, and **images** assets works fine I see:\n\n`http://objectcdn0.domain.com/assets/logo-4cbddb290494d56e25f86fffa93f4b00.png`\n\nWhat am I doing wrong? with carrierwave?\n  ...and replace it with the default background color.\n\nThis happens when the -extent command crops the image.\n\nFrom the http://www.imagemagick.org/Usage/crop/#extent :\n\n> Note that \"-extent\" works by using the same 'overlay' technique that both the Border and Frame operators uses. As such by default using it with a image containing transparency will replace the transparency with the current \"-background\" color.\n  The file config/initializers/carrierwave.rb configures the rail environments.\nThese should be correctly done in environment/<<environment_file>>.rb\n\nThis causes the problem where carrierwaver processing (for RMagic) is turned off and the developer does not what is happening.\n\nI had the problem of the system working well on development, but when using capistrano, the same system did not work in staging on a different server. After several hours, the problem was that carrierwave was configuring the environment in this unexpected place (initializers/carrierwave). I believe this problem would have been solved earlier if the initialization had happened in the right file. I see a few threads with this problem online but without solution.\n  Hi.  I am using fog 0.9.0, carrierwave 0.5.8, ruby 1.9.3p0, and rails 3.2.  I keep getting this error no matter what I do (yup, I checked the actual doc, not readme as well).  I've been mulling over it for a few days now and tried everything on the web and I can't seem to fix it.  Thanks.\n# carrierwave.rb\n\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    provider: 'AWS',\n    aws_access_key_id: ENV['code'],\n    aws_secret_access_key: ENV['secret_code'],\n    provider: 'AWS'\n  }\n\n  if Rails.env.test? || Rails.env.cucumber?\n    config.storage = :file\n    config.enable_processing = false\n    config.root = \"#{Rails.root}/tmp\"\n  else\n    config.storage = :fog\n  end\n\n  config.cache_dir = \"#{Rails.root}/tmp/uploads\"\n  config.fog_directory = ENV['bucket']\n  config.fog_public = true\nend\n# uploader\n\nclass GiftImageUploader < CarrierWave::Uploader::Base\n\n   include CarrierWave::RMagick\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  version :thumb do\n    process :resize_to_limit => [170, 170]\n  end\nend\n  I have an image uploader that resizes images to a \"standard\" version, and stores via fog on s3.\n\n  version :standard do\n    process :resize_to_limit => [200, 200]\n  end\n\nEverything is fine until I add this to my uploader:\n\n  def filename\n    \"#{Time.now.to_i % 1000000}_#{super}\" if original_filename\n  end\n\nThe original file is still publicly readable on s3, but the standard version is not (access denied from s3 in web browser).  If I comment out the filename method (ie, go back to default filename) the standard version is publicly readable.\n I believe you have a typo in your code.  It should be Time.now.to_i unless you've extended the Time class with a 'toi' method\n I believe that's markdown syntax eating my underscores and displaying italics.\n\nLet me try again.\n\n```\n  def filename\n    \"#{Time.now.to_i % 1000000}_#{super}\" if original_filename\n  end\n```\n ahh, I see.  What about this (probably not the best way to do this, but a quick solution which can be refactored later):\n\n``` ruby\ndef filename\n  super\nend\n\nversion :standard do\n  process :resize_to_limit => [200, 200]\n\n  def full_filename(for_file = model.file)\n    \"#{Time.now.to_i % 1000000}_#{sanitize(original_filename)}\" if original_filename\n  end\nend\n```\n The problem is not that the filename doesn't get changed, it's that the permissions are messed up.  I want both versions to have the timestamp thingy in the name (and my method did that).  The problem is that when I changed the name like this, the permissions of the versioned file was different than when I didn't change the name.\n It seems to me that carrierwave has a problem with just that particular method.  If you log into your s3 bucket, are you able to view the standard version file?  Also, how are you querying that file?\n When I connect to the bucket with authentication, both the original and the version are there.  They should both be public, but when the version is accessed via the public http url access is denied.  The original is accessible via plain http.\n hmm...can you paste in your fog config initializer file?\nI know in the carrierwave fog instructions, it says to do this:\n`config.fog_public = false`\nbut i'm pretty sure it should be\n`config.fog_public = true`\n Here you go.  (Some bits changed to protect the guilty.)\n\n``` ruby\nCarrierWave.configure do |config|\n  config.permissions = 0666\n  config.storage = :fog\n\n  config.s3_access_policy = :public_read\n\n  config.fog_credentials = {\n    :provider               => 'AWS',\n    :aws_access_key_id      => 'blahblahblahackackack',\n    :aws_secret_access_key  => 'morphalotaelephantsgoingroundandround'\n  }\n\n  if Rails.env.production?\n    config.fog_directory = 'prod.oinkoink'\n  elsif Rails.env.test?\n    config.fog_directory = 'test.oinkoink'\n  else\n    config.fog_directory = 'dev.oinkoink'\n  end\n\n  config.fog_host = \"http://#{config.fog_directory}.s3.amazonaws.com\"  # optional, defaults to nil\n  config.fog_public     = true                                      # optional, defaults to true\n  # config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\n\nend\n```\n What if you remove the permissions and s3_access_policy options?\nFog as far as I know does not support s3_access_policy (like aws/s3 did), instead sets it with fog_public.\n @bensie: i'm seeing the same issue as the @pdk - setting `config.fog_attributes = { :acl => 'authenticated-read' }` does not appear to work. Reading through the code it looks like the key has to be `x-amz-acl` - but _that_ does not work either.\n @bensie I can't say for sure. my app does mess around with generating a custom filename and path. The original file is not accessible as well. In my case I'm trying to make it the files on s3 be read-accessible by anonymous users/clients - so have been banging my head trying various combinations to communicate what the acl of the uploaded file and versions should be (see my previous comment)\n\nHere's the current incarnation of my carrier wave config:\n\n``` ruby\ns3 = YAML.load_file(Rails.root.join 'config/amazon_s3.yml')[Rails.env]\nCarrierWave.configure do |config|\n  config.permissions     = 0644\n  config.fog_credentials = {\n    provider:              'AWS',\n    aws_access_key_id:     s3['access_key_id'],\n    aws_secret_access_key: s3['secret_access_key']\n  }\n  config.fog_public     = true\n  config.fog_attributes = { 'Cache-Control' => 'max-age=315576000', 'x-amz-acl' => 'public-read' }\nend\n```\n\nIf the posts I found on the web is to be believed, it should be setting the ACLs on the uploaded file like I need to (it doesn't) \nI wonder if maybe the issue lies in the way fog is used by carrierwave, or fog itself...\n  I've setup carrierwave like so:\n\n``` ruby\nCarrierWave.configure do |config|\n  ...\n  # Choose what kind of storage to use for this uploader:\n  config.storage :fog\n\n  config.fog_credentials = {\n  # ...\n  }\n\n  config.fog_directory  = bucket_name\n  config.fog_public     = false\n  config.fog_host       = bucket_host\nend\n```\n\nHowever, whenever I access the private files I'm sent to the stock s3 url instead of the cnamed version.\n\nHad a quick poke around in `CarrierWave::Storage::S3` and noticed that unlike `#public_url`, `#authenticated_url` uses fog to generate the url.\n\n``` ruby\n        def authenticated_url\n          connection.get_object_https_url(bucket, path, Time.now + authentication_timeout)\n        end\n```\n\nLooking in the fog gem it seems that it only uses a custom host if the `:host` option is provided when the connection is created, which currently isn't happening:\n\n``` ruby\n        @connection ||= ::Fog::Storage.new(\n          :aws_access_key_id      => uploader.s3_access_key_id,\n          :aws_secret_access_key  => uploader.s3_secret_access_key,\n          :provider               => 'AWS',\n          :region                 => uploader.s3_region\n        )\n```\n Sorry, my mistake. I'll have another sweep through to see if/what the problem is.\n For the record it seems that is/was the problem, the code that was linked to was only added recently and isn't in the latest release of the gem.\n  Currently, my uploaded project is called with `asset.document`, which returns a full URL to the file's location on S3. However, in the database, the `document` property consists only of the filename on S3. The full URL is generated by Carrierwave combining the S3 host, bucket information, and other `store_directory` settings. That works fine.\n\nBut I'd like to know if it's possible instead to store the full URL in the `document` property. Any ideas?\n  Hello, I really have no time to investigate carrierwave's code, I just create really simple test and fix it.\nAlso fix \n\nNoMethodError (undefined method `remove_previously_stored_files_after_update' for nil:NilClass):\n\nIt's works for me now.\n  Hi,\n\nI'm trying to convert a JPG to a PNG with a transparet background. Here the code I'm using:\n\n```\nprocess :convert => 'png'\n\ndef filename\n  @filename = ( @filename.split('.').first + '.png' )\nend\n\nversion :thumb do\n  process :resize_and_pad => [100, 100]\nend\n```\n\nBut the generated thumbs have not  a transparent background.\nBy the way, if i upload a PNG file it gets a transparent background.\n\nMy enviroment:\nrmagick (2.13.1)\ncarrierwave (0.5.8)\nrails (3.0.10)\n\nAny idea?\n  I have [this uploader](https://gist.github.com/1953740), called in [this model](https://gist.github.com/1953744).\n\nWhen I do a @member.to_json The return is like:\n\n``` javascript\n{\n  \"_id\":\"4f4ff9247852cc0b3a000002\",\n  \"artist_id\":\"4f4ff5327852cc0a4a000002\",\n  \"avatar\":\"avatar.jpg\",\n  \"created_at\":\"2012-03-01T22:33:08Z\",\n  \"instrument\":\"asdasd\",\n  \"name\":\"asdas\",\n  \"period\":null,\n  \"updated_at\":\"2012-03-01T22:33:08Z\"\n}\n```\n\nI'd like to get the full path for the file on this json, is this possible?\nAlso I'm using mongoid, but I guess this is the normal behavior.\n Hmm, ok I pointed to master and it fixed the problem inside a controller. Just one thing left me scratching my head.\n\n``` shell\nrafa at frost in ~/Projects/magnafm on master!\n\u25cb rails c\nLoading development environment (Rails 3.2.2)\n1.9.3p0 :001 > m = Member.first\n => #<Member _id: 4f4ffdb57852cc0c87000003, _type: nil, created_at: 2012-03-01 22:52:38 UTC, updated_at: 2012-03-01 22:52:38 UTC, name: \"adsad\", instrument: \"adad\", avatar: \"avatar.jpg\", period: nil, artist_id: BSON::ObjectId('4f4ffd907852cc0c7a000002')> \n1.9.3p0 :002 > m.to_json\n => \"{\\\"_id\\\":\\\"4f4ffdb57852cc0c87000003\\\",\\\"artist_id\\\":\\\"4f4ffd907852cc0c7a000002\\\",\\\"avatar\\\":\\\"avatar.jpg\\\",\\\"created_at\\\":\\\"2012-03-01T22:52:38Z\\\",\\\"instrument\\\":\\\"adad\\\",\\\"name\\\":\\\"adsad\\\",\\\"period\\\":null,\\\"updated_at\\\":\\\"2012-03-01T22:52:38Z\\\"}\" \n1.9.3p0 :003 > m.avatar\n => /uploads/artists/amigas-lesbicas-nao-andam-de-maos-dadas/members/4f4ffdb57852cc0c87000003/avatar.jpg\n```\n\nOutside the controller context when I call the to_json method it still returns only the filename, even though I can see by calling `m.avatar` that carrierwave is doing its job.\n That makes sense! Thanks a lot!\n This is driving me nuts, even using carrierwave's master I'm still not able to acess the avatar's full path unless I do something like this in my controller:\n\n``` ruby\nrender :json => @member.as_json(:include => [:artist], :methods => :avatar)\n```\n\nI know I said it was working, but that was a mistake. Without the `:methods => :avatar` it goes back to showing just the filename.\n\n@bensie Maybe I can help to port that to mongoid, can you give me some guidance on that matter?\n Ok, I added it in:\nhttps://github.com/escobera/carrierwave-mongoid/blob/master/lib/carrierwave/mongoid.rb\n\nAnd now I get:\n\n```\nLoading development environment (Rails 3.2.2)\n1.9.3-p0-perf :001 > m = Member.first\n => #<Member _id: 4f50f2687852cc150f000002, _type: nil, created_at: 2012-03-02 16:16:40 UTC, updated_at: 2012-03-02 16:16:40 UTC, name: \"asdad\", instrument: \"asdad\", avatar: \"avatar.jpg\", period: nil, artist_id: BSON::ObjectId('4f4ffd907852cc0c7a000002')> \n1.9.3-p0-perf :002 > m.to_json\n => \"{\\\"_id\\\":\\\"4f50f2687852cc150f000002\\\",\\\"artist_id\\\":\\\"4f4ffd907852cc0c7a000002\\\",\\\"avatar\\\":{\\\"url\\\":\\\"/uploads/artists/amigas-lesbicas-nao-andam-de-maos-dadas/members/4f50f2687852cc150f000002/avatar.jpg\\\",\\\"thumb\\\":{\\\"url\\\":\\\"/uploads/artists/amigas-lesbicas-nao-andam-de-maos-dadas/members/4f50f2687852cc150f000002/thumb_avatar.jpg\\\"},\\\"profile\\\":{\\\"url\\\":\\\"/uploads/artists/amigas-lesbicas-nao-andam-de-maos-dadas/members/4f50f2687852cc150f000002/profile_avatar.jpg\\\"}},\\\"created_at\\\":\\\"2012-03-02T16:16:40Z\\\",\\\"instrument\\\":\\\"asdad\\\",\\\"name\\\":\\\"asdad\\\",\\\"period\\\":null,\\\"updated_at\\\":\\\"2012-03-02T16:16:40Z\\\"}\"\n```\n\nWhich is right, but I wasn't able to make it work inside the specs.\n https://github.com/escobera/carrierwave-mongoid/blob/master/lib/carrierwave/mongoid.rb#L55\nis giving me\n\n``` shell\nNoMethodError:\n       undefined method `serializable_hash' for /uploads/test.jpg:MongoUploader\n```\n\nunfortunately I don't know how to proceed from here. Any ideas?\n\n(Since this is evolving into a debugging session we can move this to another place if you like) \n I've bundled the carrierwave-mongoid .gemspec before testing, so it was running against 0.5.6. \n\nAgainst master it's running fine for the mongoid_spec.rb (but a lot of other tests are blowing up). I'll add the tests later today and send a pull request with those changes.\n  When I use rackspace as carrierwave's storage, the objects stored in the container all have a \"uploads/\" prepended to the filenames.\n\nIs there a setting that can be changed to get rid of that?\n\nThanks.\n That's it! I had to use nil instead of and empty string to get no leading slashes, but it works now.\n\nThanks.\n  I was setting a custom filename (including the file extension with \"....#{model.picture.file.extension}\"  using local storage, and it worked well.\n\nBut once I switched to Fog (Rackspace) I get this error:\n`undefined method 'extension' for #<CarrierWave::Storage::Fog::File:0x1031b8218>`\n\nAnyone have any idea how to access the file's extension again?\n\nThanks.\n Perfect. Here's how I have it working now:\n`model.picture.file.path.split('.').last` (picture being the model's image attribute)\n\nThanks.\n  I suspect this is a documentation issue more than an actual 'bug' as when I thought about the implementation I realised what was probably happening.\n\nAnyway:\n\nI have a number of .gifs uploaded. I added a:\n\n``` ruby\n  process :format => 'png'\n\n  def filename\n    super.chomp(File.extname(super)) + '.png'\n  end\n```\n\nto my uploader. I then call recreate_versions! on my uploaded images. Versions get recreated as .png, but the actual image path in my model isn't updated.\n\nGoing to try a couple of workarounds (delete image, manually store from tempfile) and will let you know if that helps.\n\nRails 3.2, REE 1.8.7, Carrierwave 0.5.8\n Here's my workaround. Took a while to get it right.\n\n``` ruby\n            temp_path = File.join('/tmp', File.basename(store.companylogo.path))\n            FileUtils.cp(store.companylogo.path, temp_path)\n\n            store.remove_companylogo = true\n            store.save!\n\n            store.reload\n            store.remove_companylogo = false\n            store.companylogo = File.open(temp_path)\n            store.save!\n\n            FileUtils.rm(temp_path)\n```\n It's not immediately obvious that the versions can't be tracked separately from the original: ie, you can't have a .png version and a .gif original, because CW is only storing the filename of the original. This is probably a separate documentation issue, and I also believe that if you process :convert => in a version block (or any other action that would imply a filename change) it should error.\n\nIn our case we only use the original for archival, all requests are to the versions. As such, recreate_versions! is what I wanted - but I wanted it to track the filename change from the convert. I also didn't want to change the filename of the versions and then 'ignore' it.\n\nWould a pull request for a recreate_image! method or similar be worthwhile?\n  I have applied the validations of this wiki: https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Validate-uploads-with-Active-Record\n\nNow, if I upload a corrupted jpg file (for example, text file with the jpg extension), CarrierWave will throw this error:\n\n```\nen.errors.messages.mini_magick_processing_error\n```\n\nI'm using the cache to display the submitted image, and it is showing a non-existent file (so, it shows a question mark inside a box in Safari). If a valid image was uploaded before, it will be overwritten with the corrupted file.\n\nIt seems a bug to me. I have searched through the issues and I have found #386 to be the exact problem I have found.\n\nI'm using latest CarrierWave version (0.5.8) with MiniMagick 3.4 on Rails 3.2.1 (Mac OS X Lion).\n I would do it, but right now I'm not using CarrierWave anymore, I'm doing it by myself from scratch, because I have short deadlines.\n\nJust to let you know about the issue.\n  When l try and do the following \n\nversion :thumb do\n   process :resize_to_fill => [50, 50]\nend\n\nThe entire app crashed but works fine without it. I have rmagick gem and everything installed and am running rails 3.2.1\n\n.rvm/gems/ruby-1.9.3-p0@working_title/gems/carrierwave-0.5.8/lib/carrierwave/processing/rmagick.rb:248: [BUG] Segmentation fault\n Worked a treat thanks\n  This is usually taken care of when using carrierwave with rails, but when including in a project outside of rails, you need to declare the mime-types dependency yourself.\n I don't think it's required unless you're using it specifically. See the \"Setting the content type\" section of the readme. If that's wrong, we should set the gem dependency, though. \n Ah gotcha, thanks for the quick response.\n  In 0.5.8 we could set config.s3_access_policy = :authenticated_read so that cloud front signed urls would allow access to private content. This would automatically add \"Authenicated User's\" with read permissions to uploaded files.  \n\nUsing the latest git version I have tried setting config.fog_policy = false and config.fog_attributes = { 'x-amz-acl' => 'authenticated-read' } but it does not set the read permissions for uploaded files. \n\nHow do I set this policy for uploaded files?\n @creddy I think what you want is `config.fog_attributes = { :acl => 'authenticated-read' }`.  Sorry for the confusion, but I think that should solve your problem.  Thanks!\n  For performance reasons, when you are working with big files it makes sense, if possible, start processing the file from a small version, instead of using the original one. I.e.:\n\n  version :thumb do\n    process resize_to_fill: [280, 280]\n  end\n\n  version :small, from_version: :thumb do\n    process resize_to_fill: [60, 60]\n  end\n Added! Any comments are welcome :)\n Here you have :)\n I broke the build for 1.8.7 and 1.9.2 versions. Let me fix it!\n Thanks man!\n You have to fix also the step definition that uses File.write!\n Is there any way to run the build again manually? It's so strange, because that step passes in my laptop in Ruby 1.9.3, 1.9.2, 1.8.7-p358 (which is the same as Travis runs) and Ruby 1.8.7-p334.\n  @bensie awesome, just let me know if you have questions or need help and I can probably at least put you in touch with the right people.  Thanks!\n  This request replaces #622. Simply gsub the improperly unescaped brackets after normal uri sanitization. Covered by test and also passes my \"field test\" on my current project.\n Looking good, but what do you think about moving the\n\n`URI.escape(URI.unescape(uri)).gsub(\"[\", \"%5B\").gsub(\"]\", \"%5D\")`\n\n...stuff into a new method?\n that's the only line in `process_uri`.\n That's a good point!\n oh, you mean without the parse? Meh, it's short and I think it falls under \"process uri\" as a concept. What would be the point? Monkeypatching?\n No, I'm just being dumb. Merged, thanks!\n  When using carrierwave in combination with ActiveRecord, is there a way to keep the uploaded files when destroying the model?\n This seems like a hack, surely there must be a cleaner way of intercepting the removal of the file? \n In fact i am using act as paranoid, but the problem is that the files get deleted anyway\n Add this to your model:\n\n skip_callback :destroy, :after, :remove_avatar!\n\nwhere avatar is the name of your mount_uploader:\nmount_uploader :avatar, AvatarUploader\n  Square bracket uris cannot be used to upload an image via carrierwave. This is because of a bug in ruby whose fix has been rejected.\n\nI believe that a reasonable approach is to delegate the duty of sanitizing URIs to the user (i.e. developer using the library). That way they can use whatever practice they are comfortable with to sanitize URIs.\n\nIn my case that caused this patch, I have a list of URIs from a trusted source and I am doing a bulk import. Carrierwave is incredibly good at this, except for URIs with brackets in them.\n\nThis patch passes all tests because it changes the expectations of the library, as seen in the diff.\n\nIf an invalid URI is passed to carrierwave, URI will raise a URI::InvalidURIError, which is tested for in the specs. This will easily alert the developer to the cause of the problem.\n\nThanks!\nxoxo @ngauthier\n Wouldn't existing apps need to upgrade their gem to become broken? So, put a warning in the changelog?\n\nWhen I upgrade a gem I check the changelog. Alternatively, we could have an intermediate warning that spat an error out, but that's pretty annoying.\n\nPerhaps make a different method?\n\n``` ruby\nobject.remote_avatar_url = \"this can be unsafe\"\nobject.raw_remote_avatar_url = \"this better be safe!\"\n```\n How can it be overridden per uploader? I couldn't figure it out, except for\nmonkeypatching a private method.\n\nWe could always save this for a large release, and in the mean time people\nsearching for a solution can use my fork.\n\n@ngauthier\nOn Feb 14, 2012 5:29 PM, \"James Miller\" <\nreply@reply.github.com>\nwrote:\n\n> It depends on which release it is -- I avoid violating semver whenever\n> possible.\n> \n> So there was a patch submitted to ruby stdlib for URI that fixes bracket\n> support and it was rejected? Lame sauce.\n> \n> Care to chime in @trevorturk? I agree that CW shouldn't be responsible for\n> sanitizing, but it's already in there (yay code debt) and is easy enough to\n> override per-uploader...\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/622#issuecomment-3971067\n Honestly, I don't see the problem with CW doing sanitization. If we can get things working with URLs with square brackets, I say let's do it. If not, then fuck it -- let's remove support in the next version. Remember we haven't hit 1.0 yet, so we have some liberties :wink2:\n So, we could setup a special-case gsub after the unescape/escape that just\nhandles the square bracket issue. Everyone ok with that?\n\nOn Wed, Feb 15, 2012 at 12:26 AM, Trevor Turk <\nreply@reply.github.com\n\n> wrote:\n> \n> Honestly, I don't see the problem with CW doing sanitization. If we can\n> get things working with URLs with square brackets, I say let's do it. If\n> not, then fuck it -- let's remove support in the next version. Remember we\n> haven't hit 1.0 yet, so we have some liberties :wink2:\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/622#issuecomment-3975232\n Yeah, I might suggest moving the url sanitization into a new method to keep things tidy, but that's the basic idea. If we can get things working, let's go for it. \n Closing in favor of #625\n  This pretty much says it all:\n\n```\njruby-1.6.6 :006 > g.remote_photo_url = \"https://www.google.com/intl/en_com/images/srpr/logo3w.png\"\nNoMethodError: \nfrom org/jruby/RubyStringIO.java:520:in `path'\nfrom org/jruby/RubyBasicObject.java:1694:in `__send__'\nfrom org/jruby/RubyKernel.java:2095:in `send'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/uploader/download.rb:42:in `method_missing'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/sanitized_file.rb:114:in `path'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/sanitized_file.rb:144:in `exists?'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/sanitized_file.rb:204:in `copy_to'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/uploader/cache.rb:121:in `cache!'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/uploader/cache.rb:112:in `cache!'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/uploader/download.rb:58:in `download!'\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:339:in `remote_url='\nfrom /Users/peter/.rvm/gems/jruby-1.6.6/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:286:in `remote_photo_url='\n```\n\nFrom looking at the source, @file is being sent path, which it doesn't have:\n\n```\ndef path\n  unless @file.blank?\n    if is_path?\n      File.expand_path(@file)\n    elsif @file.respond_to?(:path) and not @file.path.blank? # sanitized_file.rb:114:in `path'\n      File.expand_path(@file.path)\n    end\n  end\nend\n```\n\nRespond to isin't overridden, is it?\nhttp://technicalpickles.com/posts/using-method_missing-and-respond_to-to-create-dynamic-methods/\n\nEDIT:\nSome more debugging output:\n\n```\n# @file\n\"#<CarrierWave::Uploader::Download::RemoteFile:0x40553c13 @uri=#<URI::HTTPS:0x1bdb2464 URL:https://www.google.com/intl/en_com/images/srpr/logo3w.png>, @file=#<StringIO:0x50322f85>>\"\n```\n\nAnd StringIO is not supposed to have a method #path\nhttp://stackoverflow.com/questions/6235048/undefined-method-path-for-stringio-in-ruby\n\nalso, this happens when setting storage type to file:  `NoMethodError (undefined method 'path' for #<CarrierWave::SanitizedFile:0x27dca19b>):`\n Do you know what would be involved for jruby support? Is this issue certainly a jruby one?\n\nI'm experiencing other very mysterious issues, but only on staging/production.  Do you think carrierwave could be the problem?\n\nhttp://stackoverflow.com/questions/9236143/image-corruption-on-upload-to-s3-production-only-carrierwave-engineyard\n\nThanks\n This may be fixed with 1.6.7:\n- Many 1.9-mode encoding bugs fixed in String, Regexp, StringIO, and YAML\n\nhttps://groups.google.com/forum/?fromgroups#!topic/jruby-users/fIL1NyNh8vo\n  Short story:\n\n``` ruby\n# @post has an :image uploader\n\n# Each example will raise \n# ActiveSupport::JSON::Encoding::CircularReferenceError: object references itself\n\n[@post.image].to_json\n{data: @post.image}.to_json\n```\n\nFix: Adding `as_json` method to `CarrierWave::Uploader::Serialization`.\n\nLong story:\n\nCalling `to_json` directly on the uploader works fine - it's implemented in CarrierWave. However, when we add uploader instance to any collection, `to_json` is never called on the uploader. ActiveSupport calls `as_json` method on each object of the collection. Since this method was not implemented, original `as_json` added to `Object` ([see here](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/json/encoding.rb#L145)) is called, exposing all instance variables of the uploader. Since one of them is `@model` containing the very same uploader, we're in a circular reference.\n\nThis bug is also causing \"stack level too deep\" error in Mongoid models.\n `to_xml` works in a different way and is much more complicated.\n\nCurrently, any of the following calls:\n\n``` ruby\n[@post.image].to_xml\n{data: @post.image}.to_xml\n```\n\nwill raise `ArgumentError: wrong number of arguments (1 for 0)`. It's because ActiveSupport expects all `to_xml` methods to take one optional argument. Fixing the declaration in `CarrierWave::Uploader::Serialization` makes the error go away but the XML returned in the above two cases is kind of empty:\n\nFor array: \n\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<image-uploaders type=\"array\">\n</image-uploaders>\n```\n\nFor hash:\n\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<hash>\n</hash>\n```\n\nI'll need to look deeper to find the cause. Should I post follow-up commits here or should I make a new pull request for xml-related fixes?\n Looks like `to_xml` just needed to respect first parameter and pass it to `serializable_hash.to_xml`.\n\nSo XML serialization is fixed as well.\n  I am having an issue with having too many open files when running carrierwave in our tests. When using something like Fabricator or FactoryGirl (the former in our case). We end up with thousands of entries of open files (which sometime overflow into a getcwd too many files open error).\n\nFabricator:\n\n``` ruby\n# NOTE this is necessary to prevent thousands of open files to the same image (lsof)\n# @profile_image ||= Rack::Test::UploadedFile.new(\"#{Rails.root}/spec/fixtures/files/rails.png\", 'image/png', true)\n\nFabricator :user do\n  name { Faker::Name.name }\n  email { Faker::Internet.email }\n  picture { Rack::Test::UploadedFile.new(\"#{Rails.root}/spec/fixtures/files/rails.png\", 'image/png', true) }\nend\n```\n\n**NOTE** I have tried setting `picture { @profile_image }` to get it to reuse the same uploaded Tempfile, but that does not seem to work (it effectively sets the picture to nil with all sub-versions also set to nil) even when setting `config.delete_tmp_file_after_storage = false`.\n\n`lsof | grep ruby` output:\n\n```\n...\nruby      19517 justinsmestad   55u     REG               14,2      87443 2921382 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-r22z3pruby      19517 justinsmestad   56u     REG               14,2      87443 2921392 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-sxde2truby      19517 justinsmestad   57u     REG               14,2      87443 2921397 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-wxqngi\nruby      19517 justinsmestad   58u     REG               14,2      87443 2921407 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1mp68wa\nruby      19517 justinsmestad   59u     REG               14,2      87443 2921412 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1xgzgv7\nruby      19517 justinsmestad   60u     REG               14,2      87443 2921422 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-gp1i6y\nruby      19517 justinsmestad   61u     REG               14,2      87443 2921427 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-pea10j\nruby      19517 justinsmestad   62u     REG               14,2      87443 2921437 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-l8knkpruby      19517 justinsmestad   63u     REG               14,2      87443 2921442 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1cetyyh\nruby      19517 justinsmestad   64u     REG               14,2      87443 2921452 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-ts4w0z\nruby      19517 justinsmestad   65u     REG               14,2      87443 2921457 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-460di8\nruby      19517 justinsmestad   66u     REG               14,2      87443 2921467 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-b1lk2y\nruby      19517 justinsmestad   67u     REG               14,2      87443 2921472 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-mb1xz1\nruby      19517 justinsmestad   68u     REG               14,2      87443 2921482 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1fggsgx\nruby      19517 justinsmestad   69u     REG               14,2      87443 2921487 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-61en33\nruby      19517 justinsmestad   70u     REG               14,2      87443 2921497 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1o2hfb9\nruby      19517 justinsmestad   71u     REG               14,2      87443 2921502 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1mjnlgn\nruby      19517 justinsmestad   72u     REG               14,2      87443 2921512 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-mo4fak\nruby      19517 justinsmestad   73u     REG               14,2      87443 2921517 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-oyzlj3\nruby      19517 justinsmestad   74u     REG               14,2      87443 2921527 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-16re0wt\nruby      19517 justinsmestad   75u     REG               14,2      87443 2921532 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1qluw2e\nruby      19517 justinsmestad   76u     REG               14,2      87443 2921542 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-138gerk\nruby      19517 justinsmestad   77u     REG               14,2      87443 2921547 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1yk7dcy\nruby      19517 justinsmestad   78u     REG               14,2      87443 2921557 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-caisea\nruby      19517 justinsmestad   79u     REG               14,2      87443 2921562 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-dgroqf\nruby      19517 justinsmestad   80u     REG               14,2      87443 2921572 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1372klb\nruby      19517 justinsmestad   81u     REG               14,2      87443 2921577 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-pikg0q\nruby      19517 justinsmestad   82u     REG               14,2      87443 2921587 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1fvyr9f\nruby      19517 justinsmestad   83u     REG               14,2      87443 2921592 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1khv7lt\nruby      19517 justinsmestad   84u     REG               14,2      87443 2921602 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-q3fbon\nruby      19517 justinsmestad   85u     REG               14,2      87443 2921607 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1ng3953\nruby      19517 justinsmestad   86u     REG               14,2      87443 2921617 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-kte79t\nruby      19517 justinsmestad   87u     REG               14,2      87443 2921622 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-a2zg02\nruby      19517 justinsmestad   88u     REG               14,2      87443 2921632 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1tsvrlx\nruby      19517 justinsmestad   89u     REG               14,2      87443 2921637 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-9vcejh\nruby      19517 justinsmestad   90u     REG               14,2      87443 2921647 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-og4jsc\nruby      19517 justinsmestad   91u     REG               14,2      87443 2921652 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1sl42fz\nruby      19517 justinsmestad   92u     REG               14,2      87443 2921662 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-krpdim\nruby      19517 justinsmestad   93u     REG               14,2      87443 2921667 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-tlvyn9\nruby      19517 justinsmestad   94u     REG               14,2      87443 2921677 /private/var/folders/6r/69zwcwrj3pl6hvqc1jf_zzy00000gn/T/rails.png20120212-19517-1oo7slw\n```\n\n---\n\nI have also posted this issue over on the [Fabrication gem GH issue tracker](https://github.com/paulelliott/fabrication/issues/84) /cc @paulelliott\n @bensie it seems that you have git locked to activemodel >= 3.2.0, could you losen this dep so I can try it on Rails 3.1?\n\n---\n\nThis probably will not change anything. I am using :file store in test mode. But seems like the same issue with the file not getting closed after reading.\n @bensie this doesnt seem to fix the issue. Can you look at closing the file after store is called (in the file adapter) ? SanatizedFile does not have access to file.close it looks like.\n I have the same issue when running a rake task to migrate a lot of media using carrierwave. Seems like all the files remain open until my mac pukes. I'm using the remote_attr_url feature to migrate the media from one server to a carrierwave-backed solution.\n  Using carrierwave (0.5.8), carrierwave-datamapper (0.2.0) and DataMapper (1.1.0) on Ruby 1.8.7-p357, and am noticing that `resource.uploader.filename` always returns `nil`. However, I can get the original filename by accessing the underlying identifier column, `resource.attribute_get(:uploader)`.\n https://gist.github.com/af254c5c6c870ef25657\n  This previously wasn't exposed.\n Ok, sure, I'll submit another pull request, I was going with the least invasive, but you might as well rewrite the whole Carrierwave::Storage::Fog::File layer if you want to make that point, since every single call to size, content_length etc calls the file function which loads the whole file which I assumed you had determined was necessary.  If not, you should be calling file.head for those functions also.\n  This pull is more like a RFC than an actual fix.\n\nWhen storing a file using fog, the method `CarrierWave::Storage::Fog::File#store` leaves a file descriptor open and can possibly exceed OS file descriptor count limit. (A valid use case is when you create a new version in an uploader and wants to generate it for all entries in your database. `#store` leaves 1 fd open for each version, including the original, and Linux, for example, limits open fd's to 1024, so you can quickly exceed that in a batch operation using `#recreate_versions!`)\n\nActually, it may be that `CarrierWave::SanitizedFile#to_file` is to blame, because it `File.open`'s and then delegates to the caller the responsibility to close the file. I know that behavior from C functions, but I'm not sure if it's the correct design here, because I lack the knowledge on CarrierWave and am left with unanswered questions: which entity should know the state of the `open()`'d file? It seems `SanitizedFile` can be initialized with a `File` object, and `#to_file` simply forwards it if that's the case, so, is it safe to `close()` it from outside? The current implementation makes it impossible to decide, since `#to_file` either returns `@file` if it's a `File` or a brand new object from `File.open`.\nSince it seems `#to_file` was exclusively created to be used in `#store` (there's only a single occurrence of a `#to_file` call and it's inside `#store`), maybe it would be better to remove the whole `#to_file` method, pass only the path and the client opens and closes it?\n\nIn this fix, I chose the laziest approach and closed the file from outside.\n\nAlso, I didn't write any specs because I wasn't sure what was to be tested: the way it is now, `#to_file` throws the `open()`'d file and forgets. So it comes down to testing that there are zero open file descriptors after callers of `#to_file` are done, which sounds like implementing a james bond test like a kernel module. Or am I wrong?\n\nIf it matters, I pinned that `File.open` down using [rbtrace](https://github.com/tmm1/rbtrace) on a call to `#recreate_versions!` ([tracer used](https://gist.github.com/1784153) and the [output](https://gist.github.com/1784185) of it, interesting lines in the output: 1241-1271) and monitoring `/proc/<pid>/fd/*` (and a lot of code reading, of course).\n +1 for this patch.\n\nI don't know how we could spec this one, maybe checking if every `File.open` has a `File.close`. But this problem can easily be avoided adopting Ruby best practices: always use block syntax when working with files, to ensure that the file will be closed.\n\nAnd for this to happen need to always keep the `File.open` within the scope of the method to not leave any open doors. So, maybe it's a good idea to extract `#to_file` from `SanitizedFile` as @13k suggested.\n @bensie this is probably an issue that should be applied to file stores as well correct?\n it would be nice to have this included in a 0.5 release... I can't upgrade to 0.6 because I can't upgrade to rails 3.2... and it's pretty serious.\n @bensie thanks\n  it seems like there is no way to check whether the remote file actually exists via carrierwave/fog without doing some sort of file.size that will throw an exception?  would be nice to have this be part of the standard suite.\n  It looks like the gravity option for resize_to_fill was missing from the ClassMethods. For instance, setting up a version like this:\n\n``` ruby\nversion :large do\n  resize_to_fill(600, 600, 'North')\nend\n```\n\nwould result in a \"wrong number of arguments\" error. I couldn't find a set of tests which used the public ClassMethods, but all existing tests still passed after this addition. Let me know if there's anything I should change/try.\n  if i try to use resize_to_fit  from RMagick module at version > process method - see uploader file - it crashes app.\n\ncode: \n\n  version :thumb do\n     process :resize_to_fit => [70, 70]\n  end\n\nit isnt compatible?\n\ntrace header:\n\n/Users/fagnermoura/.rvm/gems/ruby-1.9.3-rc1/gems/carrierwave-0.5.8/lib/carrierwave/processing/rmagick.rb:248: [BUG] Segmentation fault\nruby 1.9.3dev (2011-09-23 revision 33323) [x86_64-darwin10.8.0]\n\n-- Control frame information -----------------------------------------------\nc:0097 p:---- s:0509 b:0509 l:000508 d:000508 CFUNC  :read\nc:0096 p:0054 s:0505 b:0505 l:000504 d:000504 METHOD /Users/fagnermoura/.rvm/gems/ruby-1.9.3-rc1/gems/carrierwave-0.5.8/lib/carrierwave/processing/rmagick.rb:248\nc:0095 p:0011 s:0496 b:0496 l:000495 d:000495 METHOD /Users/fagnermoura/.rvm/gems/ruby-1.9.3-rc1/gems/carrierwave-0.5.8/lib/carrierwave/processing/rmagick.rb:161\nc:0094 p:0044 s:0491 b:0491 l:000480 d:000490 BLOCK  /Users/fagnermoura/.rvm/gems/ruby-1.9.3-rc1/gems/carrierwave-0.5.8/lib/carrierwave/uploader/processing.rb:83\n i already try to reinstall imagemagick but... not works. - via homebrew -\n\ni think this is a common issue when use rmagick - use resize image -, therefore i believe that this error not exists.. but im not sure.. but, it can be frustrating to carrierwave users try to use rmagick\n\nanyway.. ill try to use minimagick :-) tks!\n yep, i agree.. i just replace it by minimagick and works fine..\n\ntks bensie :-)\n  Hi, I've been discussing this error issue, #505, and I am not able to bypass it.\nIs it possible to reopen issue 505, https://github.com/jnicklas/carrierwave/issues/550?\n\nThanks in advance.\n Hi @bensie, this issue is not related to mongoid.\n @bensie, you are right, it's issue #550, https://github.com/jnicklas/carrierwave/issues/550\nI've described a possible solution that in my case resolves it when developing on vagrant vms.\n  I think commit 9e869ae broke the serialization of Mongoid models with a carrierwave uploader mounted.\nIt throws the following when trying to render the .json\n\n```\nActiveSupport::JSON::Encoding::CircularReferenceError in Advertising::BrandsController#show\nobject references itself\n```\n\nWhen I use the stable gem all is fine; when I run master it breaks. Test case:\n\nGemfile\n\n```\ngem 'carrierwave', git: \"git://github.com/jnicklas/carrierwave.git\"\ngem 'carrierwave-mongoid', :require => 'carrierwave/mongoid'\n```\n\nMount Uploader on Model, try to render JSON for that model.\n I see; I posted it here because the commit that broke it was made on this repo :) \nBut I understand the reasoning.\n\nThanks!\n  Is possible to have a pre version on rubygems?\n\nThanks!\n  I have a scenario where i am uploading files dynamically using ajax `remotipart`, then later i assign those uploaded files to any model. I have such settings in uploader.\n\n``` ruby\n    class DocumentUploader < CarrierWave::Uploader::Base\n      storage :file\n      def store_dir\n        \"uploads/#{model.class.to_s.pluralize.underscore}/#{model.documentable_type.to_s.pluralize.underscore}/#{model.documentable_id}\"\n      end\n\n      def extension_white_list\n        %w(doc pdf docx xls xlsx)\n      end\n    end\n\n    class Document < ActiveRecord::Base\n      mount_uploader :document, DocumentUploader\n      belongs_to :documentable, :polymorphic => true\n\n      validates :document, :presence => true\n      validates :description, :presence => true\n    end\n\n    class Post < ActiveRecord::Base\n        has_many :documents, :as=>:documentable\n    end\n```\n\nWhen i upload a document without providing `documentable` source, it uploads the files to `/uploads/documents/uploaded_file.doc`\n\nBut when i assign that document to some other model like\n\n```\n@post = Post.first\n@post.documents << Document.last\n@post.save\n```\n\nIt save the record correctly and when get url of the file like `@post.documents.first.document.url` it gave url like this `/uploads/documents/posts/10212/uploaded_file.doc` where the file was not available. \n\nHow can i handle such assignment of pre-existing uploads? \n Any one please respond to it ASAP, need to go through further and struck in it. \n  When using resize_and_pad on a .jpeg image without specifying the background color, or when specifying :transparent, the padding is black instead of white.\n  When using fog, new uploader instance generate Fog::Storage instance each time.\nCaching Fog::Storage instance gives 60x faster url generating in my case.\nBenchmark is here: https://gist.github.com/1705787\n Seems good.  Only thing I would say is that credentials is a hash, so you might not want to use the entire credentials hash as the key in the cache.  The performance should be further improved by this, but I'm not sure off hand what the best key to actually use would be.  It shouldn't be a deal breaker to do it this way though.\n @bensie there in lies the problem.  I guess the bigger question is, do you expect that the fog credentials will actually change while the app is running?  IE will the carrierwave config dynamically be changed?  If not, then this could just memoize as @fog or whatever, instead of a hash.\n Thank you for comments.\n\n> If not, then this could just memoize as @fog or whatever, instead of a hash.\n\nDid you mean using only one fog credentials in the app? I don't expect that fog credentials will change dynamically, but may use two or more credentials for each uploader class.\n @labocho Yep, I did mean having just one.  I wasn't sure what was common practice (or not).  Since it seems like there could be many different cases I guess the easiest will probably be to just use the whole hash as a key.  It is a big hash key, but it should always work (and that is more important).  Sorry for the confusion, and thanks for the patch!\n\n@bensie Thanks for bouncing the ideas around with me for a bit.  Upon further consideration I think the simplest is to merge as-is.  I don't generally like using a hash as a key in another hash, but it is less likely to cause other issues if we just go with that here I think.\n Thanks! @bensie @geemus\n  Hi guys\n\nI am encountering this really weird issue.. My code:\n\n``` ruby\nclass ImageUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n  storage :file\n\n  version :avatar, :if => :is_avatar? do\n    process :resize_to_fill => [65, 65]\n  end\n\n  version :full do\n    process :resize_to_fit  => [652, 800]\n  end\n\n  protected\n  def is_avatar?(image)\n    return model.is_avatar\n  end\nend\n```\n\nMy model has an attribute called \"is_avatar\". It is boolean. I checked its status by setting the filename to #{model.user.id}-#{model.is_avatar}\" and every time the file name turned up to be \"1-true\" when the other versions are saved. So I can be sure that is_avatar is actually TRUE.\n\nYet, version :avatar is never run.\n\nI am completely gobsmacked.\n It does run. If I just return a string it runs the avatar. \n\nBut if i try to use model.is_avatar (boolean which returns true) it doesnt run :avatar.\n  @bensie Yeah, I'll take a look. Bit busy at the moment but I'll do my best to find some time in the next few days.\n @bensie sorry, not sure how that fell off my radar.  Will revisit, probably early next week.\n @bensie - short answer, mime type is calculated and set in the request when you save an object but currently it does not propogate this info back up to the model.  So if you reloaded the fog model after the save the tests would pass, but checking the content type directly after saving it won't have changed it yet.  Need to think about the proper fix (I want the request to work on it's own and I'd rather not have to do the content-type checking twice).\n @bensie sorry again for the delay.  Fixed here: \nhttps://github.com/fog/fog/commit/f0f692456956fe2e414ef8205d0268259901644a\nI'll try to roll a release tomorrow (or at least this week).\n @bensie my pleasure.  It helped reveal a couple rather long standing edge case bugs in fogs file models that are good to finally fix.\n  I have this in my controller\n\nrespond_to do |format|\n    format.json { render :json => @picture }\n    format.xml  { render :xml => @picture }\nend\n\nMy json renders something like \n\n[\n  \"image\":\n  {\n    \"url\":\"/uploads/picture/2012/01/1/29c2f4cc168a9af416001609e437d37c.jpg\",\n    \"small\":{\n      \"url\":\"/uploads/picture/2012/01/1/small_29c2f4cc168a9af416001609e437d37c.jpg\"\n    }\n  }\n]\n\nwhile my xml format renders something like \n\n&lt;image>d7af79d498b609a1b9090fa2dbf7c354.jpg&lt;/image>\n I believe it's a known issue that to_xml and to_json don't match...?\n\nhttps://github.com/jnicklas/carrierwave/blob/master/spec/orm/activerecord_spec.rb#L96\n\nAny help in this would be most appreciated!\n FWIW issue #337 was about this as well. \n\nBTW awesome work this weekend, @bensie :tada:\n Btw, since Rails 3.2, both to_xml and to_json calls serializable hash. Does this help solve any problem?\n Here is the thing, you cannot really rely on ActiveModel API for serialization. ActiveModel does not say anything about serialization, it just provide some default behavior but it does not force ORMs to implement it (opposite to persisted?, to_key and other methods that are required and their behavior enforced). This means that any ORM can implement whatever they want, so there isn't an unified way that Carrierwave could take advantage for.\n\nWould it be better if AcitveRecord and ActiveModel serialization behavior were more similar? Yes, it would. We can focus on it as long as it is clear that their APIs _can_ be different. That said, have you checked if to_xml in ActiveRecord is calling serializable_hash or is it simply ignoring it?\n  How can I get the with and height of the current instance of carrierwave?\n\nsomething like this....\n\n``` ruby\ncar_images.each do | image|\n  image_tag( image.photo_url, :width => image.photo_width, :height => image.photo_height)\nend\n```\n\nunfortunately `image.photo_width` and `image.photo_height` are not working\nI need to specify the width and height of the images, it is required on the jquery plugin I'm using.\n\nThanks... :)\n I think the wiki has some info about that. \n Yes there is,\n\nI already wrote this in my upload\n\n```\n  def get_version_dimensions\n    width, height = `identify -format \"%wx%h\" #{file.path}`.split(/x/) \n  end\n```\n\nbut still the docs, didn't mention on how to get the value when you need it in the view.\n You'll want to store it yourself in the database.\n  I recently migrated my carrierwave from file storage to Amazon S3 using fog.  I copied the directory structure from my uploaded files to a bucket, and configured carrierwave.  It is all working since new files are uploading properly.  However my existing file instances are nil.  How can I generate carrierwave objects for all my uploader file instances so as to prevent having to re-upload all my files again?\n What do you mean the file instances are nil? The files aren't\naccessible on s3? Maybe it's permissions.\n\nMaybe the file IDs have changed?\n\nI'm not clear what's wrong. Please be a bit more specific.\n\nOn Jan 12, 2012, at 10:10 PM, brewster1134\nreply@reply.github.com\nwrote:\n\n> I recently migrated my carrierwave from file storage to Amazon S3 using fog.  I copied the directory structure from my uploaded files to a bucket, and configured carrierwave.  It is all working since new files are uploading properly.  However my existing file instances are nil.  How can I generate carrierwave objects for all my uploader file instances so as to prevent having to re-upload all my files again?\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/587\n maybe showing code is the best explanation\n\n##### initializer\n\n```\nCarrierWave.configure do |config|\n  config.storage = :fog\n  config.cache_dir = \"#{Rails.root}/tmp/uploads\"\n\n  config.fog_credentials = {\n    :provider               => 'AWS',\n    :aws_access_key_id      => ENV['AWS_ACCESS_KEY_ID'],\n    :aws_secret_access_key  => ENV['AWS_SECRET_ACCESS_KEY']\n  }\n  config.fog_directory = ENV['FOG_DIRECTORY']\nend\n```\n\n##### model\n\n```\nclass User\n  include Mongoid::Document\n  mount_uploader :avatar, AvatarUploader\nend\n```\n\n##### console\n\n```\n>> # from a migrated user avatar uploaded while using storage :file\n>> User.first.avatar.class\n=> AvatarUploader\n>> User.first.avatar.file\n=> nil\n>>\n>> # from a new user avatar uploaded after moving to storage :fog\n>> User.last.avatar.file\n=> #<CarrierWave::Storage::Fog::File:0x00000006319268 @uploader=https://bucket.s3.amazonaws.com/uploads/avatars/4f0fa15f371673000100000d/IMG_0009.JPG, @base=#<CarrierWave::Storage::Fog:0x0000000642c830 @uploader=https://bucket.s3.amazonaws.com/uploads/avatars/4f0fa15f371673000100000d/IMG_0009.JPG>, @path=\"uploads/avatars/4f0fa15f371673000100000d/IMG_0009.JPG\">\n```\n\nthe User IDs are still the same as the directory names, its just that there is no file object for the users that were migrated over.\n here is what i found from the mongo shell.\n\n```\n{ \"_id\" : ObjectId(\"4e0a9a5618200c24cc000004\"), \"avatar_filename\" : \"img_0057.jpg\" }\n{ \"_id\" : ObjectId(\"4f0fa15f371673000100000d\"), \"avatar\" : \"IMG_0009.JPG\" }\n```\n\nthe first object is User.first.  the second is User.last.  the attribute for the filename changed.\n Ah I think that's the problem. The column name default for mongoid was\nchanged at some point. You should run a migration of some kind to make\nthose all match up.\n\nOn Jan 13, 2012, at 3:13 AM, brewster1134\nreply@reply.github.com\nwrote:\n\n> here is what i found from the mongo shell.\n> \n> ```\n> { \"_id\" : ObjectId(\"4e0a9a5618200c24cc000004\"), \"avatar_filename\" : \"img_0057.jpg\" }\n> { \"_id\" : ObjectId(\"4f0fa15f371673000100000d\"), \"avatar\" : \"IMG_0009.JPG\" }\n> ```\n> \n> the first object is User.first.  the second is User.last.  the attribute for the filename changed.\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/587#issuecomment-3477294\n when i started using the carrierwave-mongoid gem, it exposes a mount_on method to prevent having to migrate... i just had to do `mount :avatar, :mount_on => :avatar_filename` and its back running :)\n Glad to hear it -- thanks for updating this ticket with your solution.\n  Hi, there\n   I'm using carrierwave in my app, it's pretty nice. But when I try to upload files which path contains some Chinese, it rails `mini_magick_processing_error`. Then I tried the `uploader#store!` method and passed a file which opened using `UTF-8`, but still got the same error. When I digged deepper, I found the `current_path` was the reason to cause the problem. So I forced it to `UTF-8` and it worked. \n   And when read upload file out, say `picture.url`, still suffered with the encoding issue. I'm tried not offend the source code, so I did this and it worked:\n\n``` ruby\nclass PictureUploader < CarrierWave::Uploader::Base\n  alias old_url url\n  def url\n     old_url.force_encoding('UTF-8')\n  end\nend\n```\n\n   I don't know whether I'm doing the right way or not, so please take a look. \n Sorry for not providing any test. I'm not familiar with the system, it seems that only force the enconding of `current_path` to `UTF-8` will bypass some trouble, but when you call `CarrierWave::Uploader:Base#cache!` in the console will get into the same trouble.\nYou can simply use a jpg file, say 'test.jpg' and rename it to '\u6d4b\u8bd5.jpg' and then call `uploader.store!(File.open( '\u6d4b\u8bd5.jpg' ))`, you will see the encoding problem.\n  I've just bumped an app to 3.2.rc2 but it seems like when an app is using image versions then it fails with undefined method errors.\n\neg\n\nphoto.image.thumb.url fails\n\nreverting it back to rails 3.1 it works fine. Inspecting the same object reveals that none of the carrierwave methods/properties are being added to the Rails 3.2 version.\n it does? I must be doing something wrong then as I'm using it from master via\n\ngem 'carrierwave', :git => 'git://github.com/jnicklas/carrierwave.git'\n\nand it still fails when accessing image versions.\n this bit https://gist.github.com/1566215 ?\n here's the 3.2.rc2 output of an asset https://gist.github.com/1566228\n\nhere's the 3.1 output of the same asset https://gist.github.com/1566236\n\nonly change here was to gem file to toggle Rails version.\n gemfile.lock full gist https://gist.github.com/1566215\n\nand https://gist.github.com/1566255 - just to make sure it's not an awesome_print problem.\n This is still an issue for me too\n I think that commit is in the 3-2-stable branch as well. \n The commit is definitely in 3-2-stable and made it into the release of 3.2.0. Yet, this problem with...\n\n```\nNoMethodError (undefined method `remove_previously_stored_files_after_update' for nil:NilClass)\n```\n\nStill is an issue. I'll have a look into it this weekend. I'd like to move to Rails 3.2.0 ASAP to keep up, and I think this is the last thing on my list to check off.\n fyi - my output is using awesome_print to prettify object dumps - not Rails 3.2.\n @bensie, I'm seeing the wrong behavior too \n\nIn 3.2.0 (final), this is what I get for a User ActiveRecord model with `mount_uploader :avatar, AvatarUploader`:\n\n```\n>> User.find(1).avatar.class\n[2012-01-20 15:19:13] DEBUG ActiveRecord::Base     :   User Load (0.4ms)  SELECT\n \"users\".* FROM \"users\" WHERE \"users\".\"id\" = $1 LIMIT 1  [[\"id\", 1]]\n=> String < Object\n```\n\nI'm also using pry for the console, so investigating the source\n\n```\n>> show-source User.find(1).avatar\nFrom: /home/nixme/Projects/manymoon/deathstar/vendor/bundle/ruby/1.9.1/bundler/g\nems/carrierwave-181620a505b4/lib/carrierwave/mount.rb @ line 157:\nNumber of lines: 100\nOwner: User\nVisibility: public\n\n    def #{column}; super; end\n    def #{column}=(new_file); super; end\n  RUBY\n\n  ...\n```\n\nSo it seems the `super` call is hitting the original accessor and not the included Module that's created in mount.rb right underneath those lines.\n I understand... working on an extraction right now. Our app is pretty large, but I just wanted to point out we're seeing it too.\n I can post my Gemfile, but it's also very long and don't think it'll help (too many libs). But I investigated further looking at the inheritance chain of `User#avatar`.\n\nIn 3.2, my User model has the following inheritance chain and whether or not the method `avatar` is defined:\n\n```\nUser                                                   true\n#<Module:0x000000049c1b30>                             true\nCarrierWave::Validations::ActiveModel::HelperMethods   false\nCarrierWave::Validations::ActiveModel                  false\n#<Module:0x00000004c8fa10>                             true\nCarrierWave::Mount::Extension                          false\n...\n```\n\nIn 3.1, the same model shows the following:\n\n```\nUser                                                   true\n#<Module:0x007f9eb062efc0>                             false\nCarrierWave::Validations::ActiveModel::HelperMethods   false\nCarrierWave::Validations::ActiveModel                  false\n#<Module:0x007f9eac2a4db8>                             true\nCarrierWave::Mount::Extension                          false\n...\n```\n\nSo the `super` call at L157 of mount.rb ends up hitting that first Module in Rails 3.2, and doesn't in 3.1 cause `avatar`s not defined in that module. The second nameless module is the one defined in `mount_uploader` in mount.rb - where we'd expect `super` to hit.\n\nSo what's in that module?\n\n```\n>> show-source self.class.ancestors[1]#avatar\nFrom: /home/nixme/Projects/manymoon/deathstar/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.0/lib/active_record/attribute_methods/read.rb @ line 73:\nNumber of lines: 3\nOwner: #<Module:0x000000049c1b30>\nVisibility: public\n\ndef __temp__\n  #{internal_attribute_access_code(attr_name, cast_code)}\nend\n```\n\nWhile in 3.1 it's not defined (although `avatar_before_type_cast`, `avatar_changed?`, `avatar_change`, `avatar_will_change!`, `avatar_was`, and `reset_avatar!` are defined in that Module)\n\nI'm still working on an extraction that exhibits the behavior.\n Hi guys,\n\nI also have these issues. After upgrading Rails to 3.2.0 and Ruby to 1.9.3 I got also this error message. \nundefined method `thumb' for \"Grand_Canyon__Arizona__USA.jpg\":String\n\nIs there already a solution available? Or does someone know why that error appears?\n I'm seeing this newly upgraded to 3.2.0:\n\nhttps://gist.github.com/ae7f71ca0d8463e85c6f\n\nThere's the `Gemfile`, and  `Gemfile.lock`. \n\nI'm seeing `ActiveModel::MissingAttributeError: can't write unknown attribute`avatar'` (I guess we all have avatars! ;-) ) out of any code that touches the user model significantly, the avatar uploader is defined as:\n\n`mount_uploader :avatar, FileUploader`\n\n`FileUploader` looks like this:\n\n``` ruby\nclass FileUploader < CarrierWave::Uploader::Base\n\n  include CarrierWave::MiniMagick\n  include Sprockets::Helpers::RailsHelper\n\n  storage :file\n\n  process :convert => 'png'\n\n  def store_dir\n    p = model.to_param\n    if p =~ /^--.*/\n      p = model.class.model_name.downcase\n    end\n    Rails.root + \"#{Rails.env.test? ? 'tmp' : 'public'}/images/dat/#{mounted_as}/#{p[0]}/#{p}\"\n  end\n\n  def filename\n    p = model.to_param\n    if p =~ /^--.*/\n      p = model.class.model_name.downcase\n    end\n    \"#{model.to_param}.png\"\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\nend\n\n```\n @bensie here is my gemfile https://gist.github.com/1683217 and my gemfile.lock https://gist.github.com/1683222\nI hope it helps you\n Ran into the same issue and traced it down to an old version of kaminari. Bumping fixed it.\n :tada: :smoking: :gun: :checkered_flag:\n Awesome.\n Even with Kaminari `0.13.0` I'm still seeing this error.\n\n```\n===============================================================================\nError:\ntest_registration_with_facebook_is_silky_smooth(TestRegistrationWithFacebook):\nActiveModel::MissingAttributeError: can't write unknown attribute `avatar'\n    app/controllers/users/omniauth_callbacks_controller.rb:23:in `facebook'\n    test/integration/registration_with_facebook_test.rb:15:in `test_registration_with_facebook_is_silky_smooth'\n===============================================================================\n```\n\nI'm assuming I have some other plugin stepping on `inherited`, but I wanted to leave this comment here so that it's known for others that upgrading Kaminari isn't the canonical fix.\n\n**Update:** Full (unsilenced) backtrace [here](https://gist.github.com/e8f103e4b7f4b297ab04#file_backtrace.log), top of my model [here](https://gist.github.com/e8f103e4b7f4b297ab04#file_user.rb).\n\nI'm using _carrierwave_ from Git at SHA:719a13ce97. I have ruled out _role_model_ as causing the error, although they do have a similar `inherited` method, but it doesn't appear to conflict. Curiously this is just _one_ of **four** uploaders in my application, and the others appear to work as expected.\n\nI can't isolate what is special about my user model except for _devise_, I have tried with devise `~> 1.5.x`, and `= 2.0.0`, same problem with both. I have also tried with and without _role_model_\n @bensie turned out to be an unmigrated database, and a bad schema merge masking missing migrations ( I assume ) - as the fallback for our test cases is gravatar, and the tested avatar, and the gravatar images were the same, I dare say it's never worked (thank god we're not in production yet!)\n  I have some code in nested formtastic form: \n\n<%= f.inputs :for => :images do |i| %>\n            <%= i.input :image, :as => :file %>\n            <%= i.input :image_cache, :as => :hidden %>\n            Remove? :<%= i.check_box :remove_image %>\n        <% end %>\n\nremove_image doesn't work ( yes, i have attr_accessible :remove_image in model) \nremove_image! in view work half-way because it removes file but doesn't remove image from model\n It's going to be hard to track this down without more information. Can you tell if this is only a problem with nested forms? I wonder if that could be an issue. Please do some more testing and let us know if you find anything interesting. If you could provide a sample application that would be cool, too. \n Hello, I am having a similar issue with remove and with the cache in a nested form. Here is the code for the parent and child models.\n\n``` ruby\nclass Company < ActiveRecord::Base\n  has_many :images, :dependent => :destroy\n\n  attr_accessible :name, :logo, :remove_logo, :logo_cache, :images_attributes \n\n  mount_uploader :logo, LogoUploader\n\n  accepts_nested_attributes_for :images, :allow_destroy => true\nend\n```\n\n``` ruby\nclass Image < ActiveRecord::Base\n  belongs_to :company\n\n  attr_accessible :image, :remove_image, :image_cache, :comment\n\n  mount_uploader :image, ImageUploader\nend\n```\n\nIn the same form, I have a logo for a company and a nested form for the images of the company. The creation, update and deletion of the logo works fine (it is an attribute of company). However, the nested form for the image model can only create and update the picture. \n\nThe problem comes when I try to remove it (the remove flag is passed correctly in the params) or when validation fails and the image gets \"saved\" in the cache, when you resubmit the form the image is not saved.\n\nI'm fairly new to the community but I would love to help in anything I can.\n\nThanks!\n I have quite similar code like hectorvs.\n\nI solved this problem using controller:\n\n``` ruby\n def update\n    @place = Place.find(params[:id])\n    params[:place][:images_attributes].each_key { |key|\n     if params[:place][:images_attributes][key.to_sym][:remove_image] == \"1\"\n       @image = Image.find(params[:place][:images_attributes][key.to_sym][:id])\n       @image.remove_image!\n       @image.destroy\n       params[:place][:images_attributes].delete(key.to_sym)\n     end\n    }\n\n    @place.update_attributes(params[:place])\n    respond_with(@place)\n  end\n```\n\nbut this is quite ugly solution :)\n\nAlso when I delete parent record, I must manually remove nested images\n\n``` ruby\n  def destroy\n    @place = Place.find(params[:id])\n    for image in @place.images\n        image.remove_image!\n        image.destroy\n    end\n    @place.destroy\n    respond_with(@place)\n  end\n```\n\nSorry, but I don't have time now to do some more tests, maybe in future. Good luck, great gem!\n  For example, a user has one picture.  When they upload a new picture, the old one get's removed.  This causes issues for all existing links in things like emails to that that old picture.  I would like the ability to have all old uploads remain on S3 and not get replaced by the new upload.\n\nWe're using FOG to store on S3.  Is this possible?\n  I am a little lost with Heroku and Carrierwave Gem. I have read the WIKI, Read me and searched the net and i admit, i need help. Everything well on local but Heroku crushes the application.\n\n**///ERROR MESSAGE FROM HEROKU LOGS**\n\n```\n2012-01-03T17:33:26+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/carrierwave-0.5.8/lib/carrierwave/uploader/configuration.rb:91:in `eval': uninitialized constant CarrierWave::Storage::Fog (NameError\n```\n\n**///GEM FILE**\n\n```\ngem \"fog\"\ngem 'carrierwave'\n```\n\n**/app/uploaders/avatar_uploader.rb**\n\n```\nstorage :fog\n```\n\n**/config/initializers/carrierwave.rb**\n\n```\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',    \n    :aws_access_key_id      => 'XXXX',    \n    :aws_secret_access_key  => 'XXXX',   \n    :region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n  }\n  config.fog_directory  = 'site_images'  # required\n  config.fog_public     = true     # optional, defaults to true\n  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\nend\n```\n\nWhen i change the storage to file not fog, then i do not get errors. Are there any other fog settings i am skipping or missing. Any help greatly appreciated. \n Is that the whole content of the avatar_uploader file, looking at the README it looks like it should be more along the lines of:\n\n```\nclass AvatarUploader < CarrierWave::Uploader::Base\n  storage :fog\nend\n```\n\nI suspect you probably already have that though.  Just hoping to narrow it down a bit (especially since nothing particularly obvious is jumping out at me on this).  Thanks!\n  As far as I can tell, doing something like:\n\n<pre>process :convert_svg\n\n  def convert_svg\n    manipulate! do |img|\n      if img[:format] == 'SVG'\n        img.format 'PNG'\n      end\n      img\n    end\n  end\n\n  def filename\n    \"#{secure_token}.#{file.extension.gsub(\"svg\",\"PNG\").gsub(\"SVG\",\"PNG\")}\" if original_filename\n  end</pre>\n\n\nand then doing:\n\n<pre>version :thumb do\n    process :resize_to_limit_with_gif_fix => [150, 150]\n  end</pre>\n\n\nwill result in the version being generated (using manipulate!) from the SVG version of the file rather than the PNG version. Which is awkward, because SVG resize operations take forever (not to mention the slight detail of the 2.4 gigabytes of RAM a simple 48kb SVG requires to be resized). What I'm trying to do is have the SVG converted to a PNG (takes 5 seconds and nearly no RAM), which works, but then have the versions use the PNG version of the image for their operations (which amount to a resize, or in the case of GIFs, coalesce/resize/optimize). I'm using MiniMagick throughout.\n\nIs this functionality present in CarrierWave and I'm just overlooking it, or is this not something that can be done at present?\n  This is a fix to the issue described in: https://github.com/jnicklas/carrierwave/issues/517\n\nI added a spec under the processing_spec.rb file. It's just testing that converting a multi_page pdf with RMagick doesn't throw an error. The fix modifies the manipulate! method so that if it's called on a multi-page document without a block, it will return the raw list of frames without trying to call a non-existent block on them\n  Today all of a sudden i got a bug when i attempted to upload my images with carrier. ([BUG] Segmentation fault) and the server crashed.\n\nI really couldnt understand what the problem was, so i found a fix on this.\n\nIn terminal:  brew unlink imagemagick \nAND AFTER\nbrew install --force imagemagick --disable-openmp\n\nThis will uninstall the imagemagick and install it with proper settings.\n\nHope this helps someone with the same problems.,\n\nBest regards Forsberg\n This also has nothing to do with Carrierwave, it is an imagemagick or rmagick problem. \n  Hi, \n\nI've just run into a bug when using Carrierwave with the Padrino framework. This was reported previously, but the issue was hard to understand from the bug report given:\n\nhttps://github.com/jnicklas/carrierwave/issues/227\n\nI'll try to explain a bit further. \n\nBasically, Carrierwave works very well with Padrino, and I hadn't noticed this problem until today, because I've always included something like this in my uploaders:\n\n```\ndef root\n  Padrino.root + \"/public/\"\nend\n```\n\nStarting on a new project, I ran into a weird problem today where uploads worked, but attempts to access @upload.file.url in a view was inexplicably blowing up. \n\n```\n => #<Video id: 107, title: \"\", description: \"\", view_count: nil, duration: nil, state: \"waiting_for_encode\", created_at: \"2011-12-30 10:24:07\", updated_at: \"2011-12-30 10:24:10\", original_file: \"20100423_002.mp4\", uuid: \"cc70afba-5cb5-4dbb-8f4a-883bf84efec7\"> \nruby-1.9.2-p290 :002 > v.original_file.url\nTypeError: can't convert nil into String\n    from /Users/dave/.rvm/gems/ruby-1.9.2-p290/gems/carrierwave-0.5.8/lib/carrierwave/uploader/url.rb:18:in `expand_path'\n```\n\nThe problem, as seen from the stack trace, is in line 18 of carrierwave/uploader/url.rb.  `File.expand_path(root)` in that line doesn't work in Padrino because \"root\" is nil.  I'll fork the gem and take a look at fixing it, then send a pull request. I imagine that it just needs something like an `if defined?(Padrino)` somewhere.\n\nI've done up a bug proof, with a failing spec in a github repo: \n\nhttps://github.com/futurechimp/carrierwave-bug-demo\n\nPadrino and Carrierwave are an ideal combination of light weight and ease-of-use, fixing this will hopefully help somebody else, it was a bit of a head-scratcher for me for an hour or so.\n Hm, it may be a little more complex than I thought to fix this.  I've been looking at this code in carrierwave.rb:\n\n```\nelsif defined?(Sinatra)\n\n  CarrierWave.root = if Sinatra::Application.respond_to?(:public_folder)\n    # Sinatra >= 1.3 \n    Sinatra::Application.public_folder\n  else\n    # Sinatra < 1.3\n    Sinatra::Application.public\n  end\n\nend\n```\n\nIn a Padrino application, Sinatra::Application.public_folder is always nil (which explains the behaviour I'm seeing in the Padrino app). However, at this point Padrino is not yet defined, so simply adding something like (crudely):\n\n```\nelsif defined?(Padrino)\n  File.join(Padrino.root, \"public\")\nend\n```\n\ndoesn't do the trick.  I need to go meet a friend for lunch, will maybe come back to this in a few days. \n Since Padrino uses Sinatra, I think your `elseif defined?(Padrino)` might work if it's placed above the `elsif defined?(Sinatra)` check.\n\nWhy wouldn't Padrino be defined yet?  It should be...\n I think I don't really understand the Padrino boot sequence very well, or maybe I need to understand the functionality of Bundler better. \n\nAssuming that \"gem CarrierWave\" appears _after_ \"gem Padrino\" in the Gemfile, then this will work fine:\n\n``` ruby\nelsif defined?(Padrino)\n  CarrierWave.root = File.join(Padrino.root, \"public\")\nend\n```\n\nHowever, if \"gem CarrierWave\" appears _before_ \"gem Padrino\" in the Gemfile, then there is no Padrino.root at the time of CarrierWave load. \"Padrino\" is defined, but it's a module only. \n\nBy default, most Padrino users will definitely place CarrierWave before Padrino in the Gemfile (it's the logical thing to do, given the way the generators lay the Gemfile out). \n\nThis works:\n\n``` ruby\nelsif defined?(Padrino)\n  CarrierWave.root = File.join(PADRINO_ROOT, \"public\")\nend\n```\n\nHowever, this is a tiny bit ugly as it means bypassing the Padrino.root class method, which is designed to be configurable. \n\nI have asked on the Padrino mailing list what the right course of action is, or if they have any advice. I'll jump back in here when I get an answer from them.  \n\nIn the meantime, one tip which could help the situation for Padrino users who may run across this page while trying to figure out what to do: here's a good way to load CarrierWave, and its ActiveRecord integration, in Padrino.\n\n``` ruby\n# config/boot.rb, anywhere after Bundler stuff\n#\n# Carrierwave loading in Padrino\n#\nrequire Padrino.root + '/models/video_uploader'\nrequire 'carrierwave/orm/activerecord'\nCarrierWave.root = File.join(PADRINO_ROOT, \"public\")\n```\n\nThe first line requires the uploader, which doesn't happen by default. \n\nThe second line requires ActiveRecord. Swap for another orm as necessary. \n\nThe last line properly sets the CarrierWave.root, so you won't have inexplicable explosions when you actually try to use your uploader. \n Yeah, it would be one way to go - and then just submit a pull request to the Padrino devs to change the default layout of the Padrino Gemfile, assuming it can solve problems like this one without introducing other troubles. \n\nI'll wait to see what they come back with, though. \n\nThere's not really a bug in either piece of software, it's more of an integration gotcha. So, another alternative would just be to document Padrino in the CarrierWave documentation, which would save on the feeling of weirdness I had when CarrierWave appeared at first glance to be blowing up for no real reason. \n Hi guys,\n\nwe prefer to add `padrino` at the end of `Gemfile` to prevent gem clashing, in this way for example if you have problems with latest `rack` you can add on top a specific version.\n\nIn past I submitted a pull request to @jnicklas to fix these kinds of problems with carrierwave. Wasn't accepted.\n\n@bensie to autorequire uploaders puts it under `lib` folder.\n\n`Padrino.root` works like `Rails.root.join` so you'll are be able to do `Padrino.root('public')`\n\nThe avoid editing of boot.rb I also suggest to put this in your gemfile:\n\n`gem 'carrirerwave', :require => %w[carrierwave carrierwave/orm/activerecord]`\n Ok, thanks for the tips @DAddYE \n\nOver in https://github.com/padrino/padrino-framework/issues/762, @DAddYE says that the right thing to do in the case of CarrierWave would be to use this form in the CarrierWave init code:\n\n``` ruby\nelsif defined?(Padrino)\n  CarrierWave.root = File.join(PADRINO_ROOT, \"public\")\nend\n```\n\nI'll do up a pull request for the initializer and also the documentation. \n Ok, the pull request is here:\n\nhttps://github.com/jnicklas/carrierwave/pull/593\n\nThe wiki page is at: https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Make-CarrierWave-work-with-Padrino\n\nI've linked it from the CarrierWave wiki front page, as it'll keep people out of trouble for the moment. \n\nIf the pull request is accepted, I will take the note about setting CarrierWave.root out of the wiki page, as it'll then be superfluous. \n  Hi guys,\n\nPlease have a look at fix for storages with File#url methods not accepting params.\n\nRelated commit: [add query options for s3 to support response headers overwriting](https://github.com/jnicklas/carrierwave/commit/593907495e060ba3a128988fd686c3d97699a3e2#commitcomment-824154)\n\nBest regards,\nMateusz\n  In case you or anyone is looking to tackle this -- a few things I've found.\n1. Rubinius is fine -- there's a problem with the current build of rbx on Travis -- it works fine locally with the latest master rbx.  Travis guys said they are going to push out a new build soon.\n2. 1.9.3 has an issue that came from something Rails introduced between 3.1.0 and 3.1.1.rc1.  So bizarre that it only fails on 1.9.3 -- 1.9.2 and ruby-head are fine.\n3. Rails 3.2.0.rc1 and rails master have a whole bunch of failures all surrounding the same line of code -- see issue #533 for info.\n For the Rails 3.2rc1 stuff, I'm pretty sure it has something to do with the way that the #add_config methods get generated. The class_eval might be changing... I'll look into it.\n Thanks, I'm starting to look into it as well.\n\nI've updated Travis to test Rails 3-0-stable, 3-1-stable, and 3-2-stable on all rubies so it's easier to see where we're at:\nhttp://travis-ci.org/#!/jnicklas/carrierwave\n An update to MiniMagick made things a bit more strict when it comes to arguments on the mogrify commands.  They need to be strings.  Since Travis does a bundle install from scratch each time without a lock file, it always pulls the latest.\n\nAnd now back to where I was yesterday...\n  in cache_stored_file! file.read sometimes returns returns a File object.\n\nThis seems to happen when you upload a new file, which is cached  between form displays, then save the model, and then a recreate_version! is executed in an after_save. \n\nI use this to create custom crops in my versions.\n\nIt seems like an ugly fix, but I don't really know how to solve it in a better way. Here's some debugging output that might give some clues.\n\n```\n(rdb:1) self\n  <Fog::Storage::AWS::File\n    key=\"uploads/development/video/screenshot/1/image.jpg\",\n    cache_control=\"max-age=315576000\",\n    content_disposition=nil,\n    content_encoding=nil,\n    content_length=170769,\n    content_md5=nil,\n    content_type=nil,\n    etag=\"6bad799a542968e7bfd883c6c550e784\",\n    expires=nil,\n    last_modified=nil,\n    metadata={},\n    owner=nil,\n    storage_class=nil\n  >\n```\n\n```\n(rdb:1) attributes\n{:body=>#<File:/blabla/uploads/development/tmp/20111222-1210-4994-6806/bla.jpg>, :content_type=>nil, :key=>\"uploads/development/video/screenshot/1/image.jpg\", :cache_control=>\"max-age=315576000\", \"x-amz-id-2\"=>\"XXXXX\", \"x-amz-request-id\"=>\"XXXXXX\", \"Date\"=>\"Thu, 22 Dec 2011 11:10:49 GMT\", :etag=>\"6bad799a542968e7bfd883c6c550e784\", :content_length=>170769, \"Server\"=>\"AmazonS3\"}\n```\n\n```\n(rdb:1) body\n#<File:/blabla/uploads/development/tmp/20111222-1210-4994-6806/bla.jpg>\n```\n Would you mind adding one or more tests for this?  I'm not sure I'm really understanding the problem here.\n Guys, sorry for the delay. I was away for a while and then I had a lot of trouble exposing this bug in a spec.\nI'm not quite sure how to fit this into the existing specs, but this should expose the bug:\n\n``` ruby\ndescribe \"Fog/S3 bug supporting https://github.com/jnicklas/carrierwave/pull/571\" do\n\n  before do\n    CarrierWave.configure do |config|\n      config.reset_config\n      config.fog_credentials = {\n        :provider               => 'AWS',\n        :aws_access_key_id      => 'xxxx',\n        :aws_secret_access_key  => 'xxxx',\n        :region                 => 'eu-west-1'\n      }\n      config.fog_directory  = 'eu1storage'\n    end\n\n    class ScreenshotUploader < CarrierWave::Uploader::Base\n      # Choose what kind of storage to use for this uploader:\n      storage :fog\n      version :small\n    end\n  end\n\n  it \"should cache, store and recreate versions\", :y => true do\n    @up = ScreenshotUploader.new\n    @up.cache! File.open(file_path('portrait.jpg'))\n    @up.store!\n    @up.recreate_versions!\n  end\n\nend\n```\n @trevorturk, @bensie  please let me know if you need anything else. I'd like to integrate this spec with the existing specs for S3/fog based uploaders, but I had some trouble understanding how those work. The existing specs seem to use S3 directly, not through fog. \n I don't have time to look at this now, but I'll reopen at least. \n #482 looks related\n Yes, it's the same issue. I think your fix is cleaner than mine.\n\nOn Tue, Jan 10, 2012 at 8:15 PM, Joel Nimety <\nreply@reply.github.com\n\n> wrote:\n> \n> #482 looks related\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/571#issuecomment-3435167\n I'm closing this pull request, @jnimety 's fix seems better. \n I didn't provide a fix. :)\n doh! Sorry guys! I should look twice before I comment. \n\nAnyway, I _do_ still think it's the same issue :)\n Thanks for this.  I think this should mean I can upgrade off of 0.5.7.\n Was another ticket opened for this issue?  0.6.0 and 0.6.1 still fail with \"TypeError Exception: can't convert File into String\" when calling StringIO.new(file.read) in cache_stored_file!\n I haven't had the time to look into the tests. I'm still running my own fork :-/\n  Hi there.\n\nI have a bunch of icons (about 10.000) that I wish to serve over Rackspace Cloud Files. It takes an extremely long time to get this going when transferring them one by one. So to speed up the process, I tried to use threads (Using the [Parallel](https://github.com/grosser/parallel) library) - This will significantly reduced the process time, but it keeps raising exceptions at around the 50th icon.\n\nI tried transferring in 50 threads, 25 threads, 5 threads, but every time I use threads it seems to raise exceptions with the following error:\n\n```\n\nExcon::Errors::SocketError: getaddrinfo: nodename nor servname provided, or not known\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:26:in `getaddrinfo'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:26:in `connect'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:16:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/ssl_socket.rb:21:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `socket'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:83:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/connection.rb:20:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/aws/storage.rb:375:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/aws/requests/storage/put_object.rb:43:in `put_object'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/aws/models/storage/file.rb:119:in `save'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/collection.rb:50:in `create'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:230:in `store'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:79:in `store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/store.rb:59:in `block in store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n... 11 levels...\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.1.3/lib/active_support/callbacks.rb:81:in `run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:42:in `block in run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `call'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `run_cascading_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:41:in `run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence/modification.rb:23:in `prepare'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence/operations/update.rb:43:in `persist'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:86:in `update'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:151:in `upsert'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:127:in `block in update_database!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:260:in `call'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:260:in `call_with_index'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:101:in `block (2 levels) in work_in_threads'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:94:in `loop'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:94:in `block in work_in_threads'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:16:in `block (2 levels) in in_threads'ruby-1.9.3-p0 :003 > \n```\n\nSo instead I tried transferring the files in multiple processes (also 50, 25, 5) and this seemed to work for a while, but eventually it also started raising exceptions, such as:\n\n```\nExcon::Errors::SocketError: No route to host - connect(2)\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:36:in `connect_nonblock'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:36:in `block in connect'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:29:in `each'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:29:in `connect'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:16:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/ssl_socket.rb:21:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `socket'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:83:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/connection.rb:20:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/rackspace/storage.rb:106:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/rackspace/requests/storage/put_object.rb:22:in `put_object'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/rackspace/models/storage/file.rb:59:in `save'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/collection.rb:50:in `create'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:230:in `store'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:79:in `store!'\n... 25 levels...\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:196:in `process_incoming_jobs'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:179:in `block in worker'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:174:in `fork'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:174:in `worker'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:115:in `block in work_in_processes'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:115:in `map'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:115:in `work_in_processes'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:55:in `map'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/parallel-0.5.5/lib/parallel.rb:32:in `each'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:121:in `update_database!'\n    from (irb):3\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/console.rb:45:in `start'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/console.rb:8:in `start'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands.rb:40:in `<top (required)>'\n    from script/rails:6:in `require'\n    from script/rails:6:in `<main>'ruby-1.9.3-p0 :004 > \n```\n\nSo just for the sake of trying I swapped out Rackspace Cloud Files for Amazon S3 to see if the issue was tied directly to Cloud Files, but the same errors occur when transferring to Amazon S3.\n\nPrior to this I was using MongoDB's GridFS and stored all 10.000 icons directly in GridFS without any issues using the same threaded approach. However, my app will be hosted on Heroku and it turns out (I found out later) that all requests would have go through the Ruby layer to access the DB and return the icons. Seeing as every page loads maybe 50+ icons, it caused a lot of noise in the logs, and I think it might also not be very performant compared to Cloud Files' CDN. So I'm trying Rackspace, but it's taking hours to upload just 10.000 small 1-72kb files without threads, while it took only 1-5 minutes when using threads in GridFS.\n\nI'm not sure whether this issue is being caused by CarrierWave or Fog, seeing as it's an Excon error, and GridFS worked, I'd say it's a Fog issue. \n\nIs there any advice you could give, or do you know of any alternative ways for cutting down the overall process time?\n\nThanks!\n\nNote: I will submit a ticket to Fog's GitHub repository referring to this one.\n Alright, I will explain what I know so far (which doesn't exactly solve the issue, but maybe it can help us narrow it down).  Excon stores most stuff in instance variables, which should get duplicated across in the thread creation no problem.  It stores sockets in thread local variables, which mean that a socket should not get duplicated into a new thread.  This prevents having more than one thread write to the same socket.\n\nSo far so good.  The problem appears to be that in one of the new threads it sees it does not have a socket and it then proceeds to try and create one.  This shouldn't be a problem in and of itself (there is even a test in the excon project for this situation, which is still passing).  For some reason in your setup, however, when it tries to create the new sockets it is passing in invalid (or perhaps unknown) values.  i.e. you can easily duplicate this error by doing this:\n\n```\nrequire 'socket'\n# This one is what I would expect, and should work:\nSocket.getaddrinfo('google.com', 80, nil, Socket::Constants::SOCK_STREAM)\n# This one is wrong and returns the error you are seeing:\nSocket.getaddrinfo(nil, nil, nil Socket::Constants::SOCKSTREAM)\n```\n\nNow, in terms of what that means toward fixing it I'm not exactly sure.  Before I dig too deep there, though, could you update the version of excon you are using?  I've done a few releases since then, so I'd first like to ensure it isn't a bug I have already solved and that it is behaving the same way against the latest version.  Otherwise I'm afraid I might end up chasing the wrong thing or in the wrong way.  Let me know what that looks like for you and we'll go from there.  Thanks!\n @geemus thanks for your reply!\n\nYes, the first thing I did was update fog/excon/fog to the latest versions, but the issue still occurs. I have been experimenting a bit with it.\n\n---\n\nI tried JRuby and used JRuby threads. I guess because they provide true concurrency this seemed to work fine. Although it doesn't solve the issue with my current setup, because my current setup will not work with JRuby and wasn't intended to. Though I'm not entirely sure if it's safe to say that it went 100% smooth and worked, because I added some basic checks such as `if !file.nil? and File.exist?(file)` before it worked. So I'm also not sure whether 100% of the files were actually transferred or not (the files were overwriting each other because of all my attempts so it's hard to tell if any potential `nil` values were actually files that were already uploaded, I will have to test this some more).\n\nI also tried spinning up multiple Ruby processes instead of threads. This is obviously not what I want to be doing due to insane memory usage compare to spinning up threads, but also using the `if !file.nil? and File.exist?(file)` it seemed to work. (Again I would have to do a clean 100% transfer in a new container to see if all 9536 files are being transferred).\n\nFurther more I noticed that when using a lot of threads/processes/jruby threads (like 100+) it will also fail to connect. I forgot the actual exception, something along the lines of `Excon::CouldNotConnect` or something. Though that might be expected due to the high amount of API requests at the same time.\n\nIn any case, the only time that it seemed to get far or fully complete was with either Ruby Processes or JRuby Threads, not with Ruby Threads, that caused it to die pretty much a few seconds in every time.\n\nI will create a new container on Cloud Files and see if I can do a 100% transfer from scratch using the `!file.nil? and File.exist?(file)` though I doubt it, because that means that the file will never for that object, unless somehow nil objects were somehow thrown in to the array. But I'll test it out again with Ruby Threads, Ruby Processes and JRuby threads just to see what results it yields.\n\nThanks for the informative response!\n Sure, I wish I could have been even more helpful but I haven't really done a lot with large thread counts so I haven't run into this personally.  Hopefully what you said will get you a bit further along.  With the Excon::CouldNotConnect you may be hitting a limit to the number of sockets/file descriptors that the system will allow simultaneously.  By no means am I certain of that, but it seems at least somewhat feasible.  Let me know how your changes work out and we can hopefully work from there.  Thanks!\n So every attempt thus far has failed. I decided to try to run it without threads or sub processes, just wrapped it in a single `#each` loop and let it upload files one by one.\n\n```\n/Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/runner.rb:49:in `eval': getaddrinfo: nodename nor servname provided, or not known (Excon::Errors::SocketError)\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:26:in `connect'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/socket.rb:16:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/ssl_socket.rb:21:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:242:in `socket'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/excon-0.7.12/lib/excon/connection.rb:83:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/connection.rb:20:in `request'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/rackspace.rb:59:in `authenticate'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/rackspace/storage.rb:87:in `initialize'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/service.rb:67:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/core/service.rb:67:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/fog-1.1.1/lib/fog/storage.rb:25:in `new'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:100:in `connection'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:298:in `connection'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:310:in `directory'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:230:in `store'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/storage/fog.rb:79:in `store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/store.rb:59:in `block in store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/store.rb:58:in `store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/versions.rb:220:in `block in store_versions!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/versions.rb:220:in `each'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/versions.rb:220:in `store_versions!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:18:in `block in with_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:18:in `each'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:18:in `with_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/store.rb:58:in `store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:347:in `store!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:217:in `store_icon!'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.1.3/lib/active_support/callbacks.rb:410:in `_run_save_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/activesupport-3.1.3/lib/active_support/callbacks.rb:81:in `run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:42:in `block in run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `call'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `run_cascading_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:41:in `run_callbacks'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence/modification.rb:23:in `prepare'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence/operations/update.rb:43:in `persist'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:86:in `update'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:151:in `upsert'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:129:in `block (2 levels) in update_database!'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:124:in `each'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:124:in `block in update_database!'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:121:in `each'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:121:in `each_with_index'\n    from /Users/Michael/Desktop/garlond/app/models/item.rb:121:in `update_database!'\n    from (eval):1:in `<top (required)>'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/runner.rb:49:in `eval'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/runner.rb:49:in `<top (required)>'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands.rb:63:in `require'\n    from /Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands.rb:63:in `<top (required)>'\n    from script/rails:6:in `require'\n    from script/rails:6:in `<main>'\n```\n\nThis happened when trying to upload the 61st icon. I tried to reproduce this again, and again the same icon (61st) failed. At first I thought maybe it was the icon itself. The I tried to `myarray[50..-1]` to see if it would die at that icon again when it isn't the 61st, but it didn't fail. Instead, it again failed at whatever was the 61st file transfer.. Then I tried it once more with a totally different array of icons, and again on the 61st transfer the above exception is raised.\n\nSo basically a single ruby process only gets to 60 file transfers before the above exception is raised. If you start a new ruby process and continue from where you left off (61st) then it continues till 120th and raises the exception at the 121st.\n Correction. Because I'm making 3 versions of each file that's being uploaded (with Carrierwave), it actually fails at the 240th file through Carrierwave.\n\n---\n\nI decided to use Fog directly without Carrierwave to see what happens, and it seems that it isn't dying at the 240th file transfer. (At the time of writing it's at 1000+ and still going (not threaded, and no sub processes). I'm pretty sure it would reach the 9536th file transfer but didn't wait it out cause it would take too long.\n\nInstead, I tried to use 20 Ruby threads (Ruby 1.9.3 by the way) and then got the `getaddrinfo: nodename nor servname provided, or not known (Excon::Errors::SocketError)` shortly after the process started (at the 100-200th file or so).\n\nThen I tried to use 20 Ruby processes instead of threads, and then it simply transferred all 9536 files. Still took a while and isn't memory efficient, but it finished without any errors.\n\n---\n\nNow what I need to test is if I use 20 ruby processes with Carrierwave whether that would still fail.\n So running 20 ruby processes with Carrierwave causes the `/Users/Michael/.rvm/gems/ruby-1.9.3-p0/gems/railties-3.1.3/lib/rails/commands/runner.rb:49:in eval': getaddrinfo: nodename nor servname provided, or not known (Excon::Errors::SocketError)` exception to be raised again, and it happens at the 4050th file transfer.\n\nThis is basically what the code looks like, very simple:\n\n``` ruby\nParallel.each(Item.all.to_a, :in_processes => 20) do |item|\n  item.remote_icon_url = item.source_icon_url\n  item.save\nend\n```\n\nSo it downloads the icon from a remote source, then processes it so I have 3 versions of the original, and then it transfers these 4 files to Cloud Files. After about 4000 file transfers the above exception is raised.\n Thanks for all the detailed data, but I'm at a bit of a loss still.  I'd say that it was perhaps just some sort of race condition or the like, but I doubt it would act quite that predictably in that case.\n @trevorturk yeah it's a bit hard to figure out what exactly is causing this issue. Prior to Rackspace I was using MongoDB's GridFS instead and it simply worked. I think I used around 100 threads to download/import the 9500 small icons without any issues (massively parallel). I have a feeling that it's just the Rackspace service that's blocking it when it gets a bunch of files in a row.\n\nIf you resume from where you left off, it will just continue anyway, and the fact that it stops after a certain amount of files have been transferred is also odd. But, as you said, while it's not normal, wrapping it in rescue blocks to just keep retrying until all of the files succeed is probably the best you can do in such cases if Rackspace (or w/e provider) is indeed actually blocking it in some way.\n\nEventually I will have to update all the images and at that time I'll have to see if I can get it to retry on fail and see if will eventually finish.\n  Via Gemnasium\n Gemnasium is a service to help developers keep up to date on their projects' gem dependencies. They're in constant flux and knowing the status of your project can help to stay on top of upgrading. It's also helpful to demonstrate to your users how up-to-date you are with the latest gem dependency versions. This image is just a snapshot of carrierwave's status from https://gemnasium.com/jnicklas/carrierwave.\n Fine to have it available as a service, but I don't see the need for a badge in the readme either.\n  Hi. Rails 3.1.1, Ruby 1.9.1-p0, CarrierWave 0.5.8 with carrierwave-mongoid.\n\nHere's what I got while saving :\n\n```\nruby-1.9.3-p0 :012 > t = TrackedAsset.edit(\"4edaad3814d0fe7d5a000001\")\n[snip]\nruby-1.9.3-p0 :013 > t.avatar = File.new(\"#{Rails.root}/tmp/xhr_uploads/7c2ee8eaed903b860f94_cni.png\", 'r')\n => #<File:/Users/erase/dev/console/tmp/xhr_uploads/7c2ee8eaed903b860f94_cni.png> \nruby-1.9.3-p0 :018 > t.save\nTypeError: can't convert nil into String\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/carrierwave-0.5.8/lib/carrierwave/uploader/url.rb:18:in `expand_path'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/carrierwave-0.5.8/lib/carrierwave/uploader/url.rb:18:in `url'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/carrierwave-0.5.8/lib/carrierwave/uploader/versions.rb:164:in `url'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/carrierwave-0.5.8/lib/carrierwave/uploader/default_url.rb:8:in `url'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/carrierwave-0.5.8/lib/carrierwave/uploader/url.rb:30:in `as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:55:in `block in as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:78:in `check_for_circular_references'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:54:in `as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:245:in `block in as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:245:in `each'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:245:in `map'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:245:in `as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:55:in `block in as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:78:in `check_for_circular_references'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:54:in `as_json'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/json/encoding.rb:245:in `block in as_json'\n... 33 levels...\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/callbacks.rb:421:in `_run_save_callbacks'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/activesupport-3.1.1/lib/active_support/callbacks.rb:81:in `run_callbacks'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:42:in `block in run_callbacks'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `call'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:67:in `run_cascading_callbacks'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/callbacks.rb:41:in `run_callbacks'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/persistence/modification.rb:23:in `prepare'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/persistence/operations/update.rb:43:in `persist'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:86:in `update'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@console/gems/mongoid-2.3.4/lib/mongoid/persistence.rb:151:in `upsert'\nfrom (irb):18\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/railties-3.1.1/lib/rails/commands/console.rb:45:in `start'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/railties-3.1.1/lib/rails/commands/console.rb:8:in `start'\nfrom /Users/erase/.rvm/gems/ruby-1.9.3-p0@global/gems/railties-3.1.1/lib/rails/commands.rb:40:in `<top (required)>'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `<main>'\n```\n\nI also got the error multiple times while creating documents, randomly. \n This happens randomly?  Works sometimes?\n\nCan you provide a failing test?\n I've had some similar problems using Fog / S3\n\nI fixed it by changing the cache_stored_file! method a little.\n\n```\n  def cache_stored_file!\n    _content = file.read\n    if _content.is_a?(File) # could be if storage is Fog\n      _tempfile = _content.read\n    else\n      _tempfile = StringIO.new(_content)          \n    end\n    sanitized = SanitizedFile.new :tempfile => _tempfile,\n      :filename => File.basename(path), :content_type => file.content_type\n\n    cache! sanitized\n  end\n```\n Sorry about the late reply.\n\nI gave a look at this issue yesterday again\u2026 and it was working. I can't reproduce the bug anymore. I haven't changed something in the uploaders setup, nor mongoid; just let a week pass while working on other parts of my app\u2026\n\nI can't reproduce the bug anymore, and don't have any failing test or more logs :(\n\nSorry & thanks for the great work. :)\n  The default behavior like this:\n\n<pre>\nuploader.url # => '/url/to/my_file.png' \nuploader.thumb.url # => '/url/to/thumb_my_file.png' \n</pre>\n\n\nBut what I want, for example, is that `uploader.thumb.url` will return `'/url/to/my_file.png_thumb'`\n There's a wiki on how to move the version name to the end of the file. Maybe you can use that as your starting point.\n  Hi guys,\n\nThank you for Carrierwave.\n\nWe use carrierwave with s3 storage and it works nice. However we need to use query params which let us override response headers. I have added this functionality.\n\nIn the same time I am creating a pull request for fog project. Carrierwave would require first changes on fog to work correctly, that's why I have left in carrierwave's Gemfile dependency to fog forked on autohaus24.\n\nPlease let me know if the changes are on acceptable level and if there is anything that could be done better.\n\nBest regards,\nMateusz Juraszek\nautohaus24.de\n of course. I also don't want you to depend on any fork, I will let you know as fast as changes get to fog project\n Hi, my changes to fog has been accepted and [merged](https://github.com/fog/fog/commit/bf66bc1a0ff86d9c52e0acaad64eea002b6fd3ca) 4 days ago to master. I guess it'll be officially released with new gem version. So we wait until then, right? or we can use that time to review pull request and change something if necessary, what do you prefer?\n Making him submit a new request isn't very helpful for users who also seek this functionality.  If you reuse the existing request, we can enable notifications for this pull request.  Otherwise, we have to continually monitor all new pull requests until Fog releases his changes as a gem, and you therefore allow him to submit a new pull request.\n This pull request can be referenced in the new one.\n\n@meceo When you do submit a new request, please squash your changes to a single commit.\n Ah, ok, I didn't realize that.  Thanks.\n Also, @meceo, thanks for this functionality.  I am currently using your fork, and it is working splendidly -- exactly what I needed.  I thought I was going to have to dig my heels in for a few hours and implement it myself, and was very pleased to see that someone already had.\n @bensie I will do squash now and make pull request again.\n\n@jsuwo I am glad I could help.\n  Hi,\nI'm building an online safe based on carrierwave and a personal cipher library.\nMy needs are quite simple, I want a user to upload a file, my Rails app encrypt it, then store it (using Fog) in any datacenter.\nThen, when retrieving the file, my app needs to decrypt it from cache, and send it to the user.\n\nMy uploader :\n\n``` ruby\nclass EncryptorUploader < CarrierWave::Uploader::Base\n  storage :fog\n\n  before :store, :remember_cache_id\n  after :store, :delete_tmp_dir\n\n  process :encrypt\n\n  def encrypt\n    cache_stored_file! if !cached?\n    #.... Encryption logic altering the cached file in place\n  end\n\n  ...\nend\n```\n\nHow I want to use it (here without activerecord for now):\n\n``` ruby\n  @uploader = EncryptorUploader.new(FakeClass.new, :fake)\n  @uploader.store!(File.open(__FILE__))\n  ...\n  #... Years later, I need to get the file back\n  @uploader.retrieve_from_store!(@uploader.identifier)\n  @uploader.cache_stored_file!\n  #... Decryption logic altering the cached file in place\n  @uploader.read\n```\n\nBut `process!` is called twice, once on `store!`, which is quite normal, but also on `cache_stored_file!` (which call `cache!` too)\nMeaning that when I want to retrieve the file, it is double encrypted... \n\nI'm not understanding, if I misuse Carrierwave, or if there is an issue in the `cache_stored_file!` feature/code.\nBTW `cache_stored_file!` have no test, so I was unable to check what was the point of this method.\n\nAnybody have any though on my case ?\n\nI'm ready to help writing code and test case on this feature or in a new feature matching my needs.\n\nPS : I checked for issue #380 & #422 but it seems to be a different case.\n Hi Trevor,\nThx for looking at this.\nI do not know with which web server I'm gonna interact with, and I'm not sure my Rails app will be allowed to write to the file location. Since then I built a method around openssl that cipher the file in place.\nI would be glad to cipher the file in webserver temporary place (less copy means less resource and more security), but I don't think it is cross-compatible.\n\nAnyhow I also wanted to point that `cache_stored_file!` behavior's seems awkward.\n  Since #449 and #458 weren't merged, the underlying problem still exists:\n\nWhen CarrierWave is loaded, the Configuration module is loaded prior to setting CarrierWave.root. At the time the configuration 'defaults' are established, CarrierWave.root is nil, causing Uploader instances to initially carry a #root value of nil, unless config.root is explicitly configured either globally or on the Uploader instance.\n\nSee #449 for full description.\n Yes, I thought it would be good to have an open issue to track the fact that you're waiting for the pull request.. please reopen?\n I don't recommend this as a real fix, but in the meantime this seems to (somewhat clunkily) work around the issue for me:\n\n```\n   def url\n      if file.respond_to?(:url) and not file.url.blank?\n        file.url\n      elsif current_path\n        root_path = root.nil? ? <PATH> : root\n        (base_path || \"\") + File.expand_path(current_path).gsub(File.expand_path(root_path), '')\n      end\n   end\n```\n\nI wouldn't use Rails.root directly there for the path as it dumps things into folders in your root dir, but you can put whatever is needed in there.\n  Any reason why this is  the case? It seems strange given that everything else is customisable. Having had a decent plough through the code I can't see any reason why it should be.\n\nIt's causing a problem for me because I want to have a mounted uploader decide where to store a file (either grid_fs or filesystem in this example) and there doesn't seem to be any workaround.\n\nYou also can't just change the class variable with something like the before_save callback because this will cause concurrency issues in a multi-threaded production server.\n  Anyone know the latest compatible version of carrierwave that works with the old cloudfiles gem and not this new fog interface? We (along with others) are getting some very strange problems and would prefer to just revert until it's fixed.\n\nRelevant fog issues:\nhttps://github.com/fog/fog/issues/621\nhttps://github.com/fog/fog/issues/554\n   Thanks for tackling this!\n Could you please release a new version to Rubygems.org? Now that Rails 3.2 is out there, getting that deprecation warning is slightly annoying and also misleading, since the call trace only points at your app's `environment.rb`. I only managed to figure out that it's from CarrierWave after monkey-plugging into the deprecation inside ActiveSupport.\n\nThanks!\n Hello!\n\nI believe there was a tagged version mentioned.\n\nCan I has? :)\n Still no fix...?\n  I understand that may be it's still to early to think about rails 3.2, but it may help in future. Right now 46 tests fails on master branch. First fail is on \"CarrierWave::Mount.mount_uploader#image_url should get the url from a cached file's version\"\n\nFull trace\n\n```\n  1) CarrierWave::Mount.mount_uploader#image_url should get the url from a cached file's version\n     Failure/Error: @instance.image = stub_file('test.jpg')\n     NoMethodError:\n       undefined method `parent_cache_id=' for {:uploader=>#<Class:0x0000000474c148>, :options=>{}}:Hash\n     # ./lib/carrierwave/uploader/versions.rb:187:in `block in assign_parent_cache_id'\n     # ./lib/carrierwave/uploader/versions.rb:186:in `each'\n     # ./lib/carrierwave/uploader/versions.rb:186:in `assign_parent_cache_id'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `block in with_callbacks'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `each'\n     # ./lib/carrierwave/uploader/callbacks.rb:18:in `with_callbacks'\n     # ./lib/carrierwave/uploader/cache.rb:112:in `cache!'\n     # ./lib/carrierwave/mount.rb:317:in `cache'\n     # ./lib/carrierwave/mount.rb:173:in `image='\n     # ./lib/carrierwave/mount.rb:158:in `image='\n     # ./spec/mount_spec.rb:196:in `block (4 levels) in <top (required)>'\n\n```\n\nI'm trying to find why it happens, but still have no idea.\n I haven't looked at Rails master with Carrierwave recently but will definitely take a look soon. Thanks for reporting!\n all errors: https://gist.github.com/1381264\n Ok. What i've found. \n1. Problem only appears when using versions. \n2. There is should be object (at place where tests crashes) instead of hash. And i don't know why it returns hashes. The required object exists in this hash under :uploader key, but it still missing some methods (including parent_cache_id)\n\nEDIT: Any ideas will be helpful :)\n issue goes away when using uploader[:uploader] instead of uploader and moving attr_accessor :parent_cache_id from included block to module ClassMethods (in uploader/verisions). but this is not right way to fix it...\n found commit which produces this issue - https://github.com/rails/rails/commit/cdc4274931c2d6bafdf2b97f7e4ecedf89a8202e\n\nreverting it allows almost all tests to pass (except one \"CarrierWave::ActiveRecord#mount_uploader#image should return valid XML when to_xml is called when image is present\" but it's another issue)\n\nHope Aaron can tell us what's happening here :)\n/cc @tenderlove \n @slbug What do you mean when you say:\n\n> issue goes away when using uploader[:uploader] instead of uploader \n\nMind pasting a gist of that?\n Already trashed it, but it's just about changing https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/versions.rb#L187 from uploader.parent_cache_id to uploader[:uploader].parent_cache_id. same change in other places too and moving attr_accessor :parent_cache_id from line 29 to line 40, but it breaks everything on stable rails, so it's not a fix :) \n Finally having a look at CW on Rails master -- before I dig deeper, were you able to find anything else worth sharing?\n @slbug I've confirmed that the Rails commit that you referenced (https://github.com/rails/rails/commit/cdc4274931c2d6bafdf2b97f7e4ecedf89a8202e) caused this issue.  Reverting it in Rails fixes the problem, but I've been unable to come up with a failing test case for ActiveSupport though to match the situation happening in CarrierWave.  This is a blocker for supporting Rails 3.2 and beyond.  /cc @trevorturk @jnicklas @tenderlove\n Just opened a Rails pull request for this that will hopefully be merged and ported to 3-2-stable: https://github.com/rails/rails/pull/4220\n @bensie thanks! I've merged the pull request to rails master and 3-2-stable.\n after accepting this pull request - https://github.com/rails/rails/commit/d1230a8cd0ddcf0497ffe294548549c2ab0bef1c all cucumber tests pass and all specs pass except just one.\n\n<pre>\nFailures:\n\n  1) CarrierWave::ActiveRecord#mount_uploader#image should return valid XML when to_xml is called when image is present\n     Failure/Error: Hash.from_xml(@event.to_xml)[\"event#{$arclass}\"][\"image\"].should == \"test.jpeg\"\n       expected: \"test.jpeg\"\n            got: nil (using ==)\n     # ./spec/orm/activerecord_spec.rb:109:in `block (4 levels) in top (required)'\n\n</pre>\n I got this error;\n\n\"undefined method `remove_previously_stored_files_after_update' for nil:NilClass\"\nHere is the error gist; \ngit://gist.github.com/1929682.git\n\nImportant point; I was using mongoid and changed it to ActiveRecord. Before doing this I upgrade to rails 3.2 and created new gemset with rvm.\nWhat can be the problem ?\n\nAlso, here is the project code; https://github.com/farukca/SocialFreight\n  Hi,\n\nas far as I understand is the storage configuration shared among all uploaders and uploader instances. \nWhile there is a storage member variable on each uploader, it's private...\n\nCan we made this changeable from the outside?\n\ne.g. some applications would like to use \"per user\" S3-Accounts/ Dropbox Session-credentials etc.\n\nthis would be very very handy...\n\nthanks!\n  Asset pipeline generator compatibility\n Should be all good to go now @trevorturk\n Yeah, I have a feeling that the issues run deeper as well. I'll take some time this weekend and step through it with the debugger and see what I find. Cheers.\n I guess this works for now since I don't have anything better to offer, but this really breaks MVC in my mind.  We're encouraging that people use view methods in the model with this.\n  Heya :-)\n\nI have a multipage file (pdf), and I'd like to store previews for all pages.\n\nWhat is the recommended method for this?\nIdeally I'd like to have:\n\npdf.file <- original file\npdf.page[2].thumbnail(:small) <-- I can't store the \"original file\" in a page (except when I split the file, but I have to deal with unsplittable filetypes too)\n  This is more of a comment than issue report.\n\n``` ruby\n# If we have this model\nclass MyModel < ActiveRecord::Base\n  mount_uploader :bam, BamUploader\n  ...\n  before_save :set_bam\n  ...\n  def set_bam\n    self.bam = File.open(\"bam\") if need_to_set_bam?\n  end\nend\n\n# Then play\nm = MyModel.new\nm.save\n\n# Result\nm.bam # => nil\n```\n\nLooks like CarrierWave is doing its magic on before_save and our callback is executed after CarrierWave's. So if we do our business on after_validation, then all is happy.\n copied into https://github.com/jnicklas/carrierwave/wiki/Known-Issues\n  This pull-request fixes #521\n yes, to stub the file. Any other Idea to stub file access or change the file?\n yep, that's the only really needed change to fix the bug. \n hope you like this change :)\n\nedit: btw, i believe we should never forget about the tests. \n Don't really like to change History, but here we go. \n Changing history feels ugly when you're working off master -- use a topic branch next time and it really doesn't hurt anything.  Squashing your commits for a pull request is a pretty common request.\n what about an minor release? \n I agree that this doesn't warrant a release just yet -- just use git master in your gemfile for now.\n  Do you consider make option to create image versions on demand instead on create?\n  Hi, \ni get an undefined method `chomp' in [sanitized_file#241](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/sanitized_file.rb#L241) when attaching msword file to carrierwave observed field. \n\n```\nundefined method `chomp' for application/msword:MIME::Type\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/sanitized_file.rb:241:in `content_type'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/sanitized_file.rb:210:in `copy_to'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/cache.rb:121:in `block in cache!'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/uploader/cache.rb:112:in `cache!'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:317:in `cache'\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/mount.rb:173:in `file='\n/Users/ben/.rvm/gems/ruby-1.9.3-p0/gems/carrierwave-0.5.8/lib/carrierwave/orm/activerecord.rb:37:in `file='\n```\n\nQuickfix idea: make sure content_type is an String and call to_s on @file.content_type before chomping. \n oh hell. It's related to Paperclip::Upfile. The PaperClip implementation dosn't always give an String back and CarrierWave calls the content_type method. Right now i have no clue how to test this. \n  No problem I'll check it out.\n Cool I'm digging in now.\n Closed by ceebf4dc1c7d46b27cac60fd4cfbde2ec2fddc0f\n Also, not sure what the deal is with 1.9.3-p0 on Travis.  It builds fine for me locally.\n\nI'm thinking a Travis problem: http://travis-ci.org/#!/jnicklas/carrierwave\n Sure, I'm on it.\n Nope, I'm not.\n\n@jnicklas - Ping!\n Thanks.\n\nHistory is updated, all ready for you to release.\n Any word from the travis guys?  Passing on 1.9.2, failing on 1.9.3, passing on ruby-head.  Nice.\n Cool I will, thx.\n  Hi, \n\nWould you like to point out the required steps to implement a new kind of storage. We're developing a S3-ish internal file service and I would like to implement a storage for this service.\n\nAny guidance would be greatly appreciated.\n\nRegards, \n\nSandro\n Sorry.\nWIll do.\n  When using process :convert => 'jpg' on a multipage PDF carrierwave throws a LocaJumpError. The reason is that convert calls manipulate!, but does not pass in a block.\n\nA possible solution is to replace the current manipulate! method under / lib / carrierwave / processing / rmagick.rb with the following:\n\n``` ruby\n    def manipulate!(options={})\n      cache_stored_file! if !cached?\n      image = ::Magick::Image.read(current_path)\n\n      frames = if image.size > 1\n        list = ::Magick::ImageList.new\n        image.each do |frame|\n            list << (block_given? ? yield( frame ) : frame)\n        end\n        block_given? ? list : list.append(true)\n      else\n        frame = image.first\n        frame = yield( frame ) if block_given?\n        frame\n      end\n\n      if options[:format]\n        frames.write(\"#{options[:format]}:#{current_path}\")\n      else\n        frames.write(current_path)\n      end\n      destroy_image(frames)\n    rescue ::Magick::ImageMagickError => e\n      raise CarrierWave::ProcessingError, I18n.translate(:\"errors.messages.rmagick_processing_error\", :e => e)\n    end\n```\n\nThis turns the multipage image into a single page image if no block is provided. Not sure if this is the best solution though as I think multilayer images will not convert properly using this approach (in theory they're just throwing an error on convert though anway...)\n I actually just ran into the same issue, and attempted to use the code above. It didn't work for me. I stopped my rails server, replaced the appropriate method, and then started my server again, no luck, same error.\n @counterbeing did you try my fork? https://github.com/pferdefleisch/carrierwave  \nnot ready for a pull request but let me know if it works for you and then I will move in that direction.\n Hey there, I didn't try your fork. I ended up playing with the manipulate function myself, but I'd love  to give it a shot :)\nI probably will try it some time soon, because I definitely sacrificed some functionality of the plugin. Specifically using pages other than the first. That is a functionality I plan on adding at some point soon, so I'm going to have to. Currently struggling with something else that is currently more important to getting done on time :/\n FYI - I havent pulled from carrierwave master since I created it Nov 21st.\n I just don't have time right now to make any promises.  If I come into some time, I will send you a patch and you can remove it from known issues.  \nMerry Christmas\n I would also love to spend some time on it. For now it might be good to throw in the known issues. Once I'm done with this project I will have a little time to work on it. Aaron, let me know if you'd like some help :)\nOn Dec 24, 2011, at 12:00 PM, Aaron Cruz wrote:\n\n> I just don't have time right now to make any promises.  If I come into some time, I will send you a patch and you can remove it from known issues.  \n> Merry Christmas\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/517#issuecomment-3268902\n @trevorturk I have no idea how to write specs for this.  Do you have any advice?\n I don't know much about writing specs, but I was sort of thinking that you would have the ability to specify a particular page of the pdf to work with, or else it would default to the first page of the pdf\u2026 Anyone else have any thoughts on that?\n\nOn Dec 26, 2011, at 10:33 AM, Aaron Cruz wrote:\n\n> @trevorturk I have no idea how to write specs for this.  Do you have any advice?\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/517#issuecomment-3276083\n I added a pull request for this issue here: https://github.com/jnicklas/carrierwave/pull/577. It's just implementing the code in the original post. It will result in the covert method sticking each frame of the pdf one after the other vertically when it's converted (I assume this is the desired behavior?).\n\nI tested this on a live app I have up and I added a spec which just tests whether the convert method of CarrierWave::Rmagick throws an error on a multi-page pdf. @counterbeing, what was the error you were getting with the original code when you tried it? \n\nI was a bit unsure of what the proper way to test this was, so I added an actual multi-page pdf into the fixtures and added a spec into processing_specs.rb.\n @chanind I'm sorry, it was so long ago, I don't even know what I was trying at that point anymore. But I see you've added a pull request, which I'm actually testing out. I had previously added your solution to my uploader, and it seemed to be working. Thanks a bunch!\n  Hi there, \n\nI\u2019m running a Rails 3.1 application and am getting an ArgumentError exception saying `invalid byte sequence in US-ASCII`. I\u2019ve found this is caused by what I think is a bug in carrierwave. First, I\u2019ve a Photo model like this: \n\n```\nclass Photo < ActiveRecord::Base\n    mount_uploader :image, ImageUploader\n\n    validates :image, :presence => true\nend\n```\n\nNow, when a user uploads a file with a name containing a non-ascii letter, the above error happens when evaluating `photo.image.url` (the uploading itself works just fine), because carrierwave assigns an US-ASCII encoding to the string where UTF-8 should be. Here\u2019s a rails console session illustrating the problem: \n\n```\nirb(main):005:0> photo.image\n=> /uploads/photo/image/110/CIMG1372\u00e4.JPG\nirb(main):006:0> photo.image.url\n=> \"/uploads/photo/image/110/CIMG1372\\xC3\\xA4.JPG\"\nirb(main):007:0> photo.image.url.encoding\n=> #<Encoding:US-ASCII>\nirb(main):008:0> photo.image.url.force_encoding(\"UTF-8\")\n=> \"/uploads/photo/image/110/CIMG1372\u00e4.JPG\"\n```\n\nAs you can see, a workaround is to use String#force_encoding, but I doubt this is the regular usecase. \n\nSome information on my environment: \n\n`ruby -v`: `ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-linux]`\n`rails -v`: `Rails 3.1.1`\n`gem -v`: `1.8.11`\ncarrierwave version: 0.5.7\ndatabase engine: sqlite3 (The application isn\u2019t online yet, there I\u2019ll be using postgres)\nOS: Arch Linux 64 bits\n\nValete,\nMarvin\n Isn't this fixed within 0.5.8?\n And in a short test any of \"\u00e4\u00f6\u00fc\" is replaced with \"_\" within the filename. \n > And in a short test any of \"\u00e4\u00f6\u00fc\" is replaced with \"_\" within the filename. \n\nI can\u2019t confirm this. I\u2019ve just re-tested with carrierwave 0.5.8, and the issue still persists: \n\n```\nirb(main):004:0> photo.image\n=> /uploads/photo/image/112/CIMG1372\u00e4.JPG\nirb(main):005:0> photo.image.url\n=> \"/uploads/photo/image/112/CIMG1372\\xC3\\xA4.JPG\"\nirb(main):006:0> photo.image.url.encoding\n=> #<Encoding:US-ASCII>\n```\n\nHere\u2019s what I did: \n1. Updated carrierwave to 0.5.8\n2. Uploaded a photo\n3. Entered the above rails console session\n\nMaybe I\u2019m using it incorrectly? Here\u2019s the `ImageUploader` class: https://gist.github.com/1380331\n\n`rails -v`: `Rails 3.1.1`\n\nValete,\nMarvin\n > Hang on a second -- is this covered in the \"Filenames and unicode chars\" section of the readme?\n\nI\u2019ve got this at the end of my `config/application.rb` (I didn\u2019t know where else to put it and it seemed like a global option):\n\n```\n# Allow non-ascii letters in uploaded filenames\nCarrierWave::SanitizedFile.sanitize_regexp = /[^[:word:]\\.\\-\\+]/\n```\n\nSeems it doesn\u2019t do the trick.\n\nVale,\nMarvin\n I have the same problem while it worked there few days ago.\nThe following line in the file `config/initializers/carrierwave.rb` :\n\n```\nCarrierWave::SanitizedFile.sanitize_regexp = /[^[:word:]\\.\\-\\+]/\n```\n\nI think the problem came with the ruby language upgrade to 1.9.3 but I don't know how to resolv this. Thank you for the help :)\n > Quintus, check out the readme and see if that helps. I think it should be a solved issue, but maybe not..?\n\nI _did_ check out the README and it says this: \n\n> Another security issue you should care for is the file names (see Ruby On Rails Security Guide). By default, CarrierWave provides only English letters, arabic numerals and '-+_.' symbols as white-listed characters in \n> the file name. If you want to support local scripts (Cyrillic letters, letters with diacritics and so on), you have \n> to override sanitize_regexp method. It should return regular expression which would match all non-allowed  symbols.\n> With Ruby 1.9 and higher you can simply write (as it has Oniguruma built-in):\n> \n>  CarrierWave::SanitizedFile.sanitize_regexp = /[^[:word:].-+]/\n\nI however added it to the end of `config/application.rb`, but further down the README recommends `config/initializers/carrierwave.rb` so I\u2019ll give that a try tomorrow.\n\nVale,\nMarvin\n The problem become from a ruby 1.9.3 bug : see http://redmine.ruby-lang.org/issues/5287\n > > a = \"\"\n> > => \"\"\n> > a.encoding\n> > => #Encoding:UTF-8\n> > \"#{a}\"\n> > => \"\"\n> > \"#{a}\".encoding\n> > => #Encoding:UTF-8\n\n```\nruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-linux]\n```\n\nIMO this is not releated to ruby from RVM, just for head\n Cannot reproduce on ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux]\nThus is ruby related.\n Same error on head. Also with rails workaround related to ruby bug. https://github.com/rails/rails/blob/fc988115f75bdca6aa95454208b49125a5041117/actionpack/lib/action_view/template.rb#L6\n Closing for now.  If someone can confirm that this is in fact a Carrierwave issue, feel free to add details to this conversation.\n I have the same problem. I'm using Russian.\n\nRails 3.2.1, ruby 1.9.3, carrierwave 0.5.8\nput in the photo_uploader.rb: CarrierWave :: SanitizedFile.sanitize_regexp = / [^ [: word:] . \\ - \\ +] /\n\nit does not help\n @lagox, try ruby 1.9.3-p125, not p0.\n thanks, i did so\n  Just found this:\n\n```\np=Person.new\np.remote_avatar_url = \"http://aloha-editor.org/images/wordpress.png\"\np.changed?\n==> false\n```\n The main problem is that if you have an existing record and try to only update the remote_url, it won't trigger a save. Right now I'm just setting another attribute to get it to work but I'll see if I can find a real fix for it.\n I ran into the issue on a nested form so yes, it's probably just limited to saving associated records.\n Good lookin'\n :)\n  After calling `MyModel.save!` a NoMethodError is thrown.\n I am on Rails 3.1\nRuby 1.9.2\n\nonly tested this in IRB, but the error occurs when assigning a file like this\n\n`m = MyModel.new\nm.file = File.open(\"blabla\")\nm.save!`\n Sorry forgot the backtrace and version...\n\nBacktrace: https://gist.github.com/1334969\nGem Version: carrierwave-0.5.7\n\nThanks a lot!\n Closing due to inactivity. This sounds like it's probably a question for the Google Group if you're just trying to get up and running with CarrierWave.\n I got this problem too, on the production server. Trying to re-trigger the bug on my dev machine now. Have no clue why this happens.\n well, i've found the cause of my problem. i mistakenly put the `mount_upload` call after the `validates :thumb` call.\n I have this problem when the uploader is in the model of a nested form.\n  Allows to set versions type and processing it later. Main purpose is to create versions in background with resque or delay_job.\nExample:\n       We have uploader with version `:preview` that have type `:delayed`:\n\n``` ruby\n  class MyUploader < CarrierWave::Uploader::Base\n\n    version :thumb do\n      process :scale => [200, 200]\n    end\n\n    version :preview, :type => :delayed do\n      process :scale => [200, 200]\n    end\n\n  end\n```\n\nWhen file is cached version :preview will not be created. And we can create it later:\n\n``` ruby\ninstance.create_versions!(:delayed)\n```\n\nalso we can create all version for this uploader by passing :all to the method:\n\n``` ruby\ninstance.create_versions!(:all)\n```\n\nand we can create few versions by passing multiple version types to the method:\n\n``` ruby\ninstance.create_versions!(:delayed, :other_version)\n```\n\nHaving different versions we can create versions by priorities.\n I like the idea of being able to specify versions in the uploader and process them later, but I'm not a fan of your API.  How about passing `delayed: true` to an options hash instead of `type: :delayed` to `*args`?\n Thanks for your comment! I've finally got it :) \n\nYour idea is good, actually I had the same idea, but when I've started to code it, I've changed my mind. \n\nSorry for bad explanation of my idea, I'll try to explain better.\n\nThe main idea of this implementation is that we can use different type for each version and then create this version when we want and by different priorities. For example:\n\nI need to create four versions of file: \n  `thumb` - should be processed when file uploaded,\n  `preview` - should be processed as soon as possible,\n  `big_preview` - should be processed but it doesn't meter when.\n  `black_n_white` - should be created on user request (may not be created)\n\nWhen I use this uploader:\n\n``` ruby\nclass MyUploader < CarrierWave::Uploader::Base\n\n  version :thumb do\n    process :scale => [200, 200]\n  end\n\n  version :preview, :type => :critical do\n    process :scale => [200, 200]\n  end\n\n  version :big_preview, :type => :low do\n    process :long_process\n  end\n\n  version :black_and_white, :type => :on_user_demand do\n    process :long_process\n  end\nend\n```\n\nthen `thumb` version will be created on file cached. And `preview` and `big_preview` versions will be created by a deamon (Resque, for example): \n\n``` ruby\n @queue = :critical\n...\n  instance.create_versions!(:critical)\n...\n```\n\nand other\n\n``` ruby\n....\n  @queue = :low\n....\n  instance.create_versions!(:low)\n```\n\nand run resque:\n\n`QUEUES=critical,low rake resque:work`\n\nAnd if user will want black and white (and other rare types):\n\n``` ruby\ninstance.create_versions!(:on_user_demand)\n```\n I still don't like the `:type => :critical` API.  I don't think it's too much duplication to declare versions and then declare types of versions on top of that.  An API like this would work for me:\n\n``` ruby\nclass MyUploader < CW::Up::Base\n  version :big, delayed: true do\n    process :long_process\n  end\n  version :even_bigger, delayed: true do\n    process :longer_process\n  end\nend\n```\n\nThere needs to be something that indicates what's happening here -- \"type\" does not reveal anything about skipping the processing at upload time.  I think \"delayed\" or \"skip\" are ok, but would welcome other suggestions.\n\n``` ruby\nclass ImageWorker\n  @queue = :critical\n  def self.perform(...)\n    # ...\n    instance.process_version!(:big)\n    instance.process_version!(:even_bigger)\n  end\nend\n```\n\nHandling the various version types belongs in the worker.  We already have a way of accessing these versions by name, adding a type category is way overkill.\n @bensie I got you. Yes your idea is much better. I'll write code in this way. Thank you.\nThank you @trevorturk !\n +1 for configuring when version processing should occur\n   I did not know about #model - thank you for this hint! \n\nWill add another pull request with a documentation update for the README.md.\n  Sometimes it is useful. \n\n```\n   def resize_to_fill!(x, y)\n     img = MiniMagick::Image.open(self.path)\n     img.resize \"#{x}x#{y}!\"\n     img.write(self.current_path)\n   end\n```\n I will check the manipulate!.  Thank you! \n\n2) The actual need is to stretch a background image to fill a screen that can be present in different sizes, and precision isn't the real need. \n  rails 3.1.1, sprockets 2.0.3, carrierwave 0.5.7\n\nthis snippet:\n\n``` ruby\nclass PhotoUploader < CarrierWave::Uploader::Base\n    include CarrierWave::RMagick\n    include Sprockets::Helpers::RailsHelper\n\n    def default_url\n       asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n    end\nend\n```\n\ngenerates following error:\n\n```\nNameError (undefined local variable or method `config' for :#<Class:0x00000008d76b78>):\n/usr/lib/ruby/gems/1.9.1/gems/actionpack-3.1.1/lib/sprockets/helpers/rails_helper.rb:11:in `asset_paths'\n/usr/lib/ruby/gems/1.9.1/gems/actionpack-3.1.1/lib/sprockets/helpers/rails_helper.rb:56:in `asset_path'\napp/uploaders/photo_uploader.rb:23:in `default_url'\n/usr/lib/ruby/gems/1.9.1/gems/carrierwave-0.5.7/lib/carrierwave/uploader/default_url.rb:8:in `url'\napp/helpers/users_helper.rb:122:in `username_with_icon'\n```\n Can you try and isolate the problem with a small example app?\n I have the same problem.  \n\nRelated question = what is the best way to add the full root_url or the S3 path in the default_url method?\n I had the same issue and fixed it the following way:\nI've added this to methods to my Uploader \n\n```\ndef config\n  Rails.application.config.action_controller\nend\n\ndef controller\n  nil\nend\n```\n\nI got the idea from https://github.com/rails/rails/blob/master/actionpack/lib/sprockets/helpers/isolated_helper.rb\nI tracked the changed in sprockets between 3.1.0 and 3.1.1 since that update broke it for me\n I worked around this by just including...\n\n``` ruby\ninclude Sprockets::Helpers::IsolatedHelper\n```\n\nSo, it will look something like...\n\n``` ruby\nclass AvatarUploader < CarrierWave::Uploader::Base\n    include Sprockets::Helpers::RailsHelper\n    include Sprockets::Helpers::IsolatedHelper\n\n    def default_url\n       asset_path(\"fallback/\" + [version_name, \"default.png\"].compact.join('_'))\n    end\nend\n```\n\nWhich is essentially what @midday was doing.\n @trevorturk, I'll create a patch to the generator.\n Forked and patched:\n\nhttps://github.com/tonycoco/carrierwave/commit/fd3993bd2bdca3f642455699152d20783cc3b900\n  Remove previously stored files after update\n  Allows for empty files to be uploaded. In most cases this may not be necessary, but in some - for example uploading assets or creating plain text files - it may.\n For me, it sounds like an pretty valid request. File size should be validated by the application. \n Yes. I think CarrierWave shouldn't validate a file's content in any way.\n I suppose a file is still a file even if it's 0 bytes.  Glad I'm not working on apps where people are uploading empty plain text files, but I guess it's a valid use case!\n Well in my case they can upload or create a plain text file which is then uploaded through CarrierWave. Theoretically it's possible people just want to structure stylesheets, javascript files which they can later on fill in, thus having 0 byte files.\n\nThanks for the merge.\n  Hi,\n\nI've done two small changes.  I've created an exists? method and modified store to overwrite a file if it already exists.  This is to because when you call store! with CarrierWave::Storage::File::store! it will overwrite the file but when you use CarrierWave::Storage::Fog::store! it calls HTTP POST - rather than PUT which throws an error if it already exists.\n\nI could not work out how the fog testing framework works.  If you could explain what needs to be done to fog_credentials and how the mocking framework works I'd be happy to add tests to this.\n @geemus any thoughts on this?\n @newmana - For which provider are you running in to this?  With S3 at least I have no problems overwriting existing files.  Thanks!\n Hello, \n\nI am using the Ninefold provider.\n\nI saw another issue recently and began tracking it down to it not implementing a   HTTP head class (can't remember exactly the class - I am on holidays). So it was throwing another exception.\n\nI'm beginning to think that it's a bug or bugs in fog and not Carrierwave.\n\nHowever, it still seems that the method to store something (if you look in the fog code) can still fail if it exists so I'd still suggest the change or a better one to match what happens on a local file system.\n\nOn 30/10/2011, at 12:45 AM, Wesley Bearyreply@reply.github.com wrote:\n\n> @newmana - For which provider are you running in to this?  With S3 at least I have no problems overwriting existing files.  Thanks!\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/477#issuecomment-2564952\n Thanks for the heads up, I had not realized that the ninefold storage semantics varied.  It appears that fog attempts to deal with this issue, as you can see here:\n\nhttps://github.com/geemus/fog/blob/master/lib/fog/ninefold/models/storage/file.rb#L76\n\nIt will PUT/POST as appropriate given whether or not the object has an id set.  That said, in carrierwave, currently, it does not check before hand to see if the object already exists (as you pointed out).  I'm reticent to add a check like you suggest though, as it would double the number of requests required (even though it is not needed in many cases).  It might be better, therefore, to just deal with the exceptional case.  Perhaps using a rescue/retry in the case of Ninefold in particular?  I think it would make sense for that to occur in carrierwave (at least as a stop gap), but I'm not sure if that behavior is expected/required in fog itself.  I welcome your thoughts on it, but that is where I'm at so far after a little research.  Thanks!\n @newmana - I believe this should accomodate overwriting files and therefore be more consistent:\nhttps://github.com/geemus/fog/commit/89f5a07c718c5a86cbd7a903a4400de8dfb09daf\nNot sure how soon I'll get a release out though.  I'll go ahead and close this as the issue is solved but not released yet.\n Thank you.\n\nThis fix has mean an unmodified carrierwave 0.5.7 works with the current HEAD of Fog.\n  Hi,\n\nI was getting random errors in my application and I hunted them down to be because of this problem. In an uploader (which uses `:file` storage), I have overriden `filename` with a timestamp dependent implementation:\n\n``` ruby\n  def filename\n    \"T#{Time.current.to_i}_#{original_filename}\" if original_filename\n  end\n```\n\nSometimes, the same filename doesn't get written to file system and database but the one of the \"next second\", and obviously then the app can't locate it. You can reproduce it always if you go down to microseconds with `Time.current.usec`.\n\nI'm using carrierwave 0.5.7. I was about to investigate and fix it myself but before doing so i wanted to check with you if there's something wrong with that timestamp dependent overriding.\n\n(BTW, if someone is bitten by this, I worked it around in my app memoizing the `filename` method):\n\n``` ruby\n  def filename\n    @memoized_filename ||= \"T#{Time.current.to_i}_#{original_filename}\" if original_filename\n  end\n```\n Maybe it isn't. I think a method that generates something that is supposed to be unique should only be called once, but the workaround is so easy that it might not be worth the time and effort to fix it.\n\nThank you\n\n(Actually, there is a wiki page about this at https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Create-random-and-unique-filenames-for-all-versioned-files, I'll add some emphasis on the importance of memoizing the method).\n It seems that this isn't even sufficient. It gets called every time the host model is saved, so it updates the filename incorrectly. It's as if we actually need to persist the timestamp in the model? or am I missing something?\n Yeah, you'd want to persist it, I think. \n I would expect filename to work with memoization for versions, but I guess it doesn't. Is there no other way of solving this without persisting the value?\n it did actually seem to work with memoization. we ran into some other problems that led me to believe i needed to persist. Ultimately, i decided to persist it just in case as I didn't understand all the cases.\n  Fog supports streaming uploads if passed a File object.\nAdded SanitizedFile#to_file method that returns a File object.\nThis works for file system based SanitizedFile (File, Tempfile, Hash, etc)\nStringIO must still be read into memory before being passed to fog.\n Other than that one thing it looks good (basically the main difference is passing a file handle, ie `File.open(path)` instead of `string` and it certainly does this.).\n Seems reasonable I think.\n Sorry, I only tested in 1.9.2. I'm getting these same failures in 1.8.7. I'll look into it and send a new pull request.\n  I am using MiniMagick to convert uploaded images to PNG and resizing them. If I convert the image first and then resize in the code, it doesn't make it into a PNG and the MIME type is set to that of the original. If I do it the other way around the conversion goes through, but the MIME type is still not `image/png` when it uploads to S3 (which I'm using as storage).\n\nThis is what my uploader looked like first:\n\n```\nclass ImageUploader < CarrierWave::Uploader::Base\n  include CarrierWave::MimeTypes\n  include CarrierWave::MiniMagick\n\n  process :convert => 'png'\n  process :resize_to_limit => [520, 832]\n\n  version :thumb do\n    process :convert => 'png'\n    process :resize_to_limit => [130, 130]\n  end\n\n  ...\nend\n```\n\nDuring the conversion above, CarrierWave saves the PNG version to the same filename, keeping the extension of the original file (e.g. `.jpg`). Then when it does the resize MiniMagick seems to use the file extension to select the output format (JPEG - I tested this using mogrify). Finally, when uploading to S3, `CarrierWave::MimeTypes` infers the MIME type based on the file extension (`image/jpeg`).\n\nI think the filename used for processing should be updated as the image is converted in order for the resizing to be done in the correct format and setting the correct MIME type.\n\nI temporarily bypassed this issue by doing the conversion after the resizing (to avoid the resize output becoming the same format as the original) and forcing the MIME type by adding a custom processor callback.\n\nThe updated uploader:\n\n```\nclass ImageUploader < CarrierWave::Uploader::Base\n  include CarrierWave::MiniMagick\n\n  process :resize_to_limit => [520, 832]\n  process :convert => 'png'\n  process :set_png_content_type\n\n  version :thumb do\n    process :resize_to_limit => [130, 130]\n    process :convert => 'png'\n  end\n\n  def set_png_content_type\n    file.content_type = 'image/png'\n  end\n\n  ...\nend\n```\n trevorturk, where can I find  \"Using RMagick\"?\n Yeah, I use the filename method in my uploader to set a `.png` filename (didn't include it above), but CarrierWave only seems to use it to set the filename for the S3 files.\n  When I use \n\n```\n u.avatar.url\n```\n\nThis return '/url/to/file.png' (this is a app path for the object, not a url). But I need get 'http://example.com:3000/url/to/file.png' . Because this is a real url. Maybe a public_url method its the soluction.\n so what is the correct way call a url to a photo stored on s3? how does one tell carrierwave to automatically append the s3 url to the beginning of the image path? only a relative URL gets stored in the DB so either the url needs to be prepended to path stored (not preferable) or get added automatically by carrierwave. where do i configure this, as it carrierwave+s3 is very common, i can't be the only one with this issue.\n  Hi,\nI'm looking for solution to be able resize images depending on\nmy model settings.\n\nSomething like that would be what I'm looking for, but it is not\nworking :(\n\nversion :thumb do\n \u00a0 process :resize_to_limit => model.thumb_size\nend\n\nI know you can access model setting when setting the store_dir but not for versions.  \nIs this a bug or is there a way to do this?\n\nYour help would be greatly appreciated!\n I see a lot of people turning to dragonfly for the lack of this feature of creating dynamic version sizes in carrierwave. It's a shame because carrierwave is a really great solution.  \n Trevor, what would it cost to have you build this feature? \n  I still hitting #337 with latest carrierwave version so decided to send pull request by myself.\n This looks good to me. You got my vote. Thanks for jumping on this.\n You're parsing the to_json output and converting it to xml, why?\n This was my quick-and-dirty hack suggestion originally on the #337 thread. There is some discussion there about `to_xml` not having an `as_xml` equivalent of `as_json`. This technique basically launders your hash through `as_json`, which handles the original `nil` issue.\n\nI haven't tested this, but perhaps a better solution would be:\n\n```\ndef to_xml(options = nil)\n  self.as_json.to_xml\nend\n```\n  Please see issue #449 for complete details. This is a resubmitted pull request on that topic.\n This needs to be rebased with master -- doesn't merge cleanly.\n What's the best way to accomplish that?\n\nThe first commit in this pull request (b4bc77270bd25a243e26513dac658a2f71c2d507) was previously merged into master (as 9c676d83e04b50949b0ab2446135f659e414c244) and later reverted by another commit (392c91dbed7d101db8392f8a1ebc8da1b74b703f).\n\nThe original code needs to be re-merged back in... tips?\n  Currently the URLs in Carrierwave are broken when using S3 with CNAME and SSL options due to the SSL certificates not matching up with the domain. The URL Carrierwave returns for example (sorry for the length) https://uploads.cdn.placester.net/logos/4d49c138df093a0793000001/4d49c138df093a0793000001.gif or if you use the S3 subdomain format https://uploads.cdn.placester.net.s3.amazonaws.com/logos/4d49c138df093a0793000001/4d49c138df093a0793000001.gif. In at least the latest Safari, Firefox and Chrome versions they'll all appear broken unless you manually view the image and confirm that it's ok.\n\nThe small change I made was to make it so any calls to the S3 storage modules public_url will return the Amazon path URL rather than the subdomain or CNAME when SSL is enabled. Using the above URL example, it will return https://s3.amazonaws.com/uploads.cdn.placester.net/logos/4d49c138df093a0793000001/4d49c138df093a0793000001.gif which loads fine.\n Ack sorry, didn't see it had been deprecated. The fog_host option will work perfectly, thanks!\n  Hello,\n\nI just started to use carrierwave and love it so far! Thanks for the great work.\n\nJust one thing: when I was saving an object associated to a picture without any change on the picture (for instance: u = user.first, u.name = \"oyoyoy\", u.save), I was getting an error in the filename function I found in the documentation:\n\nTypeError: can't convert nil into String\n    from /app/uploaders/picture_uploader.rb:48:in `extname'\n    from /app/uploaders/picture_uploader.rb:48:in`filename'\n\nI just changed the definition from\n\n  def filename\n    super.chomp(File.extname(super)) + '.png' \n  end\n\nto\n\n  def filename\n    super.chomp(File.extname(super)) + '.png' unless super.nil?\n  end\n\nand everything seems to work great now.\n\nCheers,\nAlex\n  Hi Jonas,\n\nthis patch allows one to rais CarrierWave errors with custom messages. Prior to this patch all processing errors would read: 'failed to be processed' even when one raises a CarrierWave processing error with a custom message.\n\nSimilarly CarrierWave's own integrity error message is replaced with the rather short \"is not an allowed file type\" w/o explaining what extensions are accepted.\n\nI hope you'll accept this patch.\n Could you add some tests for this behaviour, not sure I quite understand what this is doing?\n Jonas, I've added test cases and I18n all error messages. Give it try. See if you can force a ::MIME::InvalidContentType error, that is the only one missing.\n @trevorturk, conflict resolved. I do hope @jnicklas will merge the changes as the current code doesn't allow for custom error messages. These changes allow for custom error messages while preserving i18n. \n  When CarrierWave is loaded, the Configuration module is loaded prior to setting CarrierWave.root. At the time the configuration 'defaults' are established, CarrierWave.root is nil, causing Uploader instances to initially carry a #root value of nil, unless config.root is explicitly configured either globally or on the Uploader instance.\n\nThis condition was also difficult to test for (and in fact an existing test for this was hiding the error). During test setup, in 'spec_helper.rb', a value is explicitly set for CarrierWave.root _before_ any of the modules (including Configuration) are loaded. This causes the test in 'paths_spec.rb' to give false positives.\n\nIn normal operation, the Configuration module loads before CarrierWave.root is set, near the end of carrierwave.rb.\n\nRather than re-order the initialization process and module loading, I changed the Configuration module to accept Proc values for configuration values. This has the added bonus of allowing configuration values to be dynamically evaluated at runtime, rather than at startup.\n\nI have set the default value of config.root as a Proc to resolve the race condition.\n\nAdditionally, I have corrected the 'paths_spec.rb' unit test to ensure the existing test fails, exposing the error, and a new test has been added to ensure that the Proc execution resolves correctly on the uploader instance.\n The pull request was based off of stable code v0.5.7. All tests passed with the exception of one test I left failing to demonstrate the error.\n\nI will remove the failing test, since it was not properly testing the condition for which it was intended to test.\n\nIf you'll reopen the pull request, I will submit my changes shortly.\n He didn't break the build -- it's been broken on JRuby for awhile now.  You just haven't gotten the emails until now :)\n Resubmitted pull request as #458\n Oh ok -- you're right.  Cool if we remove JRuby for now?  I'm not sure how to fix and it would be nice to get accurate emails for build status.\n  With regards to the discussion started here:\nhttp://groups.google.com/group/carrierwave/browse_thread/thread/7cd699b9d97222c9\n\nThis change improves the interchangeability of File and Fog storage providers by allowing the File storage mechanism to target a subdirectory of CarrierWave.root, which for practical purposes and compatibility should probably always be Rails.public_path.\n\nThis change would allow, for example, the Fog storage mechanism to be used in production while the File storage mechanism can be used in development.\n I do not believe this issue is related to #445. \n\nThis was meant to make the 'path-within-the-store' generated by #store_path more consistent between different storage providers. Specifically, the :file mechanism assumed a base path of Rails.public_path by default. \n\nI needed a way to make the :file storage mechanism store files within a sub-directory of 'public'. However, setting CarrierWave.root (or config.root) to my preferred base path caused conflicts when I used :file storage in development and :fog in production.\n\nThis change adds a config.file_directory option, similar to what config.fog_directory provides.\n  This patch adds a config option named \"base_url\" that is used as prefix in Uploader#url (if file#url is not present).\n\nIf using Rails, \"base_url\" defaults to ENV['RAILS_RELATIVE_URL_ROOT'], so CarrierWave's local file storage now plays nicely with Rails apps deployed to subdirectories.\n I think this is good, but would you mind reworking the naming to use `base_path` instead?  This will keep consistent with the way Rails defines routing for URLs and paths - this base path does not contain the scheme or domain.  Thanks!\n Thanks for your suggestion, I renamed the option accordingly.\n Thanks, I rebased the commits.\n\nI don't think that this intereferes with #448 (I'm not completely sure about that, however). It's meant for the case where the rails application as a whole is deployed to a subdirectory (say myhost.com/foobar) and thus any url must be prefixed with /foobar. \n  I've added a section to the README that explains how to use `CarrierWave::MimeTypes` to set more-specific content-type values.\n One small comment. Carrierwave tries to call `content_type` on the file passed in to get the content type, or it also can look at the extension of the file to allow very basic guessing. If none of this works, it just leaves the content-type blank. I believe then Amazon S3, for example, sets a default content-type of `binary/octet_stream`. So it's not Carrierwave setting that.\n\nThen the processor actually uses the mime-types gem to get the content-type by actually looking at the mime-type/encoding of the file, instead of the basic stuff described above that carrierwave does.\n Thanks for the detailed explanation, Steve. I'll try to update the pull-request tonight with that info.\n Updated! Let me know what you think.\n You're welcome, mate. Thanks for the great gem!\n  if you have ssl enabled, using a cname or even the subdomain style (bucketname.s3.amazonaws.com) will cause issues. Therefore, if use_ssl is set, use the valid s3.amazonaws.com domain.\n  Hi, \n\n   I started carrieerwave  using in our project for uploading files , before that i was using simple file upload methods found its intesting\n\n```\nBut problem is for allready build data we dont have  record  values for serialization_column in our model thats why when i was  firing update  query its giving error of NOMETHOD ERROR  #{serialization_column}_changed?    means  (eg :   avtara_changed?)\n```\n\ni edit the file lib/carrierwave/mount.rb   and  written  a method   =>>     #{serialization_column}_changed?  i gving value for it :false in side it but its not a fix,  may be it can create problems in   other process and  i current ly not getting how handle this condition  can  anybody suggest me  solution for it !!!\n\nThanks \nKetan Muneshwart\n I have the same problem. It seems to be (in my case) limited to Rails 3.1.rc6\n\nMy uploader is called PhotoUploader, and I'm mounting it in my AR model as photo. On update an error is raised saying that `photo_changed?` is undefined.\n\nHas this meta method been removed in Rails 3.1? \n Issue solved: Column didn't migrate correctly.\n  I have a custom processor, using MiniMagick's `manipulate!` method. Here's a summary of my code:\n\n``` ruby\nclass PhotoUploader < CarrierWave::Uploader::Base\n  include CarrierWave::MiniMagick\n\n  storage :file\n\n  def filename\n    \"#{model.id}.#{file.extension}\"\n  end\n\n  def store_dir\n    \"uploads\"\n  end  \n\n  version :blurred do\n    process :blur\n  end\n\n  def blur\n    manipulate! do |img|\n      img = img.radial_blur 10\n    end\n  end\nend\n```\n\nProblem is, when processing this, CarrierWave throws an error:\n\n```\nNoMethodError - undefined method `write' for \"\":String:\n/Users/kmarsh/.rvm/gems/ruby-1.8.7-p302/gems/carrierwave-0.5.5/lib/carrierwave/processing/mini_magick.rb:246:in `manipulate!'\n```\n\nIt seems as though current_path is returning `\"\"` for some reason, but I'm not too sure why.\n i too am struggling with this using mini_magick's resize\n\n```\n  def resize_by_height(height)\n    manipulate! do |img|\n      img = img.resize(\"x#{height}\")\n    end\n  end\n```\n\nif i tweak the argument (`img.resize(\"'x#{height}'\")`) so it throws the CarrierWave::ProcessingError exception, the error is more helpful...\n\n```\nCarrierWave::ProcessingError: Failed to manipulate with MiniMagick, maybe it is not an image? Original Error: Command (\"mogrify -resize \"'x75'\" /var/folders/60/22_1pphd513_xj6j36smvdy80000gn/T/mini_magick20110818-83173-1j425yg.jpg\") failed: {:status_code=>1, :output=>\"mogrify: invalid argument for option `'x75'': -resize @ error/mogrify.c/MogrifyImageCommand/5423.\\n\"}\n```\n\nessentially it seems that it is is wrapping the command line arguments in quotes\n oops. forgot to include `yield(img) if block_given?`. now its working fine. perhaps its the same issue for @willcodeforfoo\n Didn't seem to make a difference for me, current_path is still `\"\"`.\n\n@trevorturk: I used your sample Sinatra app posted on the Engine Yard blog recently as a basis for a simple app that demonstrates the issue: https://gist.github.com/1157829\n That did work! So the keys for processors are:\n1. Call method directly on existing `img` rather than assigning to `img`\n2. Make sure to yield if a block is given, `img = yield(img) if block_given?`\n3. Return `img` at the end of the processor\n\n`lib/carrierwave/processing/mini_magick.rb` should probably be edited to reflect this, as it was where I was getting the code from, thinking that `img = img.foo` would work:\n\n```\n  # Or create your own helpers with the powerful manipulate! method. Check\n  # out the ImageMagick docs at http://www.imagemagick.org/script/command-line-options.php for more\n  # info\n  #\n  #     class MyUploader < CarrierWave::Uploader::Base\n  #       include CarrierWave::MiniMagick\n  #\n  #       process :do_stuff => 10.0\n  #\n  #       def do_stuff(blur_factor)\n  #         manipulate! do |img|\n  #           img = img.sepiatone\n  #           img = img.auto_orient\n  #           img = img.radial_blur blur_factor\n  #         end\n  #       end\n  #     end\n```\n\nWould you like a pull request for this change?\n\nI'll see about making a wiki page for custom processing actions.\n The details of this Wiki addition should also be reflected in the RDOC output as found here:\n\nhttp://carrierwave.rubyforge.org/rdoc/classes/CarrierWave/MiniMagick.html\n http://carrierwave.rubyforge.org/ is no longer updated\n  Native sqlite3 looks to have outbound memory access issue and it causes\nJVM to SEGV. C-ext version doesn't scale well with multi-threads on\nJRuby so use jdbc-sqlite3 gem instead of native sqlite3 gem.\n  ```\nDEPRECATION WARNING: ActiveSupport::Memoizable is deprecated and will be removed in future releases,simply use Ruby memoization pattern instead. (called from extend at /Users/kain/.rvm/gems/ruby-1.9.3-preview1/bundler/gems/carrierwave-c4459179b0f8/lib/carrierwave/mount.rb:284\n```\n Thanks -- saw this a few weeks ago.  Tried reading through the AS::Memoizable code to see exactly what we'll need to change to get the equivalent, but it was confusing so I'm procrastinating.\n\nDeprecated in 3.2, removed after that -- correct?\n You're correct, we still have plenty of time to get that fixed; I'll try taking a look but I'm really with my head into another type of codebase at the moment, thanks.\n still outstanding?\n Yes, still outstanding. \n Is there a released/stable version I can use with this fix?\n It doesn't appear that 0.5.8 has this patch; I'm looking at the 0.5.8 installed on my system, and the 'require' in carrierwave.rb and the 'extend ActiveSupport::Memoizable' in carrierwave/mount.rb, etc., are all still there. And I'm still getting the DEPRECATION WARNING with 0.5.8.\n Having my gem fixed to 0.5-stable branch seemed to work. I had 0.5.8 before that\n vsanta: Right; I only wanted to give bensie the feedback that 0.5.8 does not appear to have this fix, since he said above that he thought it did. -- In case something further needs to be done so it gets into 0.5.9. It's not an urgent issue for me.\n you're right targeting the 0.5-stable branch removed the warning \n\n``` ruby\ngem 'carrierwave', :git => 'git://github.com/jnicklas/carrierwave.git', :branch => \"0.5-stable\"\ngem 'carrierwave-mongoid', :require => 'carrierwave/mongoid'\n```\n Can we have a gemrelease for this? Please?\n +1 Gem release would be great.\n +1 Gem release pl0x\n +1 for Gem release\n :) was thinking about posting 'time to release a new gem?' for weeks +1\n +1 for gem release!\n +1 for gem release\n +1 for gem release\n I think it's not a good practice to have a gem release just for a warning (it's super-annoying I know). But, at least, give us some insight on when you'll do it or why you didn't already did it. There is really a lot of people asking for it.\n\nThank you very much for working on this gem. It's indispensable for me.\n @bensie Thank you for the quick response and clarification! And for the awesome job on this awesome gem ;)\n :clap: :clap:\n @bensie Any chance of a 0.5.9 release to incorporate this as well? We'd like to resolve the warning in carrierwave-mongoid before we fix compatibility against carrierwave 0.6. See jnicklas/carrierwave-mongoid#31.\n  I overrode the filename method according to the docs to create a unique, random filename. \n\nThe problem is that the filename saved to S3 via fog differs from what is being saved to the database. \n\ndef filename\n  \"#{SecureRandom.uuid}.#{file.extension}\" if original_filename.present?\nend\n\nEchoing filename while saving the corresponding model shows that filenames are generated 3 times. The 2nd filename is what is saved to S3, but the 3rd filename is what is saved to the database. This corresponds with the fact that original_filename.present still returns true even after the model is saved, meaning that calling filename will generate a new name.\n I'm guessing you're referring to this page: https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Create-random-and-unique-filenames-for-all-versioned-files?\n\nI edited the page to set the instance variable @name instead of just returning the random GUID. It seems to work now. Is this correct?\n  This was written off as something that Mini_Magick doesn't support but, I have tried removing pieces of Validations that would block an image from being saved in CarrierWave and Mini_Magick works just fine....\n\nI commented out:\n\n #  validates_with ProcessingValidator, _merge_attributes(attr_names) on line 66 of /lib/carrierwave/validations/active_model.rb\n\nand these lines in the same file\n## \\-      class ProcessingValidator < ::ActiveModel::EachValidator\n-        def validate_each(record, attribute, value)\n-          if record.send(\"#{attribute}_processing_error\")\n-            record.errors.add(attribute, :carrierwave_processing_error)\n-          end\n-        end\n-      end\n\nThe result:  The error is with CarrierWave's processing code and I would recommend fixing it as this is the only one that truly with Windows and without it Paperclip will probably be more favored because of its ability to be platform-independent.\n\nThis was written off as Mini_Magick not supporting windows, but if you look through its code you will find windows? with code to adjust for windows...so once again a carrierwave thing.\n I will work on it and see if I can come up with a fix, if I can I'll send a pull request\n Appears this may have never been an issue...appears that it may have been related to a :attribute_accessible in my model.  Also, used a spin-off of mini_magick called hcatlin-mini_magick\n  Given we have such uploader:\n\n``` ruby\n  class TestUploader < CarrierWave::Uploader::Base\n    include CarrierWave::RMagick\n    include CarrierWave::MimeTypes\n\n    set_content_type(true)\n\n    storage :file\n\n    after :retrieve_from_store, :get_image_dimensions\n    process :get_image_dimensions\n\n    def get_image_dimensions(file = nil)\n      if self.file.content_type =~ /image/\n         puts 'works!'\n      end\n   end\n end\n```\n\nSo,\n\n``` ruby\n  uploader = TestUploader.new\n  uploader.cache!(file) # outputs 'works!'\n  cache_name = uploader.cache_name\n\n  uploader = TestUploader.new\n  uploader.retrieve_from_cache!(cache_name) # outputs nothing because set_content_type processor is not called\n```\n\nThere is the easy fix for this issue: manually call #set_content_type(true) from #get_image_dimensions, but I think the right way is to set content_type for SanitizedFile when the file is assigned. Is'nt it?\n My english is not so good for writing documentation. :) \n\nSorry, but I do not think there is a documentation problem. Now, file's content_type is set only if file is processed at this time. If it was not - no content_type present. In many cases I want to know file's content_type without reprocessing - for example, content-type is needed to display file's download icons and so on. How could I do this?\n Okay, I'll try. I think my solution could be useful, but it should be tested with remote storage engines. I just finished the plugin to store file's metadata (dimensions, etc) that also could be used to easily integrate Jcrop to CW (I think, you saw questions in google group). I have to use this workaround in that plugin. \n\nI am going to write a README/tutorial in few hours and send you a link. If you find it useful we could integrate my plugin and tutor into CW.\n Hello. Here'is a draft version of my plugin. Everything works, but JCrop integration needs deeper explanation. I'm working on it. I'll add a wiki link when finish.\n\nhttps://github.com/gzigzigzeo/carrierwave-meta\n  When uploading files through the web interface, the files are correctly stored at the right path specified by `PhotoUploader.store_dir`. But, if you save a file manually the file path differs slightly. It appears to be dropping the `model.id` portion of the path.\n\nAs an example, a file uploaded via the web interface will have a path like:\n\n`uploads/photo/photo/3/rails.png`\n\nwhile a manually save will have the path:\n\n`uploads/photo/photo/rails.png`\n\nI have built a small sample app: [carrierwave-app-rc4](https://github.com/raid5/carrierwave-app-rc4) to demonstrate this behavior. When creating a new `Post`, if you attach any files everything will work as expected. If you do not attach any files, the controller code will manually add the `rails.png` file as an associated `Photo` for that `Post` instance. The manual association, and the root of the problem, is below:\n\n```\npost_photo = @post.photos.build\npost_photo.photo.store!(File.open(\"#{Rails.root}/app/assets/images/rails.png\"))\npost_photo.save!\n```\n `@post` should have an id after calling save on it. It has something to do with the `has_many` association between the `Post` and its `Photos`. Note, there are two different models, not a `photo` attribute on the `Post` model.\n So, the one difference is setting the photo via `photo=` instead of `store!`. I'll give this a shot.\n Yep, that seems to have fixed the issue I was seeing! Now everything is scoped under the model.id correctly. Thanks for your help, Trevor.\n  I think we probably ought to just set a minimum version and change to using the newer method, there have been lots of fixes in fog over time and I think it is likely to avoid some trouble if we can prevent people from using versions that don't have the fixes.  There is the problem of conflicts with other gems/dependencies I suppose, is that your concern with having a minimum version?\n Seems the problem is actually in the released version of fog, rather than carrierwaves usage.  This should fix it: https://github.com/geemus/fog/commit/01544701aa3629f38e463d756c32973abffa6cd5\n\nWill try to roll a release maybe next week (at a conference presently).  We may want to consider doing minimum version stuff, but probably shouldn't be an issue (especially since this bug was internal to fog so whichever version should sync with itself).\n Cool, yeah, getting that post out will be great!\n  If you like me are getting\n    Excon::Errors::Unauthorized (Expected([200, 204]) <=> Actual(401 Unauthorized)\n\nit's because you need to point to the london api server. \nconfig.fog_credentials = {\n:provider => 'Rackspace',\n:rackspace_username => 'test',\n:rackspace_api_key => '456664546565'\n:rackspace_auth_url => \"lon.auth.api.rackspacecloud.com\"\n}\n\nMaybe it would be nice to point it out in the documentation\n Sure!\nHere we go, hope it's clear enough\n\nhttps://github.com/libo/carrierwave/commit/420be3354f957c23937c3aa0bcb2d63665632f70\n  In production mode all images in asset folder have an additional hash-value added to their name, but the fallback image url provided by carrierwave url-helper don't have it, so that fallback images are not displayed in production.\n I just say that if images for fallback are in the folder app/assets/images/fallback they are not displayed in production environment\n\nwill create a demo a little later\n I'm going to hold off on looking at this until after Rails 3.1 is released -- or at least until a more stable RC is out.  The asset pipeline is such a moving target right now that it would be very tough to get this fixed with confidence that it won't break.\n\nThat said, a failing test and/or sample app would be very helpful.\n I assume @fuksito is referring to the `default_url` for displaying a \"fallback\" image when an image is not uploaded.\n @bensie, yes right default_url method, has a default path to start with \"/assets/fallback/\", so I called this a fallback image\n Here is the demo rails application:\nhttps://github.com/fuksito/carrierwave-Rails-rc5-assets-displaying-problem\n default image needs to run through rails' image_path method to pick up the correct name of the compiled asset in the asset pipeline\n Yep -- now that 3.1 is officially released, I will look into this as soon as I can.\n Thanks James, keep us posted :)\n +1 this is a problem for me too, I can't seem to make `default_url` do anything under dev/production since upgrading to Rails 3.1\n I found a workaround for this is to include  `Sprockets::Helpers::RailsHelper` into my uploader, and use `asset_path` method to define fallback image path\n\n``` ruby\nclass AvatarUploader < CarrierWave::Uploader::Base\n\n  include Sprockets::Helpers::RailsHelper\n\n  storage :file\n\n  def default_url\n    asset_path \"fallback/avatar_\" + [version_name, \"default.png\"].compact.join('_')\n  end\n\nend\n\n```\n @fuksito While I'd like to see the sprockets include moved into CarrierWave itself, your workaround is basically what I was hoping to do.  Feel free to use this for now on 3.1 -- the challenge will be maintaining backward compatibility with 3.0 and allowing for the pipeline to be disabled in >= 3.1.\n The solution from @fuksito didn't work for me, I don't know if that's because I put it into my base-class from which my up loaders inherit, or if I'm doing something wrong at the view layer:\n\n``` ruby\nclass FileUploader < CarrierWave::Uploader::Base\n  include CarrierWave::MiniMagick\n  include Sprockets::Helpers::RailsHelper\n  storage :file\n  process :convert => 'png'\n  def default_url\n    asset_path(\"/images/fallback/\" + [mounted_as, version_name, \"default.png\"].compact.join('_'))\n    ## - or - \n    asset_path(\"fallback/\" + [mounted_as, version_name, \"default.png\"].compact.join('_'))\n  end\nend\n```\n\n``` ruby\nclass ShowPosterUploader < FileUploader\n  version :thumb do\n    process :resize_to_fill => [60, 85]\n  end\nend\n```\n\n``` haml\n  = image_tag(show.poster.thumb.url, :class => 'show-image', :width => 60, :height => 85)\n```\n\nTips would be appreciated in lieu of an official fix, thanks.\n @leehambley I had a similar issue, it was because file was not on place in precompiled assets.\nBe sure that you've ran `rake assets:precompile`\nAlso try to run `rake assets:clean` before precompiling\n @fuksito thanks for the tip, peculiarly this is development mode though, so I'm not sure what I'm missing, I'll give it a shot! Thanks\n I'm also having issues with the default_url setting in Rails 3.1.  \n\nShouldn't the following test work?\n\n``` ruby\nFactory.create(:app).screenshot_url.should == \"/assets/yourapp.png\"\n```\n\nMy uploader looks like this:\n\n``` ruby\nclass ScreenshotUploader < CarrierWave::Uploader::Base  \n  include Sprockets::Helpers::RailsHelper\n  def default_url\n    asset_path \"yourapp.png\"\n  end\nend\n```\n\nI'm always getting `nil` for this field\n\nMy uploader contains the `asset_path` fix from above.\n\n(Not sure if I'm doing something wrong or if this is a Rails 3.1 incompatibility)\n That looks pretty much what like I'm doing, except I think the problem (I traced as far as I could with a debugger) - no matter what I do Rails never enters my default_url method, either on my uploader base-class, or my individual uploaders.\n _Note: I deleted my two previous comments on the issue, here's what I have so far_\n\nSo far I think the culprit is `CarrierWave::Uploader::DefaultUrl#url`, which calls `super || default_url`, that sounds quite OK, except when `super` is `CarrierWave::Uploader::URL#url`, which in-turn calls `CarrierWave::Uploader::Proxy#current_path`, which then in turn calls `CarrierWave::SanitizedFile#path`, nowhere in this call chain is there any call to `#exits?` or `#empty?`  on the instance of `SanitizedFile`. \n\nNaturally it appears that `SanitizedFile` defines `#empty?` implemented as `@file.nil? || self.size.nil? || self.size.zero?` - but that also seems never to be called in the chain of resolving the URL. \n\nFor anyone else thinking about looking into this, you'll notice that `url` is aliased as `to_s`, which is what I'm assuming Rails calls when you pass the instance of the uploader to the `image_tag`.\n Modifying the `CarrierWave::Uploader::DefaultUrl` module to be:\n\n``` ruby\n# encoding: utf-8\n\nmodule CarrierWave\n  module Uploader\n    module DefaultUrl\n\n      def url(*args)\n        super_url = super\n        File.exists?(root + super_url) ? super_url : default_url\n      end\n\n      ##\n      # Override this method in your uploader to provide a default url\n      # in case no file has been cached/stored yet.\n      #\n      def default_url; end\n\n    end # DefaultPath\n  end # Uploader\nend # CarrierWave\n```\n\nResolves this problem for me, the trouble I have with making this change is that it's quite na\u00efve of me to think this is the fix, when I still can't figure out how it should ever have worked in previous versions of Rails\u2026 am I missing something maintainers?\n If that above patch is at least somehow suitable, I'll be more than happy to make a pull request, when I have some more time tomorrow, or later in the week I'll check again to see if I can reuse `#empty?` or `#exists?` without jumping directly into bed with the standard lib.\n bump - what's the status of this, my patch here would solve the problem, but it's hardly beautiful!\n bump\n /cc @paukul\n A simple solution is don't use the asset pipeline for your default image:\n1. Put your default image back into public/images\n2. In your uploader:\n\n```\ndef default_url\n  \"/images/your-default-image.png\"\nend\n```\n @sutherland, that's what I did - and it still didn't do anything (perhaps it's fixed in a more recent version) - I'm still using my monkey patch from above.\n\nThe problem was that my `default_image` function was never being called (perhaps, now that I think about it, it was because my default_function was defined in my `BaseUploader` from which everything else inherited) - My monkey patch in an initializer works well enough for me, although I do find the `File.exits?` call a little distasteful.\n @leehambley, I'm using it in an app without any probs. It's on Rails 3.1.1 and CarrierWave 0.5.2.\n Have a look at #529 for the current solution for this.  Other ideas are most welcome!\n  Added parent_cache_name accessor to uploader. This accessor is assigned after cache!. Version with new file passed is cached only if it's cache_id not equals parent's cache_id. In other words, child version is cached only if parent file cache has changed.\n Merged -- thanks!\n  Hello.\n\nI am using last gem version of carrierwave.\n\nGiven I have this uploader:\n\n``` ruby\nclass TestImageUploader\n  process :something_happened\n  version :base do\n    process :resize_to_fill => [20, 20]\n    process :something_happened\n  end\n\n  def something_happened\n    @i ||= 0\n    puts \"Something happened #{@i} time for #{version_name || 'original file'}\"\n    @i += 1\n  end\nend\n```\n\nThis:\n\n``` ruby\n@uploader = TestImageUploader.new\n@uploader.cache!(File.open(\"spec/fixtures/small.png\"))\n@uploader.store!\n```\n\nOutputs this:\n\n```\nSome thing happens 0 time for original file\nSome thing happens 0 time for base\n```\n\nAnd this:\n\n``` ruby\n@uploader = TestImageUploader.new\n@uploader.store!(File.open(\"spec/fixtures/small.png\"))\n```\n\nOutputs this:\n\n```\nSome thing happens 0 time for original file\nSome thing happens 0 time for base\nSome thing happens 1 time for base\n```\n\nSo, version :base is processed twice!\n\nI put #puts calls to the beginning of #cache! and #store!. The following method chain is executed for last case:\n\n```\nstore! called for original file\ncache! called for original file\ncache! called for base\nstore! called for base\ncache! called for base\n```\n\nI think last cache! is called for already cached version because the new file is passed to all store! calls in version tree. I also think that fixing this will close #381. \n\n``` ruby\n# uploader/cache.rb\ndef store!(new_file=nil)\n   cache!(new_file) if new_file\n   ...\nend\n```\n Yes, I am worknig on it. But I do not know how to fix this issue.\n\nThe simpliest way is to pass parent's cache_id to underlying cache! calls and recache version only if parent's cache_id changed. Such this:\n\n``` ruby\ndef store!(new_file=nil,new_cache_id=nil)\n  cache!(new_file) if new_file && (new_cache_id.blank? || @cache_id != new_cache_id)\n  if @file and @cache_id\n    with_callbacks(:store, new_file, @cache_id) do\n  end\n  ...\nend\n```\n\nBut this way requires to change all callbacks prototypes. It is no problem for internal carrierwave's methods, but it will break all custom user callbacks after update on new version. \n\nThe workaround is to check callback's arity before call. Like this:\n\n``` ruby\ndef with_callbacks(kind, *args)\n  self.class._before_callbacks[kind].each { |c| send c, *(args.slice[0..(self.class.method(c).arity)]) }\n  ...\nend\n```\n\nBut it is not clear. May be the clearest way is to have #topmost_version accessor with the reference to uploader who initiated the cache/store process.\n Thank you. I'll try to implement this accessor and send you a pull request.\n Failing test done. Working on fix.\n\nhttps://github.com/gzigzigzeo/carrierwave/commit/133908f9c1a2c040c9db22950d7ea282e7d73cc5\n  Hi,\n\nThis is a patch to allow writing over previously assigned file when retrieving file from remote url (see https://groups.google.com/forum/#!topic/carrierwave/IMs3kYOur1E/discussion). In the second commit I've added a configuration option to make this new behavior optional so that the default behavior does not change.\n I agree that we don't need a configuration option for this -- in my mind the expected behavior would be to always overwrite the previously assigned file.\n\nMerging the first commit -- thanks!\n  Hi,\n\nI wanted to display just the filename of the uploaded file and had to dig through the docs for the commit (0ac7af9a1bf458b344e23f75a861e88aa45b8485) that introduced a way to do so.\n\nI've added the .identifier to what I think is the relevant section that would have helped me.\n\nThanks,\nKevin\n Fixed and merged in 11b79eb6b4f78c9698d137363c8cb011d755c943, thanks!\n Yup, it should be \"_\" instead of \".\" \n  I am using an application that stores files inside versioned mongoid documents with carrierwave hooking in as uploader and storing into gridfs.\nThe documents carriewave is mounted into uses mongoids builtin document versioning.\n\nBefore updating to carrierwave 0.5.6. everything worked fine as expected:\nWhenever I updated an existent document by a new file, mongoid created a new version and carrierwave stored the correct file informations into the new document version and the file into gridfs. Old files from document versions before were still reachable by asking the specific documents version url and then fetching the files from gridfs.\n\nNow after updating to 0.5.6. carrierwave still stores fine into a new document version, but now deletes the old file from the version before from gridfs. The old document version then points to a non existing gridfs-path.\nI can eliminate this behavior by downgrading to 0.5.4 where eveything works fine with versioning and reproduce the unwanted deletion when updating back to 0.5.6.\n\nThe app runs under Rails 3.0.9 with mongoid 2.0.2.\n\nHaven\u00b4t looked into the carrierwave code yet, but I assume it must come with the new function of deleting old files when updating an document, ... which isn\u00b4t wanted when using an uploader mounted into versioned documents.\n Thanks for the quick reply! \nI will check with the option you have mentioned. Didn\u00b4t know there is such a new option. But I agree, I think the default should be to not delete previously files because otherwise this option is pretty destructive for a default one. I will ping in this thread if the option workes out for me or take a look at a new pull request.\n The config option solved my problem. Now 0.5.6 also leaves \"old\" files in place when creating new document versions. Thats fine for me, thank you! \nBut I would appreciate if this change of default behavior from one version to antother could be documented somewhere, history.txt would be fine.\n\nAnd at least, thanks for the great work on this great plugin! Great stuff! :)\n  When trying to use CarrierWave on a Globalize3 Column (ActiveRecords) the app crashes with an error:\n\nundefined method `attribute_will_change! \n\nThe combination of Carrierwave and Globalize3 can be very useful if the admin wants to upload different images for different locales.\n I am using rails 3.0.9.\n\nAll you really need to do to reproduce the problem is install Globalize3 and Carrierwave then call \"translate\" on one of your columns in your model and run the Globalize migration (This basically create a new table called model_name_translations with the column you specified and a row for each locale)\n\nIf you use one of those text columns with Carrierwave you get \"undefined method `attribute_will_change!\" error\n\nGlobalize3 hides the fact that your column is in a different table by allowing you to access it using model_name.col while Globalize3 fetch the current value for your current locale and I guess this is where CarrierWave doesn't get along with Globalize3.\n Here is an example how to make translated attachments (If you have different images in different languages):\n\n``` ruby\nclass Page < ActiveRecord::Base\n  translates :title, :banner\n\n  accepts_nested_attributes_for :translations\n\n  Translation.mount_uploader :banner, BannerUploader\nend\n\n```\n\nwork fine for me\n Thanks osegrums for you snippet, but it still does not work for me. Is there any other workaround?\n @osegrums calling `mount_uploader` on `Translation` got rid of the _will_change error, but now I'm getting `undefined method 'name' for nil:NilClass`. For some reason the attribute with the uploader (@page.banner in your case) is not of class `BannerUploader` but `ActionDispatch::Http::UploadedFile`. Did you run into anything similar?\n  Compatibility with mongoid 2.1 and support for older versions of mongoid.  Related to issue jnicklas/carrierwave#400\n\nAll specs pass.\n  If I use carrierwave with mongoid 2.1.2, I got this error\n\n```\nNameError (undefined local variable or method `setup_modifications' for #<Image:0xcc3fb84>):\n  activemodel (3.0.9) lib/active_model/attribute_methods.rb:392:in `method_missing'\n  mongoid (2.1.2) lib/mongoid/attributes.rb:153:in `method_missing'\n  carrierwave (0.5.6) lib/carrierwave/orm/mongoid.rb:42:in `urls='\n  mongoid (2.1.2) lib/mongoid/attributes/processing.rb:97:in `process_attribute'\n  mongoid (2.1.2) lib/mongoid/attributes/processing.rb:25:in `block in process'\n  mongoid (2.1.2) lib/mongoid/attributes/processing.rb:23:in `each_pair'\n  mongoid (2.1.2) lib/mongoid/attributes/processing.rb:23:in `process'\n  mongoid (2.1.2) lib/mongoid/document.rb:130:in `block in initialize'\n  mongoid (2.1.2) lib/mongoid/relations/builders.rb:47:in `building'\n  mongoid (2.1.2) lib/mongoid/document.rb:127:in `initialize'\n  app/controllers/images_controller.rb:37:in `new'\n```\n\nLine 37 of images_controller.rb:\n\n``` ruby\n@image = Image.new(params[:image])\n```\n\nIt works fine with mongoid 2.0.2\n Hi,\n\nIt seems that this method has been removed in [this commit](https://github.com/mongoid/mongoid/commit/30615c6eaaaf310034e8db485a9b124ad3e549c2) in favor of using ActiveModel::Dirty methods. So it should be safe to remove it from the Carrierwave codebase (Carrierwave will only work with `mongoid >= 2.1.2` in that case).\n\nIn fact, I made the necessary changes in [my fork](https://github.com/rymai/carrierwave/commit/7e18dd399c3227a33b4afc8a215bf8b8c1f00163) and it seems to work well so far (at least, all the specs pass).\n That's great, this separated gem will be useless for me since I don't actually use CarrierWave with Mongoid models (I only have Mongoid models, but without uploader), but since Mongoid support is currently included into CarrierWave, it made my specs break. With the Mongoid support extracted from CarrierWave, I will not have to worry anymore about this!\n\nThat's good thanks! :)\n  I have just pushed pull request for carrierwave-mongoid then we can cleanup mongoid from this gem.\nYou could check it guys.\n\nWhen it will be merged it needs to bump versions of these gems.\n\nThanks.\n Merged the carrierwave-mongoid pull request. So merging this one as well.\n I'm looking back and see that I have extracted gridfs storage too but this storage can be useful in MongoMapper. Maybe MongoMapper support will be in a separate gem with his own gridfs storage or we can return gridfs to this repo. What are you think, guys?\n  CarrierWave should support storing and retrieving large files without exhausting the available memory.\n\nCurrently CarrierWave retrieves a file from remote storage by reading it wholesale into memory. This can quickly exhaust available memory, especially if a deployment caps the memory available to any given Rails process (e.g.: four cores, with four 256MB processes, one per core, on a small server, and multiple attached files in the tens to hundreds of MB).\n\nCarrierWave should offer an additional streaming API, where it will retrieve the remote file in chunks of a certain size and immediately steam the bytes to disk, possibly a Tempfile-backed SanitizedFile. Only that amount of memory would be consumed at any time and no more.\n\nLikewise for writes: CarrierWave should offer an additional streaming API for writes, where it will write a remote file from a Tempfile-backed SanitizedFile is chunks of a certain size.\n\n```\nCarrierWave.configure do |config|\n  config.streaming_chunk_size = 4 * (1024 ** 2) # 4 MB\nend\n\nclass MyModel\n  include Mongoid::Document # or any other supported\n  mount_uploader :attachment, AttachmentUploader\nend\n\nmy_tempfile = MyModel.find(73).attachment.stream_to_tempfile(*tempfile_open_args)\n\ndo_something_with(my_tempfile)\n\nMyModel.find(73).attachment.stream_from_tempfile(my_tempfile)\n```\n\nThere already is a `CarrierWave::Uploader::Cache` module and the actual API for streaming reads/writes from/to remote files could simply be the `Cache` API, with the `Cache` internals updated for streaming reads/writes.\n  form remote=> true returns html instead of js\n\nthis is true only when a file is uploaded (when a link is provided it works).\n\nAny idea what is causing this?\n would be nice if carrierwave provided once such workarounds out of the box.\n @bensie I'm totally stumped on this, I have a regular :remote => :true form with a CarrierWave file upload, and it won't go to the javascript response, just HTML. When I take out the format.html to try and force the js response, I just get a blank screen and \"Completed 406 Not Acceptable\" in the log. \nWhat are the workarounds you speak of? \n\nThanks!\n Are these alternatives to CarrierWave? Or would I use them alongside it? \n You would use them alongside it. AJAX is code on the client side. Carrierwave/Rails is code on the server side.\n  we switched from RMagick to ImageScience and all our specs that require processing failed due to missing the RMagick library.  This is due to the default ImageLoader behavior in  CarrierWave::Test::Matcher which defaults to RMagick unless ::MiniMagick is defined, as it does not have a wrapper for ImageScience.   \n\nI tried to write an ImageScience wrapper myself, using\n\n```\n  class ScienceWrapper # :nodoc:\n    attr_reader :image\n    def width\n      image.width\n    end\n\n    def height\n      image.height\n    end\n\n    def initialize(filename)\n      @image = ::ImageScience.with_image(filename) do |img| \n        img     \n      end\n    end\n  end \n```\n\n but I was unable to query the width and height, got:\n\n```\n  TypeError:\n     Bitmap has already been freed\n```\n\nAs a workaround, we've had to disable our specs that require processing.   If anybody knows how to create an ImageScience wrapper that would be useful.\n  potatosalad/carrierwave@575542a0ef1e50e96660d3af06604e476b614320 contains the fix and specs that test the problem, below is an example that causes the exception\n\n``` ruby\nclass ExampleUploader < CarrierWave::Uploader::Base\n  include CarrierWave::RMagick\n\n  storage :file\n\n  version :thumb do\n    process :resize_to_fill => [200,200]\n  end\nend\n\nclass LevelOne\nend\nclass LevelTwo\nend\nclass LevelThree\nend\nclass LevelFour\nend\n\nclass LevelOne\n  include Mongoid::Document\n\n  embeds_one :level_two\nend\n\nclass LevelTwo\n  include Mongoid::Document\n\n  embedded_in :level_one\n  embeds_many :level_threes\nend\n\nclass LevelThree\n  include Mongoid::Document\n\n  embedded_in :level_two\n  embeds_many :level_fours\nend\n\nclass LevelFour\n  include Mongoid::Document\n\n  embedded_in :level_three\n  mount_uploader :image, ::ExampleUploader\nend\n\nlevel_one   = LevelOne.new\nlevel_two   = LevelTwo.new\nlevel_one.level_two = level_two\nlevel_three = level_two.level_threes.build\nlevel_four  = level_three.level_fours.build\nlevel_four.image = open('http://www.google.com/logos/2011/fourth_of_july11-hp.jpg')\nlevel_four.save\n\nlevel_one   = LevelOne.last\nlevel_two   = level_one.level_two\nlevel_three = level_two.level_threes.last\nlevel_four  = level_three.level_fours.last\nlevel_four.image = open('http://www.google.com/logos/2011/fathersday11-hp.jpg')\nlevel_four.save\n\n# => raises \"Mongoid::Errors::InvalidCollection: Access to the collection for LevelThree is not allowed since it is an embedded document, please access a collection from the root document.\"\n```\n  << new issue based on #403 >>\n\nThis should help with situations where a file has multiple versions, and at least one of the versions is of a different format than the master version. This scenario is documented in issue #378 as well as in issue #284 (and possibly others).\n\nSimply pass :rename => true to the existing convert helper method, and the file will be renamed as well as converted. Existing functionality is preserved, i.e., the default is to not rename the image.\n\nWhen using Fog as the storage provider, you can utilize process :set_content_type to detect the new MIME type and have that relayed to the cloud storage provider.\n FYI, without this patch, if you were to call any processing commands _after_ a :convert call, the file would be converted back to it's original format. For example\n\n```\n# assume we are working on a 'pretty_flower.jpg' image\nprocess :convert => :png  #after convert, file retains .jpg extension\nprocess :resize_to_fit => [250,250] #rmagick converts back to a JPG when it writes out the file, due to .jpg extension\n```\n\nThere are, of course, other ways to work around this limitation, such as writing a custom processor that just renames the file, but was curious as to anyone else's thoughts.\n Yes, I will make the mentioned changes...\n  This commit certainly isn't necessary, although I found it interesting that the uploader file documented ImageScience and RMagick but not MiniMagick. It took me a long time before I realized it supported MiniMagick. The point of this commit is just for slightly more consistent docs, couldn't hurt right?\n  This seems to me to be a fundamentally broken feature. Unless I'm completely missing the boat on this:\n\n``` ruby\n@user.avatar = File.open('image.png')\n@user.save\n\n@user.avatar.file\n# => <CarrierWave::File ...>\n\n@user.attributes['avatar']\n# => 'image.png'\n\n@user.remove_avatar!\n@user.reload\n\n@user.avatar.file\n# => <CarrierWave::File ...>   <-- Shouldn't this be gone?\n\n@user.avatar.file.exists?\n# => false\n\n@user.attributes['avatar']\n# => 'image.png'  <-- Shouldn't this attribute be wiped?\n\n@user.send(:_mounter, :avatar).uploader\n# /path/to/file/image.png\n\n@user.send(:write_attribute, :avatar, nil)\n@user.read_attribute(:avatar)\n# => nil\n\n@user.save\n@user.read_attribute(:avatar)\n# => 'image.png'  <-- The attribute persists despite overwriting the attribute.\n```\n I have a fix. Kind of hackist. But I might submit a pull request later.\n\n```\nclass MyUplodader < CarrierWave::Uploader::Base\n  after :remove, :clear_uploader\n\n  def clear_uploader\n    @file = @filename = @original_filename = @cache_id = @version = @storage = nil\n    model.send(:write_attribute, mounted_as, nil)\n  end\nend\n```\n Can you provide some more detail, like what ORM etc?\n ActiveRecord\n Perhaps you can try to work up a failing tests and/or pull request that solves the problem? I haven't noticed a problem personally, so there's a chance you're doing something funny, but I'm not sure. Maybe a putting a simple example app on github would be a good start. \n Ok, I'll try to put one together.\n\nFor what it is worth, I do not see anywhere in the callback system where the record's `mounted_as` column is cleared and the record saved:\n\nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/remove.rb#L13-19\n Seeing same behavior as bcardarella.  Tried bcardarella's patch above, and it worked partially, however the after :remove hook is called once for each version when changing the avatar from image1 to image2 e.g.   So changing the avatar resulted in a missing avatar file.   To get this to work, I had to explicitly call the clear_uploader method on the uploader, AND save and re-find (not reload, oddly) the model to get the correct behavior\n I just stumbled on this issue too. It does feel broken to me. For now I do something like this instead:\n@my_model.update_attributes(:remove_file => true)\n @bcardarella I've also been unable to reproduce this issue.  If you provide a sample app or a failing test as Trevor requested, we can hopefully figure out what's happening. \n Hi,\n\nI am having the same issue and added a failing spec:\n\nhttps://github.com/larskuhnt/carrierwave/commit/c0ea9d78\n\nI noticed that \n\n``` ruby\n@event.remove_image = true\n@event.save!\n```\n\nworks as expected and sets the value of the image column to the empty string.\n @crhym3 this is a closed issue and you provided no additional information, so... If you're having a problem you think might be related to this, please open a new issue, provide as much detail as possible (see the \"getting help\" section in the wiki) and reference this issue if you think that might help. \n yeah, never mind. I just don't have time for this right now, sorry.\n :metal:\n I'm not holding my breathe on the team addressing this. I provided a pretty detailed bug report (yes, no failing test case) and it was closed as \"can't reproduce\" without even asking to start a conversation. Multiple users have chimed in and noted they are having the exact same problem, at the very least this issue should be re-opened rather than cast aside.\n Didn't you guys close the issue on the same day you declared you couldn't recreate it? Aug 7.\n\nI was asked on July 19 to write a failing test case. So we're talking about 20 days or so. If that is \"forever\" that's fine. You guys also closed the issue only 4 days after a 3rd person confirmed the bug.\n But it's your project, run it how you see fit.\n How's about I reopen this issue for a while and let's see if anyone steps up to help out. Obviously @bensie and I weren't able to figure out what's wrong, so here's hoping someone else can! \n https://github.com/bcardarella/carrierwave-failure\n\n`rspec spec/carrierwave_spec.rb`\n I copied the code as I exactly entered in originally so I'm not sure what it is you guys did differently.\n I confirm this misbehavior too (using ActiveRecord). From the [README](http://rubydoc.info/gems/carrierwave/0.5.8/file/README.md#Removing_uploaded_files): `If you want to remove the file manually, you can call remove_avatar!`\nWhich, of course, is not wrong in itself, but since it _is_ exposed to the ORM as a dynamic method, one should expect that it would trigger the callbacks to clear the database column to reflect the new state (which is emulated by manually doing what @larskuhnt said `@obj.remove_image = true; @obj.save`).\n\nSo I think the problem is the semantic of the API that is exposed to the ORM. Since the user is dealing at the ORM level, s/he will expect the changes to be reflected in the database too (obj.remove_image! should also perform obj.update_attribute :image, nil). Or am I wrong?\n Just throwing my 2 cents in here from an architecture standpoint.  I believe the principal of least surprise is violated when doing this:\n\n```\nmy_obj.update_attribute(:my_uploader, nil)\n```\n\nexecutes this SQL:\n\n```\nUPDATE \"my_objs\" SET \"my_uploader\" = 'the_current_file.jpg', \"updated_at\" = '2012-02-24 05:58:19.066074' WHERE \"my_objs\".\"id\" = 123\n```\n I have only just started to look into this project, but here are my thoughts. \n\n@bensie I would like to help, but could you provide a bit more detail about how this should be fixed? Here is my understanding so far: \n\nI'm not sure if there is anything wrong with the code as such, but the semantics may be confusing. There are two ways to remove the avatar in @bcardarella's example: \n\na) `@user.remove_avatar = true; @user.save!`\nb) `@user.remove_avatar!`\n\nMethod a) works as expected, the file is deleted and the column is cleared. \nIn method b), the file is removed but the column is not modified. \n\nSo I guess the question is: _Should_ the column be cleared when calling `remove_avatar!`?  \n\nThe readme says\n\n> If you want to remove the file manually, you can call remove_avatar!.\n\nAnd the rdoc says\n\n> Removes the uploaded file from the filesystem.\n\nSo the documentation makes no promise about the column being cleared. \n\nAs I said I'm just getting started here, so I may be missing something. I would like to get involved in the project, so I would appreciate a bit of guidance. Thanks :)\n It seems reasonable to clear the column to me. The column is just an identifier for the uploaded file, so if the file is gone, it should be empty, I'd say. \n That's my feeling too.\n\n## \n\nPatrick Paul-Hus\nSent with Sparrow (http://www.sparrowmailapp.com/?sig)\n\nOn Monday, 16 April, 2012 at 10:34 AM, Trevor Turk wrote:\n\n> It seems reasonable to clear the column to me. The column is just an identifier for the uploaded file, so if the file is gone, it should be empty, I'd say.\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/401#issuecomment-5153477\n Sounds reasonable. But I guess we don't want to save the entire record, just do an update_attribute (in the case of AR). Right? \n\nI'm not sure if there's a ORM agnostic way of doing this, but I'll look more into that. \n Yeah, I think that's right. Please work up a pull request and we'll take a look. \n Added https://github.com/jnicklas/carrierwave/pull/712\n  Future Mongoid fixes ) It is compatible with mongoid master, where activemodel dirty tracking was included\n hmmm. do all the specs pass ? \nActually, if I did it like this, it was because there was a problem with the #{colum}_will_change! method. Unfortunately, I'm unable to remember it.\n Yep, all pass, but only with mongoid cutting edge. It is not an actual patch just now, it is for future mongoid releases. \n\nJust look https://github.com/mongoid/mongoid/blob/83f72d7644d6b0a03dec365e668b109491112b9d/lib/mongoid/dirty.rb The is no more setup_modifications method.\n  Following RailsCast guide on carrierwave.  I'm trying to set up an image upload for my basic user model. I repeated the RailsCasts steps multiple times only to get \"uninitialized constant User::ImageUploader\"  in my users controller.  With the bundle install setting up app/uploaders/image_uploader.rb correctly, and the db:migrate for an image column in the User model, why would the controller not know ImageUploader?  RailsCasts never mentions any other steps in defining or setting up interface with Carrierwave.\n Mysterious. Are you sure you have CarrierWace in your Gemfile?\n Perhaps the app/uploaders directory isn't being required? You could try this in config.environment.rb\n\n```\nconfig.load_paths << \"#{Rails.root}/app/uploaders\"\n```\n\nI'm not sure what else. Can you upload a sample app to GitHub? I'm guessing your missing something, but since 2 people have reported this now, perhaps we could make the docs more clear or something. \n Yep, Gemfile, bundle install verified, \n Did you add app/uploaders to your autoload_paths?  For Rails 3.1 (and maybe 3.x):\n\nconfig/application.rb\n     config.autoload_paths += %W(#{config.root}/lib #{config.root}/app/uploaders)\n Yeah, me too. I think we'll need a sample app that's not working @trbartel. \n tried trevorturk suggestions and rails server did not like that line when rebooted the server\n @trbartel upload a sample app to github please.\n besie's line worked, thanks!\n That's odd because I don't think it should be necessary. @benise if you think it's appropriate can you please add something to the wiki just under the Railscast link? Perhaps we should have this documented, you know?\n Let me know if you need more clues from me, I'd be glad to help.\n @trbartel upload a sample app to github please.\n https://github.com/trbartel/coaching_app\n I have the name issue and the solution above does not work for me.  I can't upload the app because it is a closed source commercial app, but I could offer GoToMeeting or something similar.\n Also, if I try adding the like @trbartel used, I get the following error:\n\n/home/bryanrogers/Desktop/digitalAugment/da-bv-rails/config/application.rb:21:in `<class:Application>': can't convert String into Array (TypeError)\n    from /home/bryanrogers/Desktop/digitalAugment/da-bv-rails/config/application.rb:14:in`module:Bv'\n    from /home/bryanrogers/Desktop/digitalAugment/da-bv-rails/config/application.rb:13:in `<top (required)>'\n    from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.9/lib/rails/commands.rb:28:in`require'\n    from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.9/lib/rails/commands.rb:28:in `block in <top (required)>'\n    from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.9/lib/rails/commands.rb:27:in`tap'\n    from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.9/lib/rails/commands.rb:27:in `<top (required)>'\n    from script/rails:6:in`require'\n    from script/rails:6:in `<main>'\n did you set the :image as a string on your db migrate?\n Here is the migration file:\n\nclass AddImageToGames < ActiveRecord::Migration\n  def self.up\n    add_column :games, :image, :string\n  end\n\n  def self.down\n    remove_column :games, :image\n  end\nend\n Also, in case it is useful here is my Gemfile.lock\n\nGEM\n  remote: http://rubygems.org/\n  specs:\n    abstract (1.0.0)\n    actionmailer (3.0.9)\n      actionpack (= 3.0.9)\n      mail (~> 2.2.19)\n    actionpack (3.0.9)\n      activemodel (= 3.0.9)\n      activesupport (= 3.0.9)\n      builder (~> 2.1.2)\n      erubis (~> 2.6.6)\n      i18n (~> 0.5.0)\n      rack (~> 1.2.1)\n      rack-mount (~> 0.6.14)\n      rack-test (~> 0.5.7)\n      tzinfo (~> 0.3.23)\n    activemodel (3.0.9)\n      activesupport (= 3.0.9)\n      builder (~> 2.1.2)\n      i18n (~> 0.5.0)\n    activerecord (3.0.9)\n      activemodel (= 3.0.9)\n      activesupport (= 3.0.9)\n      arel (~> 2.0.10)\n      tzinfo (~> 0.3.23)\n    activeresource (3.0.9)\n      activemodel (= 3.0.9)\n      activesupport (= 3.0.9)\n    activesupport (3.0.9)\n    arel (2.0.10)\n    builder (2.1.2)\n    carrierwave (0.5.6)\n      activesupport (~> 3.0)\n    configuration (1.3.1)\n    erubis (2.6.6)\n      abstract (>= 1.0.0)\n    excon (0.6.4)\n    fog (0.9.0)\n      builder\n      excon (~> 0.6.1)\n      formatador (>= 0.1.3)\n      json\n      mime-types\n      net-scp (>= 1.0.4)\n      net-ssh (>= 2.1.4)\n      nokogiri (>= 1.4.4)\n      ruby-hmac\n    formatador (0.1.5)\n    haml (3.1.2)\n    haml-rails (0.3.4)\n      actionpack (~> 3.0)\n      activesupport (~> 3.0)\n      haml (~> 3.0)\n      railties (~> 3.0)\n    heroku (2.3.6)\n      launchy (>= 0.3.2)\n      rest-client (~> 1.6.1)\n      term-ansicolor (~> 1.0.5)\n    i18n (0.5.0)\n    json (1.5.3)\n    launchy (0.4.0)\n      configuration (>= 0.0.5)\n      rake (>= 0.8.1)\n    mail (2.2.19)\n      activesupport (>= 2.3.6)\n      i18n (>= 0.4.0)\n      mime-types (~> 1.16)\n      treetop (~> 1.4.8)\n    mime-types (1.16)\n    mini_magick (3.3)\n      subexec (~> 0.1.0)\n    net-scp (1.0.4)\n      net-ssh (>= 1.99.1)\n    net-ssh (2.1.4)\n    newrelic_rpm (3.1.0)\n    nokogiri (1.5.0)\n    polyglot (0.3.1)\n    rack (1.2.3)\n    rack-mount (0.6.14)\n      rack (>= 1.0.0)\n    rack-test (0.5.7)\n      rack (>= 1.0)\n    rails (3.0.9)\n      actionmailer (= 3.0.9)\n      actionpack (= 3.0.9)\n      activerecord (= 3.0.9)\n      activeresource (= 3.0.9)\n      activesupport (= 3.0.9)\n      bundler (~> 1.0)\n      railties (= 3.0.9)\n    railties (3.0.9)\n      actionpack (= 3.0.9)\n      activesupport (= 3.0.9)\n      rake (>= 0.8.7)\n      rdoc (~> 3.4)\n      thor (~> 0.14.4)\n    rake (0.9.2)\n    rdoc (3.8)\n    rest-client (1.6.3)\n      mime-types (>= 1.16)\n    ruby-hmac (0.4.0)\n    sass (3.1.4)\n    sqlite3 (1.3.3)\n    squeel (0.8.5)\n      activerecord (~> 3.0)\n      activesupport (~> 3.0)\n    subexec (0.1.0)\n    term-ansicolor (1.0.5)\n    thor (0.14.6)\n    tiny_mce (0.1.4)\n    treetop (1.4.9)\n      polyglot (>= 0.3.1)\n    tzinfo (0.3.29)\n\nPLATFORMS\n  ruby\n\nDEPENDENCIES\n  carrierwave\n  fog\n  haml\n  haml-rails\n  heroku\n  mini_magick\n  newrelic_rpm\n  rails\n  sass\n  sqlite3\n  squeel\n  tiny_mce\n @bryanrogers perhaps you should try uploading a sample app to github as well.\n I cannot reproduce the error on a new app, and the app I am working on is closed source.  I can get you access via iChat or something of the like to my computer if that is an option for you.  Thanks.\n I'm going to be out for a few hours, but let me know if you see something in @trbartel 's app or if you want to schedule a time to get into my machine.  Thanks again for the help, I really appreciate it.\n OK thanks for looking @bensie!\n @bensie , would you be willing to do a remote session with my computer see if you can identify what is going on with my code?  It would be very much appreciated.\n  Hey @bensie, with this commit:\n\nhttps://github.com/jnicklas/carrierwave/commit/4e77a7fbd1e48ddc3ba06dc2a74caa6177e7977b\n\nI think you're introducing a dependency on ActiveSupport::Deprecation. I noticed this while building this:\n\nhttps://github.com/trevorturk/sinatra-carrierwave-fog/commit/48a4a4e0dc23a6b9a4130a86e02f14c519c99d6c\n\n...example app for an Engine Yard \"how to use CW with Fog\" post. I'm able to work around it, and I've put a potential fix into CW already, but I'm wondering if you think there's a better way to accomplish what you're doing. Perhaps we don't need to silence? I dunno. Lemme know what you think. \n I think that's good enough -- I just wanted to check in with you since I added that require. Thank you!\n  I'm getting failures like: https://gist.github.com/e64988d5e76d3d0d3255 when running the remote tests (as per the instructions at the bottom of the readme) -- can someone else run and confirm if this is just a problem for me?\n Damn. Hey @geemus did you change something you can think might have impacted this? \n @trevorturk - nothing off the top of my head, I'll give it a shot on my end and see what I come up with.\n @trevorturk that appears to fix it, but its one of those things where looking at it I'm not sure how it ever worked without that diff so I couldn't exactly put my finger on what introduced the issue.  Anyway, should be good to go again for now.\n Sweet. Thanks for looking at that!\n  When encountering a blank uploader, carrierwave can halt other operations from finishing.  I encountered this issue while using state_machine and carrierwave together (rails 3.0.9, ruby 1.9.2, mongoid 2.1).\n\nUnfortunately I was not able to reproduce the issue in carrierwave's specs.  When using \"normal\" callback definitions, the 'nil' returned by :store! did not halt the chain, or else I could not get the callback ordering correct so that the :store! method fired first.\n\nAny thoughts on how that callback could be actually testes would be great, otherwise explicitly returning true for the result of that operation does not seem out of line, and all the current specs pass with the change.\n\nThanks,\nDave\n I think this might be causing my validations to silently fail. Is there any way to trace the callback chain to track down where things are halting?\n @avishai are you saying you've tested this change and had problems?\n hey,\n\ni'm using the latest release and i'm having problems with this. im not sure\nthat it has to do with carrierwave, but the issue seems to have popped up\nsince switching to carrierwave.\n\n-avishai\n\nOn Tue, Jul 12, 2011 at 6:12 PM, trevorturk <\nreply@reply.github.com>wrote:\n\n> @avishai are you saying you've tested this change and had problems?\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/389#issuecomment-1554951\n Can you please try to be more clear? I'm not sure what you're talking about. Do you have a problem with this pull request, or are you just having problems with CarrierWave in general?\n Hey,\n\nUnfortunately I think I didn't fully understand what was going on before\nopening that issue. Sorry about that.\n\n-Avishai\n\nOn Wed, Jul 20, 2011 at 9:04 AM, bensie <\nreply@reply.github.com>wrote:\n\n> I'm having trouble understanding what this fixes.  You said:\n> \"When using \"normal\" callback definitions, the 'nil' returned by :store!\n> did not halt the chain\"\n> \n> Under what circumstance did it halt the chain?  Can you provide some sample\n> code from your application to help me understand the use case?\n> \n> Returning `true` from that method if the uploader is blank seems\n> counter-intuitive to me (and without any comments or tests the intent is\n> unclear), but maybe further explanation can clear this up.\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/389#issuecomment-1613186\n The \"normal\" statement was just when testing against some additional simple callbacks that I was defining in the tests, but was able to consistently demonstrate the issue when running against a model using state_machine defined transitional callbacks with a mongoid document.\n\nSomewhere something is, most likely incorrectly, interpreting the 'nil' returned when there is a blank uploader as \"something failed, halt the callback chain.\"  This was only intended to remove any vagueness of the result of this callback when there is a blank uploader, just returning a successful true from the operation if there is nothing for it to act on.\n Yeah, will be probably ~ week and a half.  Underneath a big project launch right now.  I should be able to re-test then and try to pull together a sample app and update this ticket.\n  anyone else getting is error when saving mongoid document with mounted uploader? I just pulled fresh master and started seeing this... \n\n```\nundefined local variable or method `setup_modifications'\n```\n\nI have an uploader for binary files; therefore, no image processing is defined.\n\nI'm using:\n- rails ( 3-1-stable)\n- mongoid (master)\n- carrierwave (master)\n I have the same issue with rails 3.0.9, mongoid (master), and carrierwave 0.5.5.\n\nReverting to carrierwave 0.5.4 fixed the issue for me.\n I did some digging late lastnight, looks like its related to the dirty tracking -- monogoid (master) now implements the ActiveModel::Dirty vs its previous methods (setup_modification and @modifications). Haven't had time to figure out what needs updating yet to get this all working again.\n BTW we should consider fixing this in the carrierwave-mongoid gem if/when we figure it out. \n Could someone explain to me why [here](https://github.com/skyeagle/carrierwave/blob/bdc6788e3a1e4b777613a3fb54e9d3915fe51649/lib/carrierwave/orm/mongoid.rb#L13) we are overwriting deafult mount_on option and saving into #{}_filename. If we can back to default as it in AR than we can remove all hacks arround dirty attributes and it will work out of the box. Thanks\n Whenever mongoid support was added, this was set as the default. You can see here:\n\nhttps://github.com/skyeagle/carrierwave/blame/bdc6788e3a1e4b777613a3fb54e9d3915fe51649/lib/carrierwave/orm/mongoid.rb\n\nThat seems like a mistake to me, but here we are. Jonas an I discussed and didn't want to break backwards compatibility. If we extract mongoid support into a separate gem, them maybe it's less of an issue (people can upgrade carrierwave without upgrading carrierwave-mongoid) but I'm not sure. \n\nAny ideas given that we'd like to not break backwards compatibility? \n For backwards compatibility folks may add `:mount_on => 'image_filename'` but they won't have dirty attributes methods for `image` otherwise for `image_filename` as we have at the moment. I suppose we shouldn't move away of consistency with AR.\n Sorry, I'm not clear on what you're suggesting. \n Sorry for my poor English. I suggest to fix mount_on to default uploader name(ex. pic, image etc.) and remove all that concerns with dirty attributes(let mongoid worry about it). People who have already had old versions of gem will be prompted about new behavior and they can change the field name. I think it's more simpler than other ways.\n Yeah, I'm not sure we should change backwards compatibility. Maybe others using Mongoid can decide (I'm not using it) and perhaps it's not a big deal if it's done in the other new gem. \n I would have no problems with @skyeagle's suggestion or a new gem.\n Well, I'm happy to discuss here or the Google Group, but I'd like to suggest we make changes in the new gem because Mongoid support in this particular repo is going away soon. \n\nSee: https://github.com/jnicklas/carrierwave/issues/327\n\nBTW this is not a slight about Mongoid support -- there are good reasons all around for separating this into a new gem as we did with Sequel and Datamapper.\n Please followup about this issue in the new carrierwave-mongoid gem repo: https://github.com/jnicklas/carrierwave-mongoid\n\nWe're going to remove mongoid support from this repo shortly. \n @trevorturk Are users of Mongoid supposed to use [carrierwave-mongoid](https://github.com/jnicklas/carrierwave-mongoid)? I ask because carrierwave-mongoid hasn't been updated since May 24, 2011, and CarrierWave still contains support for Mongoid.\n I'm not sure, sorry. I'm hoping that @gucki and @jnicklas will sort things out. For now, @bensie has been merging things into this repo, since we're waiting to get clarification about the new carrierwave-mongoid repo (and if we're keeping it around, getting the newer stuff from this repo over there, too). \n Thanks for the quick response, Trevor. I've got CarrierWave 0.5.4 working with Mongoid, and without carrierwave-mongoid. I'll keep my eye on carrierwave-mongoid, though!\n Users have to use this gem till new version of mongoid not being released. It works with the latest mongoid stable release. I suppose there is the goal to make separated gem works with cutting edge of mongoid. But it's very unstable at the moment and we should not move forward so fast. Give me a few days guys and i will fix the separated gem for the edge mongoid.\n @skyeagle Yeah, Mongoid's changing pretty quickly these days, and I don't expect other gems to keep up with Mongoid HEAD.\n\nSo I should use the latest version of CarrierWave and carrierwave-mongoid, rather than just CarrierWave 0.5.4?\n @nickhoffman I don't know the state of the carrierwave-mongoid gem at this moment. The carrierwave alone works with latest stable mongoid(in my case it's the 2.0.2 version and edge for carrierwave).\n @skyeagle Thanks for the info. Since I'm using Mongoid HEAD, I'm going to stick with CarrierWave 0.5.4 . When Mongoid 2.1.0 is released and carrierwave-mongoid is updated to work with it, I'll look into upgrading to the latest stable version of CarrierWave.\n Well I can confirm that CarrierWave 0.5.6 and Mongoid 2.1.2 are not working together, switching back to carrier waver 0.5.4 too\n I'm giving carrierwave-mongoid a spin with @skyeagle's latest master following the [pull request thread](https://github.com/jnicklas/carrierwave-mongoid/pull/2), and my tests are passing and things are initially looking good.\n\nAll that was needed was the specification of `:mount_on => :image_filename` as noted above for backwards compatibility. @trevorturk, as a Mongoid user my opinion personally is to standardize going forward -- it's a small matter to add this option when updating, and ought to be caught in tests if people fail to heed release notes.\n\nAlso, I'm not familiar with what Carrierwave is doing with dirty tracking, but Mongoid 2.1 uses ActiveModel for this now and has a number of related fixes, so hopefully that can help to clean up any Mongoid-specific hacks.\n same problem: undefined local variable or method `setup_modifications'\n\nthis gems set working for me at 26.08.2011\n\ngem 'bson_ext'\ngem 'carrierwave'\ngem 'paperclip', '~> 2.3.10'\ngem 'mongoid-paperclip', :require =>'mongoid_paperclip'\ngem 'carrierwave-mongoid', :require => 'carrierwave/mongoid'\ngem 'mongoid', :git => 'git://github.com/pyromaniac/mongoid.git'\n Did you try `bundle update`?\n No, but I will do that later. Pyromaniac say to me: \"just do that\", and I did )\n  When uploading a file on some deploys I get\n\n```\nNoMethodError (undefined method `content_type' for nil:NilClass)\n```\n\nIt's this comit that's at fault: https://github.com/jnicklas/carrierwave/commit/6f53ebb9b043f3b09161681a205981d7b21a3cae\n\nOn some systems it works ...\n\nI propose this patch:\n\n``` ruby\n  def retrieve_from_cache!(cache_name)\n    with_callbacks(:retrieve_from_cache, cache_name) do\n      self.cache_id, self.original_filename = cache_name.to_s.split('/', 2)\n      @filename = original_filename\n\n      if (File.exist?(cache_path) && \n          defined?(MIME::Types) &&\n          MIME::Types.of(File.basename(cache_path))[0].present?) # <- extra check !!!\n        @file = SanitizedFile.new(\n          :tempfile => cache_path,\n          :filename => @filename,\n          :content_type => MIME::Types.of(File.basename(cache_path))[0].content_type\n        )\n      else\n        @file = CarrierWave::SanitizedFile.new(cache_path)\n      end\n    end\n  end\n```\n Yeah, that looks good -- please try to come up with a pull request with tests if possible!\n Is this also whats causing recreate_versions! to fail here?\n\ninst = ImageUploader.new\n =>  \nruby-1.9.2-p180 :005 > inst\n =>  \nruby-1.9.2-p180 :006 > inst.recreate_versions!\nNoMethodError: undefined method `read' for nil:NilClass\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/activesupport-3.0.7/lib/active_support/whiny_nil.rb:48:in`method_missing'\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/carrierwave-0.5.5/lib/carrierwave/uploader/cache.rb:73:in `cache_stored_file!'\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/carrierwave-0.5.5/lib/carrierwave/uploader/versions.rb:174:in`recreate_versions!'\n    from (irb):6\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.7/lib/rails/commands/console.rb:44:in `start'\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.7/lib/rails/commands/console.rb:8:in`start'\n    from /Users/houen/.rvm/gems/ruby-1.9.2-p180/gems/railties-3.0.7/lib/rails/commands.rb:23:in `<top (required)>'\n    from script/rails:6:in`require'\n    from script/rails:6:in `<main>'\n @houen I can't read that. Can you paste into a gist?\n Sure thing: https://gist.github.com/1076237\n\nI did, however, try to copy in clyfe's patch above, and that didnt fix it\n No, as far as I can tell it depends on the environment in which is run (interpreter, gems), making `MIME::Types.of` return different stuff. \n\nGiven a test, it would always pass or fail depending on the environment in which is executed.\n I'm wondering if we should just remove this feature since we have this now:\n\nhttps://github.com/jnicklas/carrierwave/commit/697b9f6bbc18f9a914592f729bbd2b147222ad6f\n\nThoughts?\n I have the same issue as above:\nNoMethodError (undefined method `content_type' for nil:NilClass)\n\nLocally on my Mac it works and on my production servers with Ubuntu 11.04/Ruby 1.9.2./Rails 3.0.5/carrierwave 0.5.4 it is not working...\n\nIs there a official solution?\n  When CarrierWave raises `CarrierWave::ProcessingError`, it should not set the new image equal to the failed image name.  Otherwise, you end up with a bad image attribute for a file that doesn't exist and it shows up on the website as a bad image URL.\n\nI would recommend saving the state of the image field and rolling back if an exception is thrown.  If you can recommend a way to do this as a temporary fix, I would greatly appreciate it since this is an ongoing issue with our site.\n\nThanks guys!\nRob\n Have you set the configuration options to raise this exception? https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/configuration.rb#L151\n\nI'm not 100% sure what you're suggesting -- a pull request expressing your idea might be helpful. \n Hey Trevor,\n\nBy default, the configuration options raise the exception.  What I was saying is that if that exception is raised, why would CarrierWave go forward with replacing the old image with a new one that had a processing error raised on it?  You would think that CarrierWave should not replace the old image if ANY error was thrown, sort of like a transaction block.  If something went wrong in the block, roll back the state to what it was.  If everything went as it should, then replace the old image with the new one.\n\nI can look into the CarrierWave code, but I'm not sure I understand it well enough to easily change this.\n OK thanks for having a look!\n @bensie Here is the uploader (pretty basic) https://gist.github.com/1095033\n\nIt happens under all scenarios you listed using CarrierWave 0.5.4.  An easy way to replicate the error would be to create a text document, give it a .png extension, and then pass it into the model object as a remote_url.  You'll see that there will be a processing error, but CarrierWave still replaces the model image attribute with the name of the new image (even though it failed)\n Please try out CW from master and report back if this issue persists.\n Sincerely sorry for the extremely delayed response.  It appears that the above referenced commit (https://github.com/jnicklas/carrierwave/commit/d3e7ed76a7863390475ffbdf5ae810b643144dc1) did not fix the ProcessingError issue.  Carrierwave still continues to set the `image` attribute to the bad image value even though there was a processing error.  I am using CW from the current master branch in my Gemfile.\n\n`#<CarrierWave::ProcessingError: Failed to manipulate with MiniMagick, maybe it is not an image? Original Error: MiniMagick::Invalid>`\n\nThe above steps are still valid for recreating the issue:\n\n> An easy way to replicate the error would be to create a text document, give it a .png extension, and then pass it into the model object as a remote_url. You'll see that there will be a processing error, but CarrierWave still replaces the model image attribute with the name of the new image (even though it failed)\n  Initially: \"apply the removing old file function to the mongoid orm\"\n\nI merged my local mongoid branch with your master branch from the official repo. So it should suggest the \"merge automatically\" option. I also fixed a tiny bug related to the way the mongoid dirty module works.\n\nHope it will be good now :-)\n f**ck, I did the squash stuff for the commits :-(\n okay if I try to do a rebase, git includes all the commits even the ones from the master branch. Any suggestions ?\n @bensie thanks for working on this. Lemme know if you need any help. Good work, @did!\n @bensie Thanks man !!!!! Looks like if I need help with git, I know now an expert ;-)\n Awesome. I think we're ready enough for a gem release. @bensie sound ok to you? I'll handle the changelog/release/etc but just checking that you think the outstanding issues are not worth holding back a release.\n  While investigating issue #378, I noticed that an unmounted uploader handles version processing differently than one that is mounted. Specifically, an unmounted uploader creates each version from the original image, rather than any parent version; a mounted uploader, on the other hand, creates each version using any parent version as the starting point.\n\nFor example, here is a FooUploader that should resize the incoming image to 500x500, create a \"standard\" version at 250x250 and then mirror the standard version. In the end, the \"standard mirrored\" version should also be 250x250.\n\n``` ruby\nclass FooUploader < CarrierWave::Uploader::Base\n\n  include CarrierWave::RMagick\n\n  storage :file\n  process :resize_to_fit => [500,500]\n\n  version :standard do\n\n    process :resize_to_fit => [250,250]\n\n    version :mirror do\n      process :flop => [false]\n\n      def flop(foo)\n        manipulate! {|img|\n          img.flop!\n        }\n      end\n\n    end\n\n  end\n\nend\n```\n\nAssume we also have a Foo model that looks like this:\n\n``` ruby\nclass Foo < ActiveRecord::Base\n  mount_uploader :foo, FooUploader\nend\n```\n\nHere's what happens on the Rails console when we invoke the FooUploader in various ways:\n\n```\n>> foo = FooUploader.new\n=> #<FooUploader:0x1039957b0 @mounted_as=nil, @model=nil>\n>> foo.store! File.open('/Users/jcarlson/Desktop/DSC_0171.jpg')\n=> [:store_versions!]\n\n$ ls -al public/uploads/\ntotal 816\ndrwxr-xr-x   6 jcarlson  staff     204 Jun 26 20:14 .\ndrwxr-xr-x  12 jcarlson  staff     408 Jun 20 00:52 ..\n-rw-r--r--@  1 jcarlson  staff    6148 Jun 26 20:14 .DS_Store\n-rw-r--r--   1 jcarlson  staff   92780 Jun 26 20:14 dsc_0171.jpg\n-rw-r--r--   1 jcarlson  staff   33064 Jun 26 20:14 standard_dsc_0171.jpg\n-rw-r--r--   1 jcarlson  staff  276004 Jun 26 20:14 standard_mirror_dsc_0171.jpg\n$ \n```\n\nNotice that the \"standard_mirror\" version is the largest of the bunch in terms of filesize. Indeed, inspecting the image reveals it is as large as the original image, just mirrored. Now lets give it another go through the model this time:\n\n```\n>> foo = Foo.create :foo => File.open('/Users/jcarlson/Desktop/DSC_0171.jpg')\n=> #<Foo id: 2, foo: \"dsc_0171.jpg\", created_at: \"2011-06-27 00:18:38\", updated_at: \"2011-06-27 00:18:38\">\n\n$ ls -al public/uploads/\ntotal 344\ndrwxr-xr-x   7 jcarlson  staff    238 Jun 26 20:18 .\ndrwxr-xr-x  12 jcarlson  staff    408 Jun 20 00:52 ..\n-rw-r--r--@  1 jcarlson  staff   6148 Jun 26 20:18 .DS_Store\n-rw-r--r--   1 jcarlson  staff  92780 Jun 26 20:18 dsc_0171.jpg\n-rw-r--r--   1 jcarlson  staff  33199 Jun 26 20:18 standard_dsc_0171.jpg\n-rw-r--r--   1 jcarlson  staff  33567 Jun 26 20:18 standard_mirror_dsc_0171.jpg\n$\n```\n\nThis time the \"standard_mirror\" version is (nearly) identical in size to the \"standard\" version.\n\nSo you can see how versions are handled differently based on how the uploader was used. Please let me know if I can provide additional information to help replicate this issue.\n Is this with the master branch? I think you may have encountered an issue that was recently fixed, but I'm not sure. \n That's a good question and I am using the latest released 0.5.4 version of the gem... I'll see if upgrading to master yields the same problem.\n @jcarlson we're hoping to get a gem release out soon, but this is worrying us a bit. Can you test with the master branch and report back when you have a chance? Thanks!\n I will do my best to test this later tonight. Stay tuned.\n As best I can tell, this problem still exists when using the master branch (commit 3850f67ce1b7d25db595c3e2ec28b81ac172467c)\n\n```\n>> foo = FooUploader.new\n=> #<FooUploader:0x103a280d8 @mounted_as=nil, @model=nil>\n>> foo.store! File.open('/Users/jcarlson/Desktop/DSC_0171.jpg')\n=> [:store_versions!]\n\n$ ls -al\ntotal 816\ndrwxr-xr-x   7 jcarlson  staff     238 Jun 27 22:29 .\ndrwxr-xr-x  12 jcarlson  staff     408 Jun 20 00:52 ..\n-rw-r--r--@  1 jcarlson  staff    6148 Jun 27 22:31 .DS_Store\n-rw-r--r--   1 jcarlson  staff   92780 Jun 27 22:31 DSC_0171.jpg\n-rw-r--r--   1 jcarlson  staff   33064 Jun 27 22:31 standard_DSC_0171.jpg\n-rw-r--r--   1 jcarlson  staff  276004 Jun 27 22:31 standard_mirror_DSC_0171.jpg\ndrwxr-xr-x   6 jcarlson  staff     204 Jun 27 22:31 tmp\n$\n```\n\n```\n>> foo = Foo.create :foo => File.open('/Users/jcarlson/Desktop/DSC_0171.jpg')\n=> #<Foo id: 2, foo: \"DSC_0171.jpg\">\n\n$ ls -al\ntotal 344\ndrwxr-xr-x   7 jcarlson  staff    238 Jun 27 22:29 .\ndrwxr-xr-x  12 jcarlson  staff    408 Jun 20 00:52 ..\n-rw-r--r--@  1 jcarlson  staff   6148 Jun 27 22:33 .DS_Store\n-rw-r--r--   1 jcarlson  staff  92780 Jun 27 22:33 DSC_0171.jpg\n-rw-r--r--   1 jcarlson  staff  33199 Jun 27 22:33 standard_DSC_0171.jpg\n-rw-r--r--   1 jcarlson  staff  33567 Jun 27 22:33 standard_mirror_DSC_0171.jpg\ndrwxr-xr-x   7 jcarlson  staff    238 Jun 27 22:33 tmp\n$ \n```\n @jcarlson thanks for checking. I think I'll go ahead with the release since this doesn't sound like a regression, but we'll obviously leave this issue open until we figure out a solution. Any help would be most appreciated, of course!\n  I fixed the deletion stuff for the embedded documents (mongoid). be careful, the pull request also contains modification about the gemspec.\n revert to the gemspec & version from the original repo\n @bensie what's the purpose of a rebase in my case ? (I'm not a big git expert).\n Also waiting on not having any changes to the gemspec. Thanks, did!\n Closing until we can get an automatic merge working. I'll work with @did on that. \n  [As requested](https://github.com/jnicklas/carrierwave/pull/356#issuecomment-1404519), here's a new pull request with the commit from [pull 356](https://github.com/jnicklas/carrierwave/pull/356) that creates a new CarrierWave::MimeTypes file processor, complete with specs.\n\nI'm still having problems getting jnicklas/carrierwave HEAD to work with my app (I'll submit a separate issue once I figure it out), so I haven't been able to do any real-world integration testing on this with my app yet.\n Sounds good. I'm working on it now.\n Alrighty, as Trevor pointed out in the other issue, I wasn't completely mocking S3 with Fog properly in my specs, no clue why it worked with rubygems though.\n\nAnyway, testing for the win! I dropped this baby in my app, and it worked perfectly :-)\n W00t, thanks!\n A-W-E-S-O-M-E Steve! Thanks so much! When is the next release planned? :)\n  I would expect carrierwave to do this for me. When I didn't the image was not converted, and the file extension was not changed.\n\nI am using rails_admin, with the dragonfly_file partial for a file field. This gives me back an ActionDispatch::Http::UploadedFile, which I have to change the original_filename attribute to match the new extension. If I don't, it silently does not convert. I would expect some kind of error message to be logged.\n Looks like this is expected. The readme shows the extension being changed. If you think the documentation could be further improved, please submit a pull request or add something to the wiki. Thanks!\n I don't think the convert method in the source stated that you were required to add a filename method, and one cannot assume from the README either that the filename method is required from convert.\nI am not even sure if the documentation as is correct- it uses `super + '.png'`, but I would expect it to be `File.extname(super) + '.png'\n\nPlease re-open this as a feature request because this is a clear violation of DRY and an ugly point in what is usually a very elegant API.\n Can you please sort out if extname is required and create a pull request and I'll merge that in. Thanks!\n yes, can you re-open the ticket so I don't forget?\n\nBTW, extname was wrong, it should probably be `File.basename(super, '.*')` or `super.chomp(File.extname(super))`\n Yeah it's open. I'll look out for a pull request. Thanks!\n I sent a pull to fix the documentation. This ticket is still a feature request to automatically have the behavior of adding the filename method when convert is used.\n @gregwebs thanks! Are you planning on working on this new feature? If so, I'll leave this open waiting for you for a while. If not, I'd suggest pinging the Google Group to see if anyone is interested in working on the feature. \n no, I am not going to work on it. I am busy enough with other open source projects right now and content with my workarounds. Perhaps I will take a crack at it the next time I use carrierwave on a project.\n Any solution for this?\n  I'd like to see a way to customize the generated filename for a given version. For example, instead of 'filename.jpg' and 'thumb_filename.jpg', I'd like to have 'filename_thumb.jpg'.\n\nIs this as simple as exposing and overriding the 'full_filename' method in uploader/versions.rb?\n   version :thumb do\n    process :resize_to_limit => [200, 200]\n\n```\ndef full_filename (for_file = model.logo.file) \n  \"#{model.random_key}.#{file.extension}\"\nend \n```\n\nend\n\n=> \"/images/eec027c690a/d784c3b/eec027c690a.jpg\"\n=> \"/thumbs/eec027c690a/d784c3b/thumb_eec027c690a.jpg\"\n\ni dont get it - why it still has that thumb_ in the filename?\n  Just starting with cw and encountering this problem, e.g.:\n\n```\nruby-1.9.2-p180 :037 > i = File.new('/Users/xxx/Downloads/foo-3.jpg')\n => #<File:/Users/xxx/Downloads/foo-3.jpg>\nruby-1.9.2-p180 :037 > f = Asset.new( file: i, title:'midsummers night' )\n => #<Asset:8 title=\"midsummers night\" description=nil file=/uploads/tmp/20110618-2049-1853-7976/foo-3.jpg content_type=nil file_size=\"20129\" created_at=\"2011-06-19 02:32:35.416140 UTC\" updated_at=\"2011-06-19 02:32:35.416140 UTC\">\n```\n\nthe file is properly cached in `/uploads/tmp` at this point, then:\n\n```\nruby-1.9.2-p180 :053 > f.save\n => #<Asset:8 title=\"midsummers night\" description=nil file=/uploads/assets/file/8/foo-3.jpg content_type=nil file_size=\"20129\" created_at=\"2011-06-19 03:49:33.759085 UTC\" updated_at=\"2011-06-19 03:49:33.759085 UTC\">\n\n```\n\nHere the path seems correct in memory as per the inspect, but the file column in the db is actually storing the tmp path, `/uploads/tmp/20110618-2049-1853-7976/foo-3.jpg`  which seems wrong.\n\nAnd, reading the record back:\n\n```\nruby-1.9.2-p180 :058 >   f = Asset.find(8)\n => #<Asset:8 title=\"midsummers night\" description=nil file=/uploads/assets/file/8/uploads/tmp/20110618-2049-1853-7976/foo-3.jpg content_type=nil file_size=\"20129\" created_at=\"2011-06-19 03:49:33.759085 UTC\" updated_at=\"2011-06-19 03:49:33.759085 UTC\">\nruby-1.9.2-p180 :059 > f.file.url\n => \"/uploads/assets/file/8/uploads/tmp/20110618-2049-1853-7976/foo-3.jpg\"\nruby-1.9.2-p180 :060 >\n```\n\nThe path is munged.   Any idea what's going on or where to look? I've\nspent a lot of time trying to trace through the code and it seems\nincredibly convoluted for such a simple thing.\nThanks,\ntv/\n I disagree. It's a reproducible bug.\n\nIn this case, the problem is that the `#{column}` accessors are not symmetrical; i.e., doing `file = \"foo.jpg\"` does not then yield `file == \"foo.jpg\"`.  Therefore my custom ORM adapter is fetching the munged version of the attribute (i.e. the path) rather than the filename.   I supposed the work-around is to `mount_on:` another attribute? \n\nUnfortunately this kind of \"bug\" is only fixable by a redesign and rewrite -- and probably reducing the line count to 1/3 or 1/4 of current.\n\nIn doing so, I also suggest taking guidance from this article:\nhttp://blog.citrusbyte.com/2009/12/15/superfluous-dsls/\n Check the \"known issues\" page linked from the \"getting help\" section here: https://github.com/jnicklas/carrierwave/wiki\n\nI'm definitely open to more discussion around this, but @jnlickas and I discussed and didn't want to break backwards compatibility for this change. Maybe more documentation, more info the the wiki, etc would help. You're contributions are definitely welcome, @tribalvibes!\n  when trying to add a new or edit (an upload) via nested Post form, \ntop       middle     lower\nPost -> Album -> Upload\n\nactivemodel (3.0.8) lib/active_model/attribute_methods.rb:392:in `method_missing'\nactiverecord (3.0.8) lib/active_record/attribute_methods.rb:46:in`method_missing'\ncarrierwave (0.5.4) lib/carrierwave/orm/activerecord.rb:33:in `image='\nactiverecord (3.0.8) lib/active_record/base.rb:1564:in`block in attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in `each'\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in`attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1412:in `initialize'\nactiverecord (3.0.8) lib/active_record/reflection.rb:173:in`new'\nactiverecord (3.0.8) lib/active_record/reflection.rb:173:in `build_association'\nactiverecord (3.0.8) lib/active_record/associations/association_collection.rb:511:in`build_record'\nactiverecord (3.0.8) lib/active_record/associations/association_collection.rb:119:in `build'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:372:in`block in assign_nested_attributes_for_collection_association'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:367:in `each'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:367:in`assign_nested_attributes_for_collection_association'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:254:in `uploads_attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1564:in`block in attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in `each'\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in`attributes='\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:388:in `assign_to_or_mark_for_destruction'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:377:in`block in assign_nested_attributes_for_collection_association'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:367:in `each'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:367:in`assign_nested_attributes_for_collection_association'\nactiverecord (3.0.8) lib/active_record/nested_attributes.rb:254:in `albums_attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1564:in`block in attributes='\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in `each'\nactiverecord (3.0.8) lib/active_record/base.rb:1560:in`attributes='\nactiverecord (3.0.8) lib/active_record/persistence.rb:131:in `block in update_attributes'\nactiverecord (3.0.8) lib/active_record/transactions.rb:292:in`block in with_transaction_returning_status'\nactiverecord (3.0.8) lib/active_record/connection_adapters/abstract/database_statements.rb:139:in `transaction'\nactiverecord (3.0.8) lib/active_record/transactions.rb:207:in`transaction'\nactiverecord (3.0.8) lib/active_record/transactions.rb:290:in `with_transaction_returning_status'\nactiverecord (3.0.8) lib/active_record/persistence.rb:130:in`update_attributes'\napp/controllers/admin/posts_controller.rb:33:in `update'\nactionpack (3.0.8) lib/action_controller/metal/implicit_render.rb:4:in`send_action'\nactionpack (3.0.8) lib/abstract_controller/base.rb:150:in `process_action'\nactionpack (3.0.8) lib/action_controller/metal/rendering.rb:11:in`process_action'\nactionpack (3.0.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.0.8) lib/active_support/callbacks.rb:456:in`_run__604760886049450875__process_action__4370732822898983854__callbacks'\nactivesupport (3.0.8) lib/active_support/callbacks.rb:410:in `_run_process_action_callbacks'\nactivesupport (3.0.8) lib/active_support/callbacks.rb:94:in`run_callbacks'\nactionpack (3.0.8) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.0.8) lib/action_controller/metal/instrumentation.rb:30:in`block in process_action'\nactivesupport (3.0.8) lib/active_support/notifications.rb:52:in `block in instrument'\nactivesupport (3.0.8) lib/active_support/notifications/instrumenter.rb:21:in`instrument'\nactivesupport (3.0.8) lib/active_support/notifications.rb:52:in `instrument'\nactionpack (3.0.8) lib/action_controller/metal/instrumentation.rb:29:in`process_action'\nactionpack (3.0.8) lib/action_controller/metal/rescue.rb:17:in `process_action'\nactionpack (3.0.8) lib/abstract_controller/base.rb:119:in`process'\nactionpack (3.0.8) lib/abstract_controller/rendering.rb:41:in `process'\nactionpack (3.0.8) lib/action_controller/metal.rb:138:in`dispatch'\nactionpack (3.0.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.0.8) lib/action_controller/metal.rb:178:in`block in action'\nactionpack (3.0.8) lib/action_dispatch/routing/route_set.rb:62:in `call'\nactionpack (3.0.8) lib/action_dispatch/routing/route_set.rb:62:in`dispatch'\nactionpack (3.0.8) lib/action_dispatch/routing/route_set.rb:27:in `call'\nrack-mount (0.6.14) lib/rack/mount/route_set.rb:148:in`block in call'\nrack-mount (0.6.14) lib/rack/mount/code_generation.rb:93:in `block in recognize'\nrack-mount (0.6.14) lib/rack/mount/code_generation.rb:68:in`optimized_each'\nrack-mount (0.6.14) lib/rack/mount/code_generation.rb:92:in `recognize'\nrack-mount (0.6.14) lib/rack/mount/route_set.rb:139:in`call'\nactionpack (3.0.8) lib/action_dispatch/routing/route_set.rb:493:in `call'\nwarden (1.0.3) lib/warden/manager.rb:35:in`block in call'\nwarden (1.0.3) lib/warden/manager.rb:34:in `catch'\nwarden (1.0.3) lib/warden/manager.rb:34:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nactionpack (3.0.8) lib/action_dispatch/middleware/head.rb:14:in`call'\nrack (1.2.3) lib/rack/methodoverride.rb:24:in `call'\nactionpack (3.0.8) lib/action_dispatch/middleware/params_parser.rb:21:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/flash.rb:182:in `call'\nactionpack (3.0.8) lib/action_dispatch/middleware/session/abstract_store.rb:149:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/cookies.rb:302:in `call'\nactiverecord (3.0.8) lib/active_record/query_cache.rb:32:in`block in call'\nactiverecord (3.0.8) lib/active_record/connection_adapters/abstract/query_cache.rb:28:in `cache'\nactiverecord (3.0.8) lib/active_record/query_cache.rb:12:in`cache'\nactiverecord (3.0.8) lib/active_record/query_cache.rb:31:in `call'\nactiverecord (3.0.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:354:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'\nactivesupport (3.0.8) lib/active_support/callbacks.rb:416:in`_run_call_callbacks'\nactionpack (3.0.8) lib/action_dispatch/middleware/callbacks.rb:44:in `call'\nrack (1.2.3) lib/rack/sendfile.rb:107:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\nactionpack (3.0.8) lib/action_dispatch/middleware/show_exceptions.rb:47:in`call'\nrailties (3.0.8) lib/rails/rack/logger.rb:13:in `call'\nrack (1.2.3) lib/rack/runtime.rb:17:in`call'\nactivesupport (3.0.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.2.3) lib/rack/lock.rb:11:in`block in call'\ninternal:prelude:10:in `synchronize'\nrack (1.2.3) lib/rack/lock.rb:11:in`call'\nactionpack (3.0.8) lib/action_dispatch/middleware/static.rb:30:in `call'\nrailties (3.0.8) lib/rails/application.rb:168:in`call'\nrailties (3.0.8) lib/rails/application.rb:77:in `method_missing'\nrailties (3.0.8) lib/rails/rack/log_tailer.rb:14:in`call'\nrack (1.2.3) lib/rack/content_length.rb:13:in `call'\nrack (1.2.3) lib/rack/handler/webrick.rb:52:in`service'\n/Users/omar/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/Users/omar/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/httpserver.rb:70:in`run'\n/Users/omar/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n  I removed the storage declaration from all of my uploaders and set it in the initializer.  Carrierwave seems to ignore what I have set in my initalizer, I still have to set the storage in each uploader.\n\nMy Initializer:\n\n```\nRACKSPACE_CONFIG = YAML.load_file(\"#{Rails.root}/config/rackspace.yml\")[Rails.env]\n\nCarrierWave.configure do |config|\n  if Rails.env.test? || Rails.env.development?\n    config.storage = :file\n    config.enable_processing = false\n  else\n    config.fog_credentials = {\n      :provider           => 'Rackspace',\n      :rackspace_username => 'XXXXX',\n      :rackspace_api_key  => 'XXXXXXXXX'\n    }\n    config.fog_directory = RACKSPACE_CONFIG[\"fog_directory\"]\n    config.fog_host = RACKSPACE_CONFIG[\"fog_host\"]\n  end\nend\n```\n\nWhat I have to have in each uploader:\n\n```\nstorage (Rails.env.development? || Rails.env.test?) ? :file : :fog\n```\n\nI'm running Rails 3.0.9 and Carrierwave 0.5.4\n Keep in mind that if you want to set it in an initializer you should _not_ also set it in an uploader. I've used this technique a number of times and it's always worked for me.\n Yeah, I didn't have it set in the uploader.  I tried removing the conditional within the CarrierWave.configure block first to force it into Rackspace and that didn't work.  So thats when I added the setting within the uploaders and it seemed to pickup the fog config then.\n Great... yes, I would be an idiot ;)  Problem sovled.  Sorry for troubling you.\n  We can't operate with @modifications before we didn't setup it. In Mongoid [#setup_modifications](http://rubydoc.info/github/mongoid/mongoid/master/Mongoid/Dirty:setup_modifications) is run after attributes were [assignment](http://rubydoc.info/github/mongoid/mongoid/master/Mongoid/Attributes/Processing#process-instance_method). Here is a workaround and spec.\nI think it also refers to the #361 issue.\n  Each `version` creates a copy of its parent `Uploader`.  The value of the `versions` hash was inheritable which meant versions were processing unrelated versions.  `Uploader.versions` now defaults to an empty hash but is not inheritable.  As far as I can tell there's no reason for a version to ever inherit versions; rather it should only be assigned any nested versions it might have.\n\nWasn't exactly sure how to test this.  Locally I discovered the issue when I noticed that some thumbnails were clearly blown-up versions of smaller thumbnails (e.g. a non-nested version is processed based on a smaller version); so I could test based on thumbnail dimensions, but I tested closer to the source and simply made sure a version hashes were being set correctly.\n Looks good to me :) thanks!\n Completing reverting the commit removes the specs I added, which verify that the versions hash is correct, which is crucial to properly handling versions.  I acknowledge that the patch doesn't work (should have figured; too easy) but nevertheless IMO those specs I added need to pass or the versions functionality is more or less borked.\n Still working on it.  Is it a rule to not commit failing specs?  This isn't a shiny new feature but rather the correct functionality for the gem.\n Word.  Fair enough.\n  Since the README was converted to github-style markdown in [this commit](https://github.com/jnicklas/carrierwave/commit/0d2e9ee8706074059cb78f2f85232caf17327952), I can no longer compile the gem or install from github, as I get the following error from bundler:\n\n```\ncarrierwave at [clipped] did not have a valid gemspec.\nThis prevents bundler from installing bins or native extensions, but that may not affect its functionality.\nThe validation message from Rubygems was:\n  [\"README.rdoc\"] are not files\n```\n\nSo, I just removed the rdoc references to README.rdoc from the gemspec and it works again.\n Oops, no, just an oversight. Fixed it now.\n  This is comprised of two commits:\n1. Added methods for more control over `file.content_type`, including the ability to set the content-type manually with `file.content_type='blah/blah'`, and to access `file.original_content_type` which gets set to the previous content-type whenever `file.content_type=` is called.\n   \n   Specs are included for this in the sanitized_file_spec.rb, and this commit could be pulled in easily without the next.\n2. A new processor to do more advanced content and mime-type processing. Right now, this processor simply uses the mime-types gem to more intelligently guess the file-type, using the `process :set_content_type` processor.\n   \n   I added the `CarrierWave::MimeTypes` processor, mainly because I didn't want to make a hard dependency on the mime-types gem considering CarrierWave already does a decent job at content-type guessing, and this seemed analogous to the optional RMagick, ImageScience, etc, dependencies.\n   \n   Also, in the future, we could maybe even do more cool stuff with file processing, who knows?\n   \n   The second commit doesn't necessarily require the first in order to work, but it is more useful with the first.\n\nI created specs for all the functionality described above, however, I have not yet gotten this working with my Rails 3.1 app, because as soon as I started installing the gem from github (even before I changed anything, just from the current jnicklas/carrierwave master HEAD), I started getting other errors I have yet to figure out.\n\nThese two commits together would essentially solve Issue #284.\n\nLet me know what you guys think.\n > why wouldn't we always set an original_content_type?\n\nThat's a good question. Honestly, I just did it that way because, since I'm new to carrierwave, I was trying to touch as little of the codebase as possible, and I didn't want to add 2 entire lines to [`#sanitize`](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/sanitized_file.rb#L248) in SanitizedFile just to set a new global instance variable. Then I just added the test to make that behavior clear.\n\nBut I think you're right that it would make more sense and be more consistent to always set it. I can make that change.\n\n> Processors manipulate images... Would make documentation for processors inconsistent.\n\nThis, in my view, is the inconsistent part. Carrierwave uploads files, while processors only manipulate images. But if carrierwave uploads files, shouldn't processors process files? What's so special about images?\n\nJust as you can now write `process :convert => 'png'` with the CarrierWave::MiniMagick processor, what if you could write\n\n```\nprocess :convert => 'pdf'\n```\n\nwith the CarrierWave::PDF processor, or `process :set_content_type` with the CarrierWave::MimeTypes processor?\n\nI was envisioning a collection of processors somewhat like:\n\n```\nprocessing\n|- images\n|  |- image_science.rb\n|  |- mini_magick.rb\n|  `- rmagick.rb\n`- files\n   `- mime_types.rb\n```\n\nBut yeah, if I'm off-base, just let me know. You guys are doing awesome work with CarrierWave, so I trust your judgement.\n Good deal. I had originally started with an attr_writer :content_type sort of solution, but I needed the original content-type as well, which is why I had done it this way.\n Yeah, the original_content_type stuff seems a little unnecessary to me to. I'm not 100% convinced that overriding methods in SanitizedFile is a good API, I'd rather there'd be something more official than that. But this is fine for the time being. As for the processor, I'm okay with that, actually it might be good to have something like that, since it illustrates that processeors don't have to all be image related.\n Awesome, thanks Jonas. Yeah, I needed the original_content_type stuff for my app, but I can see how that'd be only marginally useful.\n\nWould you like me to take out the original_content_type stuff so this can get pulled in? I can also write up an article and/or add to the wiki documentation for the file processor.\n  I'm not certain this is a real issue yet, but it certainly manifests that way on my machine, since upgrading my 3.0.7 application to 3.1.rc4 I have after each test run (integration tests) I have an `uploads` directory full of empty date-stamped directories sitting around in the `Rails.root`\n I also have been seeing this in my app ever since Rails 3.1.0.beta1. Except, in my app, it's actually in /public/updloads.\n Not sure what code you need exactly, but here are the basics for one of my setups.\n\n`spec/support/mock_fog.rb`:\n\n```\nFog.mock!\nFog.credentials_path = Rails.root.join('config/fog_credentials.yml')\nconnection = Fog::Storage.new(:provider => 'AWS')\nconnection.directories.create(:key => 'my-bucket-name')\n```\n\n`app/uploaders/my_uploader.rb`:\n\n```\nclass MyUploader < CarrierWave::Uploader::Base\n  storage :fog\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\nend\n```\n My test code literally looks like:\n\n@stub_avatar_path = Rails.root + './test/data/stub-image.png'\n@user = Factory(:user)\n@user.remote_avatar_url = @stub_avatar_path\nassert @user.save\nassert @user.avatar\n\nI'm not sure that's going to be of any help to you!\n Yeah, tons, but most of them are just normal tests. Things like `@something = Factory.build(:something)`, where the `Something` model has a mounted uploader as `:my_file`, and:\n\n```\nFactory.define :something do |f|\n  f.my_file File.new(Rails.root + 'spec/fixtures/sample_file.zip')\nend\n```\n\nAnd then of course, there are the uploader specs themselves. They're pretty basic. In `spec/uploaders/my_uploader_spec.rb`:\n\n```\nrequire 'spec_helper'\nrequire 'carrierwave/test/matchers'\n\ndescribe MyUploader do\n  include CarrierWave::Test::Matchers\n\n  before do\n    # Capture the old storage engine, just in case it wasn't already :file\n    @old_storage = MyUploader.storage.to_s\n    MyUploader.storage = CarrierWave::Storage::File\n    MyUploader.enable_processing = true\n\n    @something = Something.new\n    @uploader = MyUploader.new(@something, :my_file)\n    @uploader.store!(File.open(File.expand_path(\"../../fixtures/sample_file.zip\", __FILE__)))\n  end\n\n  after do\n    MyUploader.storage = eval(@old_storage)\n    MyUploader.enable_processing = false\n  end\n\n  it \"should make the package readable only to the owner and not executable\" do\n    @uploader.should have_permissions(0644)\n  end\nend\n\n```\n I am using Rails 3.0.9 and it also leaves empty directories in public/attachments\n Interesting -- I thought it was just an issue with 3.1.x -- can you post a sample 3.0.9 app that contains the issue?\n I will try to post one today or tomorrow.\n It may be just because I am on Windows and I have found other things like Image-conversion not to work without hacking the code a bit.\n any update on this? I am having the same issue.\n @bensie @leehambley I figured this out.\n\n``` ruby\nCarrierWave.configure do |config|\n  config.cache_dir = 'uploads'\n  config.root = Rails.root.join('tmp')\nend\n```\n\nsolves the issue.\n @bensie its the uploader.root thats happening on file storage. I fixed this locally and unfortunately won't have time to do a PR. Hopefully though this helps fix the issue or get someone started on an official patch.\n I have the same issue, that when running tests cache images will be store in `Rails.root/uploads/tmp` folder.\n\nI would like to try making a patch for this. However may I ask what is the the **correct** behaviour/ folder for cache to reside in? Is it the `Rails.root/tmp` folder? or is it the `Rails.root/public/uploads/tmp`? or would the test not leave any folders behind?\n Its happening in the cache! call, as cache_dir has been set to uploads/tmp and root is Rails.root. I think we should just set the cache_dir to ./tmp/uploads inside the Railtie setup_paths initializer?\n Is this still an issue? \n  Hi,\n\nI have a very odd issue with CarrierWave and S3, I have a form uploading an image to S3, works fine on my development machine but I cannot get it to work on Heroku.\n\nI've used the Heroku console and run a test upload to S3 with the same credentials used by my app and everything works fine, but once handled by CarrierWave, I get a 403 error: \n\n<pre>\nUsersController# (Excon::Errors::Forbidden) \"Expected(200) <=> Actual(403 Forbidden)\\n reqMore\n\n/app/.bundle/gems/ruby/1.9.1/gems/excon-0.6.3/lib/excon/connection.rb:179:in `request'\n/app/.bundle/gems/ruby/1.9.1/gems/fog-0.8.2/lib/fog/core/connection.rb:20:in `request'\n/app/.bundle/gems/ruby/1.9.1/gems/fog-0.8.2/lib/fog/storage/aws.rb:329:in `request'\n/app/.bundle/gems/ruby/1.9.1/gems/fog-0.8.2/lib/fog/storage/requests/aws/put_object.rb:43:in `put_object'\n/app/.bundle/gems/ruby/1.9.1/gems/fog-0.8.2/lib/fog/storage/models/aws/file.rb:119:in `save'\n/app/.bundle/gems/ruby/1.9.1/gems/fog-0.8.2/lib/fog/core/collection.rb:50:in `create'\n/app/.bundle/gems/ruby/1.9.1/gems/carrierwave-0.5.4/lib/carrierwave/storage/fog.rb:229:in `store'\n/app/.bundle/gems/ruby/1.9.1/gems/carrierwave-0.5.4/lib/carrierwave/storage/fog.rb:79:in `store!'\n</pre>\n\n\nMy configuration is as follow: initializers/carrierwave.rb:\n\n<pre>\n# CarrierWave S3 config\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',       # required\n    :aws_access_key_id      => SETTINGS[Rails.env]['s3']['access_key_id'],       # required\n    :aws_secret_access_key  => SETTINGS[Rails.env]['s3']['secret_access_key'],       # required\n    #:region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n  }\n  config.fog_directory  = SETTINGS[Rails.env]['bucket']                     # required\n  #config.fog_host       = 's3.amazonaws.com'            # optional, defaults to nil\n  #config.fog_public     = false                                   # optional, defaults to true\n  #config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\nend\n</pre>\n\n\npicture_uploader.rb:\n<code>\nclass PictureUploader < CarrierWave::Uploader::Base\n\n  # Include RMagick or ImageScience support:\n  include CarrierWave::MiniMagick\n  # include CarrierWave::ImageScience\n\n  # Choose what kind of storage to use for this uploader:\n  storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # fix for Heroku, unfortunately, it disables caching, see: https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Make-Carrierwave-work-on-Heroku\n  def cache_dir\n    \"#{Rails.root}/tmp/uploads\"\n  end\n\n  # Create different versions of your uploaded files:\n  version :thumb do\n    process :resize_to_fill => [96, 96]\n  end\n\n  version :mini do\n    process :resize_to_fill => [48, 48]\n  end\n\nend\n</code>\n\nI've been dealing with this issue since yesterday night trying to test everything...\n @tarikjn in the Google Group, post as much info as possible from the 403 -- there may be something helpful in there. \n Thanks bensie, trevorturk, I posted a thread in the Google Group and awaiting moderation to append the full request details.\n @tarikjn - Just a quick chime in based on my experience with this sort of error.  You said you are using the same credentials, but are you using the same bucket name?  My guess is that it is probably a bucket in production that you don't actually own (or that doesn't yet exist).  Anyway, feel free to continue the discussion on the google group but I thought I would toss in my two cents.\n @geemus, yes, I did suspect the bucket, and so I've tested with the same bucket as well. Right now I'll create a Rails app from scratch and push it to Heroku to try to isolate the issue. FYI I've posted the full request on the Google Group: http://groups.google.com/group/carrierwave/browse_thread/thread/fc5edb064328007f\n @tarikjn - I've responded (pending moderation), I'll just wait on that rather than having doubled discussions.\n  Another piece of the puzzle... #339\n @bensie, your fix is clearly better which points to me not fully understanding whats happening internally. Thanks for looking.\n  In the current version of CarrierWave if you have an uploader defined like this:\n\n``` ruby\nclass LogoUploader < CarrierWave::Uploader::Base \n  # ... \n  def filename \n    \"original.#{model.logo.file.extension}\" if original_filename \n  end \n  version :small do \n    process :resize_to_fit => [190, 190] \n    process :convert => 'png' \n    def filename \n      \"small.png\" \n    end \n  end \n  version :icon do \n    process :resize_to_fill => [50, 50] \n    process :convert => 'png' \n    def filename \n      \"icon.png\" \n    end \n  end \n  # ... \nend \n```\n\nand attach a file name `somefile.jpg`, you will end up with files named `original.jpg`, `small_small.png` and `icon_icon.png` respectively.\n\nThe problem seems to be these two functions defined in CarrierWave::Uploader::Versions \n\n``` ruby\n      def full_filename(for_file) \n        [version_name, super(for_file)].compact.join('_') \n      end \n      def full_original_filename \n        [version_name, super].compact.join('_') \n      end \n```\n\nThese will _ALWAYS_ force the final file name to be `#{version_name}_#{filename}`. It turns out you can override that in your version, but in a really cludgey way:\n\n``` ruby\n  def filename \n    \"original.#{model.logo.file.extension}\" if original_filename \n  end \n  version :small do \n    process :resize_to_limit => [190,190] \n    process :convert => 'png' \n    def full_filename (for_file = model.logo.file) \n      @name ||= \"small.png\" \n    end \n  end \n  version :icon do \n    process :resize_to_fill => [50,50] \n    process :convert => 'png' \n    def full_filename (for_file = model.logo.file) \n      @name ||= \"icon.png\" \n    end \n  end \n```\n\nIMO, the original functions from the Versions class should be updated so that they return just the filename if that method is defined in the version. The software should assume that the user is responsible for avoiding naming conflicts in that case.\n I will look into providing a patch as soon as I can wrap up the project I'm using CW for. It probably would have been fine to let the versions manage their own name, but I already had a lot of attachments generated with Paperclip and I wanted to keep the naming conventions that I already had in place.\n  https://github.com/jnicklas/carrierwave/issues/338\n @clyfe, I will test your branch.\n Great stuff, I was just looking into how to deal with the excess of tmp dirs in our project and boom, it's been fixed! Looking forward to the next release.\n  I am using Rails 3.1 RC and Carrierwave 0.5.4. Don't know if this is an issue with 3.1.\n\nI verified that the path and file exists (http://bucket_name.s3.amazonaws.com/unencoded/users/1/photos/test.gif) in my S3 bucket. \n\nWhen I do:\n\n```\nPhoto.first.update_attributes!(:job_state => 'processing', :remote_attachment_url => 'http://bucket_name.s3.amazonaws.com/unencoded/users/1/photos/test.gif')\n```\n\nError I get:\n\n```\nErrno::ENOENT: No such file or directory - /Users/Chris/Sites/site_name/tmp/uploads/20110603-1813-612-6936/small_test.gif\n```\n\nWhy is Carrierwave trying to access the local dir instead of S3?\n\nMy initializer looks like:\n\n```\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',       # required\n    :aws_access_key_id      => APP_CONFIG['amazon_access_key_id'],       # required\n    :aws_secret_access_key  => APP_CONFIG['amazon_secret_access_key']       # required\n  }\n  config.fog_directory  = 'bucket_name'                     # required\n  config.fog_host       = 'http://cdn.site_name.com'            # optional, defaults to nil\n  config.fog_public     = true                                   # optional, defaults to true\n  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\nend\n```\n\nMy uploader class looks like:\n\n```\n# encoding: utf-8\n\nclass PhotoUploader < CarrierWave::Uploader::Base\n  include CarrierWave::MiniMagick\n\n  # Choose what kind of storage to use for this uploader:\n  storage :fog\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/users/#{model.user.id}/#{model.class.to_s.underscore}s/#{model.id}\"\n  end\n\n  # Create different versions of your uploaded files:\n  version :small do\n    process :resize_to_fill => [53,53]\n  end\n  version :medium do\n    process :resize_to_fill => [106,106]\n  end\n  version :large do\n    process :resize_to_fill => [212,212]\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n\n  # https://github.com/jnicklas/carrierwave/wiki\n  # Heroku has a read-only filesystem, so uploads must be stored on S3 and cannot be cached in the public \n  # directory. You can work around the caching limitation by setting the cache_dir in your Uploader classes \n  # to the tmp directory.\n  def cache_dir\n    \"#{Rails.root}/tmp/uploads\"\n  end\nend\n```\n\nIn my uploader class, if I remove the versions, the upload succeeds without any errors.\n Full stack trace:\n\n```\nErrno::ENOENT: No such file or directory - /Users/Chris/Sites/site_name/tmp/uploads/20110603-1827-5843-3673/small_test.gif\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/sanitized_file.rb:157:in `initialize'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/sanitized_file.rb:157:in `open'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/sanitized_file.rb:157:in `read'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/storage/fog.rb:230:in `store'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/storage/fog.rb:79:in `store!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/store.rb:59:in `block in store!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/store.rb:58:in `store!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/versions.rb:193:in `block in store_versions!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/versions.rb:193:in `each'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/versions.rb:193:in `store_versions!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/callbacks.rb:18:in `block in with_callbacks'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/callbacks.rb:18:in `each'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/callbacks.rb:18:in `with_callbacks'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/store.rb:58:in `store!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/bundler/gems/carrierwave-0d2e9ee87060/lib/carrierwave/uploader/versions.rb:193:in `block in store_versions!'\n... 16 levels...\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/connection_adapters/abstract/database_statements.rb:183:in `transaction'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:208:in `transaction'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:246:in `save!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/persistence.rb:168:in `block in update_attributes!'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/connection_adapters/abstract/database_statements.rb:183:in `transaction'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:208:in `transaction'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/activerecord-3.1.0.rc1/lib/active_record/persistence.rb:166:in `update_attributes!'\nfrom (irb):5\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/railties-3.1.0.rc1/lib/rails/commands/console.rb:44:in `start'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/railties-3.1.0.rc1/lib/rails/commands/console.rb:8:in `start'\nfrom /Users/Chris/.rvm/gems/ruby-1.9.2-p136@railspre/gems/railties-3.1.0.rc1/lib/rails/commands.rb:40:in `<top (required)>'\nfrom script/rails:6:in `require'\nfrom script/rails:6:in `<main>\n```\n Does this happen if you're saving a new record?\n Yes, it does. The same problem here. Running rails 3.0.7 and uploading to S3. Don't know why, but carrierwave is always processing files locally (in the folder public/ + store_dir from uploader file) and after a few processed versions throws the exception shown by krzkrzkrz\n Actually, correct me if I am wrong. Is it normal that it tries to process the files locally first before sending to S3? Hence why a tmp folder is being used.\n\nWhat I have observed so far is that the processed files (small_test.gif, medium_test.gif, large_test.gif) are being put in the tmp folder (/Users/Chris/Sites/site_name/tmp/uploads/20110603-1827-5843-3673/).\n\nHowever, I also notice that these files are being removed. Perhaps they are being removed too quickly before they sent to S3? Hence the error: \"Errno::ENOENT: No such file or directory - /Users/Chris/Sites/site_name/tmp/uploads/20110603-1813-612-6936/small_test.gif\"\n\nYou can see this in action, by going to your tmp dir. In my case it was /tmp. Run something like:\n\n```\nPhoto.first.update_attributes!(:job_state => 'processing', :remote_attachment_url => 'http://bucket_name.s3.amazonaws.com/unencoded/users/1/photos/test.gif')\n```\n\nIn /tmp, you will see that it will create the necessary tmp folders for the photo (/tmp/uploads/20110603-1813-612-6936/). Inside this folder, you will the the 3 files (small_test.gif, medium_test.gif, large_test.gif) being created and then removed automatically by Carrierwave.\n You are right. I processes the files locally and then deletes them.\n Yea, at this point, I am thinking that Carrierwave deletes the tmp files too quickly before it can be sent to S3... I suspect this is the reason. At least, we ruled out the possibility that it may be a Rails 3.1 compatibility problem, since the error is also showing up with Rails 3.0.7.\n @krzkrzkrz I doubt that, but happy to be proven wrong! Please do investigate!\n I'd like to help, but I am not familiar with the Carrierwave lib and all its relevant files. Only a few months into Ruby and Rails, unfortunately..\n Not sure if this is somewhat related to mini_magick: https://ar-code.lighthouseapp.com/projects/35/tickets/6-race-condition-with-temp_file\n\nI don't think it is, since I tried switching to rmagick, and the problem is still there.\n\nA second suspect, is this https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/store.rb line 60, which contains\n\n```\n@file.delete if delete_tmp_file_after_storage\n```\n\nPerhaps Carrierwave is deleting the file before verifying its existence.\n This changed between 0.5.3 and 0.5.4. Trying to pin down the exact cause.\n This might help? https://github.com/jnicklas/carrierwave/compare/v0.5.3...v0.5.4\n I believe it's related to old s3 config that hasn't been updated to the new fog syntax.\n I'm not sure what you mean.\n Hmmmm, I don't know exactly what the problem is, but I switched my gem file from:\n\n```\ngem 'carrierwave', :git => 'http://github.com/jnicklas/carrierwave.git'\n```\n\nto\n\n```\ngem 'carrierwave', '0.5.4'\n```\n\nThe problem seems to have gone away. There is something definitely wrong with the master version...\n I'm experiencing this issue as well. It seems to work fine for me if I only have 1 version, but I encounter the problem when I try to do multiple versions. I'm just getting familiar with CarrierWave but I was under the impression that the cache directory is used for post-processing before uploading to S3 but it looks like when I specify versions that no file is getting stored in my cache directory. So as soon as it tries to do the processing it doesn't find that [version]_[filename] in my cache directory. Again, if I specify just 1 version it works just fine.\n\nI will dig into the code a little more to see what I can find.\n\nEdit: For what it's worth, I'm also using MiniMagick for processing.\n Apparently if you set this config value to false then everything will work ok:\n\n``` ruby\nconfig.delete_tmp_file_after_storage = false\n```\n\nI suppose this setting could make some sense but it seems by default that maybe it should work the other way (set to false as default) as I imagine that most uses of CarrierWave involve some sort of processing. I'm also guessing that there is a race condition in any processing getting done and it getting stored to the eventual storage (which is why 1 version seemed to work for me I'm guessing).\n I ran into a similar problem with version 0.5.4 when I added the code from https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Delete-cache-garbage-directories to my uploader class. I added this note to that page:\n\n> This method breaks uploaders that have more than one version defined. Your first version will be saved, but afterwards the cleanup code will run and remove the tmp file that is used to generate additional versions. In that case, you are better off creating a rake task that cleans out the tmp folders periodically.\n\nIt is likely that the same thing is happening with the new `delete_tmp_file_after_storage` configuration option. Ideally, any post-processing action that gets triggered should only happen after all of the versions have been created. This might be problematic if processing is offloaded to Delayed Job, et. al.\n I just did the opposite of @krzkrzkrz and switched from using version 0.5.4 of the gem to using the github hosted edge version. However, if I specify `config.delete_tmp_file_after_storage = false` in my initializer (in order to work around the problems outlined here) the temp files are still deleted anyway.\n Apparently even if you set `config.delete_tmp_file_after_storage = false`, unless you **also** set `config.delete_cache_id_after_storage = false` then the temp files will be deleted anyways because the `delete_cache_id` method calls `FileUtils.rm_rf`. This is really borked.\n\nIdeally the entire versioning process should take place inside a wrapper, and that wrapper should be tasked with making sure that all versioning tasks have completed before any cleanup is done.\n\nAlso, in the present context `delete_tmp_file_after_storage` and `delete_cache_id_after_storage` seem to be redundant. It is unlikely that someone would want to delete the individual cache files but not the parent folder. Perhaps we should get rid of the former configuration option and keep only the latter.\n Yeah, I think delete_cache_id_after_storage was just added, and maybe we should change it so that delete_tmp_file_after_storage is the name but takes the functionality from delete_cache_id_after_storage. Your suggestions are smart, and your help is definitely appreciated if you have ideas about how to fix this stuff!\n I'm just trying to get through this project, but every step forward I try to take with CW ends up setting me two steps back :(\n Sorry to hear that! I hope you can use CW but no worries if you need to switch to Paperclip or something else. I know there are still some rough spots in CW here and there. \n Chris, I share the same sentiment. Issues I normally open up with CW are not easily solvable. Sometimes causing a bit of a delay in development. Just curious. What are you using now?\n I'm still using CW. Specifically the master version as it fixed a number of bugs that I was experiencing with 0.5.4, but I'm nervous about using that in production and we're doing a soft go-live in 2 days. I tested it on our staging environment yesterday and everything looked OK. _fingers crossed_ IMO, (with the caveat that this is my first production-level Rails app and I've only been working with CW, et. al. for less than a month) CW still has some benefits over Pc. I like the fact that you can DRY up your uploaders and re-use them across different models. I've also found testing to be much simpler with CW, and the built-in remote upload is nice as opposed to the hacks that were necessary to get that to work with Pc. Plus the CW mailing list is infinitely more active and useful than the one for Pc. So, I carry on and just have lots of comments in my uploader and initializers about temporary hacks to override the bug from issue X, etc. \n\nI know I've been pretty vocal on the issue and mailing lists lately, but I hope it's not mistaken for complaining. I try to provide a workaround when possible, and if nothing else provide constructive criticism. FWIW, I think the time I spent switching from Pc to CW will be worth it in the long run. \n Still no updates on this? Been a while already....\n I've fixed this in our fork (so it doesn't delete the cache dir until all versions are processed) but I accidentally applied from my stash into an older revision of the repo to what I made the edits on, so the combination of my commit and then the merge of the missing revisions from origin looks really messy. I'm not sure what a pull request would look like, I've been meaning to look into git to see how best to rebase it, any advice appreciated on that.\n\nhttps://github.com/agworld/carrierwave\n\nI also mean to write a couple of test cases but we're flat out at the moment.\n OK I think we've got a fix for the config options:\n- delete_tmp_file_after_storage\n- delete_cache_id_after_storage\n\nPlease test with the latest master and report back. I'm releasing a new gem version today as well, so that may also fix the issue. \n\nI'm going to open a new issue about combining these two options as @chrisbloom7 suggested. @chrisbloom7 if you're still using CW perhaps you'd be interested in looking into that?\n\nhttps://github.com/jnicklas/carrierwave/issues/398\n @trevorturk - Yes, still using CW. Will take a look at the new ticket and poke at it if time permits.\n I also think the fix for #338 that is now in master and going out in 0.5.6 will fix this problem. For one, even with `delete_cache_id_after_storage` set to `true`, it will never delete the cache directories if they are not empty. So, if you set `delete_tmp_file_after_storage` to `false`, you will never get any of your temp files removed.\n @scottwb would you take a look at issue #398 if you have time? I'm thinking there's no good reason for the 2 config options. Perhaps we could combine them into one?\n So just to be clear, was this particular issue ever patched in which temp files were being deleted too quickly? Is it in the latest gem, or still just in master?\n @chrisbloom7 I haven't tested the patch from the guys, but my fork has been working great for a few weeks.. \n\n@all i'll switch back to HEAD next week and try out the fixes\n I just ran into this issue in development.\n\nRails 3.1.0\nRuby 1.9.2p312\npostgres 9.0.3\ncarrierwave (0.5.8)\nmini_magick (3.4)\n\nstore_dir set to:\n\"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n\nset in application.rb:\nconfig.delete_tmp_file_after_storage = false\nconfig.delete_cache_id_after_storage = false\n\nError reads:\nErrno::ENOENT in UsersController#update\n\nNo such file or directory - identify -ping /var/folders/7l/7lHpnfiYG30W5eePveOqk++++TI/-Tmp-/mini_magick20120229-69935-1eei36s.jpg\n\nAny thoughts?\n Oy, I'm having the same issue - both on the latest released gem and also on head.\n I'm also having the same issue.\n Correction, I'm a bit daft. Didn't have Imagemagick installed. Installed it and it now works fine. #havingoneofthosedays\n Oh good - somebody else commented. I lost this thread! Anywho, I figured out my problem. I was running Rails via an IDE and it wasn't picking up my terminal environment settings including $PATH. Since Imagemagick was installed via brew, it is all in /usr/local and that's not in the default. So to get around this I decided to add this line of code to application.rb:\n\nENV['PATH'] = \"/usr/local/bin:#{ENV['PATH']}\"\n\n... and it worked!\n  lib/carrierwave.rb line 6:\n\nrequire 'active_support/core_ext/class/inheritable_attributes'\n\nIt's deprecated and removed in rails 3.1. \n It will be removed in rails 3.2... it is deprecated in 3.1. 3-1-stable is the current 3.1 branch in rails core... \n Ah. Sorry. Looked on master branch. But anyway it's already removed in master and there is no reason in using inheritable attributes instead of class attributes\n Can we support Rails 3.1 and 3.2 somehow? Pull requests welcome. \n I've tried, but still have some issues with some specs. \n Ok. I need help. I've started from processing.rb. Here is a diif https://gist.github.com/1006382\n\nAnd 2 spec fails: https://gist.github.com/1006385\n\nAny suggestions will be appreciated. Thanks\n It's a long shot, but maybe @josevalim will have an idea for us...?\n Actually, it is not hard to fix. The only thing you need to keep in mind is that you should not modify things in place using class_attribute. With class_inheritable_accessor, when you inherited, all attributes were copied from parent to child. With, class_attribute, it doesn't happen:\n\n```\nclass Foo\n  class_attribute :foo\n  self.foo = { :bar => :baz }\nend\n\nclass Bar < Foo\nend\n\nFoo.foo # => { :bar => :baz }\nBar.foo # => { :bar => :baz }\nBar.foo.delete(:bar)\n\nFoo.foo # => {}\nBar.foo # => {}\n```\n\nSo, what to do instead? Use .dup plus setters:\n\n```\nFoo.foo # => { :bar => :baz }\nBar.foo # => { :bar => :baz }\nBar.foo = Bar.foo.dup.delete(:bar)\n\nFoo.foo # => { :bar => :baz }\nBar.foo # => {}\n```\n\nBesides that, you will be fine and it should work from 3.0.x forward.\n Sweet! Thanks for the super quick response!\n\n@bensie you want to take a shot at fixing?\n I don't think that dup can help, because, according to class_attribute docs, using += on array will not change parent attributes(and children too). So this is same thing as using dup.\n Yes, += is also fine because you aren't modifying it in place.\n @josevalim, but this is a problem.\n\n<pre>\nclass A\n  class_attribute :x\n  self.x = []\nend\n\na1 = Class.new(A)\na1.x += ['a']\na2 = Class.new(a1) # a2.x should be ['a']\n</pre>\n\n\nAt least it worked so with inherited accessor\n That should also work with class_attribute.\n @josevalim i've updated comment, may be it because of \"self.x = []\" in class code\n hmm. let me try it once again.\n ok. i've found the problem (but not solution). in https://github.com/jnicklas/carrierwave/blob/master/spec/mount_spec.rb#L51 if we delete lines 51-53 (version initialization), then \"@uploader1.processors.should == [[:rotate, [], nil]]\" test will pass (but ofc it will fail un uploader2). so seems like new version initialization brokes processors array.\n versions.rb line 79 - versions[name][:uploader].processors.clear i think this is an issue\n Very likely, never modify anything in place. Even an array inside a nested hash. :)\n https://gist.github.com/1013026 - working diff. now need to replace rest inherited accessors\n I don't think that pull request will be usefull right now. There is 3 more inherited accessors left. Trying to deal with it too.\n Sure i will. If i will complete it first. Right now i changed _storage inherited accessor and stuck on version and version_names.\n Ehrm. Seems like i need help with versions and version_names. You can checkout my fork to use already fixed (_storage and processors) version. My problem that when i tried to do something with version tests fails with 'stack level too deep'. I discovered that it happens right on class.image = some_image_object. I'll try to do something with it a few days later, if someone won't fix it.\n Also. I have question to @josevalim. Maybe it may help me. Using class_inheritable_accessor we have disabled instance_reader and created it manually - https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/versions.rb#L101 \n\nBut, using class_attribute this method not called. I think this method not overriding default instance reader. Can you tell where problem is?\n Added pull request for version_names: https://github.com/jnicklas/carrierwave/pull/349\n\nStill looking at versions...\n The main proble in https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/versions.rb#L101 as i said before. It's never called using class_attribute.\n I've tried to redefine method versions as __versions and fixed all call to it. So all tests passed (using class_inheritable_accessor), but after changing it to class_attribute with all fixes related to inplace modifying some tests still gives 'stack level too deep'. I still think that problem in overriding instance reader. Don't know why it not works.\n  dmathieu implemented in this pull:\n\nhttps://github.com/jnicklas/carrierwave/pull/125\n\nthe \"Remove the cached file after storing it\" feature.\nBut after removal of the file, an empty directory with the upload timestamp is left behind, filling the cache storage with empty directories.\n\nThe `Carrierwave.clean_cached_files!` feature helps a little, but it would be nice to have these directories removed along with the file.\n I think this has been discussed before... Can you search around and see what you find?\n There are discussions about deleting the cached **file** but nothing about the **companion directory** that goes along.\n\nAs I said, dmathieu's patch for removing cached files that have been moved to storage deletes only the file:\n\n```\n@file.delete if delete_file_after_storage\n```\n\nbut not the companion directory, say something like\n\n```\nif delete_file_after_storage\n  @file.delete # /tmp/uploads/20110527-0535-21045-1255/--->myfile.txt<---\n  also_delete_the_dir_please() # /tmp/uploads/--->20110527-0535-21045-1255<---/myfile.txt\nend\n```\n Yeah, I really thought there was discussion about that, too. Maybe you can work up a pull request? You might want to wait and see if @jnicklas wants to weigh in. I think he had concerns about this, but I might just be confusing things. \n I just ran into the case that `tmp` was filled up with  32768 cache directories and as such uploads did not work anymore. Hope someone comes up with a solution.. even a recommended shell script. :-(\n I'm thinking on something on the lines of an after_store callback to delete those dirs, that each user is to implement depending on his caching config. I'll document more as I come up with it. As I said `Carrierwave.clean_cached_files!` might also help, that is put that line in a rake task and call it daily via cron.\n If somebody wants to work up a pull request, we can definitely discuss then. In the mean time, I'm closing this. \n I totally disagree with this procedure!\n\nThis is a open bug, people could and will run into it (like me) and it causes severe damage! Closing this issue will hide it from other people that are just starting to use this extension in the hopes of all being good and unaware of such an issue.\n\nPlease reopen and state again that you need a pull request. I will also try to work something out, even a cron job for should do.\n Sorry, I just don't like leaving open issues around. We like to list \"known issues\" in the wiki. If you want to work something up for the wiki that would be great. Also, a pull request would be great, too ;)\n\nI'll re-open for now, but if we don't get activity on it, I'll close again after a while. \n @jnicklas Could you please be a little bit more specific with that? Why would I operate from within my app with a Gems generated cache files. I think we should consider having a configuration option (that defaults to true) to determine whether the cache dir should be deleted once all Carrierwave-related jobs are done or not. \n\nI never tickle around in cache-directories that are not created by me.. and personally if anyone does.. it shouldn't be really allowed. People could copy over the original file into their own cache file and work from there.\n Is this `cache_dir` function representing a individual cache dir for a\nupload or the global storage for all cache files, e.g. are the subfolders\nbeing created there?\n\nI think if people don't want the delete behavior, it shall be a setting.\nWould bet that 99% of your users are not even aware of this `cache_dir`\nsetting. So, let's have it as configuration option and delete the dirs after\nusage if the option is true.\n https://github.com/jnicklas/carrierwave/wiki/How-to:-Delete-cache-garbage-directories\n I think my 4 liner could be integrated in core (in lib/CW/uploader/store.rb), given that cache_id dirs are completely managed by CW, and are independent from configuration params.\n So, did you want to work up a pull request (with tests) for review? It sounds like @jnicklas is tentatively in favor. \n Yes, will do. Just had a recent migration the past days (100k carrierwave uploads).. going to work on it. Should have something by Monday as the problem bites me continuously.\n Closing in favor of https://github.com/jnicklas/carrierwave/pull/346\n I am still seeing two problems with this:\n\n1) When invoked from a Rails controller, this never actually deletes the directories because it is computing the path incorrectly. `store.rb` has this new method as a result of this merge:\n\n``` ruby\n      ##\n      # Deletes a cache id (tmp dir in cache)\n      #\n      def delete_cache_id\n        if @cache_id\n          path = File.join(cache_dir, @cache_id)\n          FileUtils.rm_rf(path) if File.exists?(path) && File.directory?(path)\n        end\n      end\n```\n\nThe `File.exists?(path)` always fails because `path` is something like `uploads/tmp/20110710-1856-9791-0202`, but the cwd of the Rails process is `Rails.root` and the `uploads` directory is inside the `public` directory. I am guessing this works in the tests because the cwd happens to be the parent dir of the `uploads` directory.\n\nI looked throughout the rest of the code and there are a number of other places that use `CarrierWave.root` to formulate a full path to this directory. I modified `delete_cache_id` to use that and now it works:\n\n``` ruby\n      ##\n      # Deletes a cache id (tmp dir in cache)\n      #\n      def delete_cache_id\n        if @cache_id\n          path = File.expand_path(File.join(cache_dir, @cache_id), CarrierWave.root)\n          FileUtils.rm_rf(path) if File.exists?(path) && File.directory?(path)\n        end\n      end\n```\n\n2) However...this technique breaks uploaders that have more than one version as described [here](https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Delete-cache-garbage-directories) because the first version being stored causes the whole directory to be deleted.\n\nAt the very least, that makes having `config.delete_cache_id_after_storage` defaulting to `true` a very dangerous thing. But, it also seems like we could possibly modify `delete_cache_id` to only delete the directory if it is empty. I haven't tested this yet, but was thinking something like:\n\n``` ruby\n      ##\n      # Deletes a cache id (tmp dir in cache)\n      #\n      def delete_cache_id\n        if @cache_id\n          path = File.expand_path(File.join(cache_dir, @cache_id), CarrierWave.root)\n          FileUtils.rm_rf(path) if File.exists?(path) && File.directory?(path) && (Dir.glob(\"#{path}/*\").size > 0)\n        end\n      end\n```\n\nI am not setup to run all the test cases, but am happy to help get this resolved. Does anyone more familiar with this code have any suggestions as to whether or not this is a sane approach?\n I was just looking into this, actually. I'm reopening this issue for now. Perhaps we should change the default. I'm not sure if running through the cache_dir looking for files will be slow...? Give it some thought and put something together if you have time. Thank you!\n @trevorturk Thanks...what do you think about using `Dir.rmdir(path)` instead of `FileUtils.rm_rf(path)`, and then catching the specific exceptions for dir does not exist, is not a dir, and is not empty?, E.g.: something like this:\n\n``` ruby\n      ##\n      # Deletes a cache id (tmp dir in cache)\n      #\n      def delete_cache_id\n        if @cache_id\n          path = File.expand_path(File.join(cache_dir, @cache_id), CarrierWave.root)\n          begin\n            Dir.rmdir(path)\n          rescue Errno::ENOENT\n            puts \"*************** Cache dir does not exist: #{path}\"\n          rescue Errno::ENOTDIR\n            puts \"*************** Cache dir is not a dir: #{path}\"\n          rescue Errno::ENOTEMPTY\n            puts \"*************** Cache dir is not empty: #{path}\"\n          end\n        end\n      end\n```\n\nI tried this out by just hacking it into my installed gem source and it seems to be doing exactly what I want. When I upload a new file with an uploader that has 4 versions total, I see this printed out:\n\n```\n*************** Cache dir is not empty: /Users/scottwb/src/potw-site/public/uploads/tmp/20110710-2323-10149-3330\n*************** Cache dir is not empty: /Users/scottwb/src/potw-site/public/uploads/tmp/20110710-2323-10149-3330\n*************** Cache dir is not empty: /Users/scottwb/src/potw-site/public/uploads/tmp/20110710-2323-10149-3330\n```\n\nand afterward that directory is gone. I also confirmed manually that the temp directory lives long enough to take advantage of the `:avatar_cache` field for preserving the upload across form postings when a model validation fails.\n\nUsing `Dir.rmdir` instead of `FileUtils.rm_rf` might also assuage @jnicklas's concern about the user overriding `cache_dir` and unwittingly getting an `rm -rf` called on an important directory.\n\nRegarding performance...I haven't done any benchmarking, nor am I familiar with the internals of `Dir` and `File`, but my gut assumption would be that `Dir.rmdir` is executing native code (e.g.: C code calling (POSIX API)[http://linux.die.net/man/3/rmdir]) almost directly, and that system's built-in checks would be more efficient than the two separate checks we already had there for `File.exists?` and `File.directory?`, and would definitely be faster than the `Dir.glob` approach I mentioned earlier, which could get unwieldy for large directories.\n\nI could whip this into a quick pull-request if you like...\n If you could look into this a bit more and work up a pull request that you're confident in, I'd definitely appreciate it. You should be able to make a few specific tests that would eliminate the concerns that @jnicklas et al would be concerned about. Let me know if you run into any problems or have questions, but it sounds to me like you know what's going on well enough to give it a shot. Thank you!\n I'm taking a stab at this now. The first step I wanted to take is to fix up the specs surrounding this a bit so that they actually fail on the problems I was seeing when testing in my app. I made a guess above that the specs for this passed because of a cwd assumption. It turns out the specs for this passed because the offending code was never called -- it was stubbed out.\n\nHere is a change I made just the spec that was passing when it shouldn't be:\n\nhttps://github.com/scottwb/carrierwave/commit/7f9c35faecb0c21c6833d36f7e1a66e1ee27caaa\n\nNote that I have departed a bit from the style of this spec. Instead of stubbing the call to `delete_cache_id`, I let it get called, and assert that the cache directory exists before `#store!` and does not exist after it. (Also just to be explicit, I confirm that its parent dir does NOT get deleted). To do so, I had to violate the black-box nature of this spec a bit too, in order to figure out the path to the cache directory we're testing, since that is privately encapsulated. I understand that this might be a bit of a maintenance hazard, but I didn't have any better ideas that weren't a lot more disruptive.\n\nI'm probably going to have to do stuff like this to fully test out what is and is not getting deleted, and wanted to make sure you're on board with this philosophy of testing before going too much further.\n Yeah, just give it your best shot. If you're giving the tests this much though, then chances are they'll be good tests. \n Sent pull request for this: https://github.com/jnicklas/carrierwave/pull/393\n Thanks, I'll look at this ASAP unless someone else beats me to it. \n Thanks, guys! :thumbsup:\n  Before I mount an uploader to my models file:\n\n```\nmount_uploader :waveform, ImageUploader\n```\n\nI can use to_xml which works great:\n\n```\nruby-1.9.2-p180 :007 >   r.to_xml\n => \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<recording>\\n  <id type=\\\"integer\\\">6</id>\\n  <name>20110527_Fri_08-08-33</name>\\n  <created-at type=\\\"datetime\\\">2011-05-27T07:11:52Z</created-at>\\n  <updated-at type=\\\"datetime\\\">2011-05-27T07:28:21Z</updated-at>\\n  <spx-size type=\\\"float\\\">84327.0</spx-size>\\n  <ogg-size type=\\\"float\\\">624970.0</ogg-size>\\n  <samples type=\\\"float\\\">5292000.0</samples>\\n  <length type=\\\"float\\\">60.0</length>\\n  <scaled-by type=\\\"float\\\">2147483647.0</scaled-by>\\n  <maximum-amplitude type=\\\"float\\\">0.334076</maximum-amplitude>\\n  <minimum-amplitude type=\\\"float\\\">-0.472839</minimum-amplitude>\\n  <midline-amplitude type=\\\"float\\\">-0.069382</midline-amplitude>\\n  <mean-norm type=\\\"float\\\">0.048891</mean-norm>\\n  <mean-amplitude type=\\\"float\\\">-0.028322</mean-amplitude>\\n  <rms-amplitude type=\\\"float\\\">0.062973</rms-amplitude>\\n  <maximum-delta type=\\\"float\\\">0.605255</maximum-delta>\\n  <minimum-delta type=\\\"float\\\">0.0</minimum-delta>\\n  <mean-delta type=\\\"float\\\">0.063686</mean-delta>\\n  <rms-delta type=\\\"float\\\">0.083394</rms-delta>\\n  <rough-frequency type=\\\"float\\\">9294.0</rough-frequency>\\n  <volume-adjustment type=\\\"float\\\">2.115</volume-adjustment>\\n  <png-url>http://192.168.0.1:81/car_project/ogg/20110527_Fri/png/20110527_Fri_08-08-33.ogg.png</png-url>\\n  <keywords nil=\\\"true\\\"></keywords>\\n  <start-date type=\\\"datetime\\\">2011-05-27T07:08:33Z</start-date>\\n  <end-date type=\\\"datetime\\\">2011-05-27T07:09:33Z</end-date>\\n  <ogg-file nil=\\\"true\\\"></ogg-file>\\n  <waveform nil=\\\"true\\\"></waveform>\\n</recording>\\n\" \n```\n\nHowever when I mount an uploader I get:\n\n```\nruby-1.9.2-p180 :003 > r.to_xml\nTypeError: can't convert nil into String\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:51:in `block in method_missing'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:44:in `each'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:44:in `method_missing'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:34:in `tag!'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activesupport/lib/active_support/xml_mini.rb:125:in `to_tag'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activemodel/lib/active_model/serializers/xml.rb:118:in `block in add_attributes_and_methods'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activemodel/lib/active_model/serializers/xml.rb:116:in `each'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activemodel/lib/active_model/serializers/xml.rb:116:in `add_attributes_and_methods'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activemodel/lib/active_model/serializers/xml.rb:103:in `block in serialize'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:155:in `call'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:155:in `_nested_structures'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:63:in `method_missing'\n        from /usr/local/rvm/gems/ruby-1.9.2-p180/gems/builder-3.0.0/lib/builder/xmlbase.rb:34:in `tag!'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activemodel/lib/active_model/serializers/xml.rb:102:in `serialize'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/activerecord/lib/active_record/serializers/xml_serializer.rb:175:in `to_xml'\n        from (irb):3\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/railties/lib/rails/commands/console.rb:45:in `start'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/railties/lib/rails/commands/console.rb:8:in `start'\n        from /home/xanview2/.bundler/ruby/1.9.1/rails-d1c74706c35b/railties/lib/rails/commands.rb:44:in `<top (required)>'\n        from script/rails:6:in `require'\n        from script/rails:6:in `<main>\n```\n I was able to confirm and reproduce your issue by producing failing tests here:\nhttps://github.com/jnicklas/carrierwave/commit/20480f4b686551987d3f602e254dd9236cb72742\n\nWe'll look into it, thanks for the report.\n Thanks for the super fast reply and the new unit tests for this :) - Can't wait for a fix, CarrierWave rules!\n :( - What is causing the issue? - seems kind of serious as all my views respond to xml requests and if I use CarrierWave it breaks all of them :/\n @hackeron we're not sure. I'm going to reopen for now, but I spent some time on this and couldn't sort it out either. Help wanted! :)\n Hrm... I'm not a huge fan. Do you think it's the only way to get around this?\n I'm not sure... maybe we can send nil if the uploader is blank somehow? I can have a look eventually if you're sick of working on it.\n This bug was biting me big time. Placing this in the model made life sweet again:\n\n```\n# mount_uploader :logo, LogoUploader\ndef to_xml(options = {})\n  options.merge!(:except => [:logo])\n  super(options)\nend\n```\n Yeah that should work for now -- as long as it doesn't raise an exception anymore.  `as_json` is generated from `serializable_hash`, but `to_xml` is not and there's no such thing as `as_xml`.  The docs on this are all pretty terrible with Rails -- see the inline docs at https://github.com/rails/rails/blob/master/activemodel/lib/active_model/serialization.rb\n\nEverything points to the fact that both XML and JSON use `serializable_hash`, but sadly they're very inconsistent.  Hopefully someone on the Google Group can help.\n Here's a hacktastic thought...I saw the hack to make `to_xml` return nil. What if you try making it something like:\n\n``` ruby\ndef to_xml(options = nil)\n  JSON.parse(self.to_json).to_xml\nend\n```\n\nI just did a quick test with my User model which uses CarrierWave to mount on a column named 'avatar' that has a version named 'square'. Check this out:\n\n```\nree-1.8.7-2011.03 :003 > puts JSON.parse(User.first.to_json).to_xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<hash>\n  <user>\n    <name>Scott W. Bradley</name>\n    <avatar>\n      <url>http://....jpg</url>\n      <square>\n        <url>http://....jpg</url>\n      </square>\n    </avatar>\n    <hometown></hometown>\n    <email>me@example.com</email>\n  </user>\n</hash>\n => nil \nree-1.8.7-2011.03 :004 >\n```\n\nI dunno if you'd be happy committing this, but it might be better than `nil`...or at least help out @hackeron with his immediate problem.\n Yeah, I'll take a shot at it. It might be a few days before I can really dive in, so bump me if you don't hear from me in a week.\n Bump @scottwb. Hitting this issue too.\n  I have 6 condtitional versions:\n\n```\n  version :photo_of_the_week, :if => :landscape? do\n    process :resize_to_fit => [520, 390]\n  end    \n  version :photo_of_the_week_portrait, :if => :portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n\n  protected\n  def landscape? img\n    @is_landscape ||= begin\n      puts img\n      pic = Magick::Image.read(img.path).first\n      pic.columns >= pic.rows\n    end\n  end\n\n  def portrait? img\n    return ! landscape?(img)\n  end\n```\n\nOnce I call the \"recreate_versions!\" method on the uploader, this will output the following:\n\n```\n>> s.picture.recreate_versions!\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cc44e8>\n#<CarrierWave::SanitizedFile:0x105cbba00>\n#<CarrierWave::SanitizedFile:0x105cbba00>\n#<CarrierWave::SanitizedFile:0x105cbba00>\n#<CarrierWave::SanitizedFile:0x105ca61f0>\n#<CarrierWave::SanitizedFile:0x105c99ab8>\n#<CarrierWave::SanitizedFile:0x105c99ab8>\n#<CarrierWave::SanitizedFile:0x105c99ab8>\n#<CarrierWave::SanitizedFile:0x105c99ab8>\n#<CarrierWave::SanitizedFile:0x105c99ab8>\n#<CarrierWave::SanitizedFile:0x105c8eb40>\n#<CarrierWave::SanitizedFile:0x105c8eb40>\n#<CarrierWave::SanitizedFile:0x105c8eb40>\n#<CarrierWave::SanitizedFile:0x105c84d48>\n#<CarrierWave::SanitizedFile:0x105c77620>\n#<CarrierWave::SanitizedFile:0x105c6d260>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c66cd0>\n#<CarrierWave::SanitizedFile:0x105c64d68>\n#<CarrierWave::SanitizedFile:0x105c64d68>\n#<CarrierWave::SanitizedFile:0x105c64d68>\n#<CarrierWave::SanitizedFile:0x105c63670>\n#<CarrierWave::SanitizedFile:0x105c62108>\n#<CarrierWave::SanitizedFile:0x105c62108>\n#<CarrierWave::SanitizedFile:0x105c62108>\n#<CarrierWave::SanitizedFile:0x105c62108>\n#<CarrierWave::SanitizedFile:0x105c62108>\nnil\n```\n\nSo in addition of asking myself why the NIL is being passed I also wonder why we need the if condition being called so many times? Is the gem not caching the value?\n Tried to fix this in my own branch (forked from @gucki). Will ask him to check and reopen once this is confirmed to be working.\n So far my branch works well for me and I will come back with more info once deployed to the staging server (where the functions will be tested by around 10 people for 5 days).\nThe uploader configuration I'm using:\n\n```\n\n# encoding: utf-8\nrequire 'carrierwave/processing/mini_magick'\n\nclass SubmissionUploader < CarrierWave::Uploader::Base\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  storage :file\n\n  def store_dir\n    \"system/uploads/#{model.shard}/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process :resize_to_fit => [1000, 1000]\n  # process :convert => 'jpg'\n\n\n  version :photo_of_the_week, :if => :is_pow_and_landscape? do\n    process :resize_to_fit => [520, 390]\n  end    \n  version :photo_of_the_week_portrait, :if => :if_pow_and_portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n\n  protected\n  def is_pow_and_landscape? img, obj = nil\n    obj.is_photo_of_the_week and landscape?(img, obj)\n  end\n\n  def if_pow_and_portrait? img, obj = nil\n    obj.is_photo_of_the_week and portrait?(img, obj)\n  end\n\n  def landscape? img, obj = nil\n    @is_landscape ||= begin\n      pic = Magick::Image.read(img.path).first\n      pic.columns >= pic.rows\n    end\n  end\n\n  def portrait? img, obj = nil\n    return ! landscape?(img, obj)\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n```\n\nI'm pretty happy to add the obj as :if argument now. Finally can save space.\n  Would it be possible to set the file owner (in addition to the permission) somewhere in the initializer / uploader?\n\nI have the case that a downloader script is running as a certain user, and needs the files to be written in the UID of the nginx user. Same is true for the system/uploads/ sub folders.\n\nWould also start working on a patch, just like to know whether this is a candiate to include. \n Hmm... maybe @jnicklas has an opinion, but I'd think it would be smart for you to just run all of the parts of your app as the same user, and then this wouldn't be an issue. \n Perhaps. Think I could use the \"after_save\" function in the model. Thanks for your support.\n Can you give an example for \"after_save\"?\n  Hi,\n\nI've Changed the path to store files/images like\n\n\"/home/hamid/Desktop/uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n\nit is storing well , but when I try to retrieve it then it will not show those images instead of just showing their titles. e.g \n\nimage1\nThumb_image1\nSmall_image1\nTiny_image1\n\nAnd if I see the path via firebug of that image, it is also correct.\nI am using ubuntu, please let me know what is actually the problem, thanks.\n\nsrc='/home/hamid/Desktop/uploads/user/avatar/1/image.jpg'\n I think your problem may be using the model.id: https://github.com/jnicklas/carrierwave/blob/master/lib/generators/templates/uploader.rb#L43\n\n...but I'm not sure. I doubt this is a bug in Carrierwave, so if you continue to have trouble, please try the Google Group. If you're sure it's an issue, read the \"getting help\" section of the Wiki so we can more easily help. \n It is saving accurate ids as per model and URL is also accurate so I think problem is with the carrierwave as when I paste the src's url in the browser then it give me image.\n\n:$\n  Hi Jonas,\n\nI'm looking into putting together new relic instrumentation for Carrierwave, following the one done for Paperclip:\n\nhttps://github.com/newrelic/rpm_contrib/blob/master/lib/rpm_contrib/instrumentation/paperclip.rb\n\nIt looks simple enough :) Just not sure what exactly to trace in Carrierwave, and would like to check with you first - which methods would be good to get stats on?\n\nthanks,\nOliver\n  Added support for Padrino Framework, I added ActiveRecord because Padrino is ORM Agnostic and can use also this other than DataMapper, MongoMapper, Mongoid, MongoMapper, Couchrest etc...\n I appreciate you working on this, but I think this is better suited for an entry in the wiki. It's so simple to do the requiring yourself that I don't want to add the extra code into CarrierWave itself. Please consider adding a section to the wiki. Thanks!\n @trevorturk sorry but you have code for sinatra and merb (there is anyone that today uses merb?) That is perfectly simple as padrino. So why not remove all?\n @jnicklas ?\n https://github.com/DAddYE/carrierwave/blob/a338ea3205a9e1507928fa211e1d420ffaaf75ac/lib/carrierwave.rb#L101 super simple... why???\n Isn't Padrino based on Sinatra anyway? I'm just not really happy about adding more stuff into Carrierwave about different frameworks, ORMs, etc when we're trying to extract things lately. I'll reopen and @jnicklas can have a look as well. \n @trevorturk thanks so much!\n @bensie and why should not be the same for a dead framework like merb? Why shouldn't be the same for sinatra that require less lines than us??? Tell me...\n I'm not 100% sure of my stance on this, I agree with bensie that we don't want to give the impression of official support, and lately we've moved a lot of stuff out of CarrierWave, which makes it seem strange to put a lot of new stuff in. It's worth noting that CarrierWave was originally called Merb::Upload (check the early commits, it's true ;)), so there's a historical reason for the Merb support (it used to _not_ support Rails), I'm not sure the Sinatra stuff has ever really worked anyway, so I'm probably -1 on this request as well.\n @DAddYE sorry about that! Thanks for your interest in improving Carrierwave, though. We definitely appreciate it!\n  ...before 1.0?\n I just extracted mongoid to a separate gem and wrote jnicklas an email about it.. :)\n Cool! I think it might be smart to put into the @jnicklas account, but he can share commit access etc easily. \n Yeah, that's one of the points I mentioned in my email to him :)\n @gucki, any movement on this? I'd like to get the Mongoid stuff living under github/jnicklas for consistency, but it's not necessarily necessary ;)\n Ah, awesome! Anyone want to do the honors of removing Mongoid support from this repo (and adding a link to the readme/wiki) ?\n Damn, you know... we're missing some DM stuff like what @did made for removing previously stored files in 0.5.5. Any chance you can try to reconcile that @gucki? \n I'm not sure, actually. I didn't know https://github.com/jnicklas/carrierwave-mongoid existed until you mentioned it. I've pinged @jnicklas and @gucki and asked them what's up. @gucki said he'll have free time again soon, so I'm hoping he'll sort things out. \n  Re: https://github.com/jnicklas/carrierwave/pull/223\n\n@jnicklas and @josevalim let me know what you think about this. I did some work on the plane and I think it's nearly ready to merge. \n Sweet, it looks good imo! Is there something else I need to do? How can I help? And thanks a lot!\n @josevalim thanks for looking!\n\n@jnicklas can you give this a quick review and let me know what you think? I just want one more sanity check before I merge into master :)\n @trevorturk: if I understand correctly you fetch the old record from the database, memorize it and then call destroy on the uploaders if the update was successfull and the new path and old storage path are different. Imo this looks more like a hack than a proper solution to the problem. I think carrierwave should never to any querying on the database. Why not just remember the path instead of the whole model?\n @gucki I appreciate your concern, but this issue has been around a long, long time and nobody has found a better solution as far as I know. If you want to take another shot, please fork this and/or start up a new branch and improve the implementation and make sure the tests pass, then we can have a look at actual code alternatives instead of just chatting about it. \n @trevorturk I think the patch looks good, but just rembering the path (and not the whole model) would be enough. Can you easily make it this way? If not I can try in my fork. \n @gucki feel free to fork and try to improve! You can also start a new temporary branch in the jnicklas repo. \n I like it, working well here.\n Awesome! Yeah, improvements more than welcome -- I just wanted to get it working and well tested. \n\nPerhaps someone will want to add this for mongoid, too. If should \"work out of the box\" actually -- they'd just need to add callbacks and tests. \n Tks Trevor <3 <3 <3\n And a shout out to @did, too! We worked on this together from the Mongoid side. Maybe he'll want to add the callbacks/tests to see if we can get that working now ;)\n Tks @did <3 <3 <3 ;)\n @josevalim @trevorturk hey guys, I can handle that for next week ! thanks !!!!!!!\n @did awesome! I think the code should work for Mongoid, too -- you just need to add the callback and tests. I think it'll work, but holler if not and I can try to help. :D\n  Hey I just added info about other ORMS to README.\n\nBTW - why did you extract only DM and Sequel and left AR and Mongoid in the main repo?\n Thanks, applied. \n\nI'm not sure why they were extracted, but I guess it's because not so many people need them and to keep the main repository slim.\n Thanks.\n\nI think it would be better to extract all ORM implementations into separate gems and have the main carrierwave project to expose only an interface that other ORM adapters would implement. It will also help other ORM developers to implement support for Carrierwave.\n\nDon't want to sound too obsessive here but leaving only AR and Mongoid in the main repo is kinda like saying \"We care less about other ORMs\". Even if you don't, it's how many people may perceive that.\n I think you are right, especially because I'm a heavy sequel user _g_. But as I'm pretty new to this project I'll leave this decision to the main developers of carrierwave.. :)\n @gucki yeah I hear you :) I'm a heavy DM user hence my reaction\n\n@jnicklas opinions?\n @jnicklas Thanks for the explanation. Anyway, I'm happy to help you with the DataMapper adapter. I think integration could be done much smoother and we should be able to use validations w/o any problems.\n FWIW I'm +1 on splitting out Mongoid as well. I think it's great to have examples of how to extend CarrierWave and these new gems are pretty sweet. \n  I tried the new GIT version of carrierwave.  (using 'gem 'carrierwave', :git => 'git://github.com/jnicklas/carrierwave.git''.\n\nMainly I'm using the conditional versions. I have a symptom that images are not created based on the original image, but it seems they are created on a version themselves. Here is my complete uploader:\n\n```\n\n# encoding: utf-8\nrequire 'carrierwave/processing/mini_magick'\n\nclass SubmissionUploader < CarrierWave::Uploader::Base\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  storage :file\n\n  def store_dir\n    \"system/uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process :resize_to_fit => [1000, 1000]\n\n  version :photo_of_the_week, :if => :landscape? do\n    process :resize_to_fit => [520, 390]\n  end    \n  version :photo_of_the_week_portrait, :if => :portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n\n\n  protected\n  def landscape? img\n    unless defined?(@pic_is_landscape)\n      pic = Magick::Image.read(img.path).first\n      @pic_is_landscape ||= pic.columns >= pic.rows\n    end\n    @pic_is_landscape\n  end\n\n  def portrait? img\n    return ! landscape?(img)\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n```\n\nI'm not able to upload pictures to github to demonstrate though.\n Hmm. That's bad. Jonas or I will look as soon as we have time, but if you care to dig into this yourself, please do!\n Sorry for the delay, but I've been real busy. I'm going to work on this _now_ :)\n @gucki holler if/when you run into any trouble on this. Thanks so much for looking at it!\n @ened: I created a small rails3 test application (https://github.com/gucki/carrierwave-test-rails3) and tried to reproduce your problem but for me everything works fine. The versions are all generated from the correct scope (original here) and dont look blurry. \n\nTo check: clone the repository mentioned above. Then:\n\n```\nrails c\nu = User.create\nu.image = File.new(\"public/images/test.jpg\")\nu.save\n```\n\nThen go into public/uploads and have a look at the generated files. You can safely remove anything in public/uploads if you want to try again.\n Hi Gucki:\n\nI tried with this uploader\n\n```\n  version :photo_of_the_week, :if => :landscape? do\n    process :resize_to_fit => [520, 390]\n  end\n  version :photo_of_the_week_portrait, :if => :portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n\n```\n\nAnd the problem re-occured, even with your picture.\n Did you try it in a project of yours or with my demo project mentioned above?\n\nI added the two photo_of_the_week versions to my demo project but still everything works fine. \n\nSo that I'll be able to reproduce the problem: please clone my demo application, make your needed changes to reproduce the problem and then push it so that i can clone it. Thanks :)\n With yours. Please take a look at:\n\nhttps://github.com/ened/carrierwave-test-rails3\n In your Gemfile you are using the jnikclas version of carrierwave. With this one, I get the same error. After changing it to gucki/carrierwave it works :)\n @gucki -- does that mean there's a problem with jnicklas/carrierwave? If so, please do fix!\n It seems so. I just want to wait for jnicklas answer to my email so I can pull my master. I'd then start working on the jnicklas repo itself from now on :)\n @gucki -- confirming that it works with your branch (yehaaa!). \n @gucki yeah, I think @jnicklas pulled in your work, but then there's this bug. So, if you can figure out what's up that would be great. Thank you!\n @trevorturk yeah, currentl I'm not completely sure what's wrong with jnicklas master. But I'll figure it out once my fork is fully pulled. I'm closing this for now, we can reopen if the error comes back after my fork has been fully pulled.\n I think your fork is \"fully pulled\" and @jnicklas had to do some work to fix bugs we ran into. Leave this open for now. One of you is going to have to figure it out, probably. If you want, please consider opening a pull request that suggested a change. I don't think @jnicklas knows what else needs to be done. \n @gucki - is your fork containing only the versions stuff? Cuz I'm in quite a need for the conditions. please don't close this issue yet, btw. :)\n @gucki any progress on this? I think it's going to require help from you, if possible!\n @trevortuk: No not yet as I didnt get any reply from @jnicklas yet. As I didnt do anything bad in my code (I think so at least _g_), is it ok if I pull my branch now and then try to fix all outstanding issues on master directly? \n @gucki I'd prefer if you make a new temporary branch to work in -- just to avoid confusing things. Thanks for looking -- I definitely appreciate it!\n @gucki, I think to have some more progress on this issue.\n\nWhen using the rails console to recreate the version, it works fine.\nWhen using the controller to call recreate_versions! on the picture, it will create the blurred images.\n\nTrying to find the problem.. crazy stuff.\n What the.. %$!\n\nOnce I changed the order of the versions, it seems to work fine. \n\nThis is how the uploader reads now:\n\n```\n\n# encoding: utf-8\nrequire 'carrierwave/processing/mini_magick'\n\nclass SubmissionUploader < CarrierWave::Uploader::Base\n  # include CarrierWave::RMagick\n  include CarrierWave::MiniMagick\n\n  storage :file\n\n  def store_dir\n    \"system/uploads/#{model.shard}/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process :resize_to_fit => [1000, 1000]\n  # process :convert => 'jpg'\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :photo_of_the_week, :if => :is_pow_and_landscape? do\n    process :resize_to_fit => [520, 390]\n  end    \n  version :photo_of_the_week_portrait, :if => :if_pow_and_portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n\n  protected\n  def is_pow_and_landscape? img, obj = nil\n    obj.is_photo_of_the_week and landscape?(img, obj)\n  end\n\n  def if_pow_and_portrait? img, obj = nil\n    obj.is_photo_of_the_week and portrait?(img, obj)\n  end\n\n  def landscape? img, obj = nil\n    @is_landscape ||= begin\n      pic = Magick::Image.read(img.path).first\n      pic.columns >= pic.rows\n    end\n  end\n\n  def portrait? img, obj = nil\n    return ! landscape?(img, obj)\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\nend\n```\n\nSo this might be a problem with some internal cache variable being carried over from the previous ran function. I BET each file is created not based on the original but on the one returned by the call before.\n Each successive version \"inherits\" the versions before it, making the order seem important when it shouldn't be.\n\nline 52 of lib/carrierwave/uploader/versions.rb contains `uploader = Class.new(self)`.  As carrierwave iterates through the versions you have specified in your uploader, the versions that have already been processed are added to the Uploader class that you are creating a copy of.  The end result is the the last version creates itself as well any versions preceding it chronologically in the Uploader source.  I implemented a ghetto patch locally that clears the versions hash from each version's uploader, but I don't know if that's a valid fix for all scenarios.\n @gucki any ideas on this? \n Every call to `Uploader.version` updates the class's `versions` hash.  Each successive version uses that Uploader as a superclass, and so takes on the (now changed) versions hash as well.  This appears to be the intended functionality of activesupport's `class_inheritable_accessor` with which `versions` is defined.  Keep in mind that an instance's `versions` method gets its versions based on its class's `versions` method.\n\nProcessing ends up occurring n(n + 1) / 2 times.  In my case I noticed that some larger thumbnails were actually blown up versions of smaller/cropped thumbnails.  Given the right ordering/process one might never even notice; say for example if the versions were thumbnails descending by size.\n\nIs there any reason for subclasses of an Uploader to have its superclass's value?\n Not to nag, but, any word on a fix?  This is a fairly big problem with the gem.\n @Eleo I feel your pain --  I just don't have time to work on it, and it seems like nobody else does either / hasn't been able to figure it out yet. Sorry! If you think you can get it sorted, a pull request would be more than welcome!\n I also don't have time to contribute a patch ATM, but perhaps I can after my current project settles down. Until then, I will re-iterate what I said in issue [#345](https://github.com/jnicklas/carrierwave/issues/345#issuecomment-1336675):\n\nThe versioning process really needs to be marshaled for a number of reasons. Processing of each version should happen in sequence, with the source file always being the parent of that version (i.e. another version if it is nested, or the base uploader object if not). The marshalling object should also be tasked with ensuring any post processing tasks (cleanup of temp files for example) are triggered at the appropriate time, and should allow for these tasks to be deferred until a later time (or skipped all together) in order to play well with offline processing jobs.\n I'll take a stab at it.\n https://github.com/jnicklas/carrierwave/pull/362 addresses only this issue directly, haven't looked into #345\n @Eleo: thanks a lot for the fix, I've merged it now could everyone (especially @ened) check if this is working as expected now?\n Unfortunately it causes subclasses of Uploaders to not inherit its superclass's versions, although I'm not entirely sure why not.  I would have thought that a subclass would run through the same `version`s defined in its superclass, but it doesn't seem to work out that way.  So either I'm mistaken on how Ruby class inheritance works or there's something else I'm missing.\n Eleo, yeah the catch is that the @versions var is defined on the Uploader class object, so the sub-class object doesn't actually inherit anything. The instance of the sub-class will inherit the instance attributes from the parent instance (not class object instance but the actual instanciation), but the two class objects themselves are singletons and only linked to indicate how the instances should inherit their data.\n\nIt's the whole fun of classes being objects/instances in Ruby.\n\nI think you need to keep versions as a class_attribute (as that does all the magic of checking up the chain of classes to get linked parent versions) and just have a different strategy for resetting versions. I've got it working on my local but I need to create some test cases etc.\n\nHaving said that, I think @chrisbloom7 is right, there needs to be a more detached management of versions I think. I might have more time to look at it at the start of our next iteration. For now we are only using one version and I've got a nicely working version frozen.\n Right now the quickest fix is to (undo my changes and) just do a `uploader.versions = {}` in the `version` method.  I didn't go this route because it didn't \"feel right\" to copy the versions and then reset them, but I can't think of anything else that works.  I guess that's why it was a `class_inheritable_accessor` to begin with.\n\nThe entire versions hash is a set of classes that are all just mutated copies of the base Uploader.  Is this efficient?  Is there a better approach?  Something about it doesn't feel right to me; it seems like a ton of repetitive data sitting around.  From a configuration standpoint, a version is typically one or more processes and maybe some overridden filenames/directories, but it spawns an entire Uploader in itself.  I feel like there should be one class doing the heavy lifting and the versions hash should contain much lighter-weight objects that are used for instruction.  (Is this what @chrisbloom7 is alluding to?)\n\nBut this is all philosophical.  CarrierWave is pretty non-trivial in its current state and it feels naive for me to second-guess it.  Screwing around with it is to presume that I understand why things are how they are, which clearly I do not; hence my bogus patch.\n Has anybody had a chance to test this yet? I think it was the blocker for doing a point release, which is overdue imo. \n Scheduled test for tomorrow. A little messy right now as I depend on @guckis branch for my changes that extended the conditional versions.\n Not sure what you mean about that -- is there more you wanted to get into carrierwave? If so, please open a new issue. If you think things are good after testing please let me know. I'd like to get a release out even if it's not totally perfect -- as long as there are no major regressions, if you know what I mean.\n Yeah there was. But it's based on guckis branch. I'm willing to test any\nmerge you do from his branch, but as I forked his branch, we need him to\nintegrate my changes first, then continue, right?\n I'd need a new pull request based on our master version with whatever additions you guys wanted, then we could review. \n @gucki any chance you could take a look into my stuff, please - then we can continue that trail.\n OK please do a new issue/pull request for that stuff. For now, though, please do test that this issue has been resolved. Then we can get a new version out. \n My application tests come out ok Trevor, thanks for that. \n\nI hit a bunch of other issues and spent ages working out how to do the exact combination of things I want with versions, cleaning up temp dirs and inserting secure tokens into filenames but I'll try to update the wiki pages on that. I will also submit a pull request against another ticket which to do with cleaning up the cache_dir.\n @matpowel awesome, thanks for testing, and I look forward to your pull requests and/or wiki contributions!\n  Example image: http://profesorji.net/system/profesorji/3/medium/Capture.PNG?1278816285\n\nSomehow it fails to upload. I've had the same issues with other PNG images as well.\nI am using rmagick.\n  version :medium do\n    process :resize_to_limit => [130, 130]\n  end\n\n  def extension_white_list\n    %w(jpg jpeg gif png)\n  end\n What more do you need? I gave the image and relevant uploader code...\n I don't use mailing lists and I have no intention to start using stone-age technology. Thanks anyway.\n  This pull request adds support for conditional versions.\n\nPS: I'd be very happy if all my pull requests could be processed very soon so we dont get confused and too many merge conflicts. Thanks :)\n I'd love to test this. Having the same problem with conditional versions here. Will checkout your branch.\n Great, let me know how it works :)\n But how to use it? Can you update the README.markdown and make it clear maybe? Also, how to reference the object itself etc from within the condition.\n I only updated the rdoc inside the source. Here's an example use case:\n\n```\nclass AttachmentUploader < CarrierWave::Uploader::Base\n  version :preview, :if => :image? do\n    process :resize_to_fill => [64, 64]\n    process :quality => 85\n    process :convert => :jpg\n  end\n\n  protected\n\n  def image?(new_file)\n    extension = new_file.extension.to_s\n    %w(png jpg jpeg bmp gif tif tiff).include?(extension)\n  end\nend\n```\n Ah, thanks for that. (I didn't know the file is passed as argument). \nWould be nice if you could document that nicely. \n\nSo far it works as advertised. Good job! :)\n Was about to fork the project to do exactly this. Would be awesome to get this pulled, it's a very useful feature.\n Sorry about the delay in working on these pull requests. I'm going to try and work with Jonas on this at RailsConf if we can find time. \n awesome!\n Need to unvote this pull request.\nI'm running into a bug that \n- recreate_versions! is not functional\n- the version processing is somehow broken. \n  I have versions like this:\n\n```\n  version :photo_of_the_week, :if => :landscape? do\n    process :resize_to_fit => [520, 390]\n  end    \n  version :photo_of_the_week_portrait, :if => :portrait? do\n    process :resize_to_fit => [293, 390]\n  end\n\n  version :thumb, :if => :landscape? do\n    process :resize_to_fit => [184, 138]\n  end\n  version :thumb_portrait, :if => :portrait? do\n    process :resize_to_fit => [104, 138]\n  end\n\n  version :big, :if => :landscape? do\n    process :resize_to_fit => [800, 600]\n  end\n  version :big_portrait, :if => :portrait? do\n    process :resize_to_fit => [450, 600]\n  end\n```\n\nAnd the picture :big and :picture_of_the_week are very blurry. I found these pictures are created based on the :thumb version, not the original!\n\nPlease try to find a way (please find it soon), I'm using the gucki/master branch.\n HI ened, I'll do my best and keep you updated. :)\n Hi gucki, any updates? Could save me quite some GB with that.. ;)\n That is indeed good news. Have you encounted a bug as I reported (thumbnail creation etc) ? \n\nI will download and test ..\n Awesome! Congrats guys.\n Thanks for pulling this! I'll test if everything works as expected from my side now :)\n File extensions do not work when the storage is set to s3, via fog, so I'm attaching the snippet that can work for it:\n\n  version :thumb, :if => :image? do\n    process :resize_to_limit => [200, 200]\n  end\n\n  protected\n\n  def image?(new_file)\n    new_file.content_type.include? 'image'\n  end\n\nThank you for the great feature ;)\n @mehigh that's great material for a section in the wiki, btw ;)\n @trevorturk, I've added that to the Wiki. I'm glad that you found that helpful.\n  Before this patch, the follwing was not possible:\n\n```\nclass AttachmentUploader < CarrierWave::Uploader::Base\n  storage :file\n\n  process :convert => :jpg\n\n  version :thumbnail\n    process :resize_to_fill => [64, 64]\n  end\nend\n\nclass EncryptedUploader < AttachmentUploader\n  storage :encrypted_file\n\n  process :add_safety_logo\nend\n```\n\nThe following was not possible as well:\n\n```\nclass Document\n  mount_uploader :attachment, AttachmentUploader do\n    storage :encrypted_file\n\n    def ecrypted_storage_key\n      storage_key\n    end\n  end\nend\n```\n\nIt's now all possible, specs included :)\n Mh, too bad... too many commits again here. Anyway, all my patches should be pulled together anyway.. :)\n +1\n  Whenever I try to save nested files it fails with the message that the filename is too long. Well go figure, check the file name below and tell me what I am doing wrong.\n\n```\nINSERT INTO \"pictures\" (\"created_at\", \"updated_at\", \"image\", \"attachable_id\", \"attachable_type\") VALUES (\n'2011-05-09  16:38:56.676612', \n'2011-05-09 16:38:56.676612', \n'--- !ruby/object:ActionDispatch::Http::UploadedFile \n     content_type: image/jpeg\n     headers: | \n     Content-Disposition: form-data; name=\"dog[pictures_attributes][0][image]\"; filename=\"IMG_0450.JPG\"\n     Content-Type: image/jpeg\n     original_filename: IMG_0450.JPG\n     tempfile: !ruby/object:File {}', \n1, \n'Dog')\n```\n\nThe form to post this to the server is as follows. I have never tried carrierwave in either polymorphic mode or in nested forms before.\n\n```\n=f.semantic_fields_for :pictures do |pic|\n  =pic.inputs do \n    =pic.hidden_field :id\n    =pic.hidden_field :attachable_id\n    =pic.hidden_field :attachable_type\n    =pic.file_field :image \n```\n\nIs it supposed to try and save the filename like that or is it a bug?\n Sorry about that, I got used to using the issue tracker for other projects. However I CAN assign an uploaded file because I have just done so. Was back to close the issue\n  When testing an uploader, setting the enable_config flag to false and then back to true does not re-enable processing for versions.\n\nHere is a short example gist with a failing spec: https://gist.github.com/961335\n\nWhen enable processing is set to false it seems to set for both the image and the version classes:\n\n```\nEnable Processing is: false for ImageUploader\nEnable Processing is: false for #<Class:0x10724a380>\n```\n\nBut when re-enabling processing it only is set true for the uploader class and not the class object used for the version.\n\n```\nEnable Processing is: true for ImageUploader\nEnable Processing is: false for #<Class:0x10724a380>\n```\n\nLeaving processing enabled for the tests works fine but the testing is obviously much slower. I would send a patch for this but i'm not too sure how I could obtain the classes for versions and then disable processing on them when the configuration is set.\n\nIdeas ?\n Hmmm, something like this would work....\n\n```\nImageUploader.versions.each do |key, version|\n  version.enable_processing = true\nend\n```\n\nCan I contribute a readme patch to state that processing needs to be enabled/disabled for each version? Or would it be best to alter carrierwaves behavior so that it sets the enable_config options for all versions?\n This seems like a bug to me. Care to work up a patch to make the behavior consistent?\n trevorturk: Awesome, i'll come up with nice a patch soon to change the behavior.\n Great - please close this issue when you create the pull request. Thanks!\n Pull request is here: https://github.com/jnicklas/carrierwave/pull/325\n  allow specifying a process condition for processors without any arguments too, ex.\n\n```\nprocess :sepiatone, :if => :true?\n```\n Which pull request is this related to? Can you combine to make this easier to see? We have a lot to look at right now :)\n Hm well, the first two commits of this pull request are related to my conditional processing patch which was already accepted. The other commits came in because of later work on the same branch and are pulled in by other pull requests again. Sorry for that :(\n Ah, this one? https://github.com/jnicklas/carrierwave/commit/d2cb99103a4fd3a4927ea616b251809969831fbe\n Yep!\n OK - thanks. Just trying to get things straight and cleaned up a bit so it's easier to look at later. \n  I just implemented conditional processing as it's been discussed here:\nhttp://groups.google.com/group/carrierwave/browse_thread/thread/3c43b215fe0122c9\n\nSpecs included :)\n Not sure if this is the best place to comment on this, but how difficult would it be to extend the :if conditional processing to the version. That way you can do something like\n\n``` ruby\n  # Create different versions of your uploaded files:\n  version :thumb, :if => image?  do\n    process :resize_to_fit => [50, 50]\n  end\n\n  version :lightbox,  :if => :image? do\n    process :resize_to_fit => [350, 350]\n  end\n```\n\nCurrently I can add the :if condition the the process, and it will not try and resize something like a zip file (which is good), but I will get 2 duplicate copies of the zip file saved (one for the thumb, and one for the lightbox)\n I like this feature request. I'll look into it and keep you updated here. :)\n I'll start working on this as soon as my other patches are accepted so not to many merge conflicts will happen and my pull requests look nicer. :)\n Done: https://github.com/jnicklas/carrierwave/pull/315\n  Currently carrierwave checks for the existance of the actual file when calling avatar? or avatar.blank?. Imo this is unecessary and can result in really bad performance depending on the environment. \n\nI'd suggest to change the two methods to a simple nil check of the column value. \n\nThe check if the underlying file/ object is really existant should be put into another method like avatar.consistent? \n\nIf you agree, I'd be happy to provide a patch :)\n I'll start working on this as soon as my other patches are accepted so not to many merge conflicts will happen and my pull requests look nicer. :)\n I was under the impression that this was implmented so that active model valdiations would work correctly with uploaders? \nWould changing the behavior break this? and cause something like this to always return true\n\n```\nvalidate_presence_of :avatar\n```\n @mariovisic the way I'm reading this, that behavior wouldn't change. It's just that we could check the column value instead of seeing if the file actually exists. \n oh right, sorry, misread!\n Yes, that's how I thought it should work. :)\n I think this should help: https://github.com/jnicklas/carrierwave/commit/297e09688e1f264a98226355fe4d8924ba307a85 -- but please let me know if not. \n  Move the code that joins a version_name and a filename into one place to provide an easy place to override this logic in an Uploader.\n Please see my post in the groups.  The idea behind this is if you want to have a different method for forming the filenames.  A good example being the convention for retina versions of images. (foo.png for non-retina and foo@2x.png for retina versions.)\n\nhttp://groups.google.com/group/carrierwave/browse_thread/thread/c83d4ab2b35f08ae/afe02caba41c1659?lnk=gst&q=retina#afe02caba41c1659\n  Add option for versions to fall back to the original \"pre-processed\" image as a starting point for their processing.\n\n  Usage:\n\n```\nclass FooUploader < CarrierWave::Uploader::Base\n\n  version :untouched do\n    use_original_image!\n    # Other processing...\n  end\n\n  # or\n\n  version :untouched, :use_original_image => true\nend\n```\n Useful if you have processing that doesn't need to be applied to all versions. See this example: http://groups.google.com/group/carrierwave/browse_thread/thread/69c24c4dbdb75365\n  Every time when I'm trying to upload a file from irb, file has content-type 'binary/octet-stream'. Is there any possible way to force change of content-type to correct one before saving the file?\n I'm assuming you mean when it's uploading to S3? There's an open issue related to this, actually: https://github.com/jnicklas/carrierwave/issues/254\n\nI think you can make a new CarrierWave::SanitizedFile to set everything manually. See how that works here: https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/cache.rb#L72\n FWIW: In fog if you don't specify a content-type it uses the content-type gem to try and guess one.  The guess is based entirely on file extension if I remember correctly.  So if you have the proper file extensions it should all 'just work'.  Barring that, explicitly passing one ought to work (soo also those other tickets though, sounds like there may be some related bugs).\n So if i install 'content_type' it will work?\n That part should already be done due to dependency resolution actually.  If you change the filenames of the things you are uploading it should probably do the right thing (or at least raw fog ought to, if that value doesn't correctly make its way through carrierwave then we have other issues).\n Well, I don't have 'content_type' gem, in fact, it fails to build because I don't have libmagic (so, this extension determinate content-type based on \"magic number\"). The problem is \u2014 there is no .content_type method for File provided...\n Oh, sorry I was wrong.  Sorry, I mis-spoke it is the 'mime-types' gem that does this.  And fog requires it, so if you have fog you should also have mime-types.\n I have that gem, but content-type is wrong. I also use fog to upload my jekyll website, and all files has correct content-type. I forget to specified, that I'm using ruby 1.9.2p180.\n Please see my initial comment. I think you'll have to use CarrierWave::SanitizedFile to set the content_type. \n I actually don't get what you  suggested ...\n I had this problem, so I put this in my PageUploader (i.e. the particular uploader I created):\n\n```\nrequire 'mime/types'\n\nclass PageUploader < CarrierWave::Uploader::Base\n  ...\n  process :set_content_type\n\n  def set_content_type(*args)\n    content_type = file.content_type == 'application/octet-stream' || file.content_type.blank? ? MIME::Types.type_for(original_filename).first : file.content_type\n\n    self.file.instance_variable_set(:@content_type, content_type)\n  end\nend\n```\n\nObviously, I'm thinking this would be a little better if the `CarrierWave::SanitizedFile` class had a `content_type=` method, so that I didn't need to use the `instance_variable_set` hack.\n\nHowever, that aside, now I'm getting this error:\n\n```\nExcon::Errors::Forbidden in ReleasesController#create\n\nExpected(200) <=> Actual(403 Forbidden)\n  ...\n  response => #<Excon::Response:0x42997e0 @body=\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<Error><Code>SignatureDoesNotMatch</Code><Message>The request signature we calculated does not match the signature you provided. Check your key and signing method.</Message>\n  ...\n```\n\nEDIT: The good news at least is that I inspected the request sent by Fog, and it does indeed include `Content-Type => 'text/html'`. So I'm closer. I'm guessing some sort of checksum signature is getting generated for the request before the new content-type is being set, so that once it is set/changed, it no longer matches the checksum. But I am new to Fog/CarrierWave, so I don't know.\n Woo, figured it out! It looks like my above solution actually does work, but for one small change. I needed to add `.to_s` to the following:\n\n```\nMIME::Types.type_for(original_filename).first\n```\n\nTo make it:\n\n```\nMIME::Types.type_for(original_filename).first.to_s\n```\n\nAnd that did the trick. Now my content_types are uploading and getting set properly in my S3 bucket.\n I will try that. Thx.\n @JangoSteve - thanks for the suggestion, but unfortunately that method stops working as soon as you have something like this in in your uploader:\n\n``` ruby\nprocess :convert => 'png'\n```\n\nThis is due to the fact that the temp file retains to original file name including the original extension, which the mime-type gem uses to determine the content type. Even if you have a filename() method that renames the file to `whatever.png`, the file isn't actually renamed until it is copied from the temp folder to the final destination.\n @chrisbloom7, I'm confused. If you know you're converting the file to a png, why not just set the `content_type` to png, instead of using the mime-type gem?\n\n```\nclass PageUploader < CarrierWave::Uploader::Base\n  ...\n  process :set_content_type\n\n  def set_content_type(*args)\n    self.file.instance_variable_set(:@content_type, \"image/png\")\n  end\nend\n```\n That is what I ended up doing. I was just pointing out that you can't do what you suggested in cases like that, just in case anyone else should try it and experience the same problem I did.\n Hrm... perhaps worthwhile adding something to the wiki? Or maybe it's possible to fix in Carrierwave itself...?\n I could probably submit a patch to carrierwave to make this much easier, if you'd like.\n If anyone is interested, I've submitted a pull request which actually adds `set_content_type` using the mime-types gem as a processor (so that mime-types doesn't become a hard dependency). [See pull request here](https://github.com/jnicklas/carrierwave/pull/356).\n Hey guys. This problem's biting me. Is there a better solution than what @JangoSteve suggested above on May 15? I see that a couple of commits were made to try to fix it, but at least one (#254) was reverted.\n After stumbling upon [lib/carrierwave/processing/mime_types.rb](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/processing/mime_types.rb) , I figured out how to get the correct content-type set on files and their versions:\n1. Add `require 'carrierwave/processing/mime_types'` to an initializer or your uploader(s).\n2. Add `include CarrierWave::MimeTypes` to your uploader.\n3. Add `process :set_content_type` to your uploader(s).\n4. Grab a beer.\n\nMy question now is: Why is this not done by default?\n I meant to write up a quick post on the new `MimeTypes` processor which I commented about in this thread on June 11, but yeah it's basically as easy as @nickhoffman described.\n\nThe reason it's not done by default, and why I built it as a processor, is because it requires a dependency on the mime-types gem in order to provide more in-depth file-type guessing than most people who use carrierwave probably need. The goal is to keep carrierwave small, modular, and having as few required dependencies as possible.\n @JangoSteve Ah, that makes sense re: minimizing CarrierWave's dependencies.\n\nI've just submitted pull request #440, which adds a section to the README that explains how to use CarrierWave::MimeTypes to set more-specific content-type values.\n I cannot get this to work using the latest carrierwave-mongoid. I've set the set_content_type directive, the Content-Type will always be set to the original file rather than the converted format.\n @nickhoffman to answer your question, it's because this is a giant hairball with a broken model of one output file plus a bunch of \"versions\" for each input upload.  Now of course you want to upload them all to e.g. s3 with the correct types for each version, and that just doesn't fit well in this model.... to say nothing of the remarkable! coding techniques used.   You might find that simply using rack, tempfile, rmagick and fog directly is a much more expedient and less painful way to go.\n@JangoSteve  thanks to you and Goog, saved another infuriating morning with cw\n  While debugging, I found that the manipulate code is ran twice for each version on recreate_versions! \n\n```\nversion :thumb do\n   process :smart_crop => [50, 50]\nend\n\n # Create a cropped version, using \"interesting\" parts.\n   def smart_crop(width, height)\n     manipulate! do |img|\n       pp img\n       img\n    end\n  end\n```\n\nWill show \n    /home/.../tmp/20110324-1421-6470-8194/thumb_default-26.png PNG 1760x694=>880x347 880x347+0+0 DirectClass 8-bit\n    /home/.../tmp/20110324-1421-6470-8194/thumb_default-26.png PNG 1760x694=>880x347 880x347+0+0 DirectClass 8-bit\n\nIt could be due to mu setup, but AFAIK I followed the readme and documentation. \n Do you manipulate the \"main\" file in some way as well? CarrierWave will run that manipulation before running the version.\n I have no processors for the main file, if that is what you mean. Also, if I put a counter in that method, it is clearly ran twice.\n\nAlso interesting is, that for muliple _versions_ they will be called as such:\n\nversion_one\nversion_two\nversion_three\nversion_one #second round\nversion_two\nversion_three\n   `extlib_inheritable_accessor :_before_callbacks, :_after_callbacks` does a shallow copy of the Hash. Callbacks that are added to the contained Array will be shared across all Uploaders.\n `CarrierWave::Uploader::Base` and its descendants store callbacks in a `Hash`\n of `Array`s, keyed by callback type. The hash is  accessed/stored \nvia the  `_{before,after}_callbacks` methods. These methods are created via the `Class::extlib_inheritable_accessor` method (part of CarrierWave's core ext). \n\nIf the `_{before,after}_callbacks` detect that they're being called from a subclass they'll `dup` the underlying callback hash. The problem is `dup` preforms a shallow copy so while the hash _is_ duplicated, the underlying callback arrays remain the same.  Therefore any callbacks added by a subclass \nare inadvertently added to all other classes holding references to the array.\n\nHere's an example\n\n```\nirb(main):009:0> MovieUploader = Class.new(CarrierWave::Uploader::Base) { before :cache, :make_gif }\n=> MovieUploader\nirb(main):010:0> AvatarUploader = Class.new(CarrierWave::Uploader::Base)\n=> AvatarUploader\nirb(main):011:0> AvatarUploader._before_callbacks\n=> {:cache=>[:check_whitelist!, :make_gif]}\nirb(main):012:0> AvatarUploader._before_callbacks.object_id\n=> 1072320010\nirb(main):015:0> CarrierWave::Uploader::Base._before_callbacks.object_id\n=> 1072341200\nirb(main):013:0> AvatarUploader._before_callbacks[:cache].object_id\n=> 1072341190\nirb(main):014:0> CarrierWave::Uploader::Base._before_callbacks[:cache].object_id\n=> 1072341190\n```\n The problem does not exist in the master branch.\n Merged. Thanks!\n  Would be a good idea to update the readme info on S3 storage config, quite out of date\n Hey, sorry - didn't mean to be obtuse.. the readme rdoc on github has this code:\n\n```\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',       # required\n    :aws_access_key_id      => 'xxx',       # required\n    :aws_secret_access_key  => 'yyy',       # required\n    :region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n  }\n  config.fog_directory  = 'name_of_directory'                     # required\n  config.fog_host       = 'https://assets.example.com'            # optional, defaults to nil\n  config.fog_public     = false                                   # optional, defaults to true\n  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\nend\n```\n\n..which you soon discover doesn't work, digging into the gem source the code is nicely documented:\n\n```\nCarrierWave.configure do |config|\n  config.s3_access_key_id = \"xxxxxx\"\n  config.s3_secret_access_key = \"xxxxxx\"\n  config.s3_bucket = \"my_bucket_name\"\nend\n```\n\n...etc. Just thought it might be a good idea to update the readme, since unfortunately not everyone would unpack the gem and have a look for themselves..\n I know people should just check the rdoc, but I was just thinking that it might scare people off .. feel free to ignore me if I'm being a pain in the ass tho :) \n Ok ignore me, I seem to have missed that the config changed. I'm an idiot.\n Weird, I'm using 0.5.3, and I even unpacked the gem and checked, needed the old config.\n  I've applied a fix here: https://github.com/sshaw/carrierwave/tree/0.4-stable. Actually, I see it's fixed in the current HEAD, though it's based on ActiveSupport 3.X code. \n Initially I didn't see the GitHub option that allows one to select the base branch (didn't want to open the request against master). I see it now... \n  Currently we have to base our file naming scheme on IDs, but we would like to base it on somewhat unique names or 'slugs' (eg. mona_lisa).\n\nThe user uploads images, we give them a temporary name, then rename them. During rename we also need to move the image files since the slug changes.\n  Having problems setting up the s3 storage:\nwhen i try to save the image i get the error message:\n\nNoMethodError: undefined method `reject' for #Symbol:0x0000000295df0e\n\nmy configs look like:\n\nIntializer looks like:\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider               => 'AWS',       # required\n    :aws_access_key_id      => 'MYKET',       # required\n    :aws_secret_access_key  => 'MYSECRET',       # required\n    :region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n  }\n  config.fog_directory  = 'BUKET'                     # required\n# config.fog_host       = 'https://assets.example.com'            # optional, defaults to nil\n# config.fog_public     = false                                   # optional, defaults to true\n# config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\n\nend\n\nand uploader file:\n\nclass TileUploader < CarrierWave::Uploader::Base\n\n  # Include RMagick or ImageScience support:\n  include CarrierWave::RMagick\n  # include CarrierWave::ImageScience\n\n  # Choose what kind of storage to use for this uploader:\n  storage :fog\n  #storage :s3\n\n  # Override the directory where uploaded files will be stored.\n  # This is a sensible default for uploaders that are meant to be mounted:\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  # Provide a default URL as a default if there hasn't been a file uploaded:\n  # def default_url\n  #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n  # end\n\n  # Process files as they are uploaded:\n  # process :scale => [200, 300]\n  #\n  # def scale(width, height)\n  #   # do something\n  # end\n\n  # Create different versions of your uploaded files:\n  version :icon do\n   process :resize_to_fit => [15, 15]\n  end\n\n  # Add a white list of extensions which are allowed to be uploaded.\n  # For images you might use something like this:\n  # def extension_white_list\n  #   %w(jpg jpeg gif png)\n  # end\n\n  # Override the filename of the uploaded files:\n  # def filename\n  #   \"something.jpg\" if original_filename\n  # end\n\nend\n\nthe gemlists is:\n\nfog (0.7.1)\n\ncarrierwave (0.5.3)\n removing the comments from initializer didnt help ....\n @ygoldshtrakh could you put the stacktrace in a gist or something and link it?  That would make tracking down why this was occurring much simpler.  Thanks!\n here is a full log:\n\nNoMethodError: undefined method `reject' for #<Symbol:0x0000000295df0e>\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/fog-0.7.1/lib/fog/core/service.rb:44:in`new'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/fog-0.7.1/lib/fog/storage.rb:9:in `new'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/storage/fog.rb:100:in`connection'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/storage/fog.rb:282:in `connection'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/storage/fog.rb:294:in`directory'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/storage/fog.rb:228:in `store'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/storage/fog.rb:79:in`store!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/uploader/store.rb:59:in `block in store!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/uploader/callbacks.rb:17:in`with_callbacks'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/uploader/store.rb:58:in `store!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/mount.rb:323:in`store!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/carrierwave-0.5.3/lib/carrierwave/mount.rb:214:in `store_tile!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:435:in`_run_save_callbacks'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/callbacks.rb:277:in `create_or_update'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/persistence.rb:39:in`save'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/validations.rb:43:in `save'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/attribute_methods/dirty.rb:21:in`save'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in `block (2 levels) in save'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:289:in`block in with_transaction_returning_status'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/database_statements.rb:139:in `transaction'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:204:in`transaction'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:287:in `with_transaction_returning_status'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in`block in save'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:248:in `rollback_active_record_state!'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/activerecord-3.0.3/lib/active_record/transactions.rb:236:in`save'\n    from (irb):3\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/railties-3.0.3/lib/rails/commands/console.rb:44:in `start'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/railties-3.0.3/lib/rails/commands/console.rb:8:in`start'\n    from /Users/yuriy/.rvm/gems/ruby-1.9.2-p136@myapp/gems/railties-3.0.3/lib/rails/commands.rb:23:in `<top (required)>'\n Have you created a file at ~/.fog ?  If so does it have only a symbol in it, rather than a hash of credentials?  The error I'm seeing here would seem to imply that, if you just remove that file you should probably be good to go.\n You are absolutely correct, removing .fog file fixed the problem.\nThank you!\n  It probably comes from holding a socket open beyond the keep-alive value.  In general the default is to keep using the same socket for performance.  Could you try adding :persistent => false to your fog_credentials and see if the problem goes away (I'm guessing that it will, and perhaps we should start adding this as the default).\n Also getting this error when using Excon 0.5.7. I could fix the issues by downgrading to fog 0.7.0 and excon 0.5.6\n\nFurthermore I got connections that weren't closed properly causing my app on Heroku to become unavailable when all dynos were used up.\n yeah, also as @fbjork pointed out the issue seems specifically to be excon 0.5.7.  I think I know what the regression was probably caused by, but I'd like to also add tests to ensure it doesn't recur in the future.  Regardless I think a new version of excon can likely finish this without `:persistent => false`.  I'll let you know, hopefully will have some kind of answer in the next couple hours.\n I believe this revert should fix the issue:\nhttps://github.com/geemus/excon/commit/c9516ec6b3be51a2219c5a1a81d1dbdf207c0c8b I have a couple other commits to review and possibly merge but I should (hopefully) have a 0.5.8 for you later today.\n I just released excon 0.5.8, which I believe should solve these issues.  Please reopen if problems continue (we may want to update the dependency too, but figured I'd give you all a chance to try it out before we call it fixed).\n Hi there, Im seeing the 'Excon::Errors::SocketError: EOFError' issue with dragonfly 0.9.0 on an app deployed to heroku. \n\nthis is with excon 0.6.2 and fog 0.7.2 and seems to happen about 20% of the time\n\n/usr/ruby1.8.7/lib/ruby/1.8/openssl/buffering.rb:133:in readline'\n.bundle/gems/ruby/1.8/gems/excon-0.6.2/lib/excon/response.rb:22:inparse'\n.bundle/gems/ruby/1.8/gems/excon-0.6.2/lib/excon/connection.rb:162:in request'\n.bundle/gems/ruby/1.8/gems/fog-0.7.2/lib/fog/core/connection.rb:20:inrequest'\n.bundle/gems/ruby/1.8/gems/fog-0.7.2/lib/fog/storage/aws.rb:323:in request'\n.bundle/gems/ruby/1.8/gems/fog-0.7.2/lib/fog/storage/requests/aws/get_bucket_location.rb:30:inget_bucket_location'\n.bundle/gems/ruby/1.8/gems/dragonfly-0.9.0/lib/dragonfly/data_storage/s3data_store.rb:90:in bucket_exists?'\n.bundle/gems/ruby/1.8/gems/dragonfly-0.9.0/lib/dragonfly/data_storage/s3data_store.rb:109:inensure_bucket_initialized'\n\nsome more details on the dragonfly thread here - https://github.com/markevans/dragonfly/issues/84\n\nwould really appreciate any ideas you may have\n\ncheers\n @trevorturk fyi, I followed up back on the dragonfly issue so you can probably skip worrying about this one for now.\n  Hi. \n\nI have just installed the gem and after uploading an image, when trying to access it through the +.url+ method I get a 403 error. Is this something with the permissions that CW sets on the file? Since it's in the public directory (and all other files there are accessible as should be), the file should be accessible?!\n\n // Emil\n  The CarrierWave::Mount#mount_uploader parameter defaults to nil in case you want to use an anonymous uploader supplied as a block. The orm specific mount modules do not reflect this, forcing you to explicitly supply nil if you want to use an anonymous uploader.\n My apologies for being unclear.\n\nThe CarrierWave::Mount#mount_uploader method implies that you can use an anonymous uploader block, for which the uploader class parameter will default to nil, like so\n    class Test\n      mount_uploader :file do\n        #anonymous uploader block\n      end\n    end\nHowever, in the orm-specific mount modules the uploader class parameter does not default to nil so you will have to explicitly supply nil for the uploader class with a specific orm uploader\n    class Test < ActiveRecord::Base\n      mount_uploader :file, nil do\n        #anonymous uploader block\n      end\n    end\nWhile more of a nuissance than a problem, it does seem a bit inconsistent.\n\nIt would appear that an easy fix to this problem would be to simply default the uploader  class parameter in the orm-specific modules to nil.\n Should be fixed in master now. \n  Hi !\nI'm enjoying your awesome work !\nI may be wrong but :\nUsing Rails 3.0.4 + CarrierWave 0.5.2 + fog 0.7.0 (uploading on s3) + sqlite3, file url generation seems very slow out of the box.\nWhen I type Painting.last.file (Painting's file attribute) in Rail's console, that method responds http://bucket.blahblah within a couple of seconds, about 2 sec. That's pretty poor :-/\n\nRendering views take a while (6 secs for displaying 3 pics)...\n\nAm I missing something ?\nIs there a simple way to cache file's url after upload ?\n\nThanks :)\nCl\u00e9ment\n I'm just using CW fog's configuration, giving my access key and secret :\n\n<pre>\n#config/initializers/carrierwave.rb\nrequire \"#{Rails.root}/config/initializers/load_app_config\"\nCarrierWave.configure do |config|\n  config.root \"#{Rails.root}/tmp/\"\n  config.fog_credentials = {\n    :provider               => 'AWS',       # required\n    :aws_access_key_id      => APP_CONFIG[:aws_access_key],       # required\n    :aws_secret_access_key  => APP_CONFIG[:aws_secret]#,       # required\n    #:region                 => 'eu-west-1'  # optional, defaults to 'us-east-1'\n  }\n  config.fog_directory  = APP_CONFIG[:s3_bucket_name] #required\n  #config.fog_host       = 'https://assets.example.com'            # optional, defaults to nil\n  #config.fog_public     = false                                   # optional, defaults to true\n  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}  # optional, defaults to {}\nend \n</pre>\n Hey !  \nI just switched to a \"pure\" S3 config (w/o fog) :  \n\n<pre>\nrequire \"#{Rails.root}/config/initializers/load_app_config\"\nCarrierWave.configure do |config|\n  config.root = \"#{Rails.root}/tmp\"\n  config.s3_access_key_id =APP_CONFIG[:aws_access_key]\n  config.s3_secret_access_key = APP_CONFIG[:aws_secret]\n  config.s3_bucket = APP_CONFIG[:s3_bucket_name]\nend\n</pre>\n\n\nAnd it's blazing fast !  \nIsn't it odd that fog slows down that process ?\nShould we initialize fog outside of CW ?\n Sorry about the confusion.  This has been fixed on master here:\nhttps://github.com/jnicklas/carrierwave/commit/c4634e5c7fb9a281dbb299232a01cb90ab3f4066\nBut we are working out a couple other kinks before we release it.  I believe that commit fixes your issue though (I made a pretty obvious error that someone else had pointed out) so I'm going to close this and hopefully we'll get that released for you soon.\n This has not been fixed... I am using fog 0.7.1, carrierwave 0.5.3 and non-authenticated urls are really slow to generate. 12 images take 18 seconds. Will be happy to provide more info if interested. Using storage :s3 is instant. Seems to me it is pulling info from s3 to determine the urls. Confirmed by uploading a file, deleting it directly from s3, and then reloading the record from the db; Excon::Errors::NotFound without even calling attachment.url.\n Currently fog is cautious and tries to verify that the file is publicly accessible before returning a url (ie it ers on the side of correctness rather than performance).  That said, the provider in carrierwave already has a switch that will allow you to prefer speed over correctness.  If you would like to do this, you can specify a fog_host in your configuration, in your case you probably will want something like \"http://#{bucket_name}.s3.amazonaws.com/\" or perhaps whatever CNAME you have setup for your assets.  If you provide this value it will assume your file is setup and just return a string (ie no API calls back to AWS).  Otherwise it tries to ensure the file exists and is public prior to returning a url that would be invalid.\n Interesting API choice to default to SLOW. In 99% of cases I would think it wouldn't be mission critical to verify the file exists. In fact, as stated above, you can't even load a record if the file doesn't exist... Maybe at least document this in the read me. Thanks for your help and the hard work BTW.\n Hmm... I might agree with lardawge about the default behavior. I guess I don't see the advantage of double-checking that the URL is valid. In the case of a locally stored file, we'd just return a busted URL, right? I don't think there's a check for File.exist? or anything. \n\nI'm definitely open to more discussion, though. I'm going to re-open the issue. I think we should change the behavior or recommend something in the docs about fog_host at least. \n The difficulty comes in making it work across providers properly.  Each has their own url generation strategy, but they also have their own ways for making files public accessible.  So it isn't just the presence check that matters, it is also the accessibility check.  I did this is fog itself because I felt it best to have correct, non-confusing info instead of knowing that a file existed but finding requesting the url was a 404.  Examples of running into this would be creating things in rackspace but not cdn enabling the container or making an s3 bucket public but not making it's files public.  Either of those is pretty easy to do and can result in a pretty confusing state of things.  As such I tried to eliminate several error categories by removing the possibility of returning a link to something for which it wouldn't work.  Unfortunately this is slower.\n\nSo the question becomes, did I make the wrong decision in the general case or is it just the wrong decision for the carrierwave use case.  ie should I fix this by rewriting the public_url logic in fog or should we just do our own thing here.  If it is something to be fixed in fog then we ought to open the ticket there instead I imagine.  If instead it is still best to be accurate but provide a way to optimize for speed then we should definitely note that in the docs instead.\n @geemus, I'm leaning towards thinking that you made the right decision for fog, but this does seem like a \"bug\" in CarrierWave. I think the default behavior should be generating the URLs as quickly as possible, and people can deal with missing images etc on their own. Give it a little thought that let me know where you come down, though.\n @trevorturk that is also more or less what I was thinking.  In carrierwave I just used the fog methods because it was convenient and hadn't properly considered the performance implications.  That being said, it should be fairly simple to fix by centralizing some of that logic.  I'll try to have a patch for you just shortly.\n [fog] optimize public_url for AWS and Google\n\nMuch faster (no api calls) url generation, at the\npossibly cost of getting back urls even when the\nfile is private or does not exist.  This may\ncause confusion during setup, but that seems\nmore desirable than causing a performance hit\nat run time.\n\nClosed by 844788609b3c25b0435c42059c9db49d89ba6680\n Nice. Thanks for working that out. I totally agree that at the level of carrierwave this is the best choice.\n Awesome - thank you!\n Great ! -- thanks guys !\n I deleted a few files with fog and it was really slow. Changed to 'storage :s3' and it was really quick. I have not done any extensive testing but it was slow when deleting 10 files with fog, and was really quick deleting 2 files with s3. Using latest master of Carrierwave on Heroku.\n Please open a new issue.\n @espen I think this should help: https://github.com/jnicklas/carrierwave/commit/d96a9b8043fa6d522c8722183c1e9029a7e3cffb\n Man, i'm glad I found this, was driving me crazy. Just switched to s3 and things are fast again. \nI can't quite tell if this is supposed to be fixed in the latest versions available or what, but I'm using carrierwave 0.5.3 and fog 0.7.2 and things were slow til switching to s3. So...should it be ok now and i'm just not up to date?\n I think the speed optimizations are in master, but not yet released as a gem. We should probably do a gem release soon. \n ok sweet, thanks trevor, appreciate it. and yeah, i think that'd be a good idea, the current reality is a bit of a blocker imho.\n Agreed. I'll try to get something out today.\n\nOn Friday, May 6, 2011, jackdempsey\nreply@reply.github.com\nwrote:\n\n> ok sweet, thanks trevor, appreciate it. and yeah, i think that'd be a good idea, the current reality is a bit of a blocker imho.\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/261#comment_1109751\n @geemus: thanks, it seems to be normal now. Hope it can be released as a gem so I dont have to fetch from github in my app.\n  there was a problem, but it was totally my mistake\n  Got this as my filename for a FileUploader:\ndef filename\n  [model.id, original_filename].join(\"_\") + \".png\"\nend\n\nWhich for uploading \"first.png\" generated files as anticipated:\nfirst.png\nthumb_1_first.png\n\nStores in the database as follows: (Shouldn't it be original_filename?)\n_first.png\n\nHowever, when I call the following:\nresource.file.thumb.url\n\nIt returns the following without the ID portion:\nthumb__first.png\n\n3 Things:\n1) Shouldn't it store the original_filename? I'd prefer that... I'd imagine I'd have to overwrite a before_save, no biggie.\n2) Would I need to override the url method to include the model.id? I looked in the rdoc's at all the urls and the stores to get a hint at how it works, but can't conclusive say what needs to be overridden. Are these even bugs?\n3) Great Gem!\n\nThanks.\n The docs say quite clearly say **not to put the model id into the filename** ;) Trust me, just don't.\n\n1) It's theoretically possible to tell CarrierWave to use the original filename by overriding the #identifier method in your uploader, I have no idea what the effects of this are though, most likely you'd need to make some changes to the storage adapter.\n\n2) The URL should work jsut fine **as long as you don't include the model id in the filename**.\n\n3) Thanks!\n\nDid I mention **not to put the model id into the filename**? No? Well **don't put the model id into the filename**.\n My apologizes! I made sure I googled/searched issues before creating... Guess I missed that note!\n\nI notice it doesn't work with a datestamp either... I guess I'll just rethink my logic (I was storing all \"Photos\" under an \"Album\" directory, so wanted to prevent the possibility of overwriting a file with the same name. I'll just change the store_dir to put photos back in each model.id subdirectory.)\n\nThanks again!\n  Alright, I will dig in now.  Not sure what would have changed to effect this but I'll try to get to the bottom of it ASAP.\n When I made changes to facilitate using 'reset_data' to reset the mocks I was overly aggressive.  I mistakenly changed it such that whenever you made a new mock connection it would reset the data (as I thought this would reduce code duplication).  Of course it is common to create a connection in something like a before(:each) as carrierwave does.  In any event, it was an easy fix and should work alright after this:\nhttps://github.com/geemus/fog/commit/cae1fd80d6d4c4297036fbd8e2d9c5da556403eb\n\nI have a couple other bug reports and patches to look through, but should hopefully be able to get out a 0.7.1 with this for you later today (or I'd say tomorrow at worst).  Sorry for the confusion/delay, unfortunately the fog tests tend to create a connection and reuse it a lot (instead of recreating a new connection for each test), so this kind of fell through the cracks.\n I believe this is now solved with 0.7.1\n  I've encountered this bug in Windows 7 x64; not sure if it affects other platforms.  Lack of complaints found after searching suggests perhaps not.\n\nThe change is quite miniscule.  Using the block form of `File.open` ensures that the file is automatically _closed_ after execution.  This change was necessary to make sure that the temporary files can be deleted.  Otherwise, the `File.unlink` method gives a Errno::EACCES Permission denied error sometimes/often/always, I suppose because Windows considers the file to still be in use and thus unable to be deleted.\n  class ImageUploader < CarrierWave::Uploader::Base\n     include CarrierWave::RMagick\n     storage :file\n\n  def store_dir\n    \"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n  end\n\n  process :check_content_type\n\n  def check_content_type\n    if @file.content_type.include?(\"image\")\n      self.version :thumb do\n        process :resize_to_fit => [200, 200]\n      end\n    end\n  end\nend\n\nI cannot create the new version, it tells me that version is undefined for class ImageUploader.  And when I do ImageUploader.version :thumb do, it tells me that there is no version named thumb.\n\nThe above method works to upload images and non-image assets pretty nicely without a lot of fuss.  If only I could get the thumb version to work and process, we'd be good to go.\n\nAny thoughts?\n You're calling a class method from an instance method.\n\n/Jonas\n\nOn Wed, Mar 16, 2011 at 8:39 AM, mtmcfarl\nreply@reply.github.com\nwrote:\n\n> class ImageUploader < CarrierWave::Uploader::Base\n> \u00a0 \u00a0 include CarrierWave::RMagick\n> \u00a0 \u00a0 storage :file\n> \n> \u00a0def store_dir\n> \u00a0 \u00a0\"uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}\"\n> \u00a0end\n> \n> \u00a0process :check_content_type\n> \n> \u00a0def check_content_type\n> \u00a0 \u00a0if @file.content_type.include?(\"image\")\n> \u00a0 \u00a0 \u00a0self.version :thumb do\n> \u00a0 \u00a0 \u00a0 \u00a0process :resize_to_fit => [200, 200]\n> \u00a0 \u00a0 \u00a0end\n> \u00a0 \u00a0end\n> \u00a0end\n> end\n> \n> I cannot create the new version, it tells me that version is undefined for class ImageUploader. \u00a0And when I do ImageUploader.version :thumb do, it tells me that there is no version named thumb.\n> \n> The above method works to upload images and non-image assets pretty nicely without a lot of fuss. \u00a0If only I could get the thumb version to work and process, we'd be good to go.\n> \n> Any thoughts?\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/255\n Hrrmm... if the version directive is outside of the check_content_type method then the version directive works, inside the method it fails.  Does the process directive change the scoping?  Trying to figure out how this thing works.  Thanks for the patience.\n No. check_content_type is an instance method, version is a class method. You're calling a class method from an instance method. Version is expected to be called on the class, and it is \"static\" in the sense that you cannot create a version per uploaded file. Think of it like a \"has_many\" declaration in Rails.\n\nIf this makes no sense to you, grab the pickaxe book, you need to brush up on your Ruby.\n Great, thanks for the explanation.   I'm the first to admit I need to brush on my Ruby for sure.  Makes sense now.  I just wanted to use one uploader for any file type.\n  I'm having trouble reproducing this, do you have an example of a failing test?\n\nRunning off of master I'm trying this:\n\n```\n    it 'preserves the content type' do\n      original = @uploader.file.content_type\n      @uploader.cache_stored_file!\n      @uploader.store!\n\n      new_file = @storage.retrieve!(@uploader.identifier)\n      new_file.content_type.should == original\n    end\n```\n\nThis happens in the `fog_helper.rb` file for AWS and Google and it passes both.\n Oh I completely understand the problem now.\n\nIt seems to me like the content_type of cached files should also be cached somewhere as well if we don't want to rely on the mime-types gem.\n\nMaybe we could have some sort of global hash on the CarrierWave object of cache-ids to content types? Or maybe just an entire hash of attributes for files needed as well. It seems a bit icky to do this, but without this, I think it's impossible to get the content type without the mime-types gem.\n\nThis isn't really specific to fog as well, it's just a bug that crops up when the file is retrieved from the cache because in this case the file has no content type to start off of.\n\nRegardless, your code passes all the specs for me. Do you wanna try and pursue a cache on the CarrierWave class?\n Yeah that's a good point... I think that the mime-types gem is the way to go then. Might as well add it to the dependencies as well while you're at it.\n\nIn that case, it looks like your branch works just fine\n This problem will happen for any storage solution, though. Even if you're just using the filesystem, the content type will be blown away upon retrieve_from_cache!\n That seems like the way to go, I think Rails depends on mime-types anyway.\n\nIt's probably not too huge a gem and I can't really think of any other way to do this.\n I am currently testing Carrierwave w Mongoid in Rails3 ... (file storage ) \nEverything seems OK accorfding to documentation & examples , but  I get an error : \n\n> TypeError (can't dump File):\n\nIs it related to your discussion about the pending bug ?\n\nhere is the params send in the request when submitting the form :\n\"picture\"=>{\"{:class=>\\\"=>#<ActionDispatch::Http::UploadedFile:0x000001056eb6c0 @original_filename=\"hash_merging.rtf\", @content_type=\"text/rtf\", @headers=\"Content-Disposition: form-data; name=\\\"picture[{:class=>\\\\\"\\\\\", :size=>\\\\\"400\\\\\"}]\\\"; filename=\\\"hash_merging.rtf\\\"\\r\\nContent-Type: text/rtf\\r\\n\", @tempfile=#File:/var/folders/NK/NKfWCW3eEVCg0ERnpPsnME+++TI/-Tmp-/RackMultipart20110326-21454-iqgqi3>}\n This stops working as soon as you have something like this in in your uploader:\n\n``` ruby\nprocess :convert => 'png'\n```\n\nThis is due to the fact that the temp file retains to original file name including the original extension, which the mime-type lookup uses to determine the content type. Even if you have a filename() method that renames the file to `whatever.png`, the file isn't actually renamed until it is copied from the temp folder to the final destination.\n  Running on master with 1.9.2 -- After uploading I can't retrieve the upload file name (tried using both :fog and :file storage:\n\nruby-1.9.2-p180 :006 > Photo.first.image.filename\n => nil\n\nruby-1.9.2-p180 :007 > Photo.first.image.path\n => \"photos/1/02266_itswood_1680x1050.jpg\"\n\nruby-1.9.2-p180 :008 > Photo.first.image.url\n => \"https://s3.amazonaws.com/bucket-dev/photos/1/02266_itswood_1680x1050.jpg?AWSAccessKeyId=AKIxxxYA&Signature=%2FxxxExpires=1300172243\"\n Essentially this, and https://github.com/jnicklas/carrierwave/issues/#issue/249 are symptoms of the same problem, it's simply a bad idea for the column storing the filename and the mounter \"column\" to have the same name. If they were different this problem would be moot, because we could simply call `mounted_on_filename` or whatever and get the name.\n  Can't give much info. When using the minimagick with rails I receive unhelpful processing errors. No trace no added info where it went wrong just processing failed. Doesn't even mention minimagick. Switching to image_science fixed the problem. It's possible I'm reading the docs wrong and minimagick is no longer supported? \n My issue is not that minimagick is failing but that the error message I'm getting is so useless. No trace, nothing. Is there a hook I'm missing because at the moment there is no way for me to debug the issue myself. \n\nOn Mar 15, 2011, at 4:46 AM, trevorturk wrote:\n\n> I'm not sure, honestly -- I'd suggest using image_science that seems to be working for you. I'm going to close this issue b/c I believe others are using minimagick successfully. You might double-check by asking the Google Group if anyone is using minimagick, though, if you're so inclined. If it turns out to be a widespread problem we can investigate more deeply.\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/issues/252#comment_875398\n Indeed, you'd want to set ignore_processing_errors to false to get a stack trace. By default CarrierWave will let these fail silently and then add a validation error on the model.\n  please ignore.  did not first grok how versions were used.\n  Adding carrierwave to an empty Rails project causes the active_record framework to be eagerly loaded. This patch leverages the on_load API available in Railties to determine when to load. This keeps things lazy loaded.\n While the ActiveRecord module is defined, none of the modules or classes inside ActiveRecord are loaded. At the bottom of orm/active_record.rb, when it calls \"ActiveRecord::Base.extend\", it triggers all of active_record to get loaded.\n\nhttps://github.com/rails/rails/blob/3-0-stable/activerecord/lib/active_record.rb\n Running individual tests and starting a rails server in development mode is faster. Sure, a typical request hits the full stack, and in this case there is no benefit. In other cases I'm using carrier_wave with cassandra, or running an individual view helper test that does not require active record. Basically, anything run with cache_classes set to false should only load the ruby files required for execution. \n\nA couple tests show that simply adding carrierwave to an empty rails project changes the \"rails s\" start time from 2.5 seconds to 3.0 seconds. I assume that's how long it takes for active_record to load.\n\nThis doesn't add any functionality so I can't say I \"need\" this. I have, however, gotten some other gems such as will_paginate and thinking_sphinx to use it.\n Thanks a lot. It's a great gem!\n  ```\nclass Document < ActiveRecord::Base\n  mount_uploader :file, FileUploader\nend\n\n# obtain a reference to a document without loading from db\ndoc = some_parent.instance_variable_get(\"@document\")\n\ndoc.is_a? Array\n```\n\nFor some reason the \"is_a?\" call passes and executes\na chain of \"method_missing\" before it reaches to Object ancestor\none of these \"method_missings\" is AR/association/association_proxy.rb +208\nthis proxy is responsible of loading from the db\nand a few lines down the call-stack it reacher AR/base.rb +1557\nand on line 1558 it assigns to the uploader the value from the db\n\n```\nrespond_to?(:\"#{k}=\") ? send(:\"#{k}=\", v) : raise(UnknownAttributeError, \"unknown attribute: #{k}\")\n```\n\nIn our case the uploader accesor is called with the DB-fetched value\n\n```\n# equivalent call\nself.file= 'string/from.db'\n```\n\nthat renders the error\n\n```\nCarrierWave::FormNotMultipart (You tried to assign a String or a Pathname to an uploader, for security reasons, this is not allowed.\n\n  If this is a file upload, please check that your upload form is multipart encoded.):\n```\n\nThis can easily be fixed obviously by mounting on a different key that the DB attribute.\nNevertheless, the general case is to be considered.\n Unfortunately there is no easy way to understand the long version unless one does make some effort.\n\n**Short**:\nI'm using ActiveScaffold + Carrierwave and when I update an existing document by uploading a new file I get the error:\n\n```\nCarrierWave::FormNotMultipart (You tried to assign a String or a Pathname to an uploader, for security reasons, this is not allowed.\n```\n\n**Long**:\nActiveScaffold is a generic CRUD plugin.\n`ManagementProcess has many Documents` and `Document mount_uploader :file, FileUploader`\nActiveScaffold does some juggling to allow mass assignment of associated objects in a generic way (that means no mather how they're named):\n\n```\nassociation_proxy = instance_variable_get(\"@#{association.name}\")\n# meaning in my case:\n# management_process.instance_variable_get(\"@document\")\n```\n\nAnd the function doing this calls allways neds to return an array that's either `association_proxy` if it's already an array or `[association_proxy]` if it's just a single object.\n\nWhen it check's if it's already an array via `association_proxy.is_a? Array` the above described behavior happens **wich sumarizes to the fact that the uploader is assigned with the string from database because both have the same name** ie.: `document.file = 'string/from.db'`.\n1. association_proxy.is_a? Array\n2. method_missing is called\n3. method_missing loads and populates from DB\n4. calls `self.uploader_name = \"value/from/db.column\"`\n5. => error\n\nAs I said this can be avoided by using \"mount_on\" to mount on a different key that the DB column name.\n\nI wonder if anything can be done in carrierwave to avoid this assignment (uploader = db value) to improve the project.\n The problem stems from doing `r1.attributes = r2.attributes` on two records.  \nWe could override the `attributes` method on our model like:  \n\n```\n  def attributes\n    attrs = {}\n    attribute_names.each { |name| \n      attrs[name] = (name == :file) ? self.file : read_attribute(name) \n    }\n    attrs\n  end\n```\n\nI'm not sure if that breaks anything.  \nAnyway, I think it's a \"best practice\" to mount on a different name, there seems to be quite a few cross-cuts if one mounts on the same key name.\n ActiveRecord has the `attributes` getter and setter to work with attributes all at once, the problem is that the getter uses `read_attribute[:attr]` and the setter uses the AR-dynamically-generated-setters `attr=`.\nIf one overrides the setter for the file-column (the accessor that used to set-get DB values now set-gets the uploader) the AR API contract might break (like in the `attributes` case).\n\nMounting the uploader on a different key like:\n\n```\nmount_uploader :file, FileUploader, :mount_on => :name\n# instead mount_uploader :file, FileUploader\n```\n\nensures that we don't interfere with AR's usual attribute logic.\n I guess either of these 3:\n1. File a bug report in AR for using for `attributes` accessor `read_attribute[:attr]` in the getter and `attr=` in the setter, they should both be the same I think, don't know the inner details of AR\n2. Monkey-patch AR `attributes` accessor from carrierwave adapter when mounting\n3. Raise 'mount overriding error' if trying to mount on the same key\n regarding 3: both  \n- always use mount_on  \n- always mount on different key  \n I've been thinking for a long time, that we should probably change CarrierWave to default to using `mount_column_filename` or something instead of just `mount_column`, it's a hugely breaking change though, essentially breaking 95% of applications using CarrierWave. It should be done, but I'm reluctant to do it. What do you guys think?\n\nIn that case we could raise an error when trying to mount on a column with the same name as the uploader.\n Just realized that technically it's not the filename we're storing, but rather what we've been calling \"identifier\" in CarrierWave. `mount_column_identifier` sounds a bit weird, and might trip some people up. Hmmm.\n Just thought I'd mention to anyone running into this bug: the workaround is to rename field in database and specify :mount_on option when mounting uploader.\n\nFor me this happened when using form with nested models. For example I had Avatar model accepting nested attributes for AvatarImages (AvatarImage has uploader mounted).  The error happened every time when form with invalid data is submitted. I think it's strange that noone noticed this before, as what I'm doing seems pretty common to me.\n I spoke with Jonas about this in depth, and we agreed that this is a shitty situation. On the one hand, we know there's a problem and want to fix it. On the other hand, we don't want to break everyone's applications by making a huge change. \n\nSo, I'd like to ask you guys to work up a new section on the wiki that explains the situation and suggests that people use the mount_on option if/when they run into issues like this. \n\nWould one of you like to volunteer for that? Jonas and I aren't having the problem, so I don't think we're the best people to do a write up. \n\nThanks so much -- I'm sorry about this messy situation. \n I've added a quick section stub about this to the wiki. Please do consider adding more detail if possible!\n  Active Record provides `attr_changed?` `attr_was` that show if the attribute was changed and also show the old value of the attribute.  \n\nhttp://api.rubyonrails.org/classes/ActiveModel/Dirty.html\n\nIt would be nice if the carrierwave column would also answer this cases.\n\nRegarding `attr_changed?`, it's easy to implement by looking at the cache\n\n```\ndef attr_changed?; attr.cached? end\n```\n  i am using webrick server with rails 3 and ruby 1.9.2 to develop a simple upload test using carrierwave.\nOn submit this form:\n=form_for @institution, :html => {:multipart => true} do |f|\nmy webrick server throws a 500 internal server error. console says:\n\nStarted POST \"/testupload/1\" for 127.0.0.1 at 2011-03-09 15:43:16 +0100\n\nTypeError (can't convert nil into Integer):\n\nError during failsafe response: ActionView::Template::Error\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/whiny_nil.rb:48:in `method_missing'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/http/parameters.rb:10:in`parameters'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb:3:in `__home_txterm__rvm_rubies_ruby_______p__lib_ruby_gems_______gems_actionpack_______lib_action_dispatch_middleware_templates_rescues_diagnostics_erb___290488952_123146490__61154301'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_view/template.rb:135:in`block in render'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/notifications.rb:54:in `instrument'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_view/template.rb:127:in`render'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_view/render/rendering.rb:59:in `block in _render_template'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/notifications.rb:52:in`block in instrument'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/notifications/instrumenter.rb:21:in `instrument'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/notifications.rb:52:in`instrument'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_view/render/rendering.rb:56:in `_render_template'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_view/render/rendering.rb:26:in`render'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/haml-3.0.25/lib/haml/helpers/action_view_mods.rb:13:in `render_with_haml'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/show_exceptions.rb:88:in`rescue_action_locally'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/show_exceptions.rb:68:in `render_exception'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/show_exceptions.rb:59:in`rescue in call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/show_exceptions.rb:46:in `call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/railties-3.0.1/lib/rails/rack/logger.rb:13:in`call'\n  /home/tbotxtermhr/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/rack-1.2.1/lib/rack/runtime.rb:17:in `call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/activesupport-3.0.1/lib/active_support/cache/strategy/local_cache.rb:72:in`call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/rack-1.2.1/lib/rack/lock.rb:11:in `block in call'\n  <internal:prelude>:10:in`synchronize'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/rack-1.2.1/lib/rack/lock.rb:11:in `call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/static.rb:30:in`call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/railties-3.0.1/lib/rails/application.rb:168:in `call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/railties-3.0.1/lib/rails/application.rb:77:in`method_missing'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/railties-3.0.1/lib/rails/rack/log_tailer.rb:14:in `call'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/rack-1.2.1/lib/rack/content_length.rb:13:in`call'\nRendered /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/actionpack-3.0.1/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (3.2ms)\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/gems/1.9.1/gems/rack-1.2.1/lib/rack/handler/webrick.rb:52:in `service'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/httpserver.rb:111:in`service'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n  /home/txterm/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/webrick/server.rb:183:in`block in start_thread'\n same project as https://github.com/jnicklas/carrierwave-example-app\nmy os is ubuntu 10.04 - is perhaps webtrick the problem?\n  See for discussion on this issue: https://github.com/jnicklas/carrierwave/issues#issue/245\n\nNote: This is my first pull request ever and I am only busy for a couple of months in Ruby so if things don't seem right or unconventional, it's because of that ;)\n\nI tested it on Rails 3.0.5, Ruby 1.9.2, but its a minor change, I don't expect it to break things (don't we all :)\n Added a spec, hope this will suffice.\n See my comments in the commit; https://github.com/jnicklas/carrierwave/commit/9ccab1aff43cdf158c9546f1e76f1df2256c36dc\n\nGreat, thanks to you too :)\n  When rendering a model with a mounted uploader I can reference a version like so:\n    @user.avatar.thumb.url\nHowever, when using\n    render :json => @user\nonly @user.avatar.url is available in the rendered hash?\n I just looked in uploader/url.rb to see what you mean with what is set as as_json.\nHowever, @user.to_json returns only the avatar.url\nJust tried to do a\n    puts @user.to_json\nand it would only give me:\n    {\"user\":{\"avatar\":{\"url\":\"https://etc.s3.amazonaws.com/something/1298921346.jpg\"}}}\n I think the .to_json also responds to as_json in this particular case, not only for a call to render :json.\nSo maybe version support should be added to the as_json method in uploader/url.rb, I am not really that competent yet in Ruby but I think that would be a solution.\n I am using CanCan to get the model itself, that's the only modification. This can't be the problem tho, else I wouldn't be able to get the .url at all?\n Sorry, will try to give more information:\n- Running Rails 3.0.5 app on Ruby 1.9.2 \n- Using CanCan gem to get User model.\n- Using Carrierwave gem (0.5.2)\n- Using model called User, mounted uploader on avatar, with a version: thumb\n- Calling a users/1.json on my app, calls render :json => @user (or @user.to_json, no difference)\n\nExpected output:\n    {\"user\":{\"avatar\":{\"url\":\"http://urltooriginal.jpg\", \"thumb\":{\"url\":\"http://urltothumb.jpg\"}}}}\n\nActual output\n    {\"user\":{\"avatar\":{\"url\":\"http://urltooriginal.jpg\"}}}\n yes, sorry, left the common id and updated_at etc out for unneeded clutter, so yes: @user.to_json\n Also: just removed CanCan for that particular Model action, just to take away possible causes. Still the same.\n Trevor: no that's not the issue.\nIssue is @user.to_json doesn't include any of the versions.\n re: your last comment. Ok, clear, will try to see if I can put together my first pull request. First have to figure out how to run the master instead of the gem (tells a lot about my Rails experience ;))\n Thanks for your help anyway, it's a great gem! \n Ok, added a pull request, see https://github.com/jnicklas/carrierwave/pull/246\n  Hi there,\n\nI don't know if it's a bug but I think so. I couldn't find a solution for my problem. My uploader uses SecureRandom.hex for the filename. I've added a new version and called asset.recreate_versions! on every asset currently stored in the database. The new version is created, BUT the problem is the new version gets a completly new filename. \n\nExample: I upload an image, it gets an filename like 123456789.jpg. Then when I run recreate_versions! on this image, the version's filename look like version_34345345.jpg. Therefore if I want to retrieve a specific version of the image the image can not be found.\n\nI think it would be better if recreate_versions! does not rename or generate new filenames or the new filename has to be stored in the database.\n\nRegards,\nMartin\n  i am having an issue returning an uploader class object from cache.  i have tried `ProductImageUploader.new.retrieve_from_cache!('20110307-0014-27129-0134/screen.png')\n`, however it only returns an array of `[:retrieve_versions_from_cache!]`\n\ni confirmed that the cache_name is valid and exists in the cache_dir.  am i using this method incorrectly?\n  Hi guys,\n\nIn development, when trying to upload to s3 I'm getting Segmentation fault:\n\n<pre>\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187: [BUG] Segmentation fault\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10.6.0]\n\n-- control frame ----------\nc:0094 p:---- s:0501 b:0501 l:000500 d:000500 CFUNC  :connect\nc:0093 p:0268 s:0498 b:0498 l:000497 d:000497 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187\nc:0092 p:0051 s:0492 b:0489 l:000488 d:000488 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:204\nc:0091 p:0484 s:0486 b:0486 l:000485 d:000485 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:106\nc:0090 p:0100 s:0472 b:0472 l:000471 d:000471 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/core/connection.rb:20\nc:0089 p:0106 s:0464 b:0464 l:000463 d:000463 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/aws.rb:339\nc:0088 p:0102 s:0455 b:0455 l:000454 d:000454 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/requests/aws/put_object.rb:43\nc:0087 p:0109 s:0447 b:0447 l:000446 d:000446 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/storage/s3.rb:140\nc:0086 p:0058 s:0442 b:0442 l:000441 d:000441 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/storage/s3.rb:206\nc:0085 p:0018 s:0437 b:0437 l:000429 d:000436 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/store.rb:59\nc:0084 p:0033 s:0435 b:0435 l:000434 d:000434 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/callbacks.rb:17\nc:0083 p:0046 s:0430 b:0430 l:000429 d:000429 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/store.rb:58\nc:0082 p:0065 s:0426 b:0426 l:000425 d:000425 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/mount.rb:323\nc:0081 p:0019 s:0423 b:0423 l:000422 d:000422 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/mount.rb:214\nc:0080 p:0300 s:0420 b:0420 l:000419 d:000419 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:435\nc:0079 p:0011 s:0411 b:0411 l:000998 d:000998 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/callbacks.rb:277\nc:0078 p:0011 s:0408 b:0408 l:000407 d:000407 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/persistence.rb:39\nc:0077 p:0027 s:0404 b:0404 l:000403 d:000403 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/validations.rb:43\nc:0076 p:0012 s:0400 b:0400 l:000399 d:000399 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/attribute_methods/dirty.rb:21\nc:0075 p:0010 s:0395 b:0395 l:001690 d:000394 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237\nc:0074 p:0015 s:0393 b:0393 l:001670 d:000392 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:289\nc:0073 p:0232 s:0391 b:0391 l:000390 d:000390 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/database_s\nc:0072 p:0025 s:0382 b:0382 l:000381 d:000381 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:204\nc:0071 p:0022 s:0377 b:0377 l:001670 d:001670 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:287\nc:0070 p:0009 s:0373 b:0373 l:001690 d:000098 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237\nc:0069 p:0017 s:0371 b:0371 l:000370 d:000370 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:248\nc:0068 p:0011 s:0368 b:0368 l:001690 d:001690 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:236\nc:0067 p:0013 s:0364 b:0364 l:000363 d:000363 METHOD /Users/Jonas/web_projects/FSRGlobal/app/controllers/admin/mail_templates_controller.rb:19\nc:0066 p:0012 s:0361 b:0361 l:000360 d:000360 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/implicit_render.rb:4\nc:0065 p:0015 s:0356 b:0356 l:000355 d:000355 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151\nc:0064 p:0041 s:0351 b:0351 l:000350 d:000350 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rendering.rb:11\nc:0063 p:0010 s:0347 b:0347 l:0015e0 d:000346 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:18\nc:0062 p:0124 s:0345 b:0345 l:000344 d:000344 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:445\nc:0061 p:0113 s:0339 b:0339 l:000338 d:000338 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:409\nc:0060 p:0024 s:0330 b:0330 l:000329 d:000329 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:93\nc:0059 p:0015 s:0324 b:0324 l:0015e0 d:0015e0 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:17\nc:0058 p:0012 s:0320 b:0320 l:000301 d:000319 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:30\nc:0057 p:0017 s:0316 b:0316 l:000306 d:000315 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52\nc:0056 p:0032 s:0314 b:0314 l:000313 d:000313 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications/instrumenter.rb:21\nc:0055 p:0036 s:0307 b:0307 l:000306 d:000306 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52\nc:0054 p:0152 s:0302 b:0302 l:000301 d:000301 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:29\nc:0053 p:0012 s:0296 b:0296 l:000295 d:000295 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rescue.rb:17\nc:0052 p:0093 s:0291 b:0291 l:000290 d:000290 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120\nc:0051 p:0084 s:0285 b:0285 l:000284 d:000284 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40\nc:0050 p:0048 s:0280 b:0280 l:000279 d:000279 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:138\nc:0049 p:0086 s:0275 b:0275 l:000274 d:000274 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rack_delegation.rb:14\nc:0048 p:0030 s:0269 b:0269 l:0010a8 d:000268 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:178\nc:0047 p:---- s:0266 b:0266 l:000265 d:000265 FINISH\nc:0046 p:---- s:0264 b:0264 l:000263 d:000263 CFUNC  :call\nc:0045 p:0022 s:0260 b:0260 l:000259 d:000259 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62\nc:0044 p:0094 s:0254 b:0254 l:000253 d:000253 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:27\nc:0043 p:0097 s:0248 b:0248 l:000220 d:000247 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:148\nc:0042 p:0014 s:0242 b:0242 l:000226 d:000241 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:93\nc:0041 p:0189 s:0237 b:0237 l:000236 d:000236 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:68\nc:0040 p:0198 s:0227 b:0227 l:000226 d:000226 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:92\nc:0039 p:0092 s:0221 b:0221 l:000220 d:000220 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:139\nc:0038 p:0025 s:0215 b:0215 l:000214 d:000214 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:492\nc:0037 p:0033 s:0211 b:0211 l:000210 d:000210 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/haml-3.0.25/lib/sass/plugin/rack.rb:41\nc:0036 p:0015 s:0207 b:0207 l:000206 d:000206 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/best_standards_support.rb:17\nc:0035 p:0093 s:0200 b:0200 l:000199 d:000199 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/head.rb:14\nc:0034 p:0155 s:0193 b:0193 l:000192 d:000192 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/methodoverride.rb:24\nc:0033 p:0046 s:0187 b:0187 l:000186 d:000186 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/params_parser.rb:21\nc:0032 p:0054 s:0182 b:0182 l:000181 d:000181 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/flash.rb:182\nc:0031 p:0027 s:0175 b:0175 l:000174 d:000174 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/session/abstract_store.rb:14\nc:0030 p:0015 s:0164 b:0164 l:000163 d:000163 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/cookies.rb:295\nc:0029 p:0014 s:0156 b:0156 l:001e60 d:000155 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:32\nc:0028 p:0019 s:0154 b:0154 l:000153 d:000153 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/query_cach\nc:0027 p:0051 s:0150 b:0150 l:000149 d:000149 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:12\nc:0026 p:0019 s:0146 b:0146 l:001e60 d:001e60 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:31\nc:0025 p:0015 s:0142 b:0142 l:000141 d:000141 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/connection\nc:0024 p:0029 s:0138 b:0138 l:001210 d:000137 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:46\nc:0023 p:0155 s:0136 b:0136 l:000135 d:000135 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:415\nc:0022 p:0011 s:0126 b:0126 l:001210 d:001210 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:44\nc:0021 p:0015 s:0122 b:0122 l:000121 d:000121 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/sendfile.rb:107\nc:0020 p:0049 s:0112 b:0112 l:000111 d:000111 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/remote_ip.rb:48\nc:0019 p:0015 s:0108 b:0108 l:000107 d:000107 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/show_exceptions.rb:46\nc:0018 p:0027 s:0100 b:0100 l:000099 d:000099 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/logger.rb:13\nc:0017 p:0032 s:0096 b:0096 l:000095 d:000095 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/runtime.rb:17\nc:0016 p:0052 s:0087 b:0087 l:000086 d:000086 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/cache/strategy/local_cache.rb:72\nc:0015 p:0014 s:0083 b:0083 l:000077 d:000082 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11\nc:0014 p:0019 s:0081 b:0081 l:000080 d:000080 METHOD <internal:prelude>:10\nc:0013 p:0054 s:0078 b:0078 l:000077 d:000077 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11\nc:0012 p:0193 s:0073 b:0073 l:000072 d:000072 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/static.rb:30\nc:0011 p:0032 s:0066 b:0066 l:000065 d:000065 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:168\nc:0010 p:0021 s:0062 b:0062 l:000061 d:000061 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:77\nc:0009 p:---- s:0057 b:0057 l:000056 d:000056 FINISH\nc:0008 p:0015 s:0055 b:0055 l:000054 d:000054 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/log_tailer.rb:14\nc:0007 p:0015 s:0050 b:0050 l:000049 d:000049 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/content_length.rb:13\nc:0006 p:0338 s:0042 b:0042 l:000041 d:000041 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/handler/webrick.rb:52\nc:0005 p:0257 s:0030 b:0030 l:000029 d:000029 METHOD /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:111\nc:0004 p:0393 s:0020 b:0020 l:000019 d:000019 METHOD /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:70\nc:0003 p:0126 s:0009 b:0009 l:001fe8 d:000008 BLOCK  /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/server.rb:183\nc:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH\nc:0001 p:---- s:0002 b:0002 l:000001 d:000001 TOP   \n---------------------------\n-- Ruby level backtrace information ----------------------------------------\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/handler/webrick.rb:52:in `service'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/content_length.rb:13:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/log_tailer.rb:14:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:77:in `method_missing'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:168:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/static.rb:30:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11:in `call'\n<internal:prelude>:10:in `synchronize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/runtime.rb:17:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/logger.rb:13:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/show_exceptions.rb:46:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/sendfile.rb:107:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:44:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:415:in `_run_call_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:353:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:31:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:12:in `cache'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/query_cache.rb:28:in `cache'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:32:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/cookies.rb:295:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/session/abstract_store.rb:149:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/flash.rb:182:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/methodoverride.rb:24:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/head.rb:14:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/haml-3.0.25/lib/sass/plugin/rack.rb:41:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:492:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:139:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:92:in `recognize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:68:in `optimized_each'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:93:in `block in recognize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:148:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:27:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:178:in `block in action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:138:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40:in `process'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120:in `process'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rescue.rb:17:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:29:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52:in `instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications/instrumenter.rb:21:in `instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52:in `block in instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:17:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:93:in `run_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:409:in `_run_process_action_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:445:in `_run__2486076039466902249__process_action__1435004535994233153__callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:18:in `block in process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rendering.rb:11:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/implicit_render.rb:4:in `send_action'\n/Users/Jonas/web_projects/FSRGlobal/app/controllers/admin/mail_templates_controller.rb:19:in `create'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:236:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:248:in `rollback_active_record_state!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in `block in save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:287:in `with_transaction_returning_status'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:204:in `transaction'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/database_statements.rb:139:in `transaction'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:289:in `block in with_transaction_returning_status'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in `block (2 levels) in save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/attribute_methods/dirty.rb:21:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/validations.rb:43:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/persistence.rb:39:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/callbacks.rb:277:in `create_or_update'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:435:in `_run_save_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/mount.rb:214:in `store_attachment1!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/mount.rb:323:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/store.rb:58:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/store.rb:59:in `block in store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/storage/s3.rb:206:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/storage/s3.rb:140:in `store'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/requests/aws/put_object.rb:43:in `put_object'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/aws.rb:339:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/core/connection.rb:20:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:106:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:204:in `socket'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n\n-- C level backtrace information -------------------------------------------\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAbort trap\n</pre>\n\n\nMy S3 initializer:\n\n<pre>\nCarrierWave.configure do |config|\n  config.s3_access_key_id = '(...)'\n  config.s3_secret_access_key = '(...)'\n  config.s3_bucket = '(...)'\n  config.s3_region = 'eu-west-1'\nend\n</pre>\n\n\nThe uploader is obviously set to `storage :s3` and works fine with `:file`\n\nI didn't notice any other issues with this, and it doesn't seem to be described anywhere, so as you might imagine, pretty unexpected. \nAny ideas what might be wrong? \n\nThanks\n Yeah, I'm getting the same error with the master branch.\n\nSince I haven't had any success connecting to s3, I'm not 100% this is working perfectly. However, I guess it shouldn't cause segmentation fault.\n\nPlease let me know if there is a reasonable way to debug it - the gem seems really nice.\n\nGemfile: `gem 'carrierwave', :git => \"https://github.com/jnicklas/carrierwave.git\", :branch => \"master\"`\n\nInitializer:\n\n<pre>\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider           => 'Hidden',\n    :aws_access_key_id => 'Hidden',\n    :aws_secret_access_key  =>Hidden',\n    :region                 => 'eu-west-1'\n  }\n  config.fog_directory = 'fsrglobal'\nend \n</pre>\n\n\nSystem:\nfog (0.6.0)\ncarrierwave (0.5.2)\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10.6.0]\n\nError:\n\n<pre>\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187: [BUG] Segmentation fault\nruby 1.9.2p136 (2010-12-25 revision 30365) [x86_64-darwin10.6.0]\n\n-- control frame ----------\nc:0096 p:---- s:0509 b:0509 l:000508 d:000508 CFUNC  :connect\nc:0095 p:0268 s:0506 b:0506 l:000505 d:000505 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187\nc:0094 p:0051 s:0500 b:0497 l:000496 d:000496 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:204\nc:0093 p:0484 s:0494 b:0494 l:000493 d:000493 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:106\nc:0092 p:0100 s:0480 b:0480 l:0024b0 d:0024b0 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/core/connection.rb:20\nc:0091 p:0106 s:0472 b:0472 l:000471 d:000471 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/aws.rb:339\nc:0090 p:0104 s:0463 b:0463 l:000462 d:000462 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/requests/aws/get_bucket.rb:55\nc:0089 p:0055 s:0458 b:0458 l:000457 d:000457 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/models/aws/directories.rb:24\nc:0088 p:0048 s:0449 b:0449 l:000448 d:000448 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:294\nc:0087 p:0040 s:0446 b:0446 l:000445 d:000445 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:228\nc:0086 p:0058 s:0442 b:0442 l:000441 d:000441 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:79\nc:0085 p:0018 s:0437 b:0437 l:000429 d:000436 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/store.rb:59\nc:0084 p:0033 s:0435 b:0435 l:000434 d:000434 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/callbacks.rb:17\nc:0083 p:0046 s:0430 b:0430 l:000429 d:000429 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/store.rb:58\nc:0082 p:0065 s:0426 b:0426 l:000425 d:000425 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/mount.rb:323\nc:0081 p:0019 s:0423 b:0423 l:000422 d:000422 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/mount.rb:214\nc:0080 p:0207 s:0420 b:0420 l:000419 d:000419 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:420\nc:0079 p:0011 s:0411 b:0411 l:001e08 d:001e08 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/callbacks.rb:277\nc:0078 p:0011 s:0408 b:0408 l:000407 d:000407 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/persistence.rb:39\nc:0077 p:0027 s:0404 b:0404 l:000403 d:000403 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/validations.rb:43\nc:0076 p:0012 s:0400 b:0400 l:000399 d:000399 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/attribute_methods/dirty.rb:21\nc:0075 p:0010 s:0395 b:0395 l:000180 d:000394 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237\nc:0074 p:0015 s:0393 b:0393 l:0005b0 d:000392 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:289\nc:0073 p:0232 s:0391 b:0391 l:000390 d:000390 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/database_s\nc:0072 p:0025 s:0382 b:0382 l:000381 d:000381 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:204\nc:0071 p:0022 s:0377 b:0377 l:0005b0 d:0005b0 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:287\nc:0070 p:0009 s:0373 b:0373 l:000180 d:001b48 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237\nc:0069 p:0017 s:0371 b:0371 l:000370 d:000370 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:248\nc:0068 p:0011 s:0368 b:0368 l:000180 d:000180 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:236\nc:0067 p:0013 s:0364 b:0364 l:000363 d:000363 METHOD /Users/Jonas/web_projects/FSRGlobal/app/controllers/admin/mail_templates_controller.rb:20\nc:0066 p:0012 s:0361 b:0361 l:000360 d:000360 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/implicit_render.rb:4\nc:0065 p:0015 s:0356 b:0356 l:000355 d:000355 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151\nc:0064 p:0041 s:0351 b:0351 l:000350 d:000350 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rendering.rb:11\nc:0063 p:0010 s:0347 b:0347 l:0013b0 d:000346 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:18\nc:0062 p:0124 s:0345 b:0345 l:000344 d:000344 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:445\nc:0061 p:0113 s:0339 b:0339 l:000338 d:000338 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:409\nc:0060 p:0024 s:0330 b:0330 l:000329 d:000329 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:93\nc:0059 p:0015 s:0324 b:0324 l:0013b0 d:0013b0 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:17\nc:0058 p:0012 s:0320 b:0320 l:000301 d:000319 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:30\nc:0057 p:0017 s:0316 b:0316 l:000306 d:000315 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52\nc:0056 p:0032 s:0314 b:0314 l:000313 d:000313 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications/instrumenter.rb:21\nc:0055 p:0036 s:0307 b:0307 l:000306 d:000306 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52\nc:0054 p:0152 s:0302 b:0302 l:000301 d:000301 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:29\nc:0053 p:0012 s:0296 b:0296 l:000295 d:000295 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rescue.rb:17\nc:0052 p:0093 s:0291 b:0291 l:000290 d:000290 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120\nc:0051 p:0084 s:0285 b:0285 l:000284 d:000284 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40\nc:0050 p:0048 s:0280 b:0280 l:000279 d:000279 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:138\nc:0049 p:0086 s:0275 b:0275 l:000274 d:000274 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rack_delegation.rb:14\nc:0048 p:0030 s:0269 b:0269 l:002488 d:000268 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:178\nc:0047 p:---- s:0266 b:0266 l:000265 d:000265 FINISH\nc:0046 p:---- s:0264 b:0264 l:000263 d:000263 CFUNC  :call\nc:0045 p:0022 s:0260 b:0260 l:000259 d:000259 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62\nc:0044 p:0094 s:0254 b:0254 l:000253 d:000253 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:27\nc:0043 p:0097 s:0248 b:0248 l:000220 d:000247 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:148\nc:0042 p:0014 s:0242 b:0242 l:000226 d:000241 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:93\nc:0041 p:0189 s:0237 b:0237 l:000236 d:000236 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:68\nc:0040 p:0198 s:0227 b:0227 l:000226 d:000226 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:92\nc:0039 p:0092 s:0221 b:0221 l:000220 d:000220 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:139\nc:0038 p:0025 s:0215 b:0215 l:000214 d:000214 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:492\nc:0037 p:0033 s:0211 b:0211 l:000210 d:000210 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/haml-3.0.25/lib/sass/plugin/rack.rb:41\nc:0036 p:0015 s:0207 b:0207 l:000206 d:000206 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/best_standards_support.rb:17\nc:0035 p:0093 s:0200 b:0200 l:000199 d:000199 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/head.rb:14\nc:0034 p:0155 s:0193 b:0193 l:000192 d:000192 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/methodoverride.rb:24\nc:0033 p:0046 s:0187 b:0187 l:000186 d:000186 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/params_parser.rb:21\nc:0032 p:0054 s:0182 b:0182 l:000181 d:000181 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/flash.rb:182\nc:0031 p:0027 s:0175 b:0175 l:000174 d:000174 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/session/abstract_store.rb:14\nc:0030 p:0015 s:0164 b:0164 l:000163 d:000163 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/cookies.rb:295\nc:0029 p:0014 s:0156 b:0156 l:001300 d:000155 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:32\nc:0028 p:0019 s:0154 b:0154 l:000153 d:000153 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/query_cach\nc:0027 p:0051 s:0150 b:0150 l:000149 d:000149 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:12\nc:0026 p:0019 s:0146 b:0146 l:001300 d:001300 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:31\nc:0025 p:0015 s:0142 b:0142 l:000141 d:000141 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/connection\nc:0024 p:0029 s:0138 b:0138 l:001190 d:000137 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:46\nc:0023 p:0155 s:0136 b:0136 l:000135 d:000135 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:415\nc:0022 p:0011 s:0126 b:0126 l:001190 d:001190 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:44\nc:0021 p:0015 s:0122 b:0122 l:000121 d:000121 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/sendfile.rb:107\nc:0020 p:0049 s:0112 b:0112 l:000111 d:000111 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/remote_ip.rb:48\nc:0019 p:0015 s:0108 b:0108 l:000107 d:000107 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/show_exceptions.rb:46\nc:0018 p:0027 s:0100 b:0100 l:000099 d:000099 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/logger.rb:13\nc:0017 p:0032 s:0096 b:0096 l:000095 d:000095 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/runtime.rb:17\nc:0016 p:0052 s:0087 b:0087 l:000086 d:000086 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/cache/strategy/local_cache.rb:72\nc:0015 p:0014 s:0083 b:0083 l:000077 d:000082 BLOCK  /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11\nc:0014 p:0019 s:0081 b:0081 l:000080 d:000080 METHOD <internal:prelude>:10\nc:0013 p:0054 s:0078 b:0078 l:000077 d:000077 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11\nc:0012 p:0193 s:0073 b:0073 l:000072 d:000072 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/static.rb:30\nc:0011 p:0032 s:0066 b:0066 l:000065 d:000065 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:168\nc:0010 p:0021 s:0062 b:0062 l:000061 d:000061 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:77\nc:0009 p:---- s:0057 b:0057 l:000056 d:000056 FINISH\nc:0008 p:0015 s:0055 b:0055 l:000054 d:000054 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/log_tailer.rb:14\nc:0007 p:0015 s:0050 b:0050 l:000049 d:000049 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/content_length.rb:13\nc:0006 p:0338 s:0042 b:0042 l:000041 d:000041 METHOD /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/handler/webrick.rb:52\nc:0005 p:0257 s:0030 b:0030 l:000029 d:000029 METHOD /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:111\nc:0004 p:0393 s:0020 b:0020 l:000019 d:000019 METHOD /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:70\nc:0003 p:0126 s:0009 b:0009 l:000418 d:000008 BLOCK  /Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/server.rb:183\nc:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH\nc:0001 p:---- s:0002 b:0002 l:000001 d:000001 TOP   \n---------------------------\n-- Ruby level backtrace information ----------------------------------------\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\n/Users/Jonas/.rvm/rubies/ruby-1.9.2-p136/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/handler/webrick.rb:52:in `service'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/content_length.rb:13:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/log_tailer.rb:14:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:77:in `method_missing'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:168:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/static.rb:30:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11:in `call'\n<internal:prelude>:10:in `synchronize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/lock.rb:11:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/cache/strategy/local_cache.rb:72:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/runtime.rb:17:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/rack/logger.rb:13:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/show_exceptions.rb:46:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/sendfile.rb:107:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:44:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:415:in `_run_call_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/connection_pool.rb:353:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:31:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:12:in `cache'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/query_cache.rb:28:in `cache'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/query_cache.rb:32:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/cookies.rb:295:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/session/abstract_store.rb:149:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/flash.rb:182:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/params_parser.rb:21:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/methodoverride.rb:24:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/head.rb:14:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/haml-3.0.25/lib/sass/plugin/rack.rb:41:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:492:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:139:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:92:in `recognize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:68:in `optimized_each'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/code_generation.rb:93:in `block in recognize'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-mount-0.6.13/lib/rack/mount/route_set.rb:148:in `block in call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:27:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_dispatch/routing/route_set.rb:62:in `call'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:178:in `block in action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal.rb:138:in `dispatch'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/rendering.rb:40:in `process'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:120:in `process'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rescue.rb:17:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:29:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52:in `instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications/instrumenter.rb:21:in `instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/notifications.rb:52:in `block in instrument'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:17:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:93:in `run_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:409:in `_run_process_action_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:445:in `_run__2553354466931751133__process_action__341666949092195414__callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/callbacks.rb:18:in `block in process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/rendering.rb:11:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/abstract_controller/base.rb:151:in `process_action'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/actionpack-3.0.3/lib/action_controller/metal/implicit_render.rb:4:in `send_action'\n/Users/Jonas/web_projects/FSRGlobal/app/controllers/admin/mail_templates_controller.rb:20:in `create'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:236:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:248:in `rollback_active_record_state!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in `block in save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:287:in `with_transaction_returning_status'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:204:in `transaction'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/connection_adapters/abstract/database_statements.rb:139:in `transaction'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:289:in `block in with_transaction_returning_status'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/transactions.rb:237:in `block (2 levels) in save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/attribute_methods/dirty.rb:21:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/validations.rb:43:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/persistence.rb:39:in `save'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activerecord-3.0.3/lib/active_record/callbacks.rb:277:in `create_or_update'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/callbacks.rb:420:in `_run_save_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/mount.rb:214:in `store_attachment!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/mount.rb:323:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/store.rb:58:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/uploader/store.rb:59:in `block in store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:79:in `store!'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:228:in `store'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/bundler/gems/carrierwave-59a5c2d35809/lib/carrierwave/storage/fog.rb:294:in `directory'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/models/aws/directories.rb:24:in `get'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/requests/aws/get_bucket.rb:55:in `get_bucket'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/storage/aws.rb:339:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/fog-0.6.0/lib/fog/core/connection.rb:20:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:106:in `request'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:204:in `socket'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n/Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n\n-- C level backtrace information -------------------------------------------\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAbort trap\n</pre>\n Yeah, segmentation faults are always a bit shocking and unexpected.\n\nThis one is on a Socket#connect (which is pretty core to things working in general).\n\nAre you able to make other http requests (ie with Net::HTTP) from this machine?  How about using fog directly?  I just setup this same ruby/fog/excon versions on my machine and tried some basic requests and didn't have any luck reproducing, so any additional details would be great to help narrow it down.\n\nThanks!\nwes\n Ok, so I got a bit closer to the origin of the error. A gem I wrote for the app seems to be causing some issues. I suspect it to be something with the dependencies (among those em-http-request). By requiring the carrierwave gem after the other gem I got rid of the segmentation fault. \nI did, however, run into another issue :)\nI'm consistently getting `[WARN] fog: the specified s3 bucket name() is not a valid dns name, which will negatively impact performance.  For details see: http://docs.amazonwebservices.com/AmazonS3/latest/dev/BucketRestrictions.html`\n\nA google search indicated that other people have had similar issues with the eu-west-1 region. Can anybody confirm this issue? Perhaps even point towards a solution? :)\n\nThanks for all the help, it's really appreciated!\n If I had to guess your bucket name probably has an underscore in it.  Basically you can address buckets in amazon one of two ways, via subdomains or via path.  If you have something that is a valid subdomain it will use it (which is faster) and if you have something that is not a valid subdomain it will use the path method (which is slower).  You are evidently not following one of the rules of valid subdomains, you can see the whole list at that s3 url, but '_' is probably the most likely culprit.\n Ok, a couple of updates. In an attempt to try out the released gem, the segmentation fault returned - and unfortunately it stayed around after switching back to the master branch. I tried different things: upgrading to ruby1.9.2-p180, removing and reinstalling gemsets, and without knowing exactly what caused it, the segmentation fault is now gone again. \nI noticed that fog uses Nokogiri, which has caused segmentation faults for me previously. I doubt it's causing it though.\n\nRegarding the bucket name, I'm pretty sure it's valid: \"fsrglobal\" (I've tried others as well).\n\nWhen using fog directly I can create, read and upload to buckets.\n\n<pre>\n$ fog\n  Welcome to fog interactive!\n  :default provides AWS\n>>  directory = AWS.directories.create(:key => \"lotsofblondesinhere\")\n  <Fog::AWS::Storage::Directory\n    key=\"lotsofblondesinhere\",\n    creation_date=nil\n  >\n>> file = directory.files.create(:key => \"Gemfile\", :body => File.read(\"Gemfile\"))\n  <Fog::AWS::Storage::File\n    key=\"Gemfile\",\n    cache_control=nil,\n    content_disposition=nil,\n    content_encoding=nil,\n    content_length=894,\n    content_md5=nil,\n    content_type=nil,\n    etag=\"\\\"9e13a015edb029783cdd5a61bf8bf5c7\\\"\",\n    expires=nil,\n    last_modified=nil,\n    metadata={},\n    owner=nil,\n    storage_class=nil\n  >\n>> got_dir = AWS.directories.get(\"lotsofblondesinhere\")\n  <Fog::AWS::Storage::Directory\n    key=\"lotsofblondesinhere\",\n    creation_date=nil\n  >\n>> got_dir = AWS.directories.get(\"fsrglobal\")\n  [WARN] fog: followed redirect to fsrglobal.s3-external-3.amazonaws.com, connecting to the matching region will be more performant\n  <Fog::AWS::Storage::Directory\n    key=\"fsrglobal\",\n    creation_date=nil\n  >\n</pre>\n\n\nAs you can see, I can even get the eu-version bucket. I guess that means I just have my fog configuration wrong? \n\nCan anyone show an example of an eu-west-1 configuration with the access key hidden? \n\nIf there's something essential that I'm getting wrong, please let me know. If there is, I'll put together something to make sure it doesn't happen to other people.\n I took a break, looked at it with fresh eyes, and realized that my uploader wasn't set to :fog. Fog!\n\nI also found the source of the segmentation fault (at least on this machine) - the mysql gem.\n\nI've uploaded an example project demonstrating the issue:\nhttps://github.com/JonasNielsen/carrierwave-mysql-problem/tree/\nThe master branch is working using sqlite3\nThe two other branches (with mysql and mysql2) goes segmentation berserk.\n\nCan you reproduce it?\n I'm sorry this thread seems endless, but I just tried updating my entire system, and the issue is exactly the same. Updated: xcode, reinstall rvm with all gems, mysql.\n\nI've also tried these rubies:\nruby-1.8.7-p334\nruby-1.9.2-p0\n\nSystem:\nRails 3.0.3\nmysql 5.5.9\nruby 1.9.2p180 (2011-02-18 revision 30909) [x86_64-darwin10.6.0]\nrvm 1.2.8\nGems:\nmysql2 (0.2.6)\nfog (0.6.0)\ncarrierwave (0.5.2) (master)\nOpenSSL 1.0.0d 8 Feb 2011\n\nI'm kind of loosing my breath on this one. I'm sure it's something fishy (at least different) with my dev setup, but I have no clue how to move forward from here :-)\n I think so yeah. I backtracked the excon source code, indicating that it's an issue with OpenSSL::SSL::SSLSocket.\n@geemus, any help would be massively appreciated. \n Reading through this (and subsequently reading through the mysql2 source) didn't really give me any leads.  Also the reproduction case repository is gone now so I didn't get a chance to really look into that.  I guess it is possible that it would have to do with the openssl version as well (but this seems unlikely if it works without the presence of the mysql2 gem).  So, unfortunately I am also drawing blanks...\n Thanks for all the efforts, @geemus and @trevorturk.\nIs this the repository you was referring to? https://github.com/JonasNielsen/carrierwave-mysql-problem\n Yep, the /tree version of the url from above 404's for me.\n Looked over that a bit too, still nothing jumping out at me I'm afraid.\n I guess it's not my day :P\nCan you clone this? https://github.com/JonasNielsen/carrierwave-mysql-problem.git\nOtherwise, here's a zip of the app directory: http://ge.tt/5gkdgn3\n Oh, sorry I was unclear there.  After you gave the link I could get to the code just fine, I just was not able to find anything that seemed likely to be causing the problem.\n No problem :-)\nIf there's anything I can do to try and locate the bug, please let me know. Paperclip is just not this cool.\n I am having the exact same problem within a rake task to backup a file.\n\nError:\n\n```\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:187: [BUG] Segmentation fault\nruby 1.9.2p180 (2011-02-18 revision 30909) [x86_64-darwin10.7.1]\n\n-- control frame ----------\nc:0035 p:---- s:0148 b:0148 l:000147 d:000147 CFUNC  :connect\nc:0034 p:0268 s:0145 b:0145 l:000144 d:000144 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:187\nc:0033 p:0051 s:0139 b:0136 l:000135 d:000135 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:204\nc:0032 p:0484 s:0133 b:0133 l:000132 d:000132 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:106\nc:0031 p:0100 s:0119 b:0119 l:0006d0 d:0006d0 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/core/connection.rb:20\nc:0030 p:0106 s:0111 b:0111 l:000110 d:000110 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/aws.rb:323\nc:0029 p:0104 s:0102 b:0102 l:000101 d:000101 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/requests/aws/get_bucket.rb:55\nc:0028 p:0055 s:0097 b:0097 l:000096 d:000096 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/models/aws/directories.rb:24\nc:0027 p:0078 s:0088 b:0088 l:001938 d:000087 BLOCK  /Users/ruddick/Kf/lbd/lib/tasks/s3_upload.rake:5\nc:0026 p:---- s:0083 b:0083 l:000082 d:000082 FINISH\nc:0025 p:---- s:0081 b:0081 l:000080 d:000080 CFUNC  :call\nc:0024 p:0043 s:0076 b:0076 l:000067 d:000075 BLOCK  /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:636\nc:0023 p:---- s:0073 b:0073 l:000072 d:000072 FINISH\nc:0022 p:---- s:0071 b:0071 l:000070 d:000070 CFUNC  :each\nc:0021 p:0171 s:0068 b:0068 l:000067 d:000067 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:631\nc:0020 p:0110 s:0064 b:0064 l:000058 d:000063 BLOCK  /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:597\nc:0019 p:0019 s:0062 b:0062 l:000061 d:000061 METHOD /Users/ruddick/.rvm/rubies/ruby-1.9.2-p180/lib/ruby/1.9.1/monitor.rb:201\nc:0018 p:0033 s:0059 b:0059 l:000058 d:000058 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:590\nc:0017 p:0048 s:0053 b:0053 l:000052 d:000052 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:583\nc:0016 p:0045 s:0048 b:0048 l:000047 d:000047 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2051\nc:0015 p:0012 s:0041 b:0041 l:000026 d:000040 BLOCK  /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2029\nc:0014 p:---- s:0038 b:0038 l:000037 d:000037 FINISH\nc:0013 p:---- s:0036 b:0036 l:000035 d:000035 CFUNC  :each\nc:0012 p:0069 s:0033 b:0033 l:000026 d:000032 BLOCK  /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2029\nc:0011 p:0009 s:0031 b:0031 l:000030 d:000030 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2068\nc:0010 p:0011 s:0027 b:0027 l:000026 d:000026 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2023\nc:0009 p:0029 s:0024 b:0024 l:000017 d:000023 BLOCK  /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2001\nc:0008 p:0009 s:0022 b:0022 l:000021 d:000021 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2068\nc:0007 p:0011 s:0018 b:0018 l:000017 d:000017 METHOD /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:1998\nc:0006 p:0036 s:0015 b:0015 l:000014 d:000014 TOP    /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/bin/rake:31\nc:0005 p:---- s:0013 b:0013 l:000012 d:000012 FINISH\nc:0004 p:---- s:0011 b:0011 l:000010 d:000010 CFUNC  :load\nc:0003 p:0127 s:0007 b:0007 l:0014e8 d:000610 EVAL   /Users/ruddick/.rvm/gems/ruby-1.9.2-p180/bin/rake:19\nc:0002 p:---- s:0004 b:0004 l:000003 d:000003 FINISH\nc:0001 p:0000 s:0002 b:0002 l:0014e8 d:0014e8 TOP   \n---------------------------\n-- Ruby level backtrace information ----------------------------------------\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/bin/rake:19:in `<main>'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/bin/rake:19:in `load'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/bin/rake:31:in `<top (required)>'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:1998:in `run'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2001:in `block in run'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2029:in `block in top_level'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2029:in `each'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2029:in `block (2 levels) in top_level'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'\n/Users/ruddick/.rvm/rubies/ruby-1.9.2-p180/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:597:in `block in invoke_with_call_chain'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:631:in `execute'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:631:in `each'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:636:in `block in execute'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/rake-0.8.7/lib/rake.rb:636:in `call'\n/Users/ruddick/Kf/lbd/lib/tasks/s3_upload.rake:5:in `block in <top (required)>'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/models/aws/directories.rb:24:in `get'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/requests/aws/get_bucket.rb:55:in `get_bucket'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/storage/aws.rb:323:in `request'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/fog-0.7.0/lib/fog/core/connection.rb:20:in `request'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:106:in `request'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:204:in `socket'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n/Users/ruddick/.rvm/gems/ruby-1.9.2-p180/gems/excon-0.5.6/lib/excon/connection.rb:187:in `connect'\n\n-- C level backtrace information -------------------------------------------\n\n[NOTE]\nYou may have encountered a bug in the Ruby interpreter or extension libraries.\nBug reports are welcome.\nFor details: http://www.ruby-lang.org/bugreport.html\n\nAbort trap\n```\n\nMy rake task is pretty simple:\n    desc \"Upload to S3 test\"\n    task :s3_upload => :environment do\n      name = \"test.txt\"\n      aws_connection = Fog::Storage.new(:provider => 'AWS', :aws_access_key_id => ENV['aws_access_key_id'], :aws_secret_access_key => ENV['aws_secret_access_key'])\n      bucket = aws_connection.directories.get('test-kf')\n      bucket.files.create(:key => name, :body => File.open(\"tmp/#{name}\"))\n      system \"rm tmp/#{name}\"\n    end\n\nUsing: excon (0.5.6) and fog (0.7.0).\n\n@JonasNielsen did you ever figure it out?\n An update: putting the fog gem before the pg gem in the Gemfile makes it work.\n @mrjogo, nice!\nTo be explicit, this gemfile works:\n\n<pre>\ngem 'fog'\ngem 'mysql2'\ngem 'carrierwave', :git => \"https://github.com/jnicklas/carrierwave.git\", :branch => \"master\"\n</pre>\n Good point, thanks!\n Same problem using mysql2 gem version 0.2.7.\n\nWorked as @JonasNielsen mentions. Adding the \"fog\" gem before the \"mysql2\" gem seems to do the work.\n Can't believe the order of gems listed in Gemfile can solve this! Thanks for your great work guys!\n I had the same error, but the gem load order wasn't the issue. I was on ruby head (currently 193 something). Switching to 192 fixed it\n  Hi, I see that you accepted a pull to remove temp files, but why the temp folders are kept? The ext3 OS limit is 32k folders, when you reach that bad things happen (files can't be uploaded).\n\nThe workaround is to set a cron to delete the folders every month/day/hour, but I think that after a file is uploaded there is no need to keep its folder (as there isn't for the temp file itself)\n For removing temp folder, I choosed to remove the `tmp` folder and all your subdirectories. I am not sure if this is the best way or practice for doing this, but it is working for me.\n\nAdd a callback to `after_destroy :remove_tmp_directory` in your desired model.\n\nand \n\n```\nprivate\n  def remove_tmp_directory\n    path_to_be_deleted = \"#{Rails.root}/public/uploads/tmp\"\n    FileUtils.remove_dir(path_to_be_deleted, :force => true)\n  end\n```\n  Its a problem with the rackspace implementation in fog.  It would pass implicit content-type but not explicit:\nhttps://github.com/geemus/fog/commit/f6ccfee60cfefcab67d659d27fa419962b856cce\n That said, I'm also getting an error on the Local store, it says it is just plain text instead of jpeg when running tests\n Alright, local fix:\nhttps://github.com/jnicklas/carrierwave/commit/4251250c5295deb24817f698600ab29d7df0e7ae\nSo this and the region ticket should be closable with the next fog release.  Probably not today, but should be able to get it out early next week, fwiw.\n  Upon yet more scrutiny I think it is a granularity problem.  Rackspace does stuff at the directory level, rather than file.  And the tests were trying to reuse the same directory with public and private files (and that just doesn't work).  So instead I'm trying to get it going with separate directories created for public/private.  Should have a patch soon.\n [fog] fix rackspace public test\n\nclosed by 4174184c2bcc886930e704e2c8761caf8c587cdf\n  Steps that illustrate the problem:\n\n```\nclass Document < AR::Base\n  mount_uploader :file, FileUploader, :mount_on => :name\n  validates :file, :presence => true\nend\n\nf = File.open('\\path\\to\\file')\nd = Document.new(:file => f)\nd.save # true, all ok 'till now\n\n    # HERE'S THE PROBLEM ->\nresult = d.update_attributes(:remove_file => true) # should fail, I validate presence\n\np result # true, oh noes !!!\np d.file # nil, oh noes !!!\n# it was saved even tough I validate presence !!!\n```\n I think if you change :mount_on then you need to validate_presence_of :name, or maybe even both.\n Sorry: never mind me, Trevor is right.\n Was this closed? Fixed? Invalid?\nIt appears to be in the closed tab, not in open, and I can't tell the resolution to it ..\n  Im using Rails 3.0.3. In my gem file I have:\n\n<pre><code>\ngem 'carrierwave', :git => 'http://github.com/jnicklas/carrierwave.git'\ngem 'mini_magick', :git => 'http://github.com/probablycorey/mini_magick.git'\ngem 'fog'\n</code></pre>\n\n\nI keep getting \"Attachment failed to be processed\", when I upload an image. Here is my uploader class:\n\n```\n# encoding: utf-8\n\nclass PhotoUploader < CarrierWave::Uploader::Base\n    # Include RMagick or ImageScience support:\n    # include CarrierWave::RMagick\n    # include CarrierWave::ImageScience\n    include CarrierWave::MiniMagick\n\n   # Choose what kind of storage to use for this uploader:\n   storage :fog\n\n   # Override the directory where uploaded files will be stored.\n   # This is a sensible default for uploaders that are meant to be mounted:\n   def store_dir\n        \"uploads/users/#{model.user.id}/#{model.class.to_s.underscore}s/#{model.id}\"\n   end\n\n   # Provide a default URL as a default if there hasn't been a file uploaded:\n   # def default_url\n   #   \"/images/fallback/\" + [version_name, \"default.png\"].compact.join('_')\n   # end\n\n   # Create different versions of your uploaded files:\n   version :small do\n          process :resize_to_fill => [53,53]\n   end\n   version :medium do\n          process :resize_to_fill => [106,106]\n   end\n   version :large do\n          process :resize_to_fill => [212,212]\n   end\n\n   # Add a white list of extensions which are allowed to be uploaded.\n   # For images you might use something like this:\n   def extension_white_list\n          %w(jpg jpeg gif png)\n   end\n\n   # Override the filename of the uploaded files:\n   # def filename\n   #   \"something.jpg\" if original_filename\n   # end\nend\n```\n\nIf I remove the code block below, the file is uploaded without any problems.\n\n```\nversion :small do\n  process :resize_to_fill => [53,53]\nend\nversion :medium do\n  process :resize_to_fill => [106,106]\nend\nversion :large do\n  process :resize_to_fill => [212,212]\nend\n```\n\nWhat is going on?\n Trevorturk, here is the application. Its a bare bone Rails app. With Rails 3.0.4 a simple model called product with 2 columns: title and attachment. I am running on MacOSX Snow Leopard. With the following gems: pg, carrierwave (0.5.2) , mini_magick (3.2) from http://github.com/probablycorey/mini_magick.git (at master).\n\nhttps://github.com/krzkrzkrz/carrierwave\n\nAfter running 'rails s'. In http://localhost:3000/products/new, if you select a file and submit, the form renders with:\n\n```\n1 error prohibited this product from being saved:\n    * Attachment failed to be processed\n```\n\nIf I remove the versions on my uploader (http://github.com/krzkrzkrz/carrierwave/blob/master/app/uploaders/product_uploader.rb), the file uploads without any problems:\n\n```\nversion :small do\n  process :resize_to_fill => [53,53]\nend\nversion :medium do\n  process :resize_to_fill => [106,106]\nend\nversion :large do\n  process :resize_to_fill => [212,212]\nend\n```\n Ok had to install imagemagic on the system first and then install the gems:\n\n```\nbrew instal imagemagick\nsudo gem install rmagick\nsudo gem install mini_magick\n```\n\nWorks now!\n Yeap, added at: https://github.com/jnicklas/carrierwave/wiki/Processing-Notes\n  I'm getting below error when setting up my initializer\n\nRails 3.0.3\ncarrierwave (0.5.2)\nruby 1.9.2p136\n\n<pre>\n$ rails s\n=> Booting WEBrick\n=> Rails 3.0.3 application starting in development on http://0.0.0.0:3000\n=> Call with -d to detach\n=> Ctrl-C to shutdown server\nExiting\n/Users/Jonas/web_projects/FSRGlobal/config/initializers/carrier_wave.rb:2:in `block in <top (required)>': undefined method `fog_credentials=' for CarrierWave::Uploader::Base:Class (NoMethodError)\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave/uploader/configuration.rb:133:in `configure'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@fsrglobal/gems/carrierwave-0.5.2/lib/carrierwave.rb:14:in `configure'\n    from /Users/Jonas/web_projects/FSRGlobal/config/initializers/carrier_wave.rb:1:in `<top (required)>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:235:in `load'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:235:in `block in load'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:225:in `block in load_dependency'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:596:in `new_constants_in'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:225:in `load_dependency'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:235:in `load'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/engine.rb:201:in `block (2 levels) in <class:Engine>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/engine.rb:200:in `each'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/engine.rb:200:in `block in <class:Engine>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/initializable.rb:25:in `instance_exec'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/initializable.rb:25:in `run'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/initializable.rb:50:in `block in run_initializers'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/initializable.rb:49:in `each'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/initializable.rb:49:in `run_initializers'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:134:in `initialize!'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/application.rb:77:in `method_missing'\n    from /Users/Jonas/web_projects/FSRGlobal/config/environment.rb:5:in `<top (required)>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:239:in `require'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:239:in `block in require'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:225:in `block in load_dependency'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:596:in `new_constants_in'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:225:in `load_dependency'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/activesupport-3.0.3/lib/active_support/dependencies.rb:239:in `require'\n    from /Users/Jonas/web_projects/FSRGlobal/config.ru:3:in `block in <main>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/builder.rb:46:in `instance_eval'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/builder.rb:46:in `initialize'\n    from /Users/Jonas/web_projects/FSRGlobal/config.ru:1:in `new'\n    from /Users/Jonas/web_projects/FSRGlobal/config.ru:1:in `<main>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/builder.rb:35:in `eval'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/builder.rb:35:in `parse_file'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/server.rb:162:in `app'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/server.rb:248:in `wrapped_app'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/rack-1.2.1/lib/rack/server.rb:213:in `start'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/commands/server.rb:65:in `start'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/commands.rb:30:in `block in <top (required)>'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/commands.rb:27:in `tap'\n    from /Users/Jonas/.rvm/gems/ruby-1.9.2-p136@global/gems/railties-3.0.3/lib/rails/commands.rb:27:in `<top (required)>'\n    from script/rails:6:in `require'\n    from script/rails:6:in `<main>'\n\n</pre>\n\n\ninitializers/carrier_wave.rb\n\n<pre>\nCarrierWave.configure do |config|\n  config.fog_credentials = {\n    :provider           => 'AWS',\n    :aws_access_key_id => '[HIDDEN]',\n    :aws_secret_access_key  => '[hidden]',\n    :region                 => 'eu-west-1'\n  }\n  config.fog_directory = '[hidden]'\nend \n</pre>\n I missed that, thanks!\n hey i am facing the same problem how did you resolve this problem..\n  Hi\nI wrote about it at the forum but i guess problem was not explained well or not understood at all.\nThe problem appears when you try to use url with redirects. So for example when you try to take a picture from facebook profile.\nThe problem exactly in this method \nhttps://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/uploader/download.rb\n\ndef file\n  if @file.blank?\n    @file = Kernel.open(@uri.to_s) # in this method\n    @file = @file.is_a?(String) ? StringIO.new(@file) : @file\n  end\n  @file\nend\n\nthat is used in detecting image size\nHere is stack trace\n\n/home/bob/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/open-uri.rb:216:in `open_loop'\n/home/bob/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/open-uri.rb:146:in`open_uri'\n/home/bob/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/open-uri.rb:671:in `open'\n/home/bob/.rvm/rubies/ruby-1.9.2-p0/lib/ruby/1.9.1/open-uri.rb:33:in`open'\ncarrierwave (0.5.2) lib/carrierwave/uploader/download.rb:40:in `file'\ncarrierwave (0.5.2) lib/carrierwave/uploader/download.rb:27:in`respond_to?'\ncarrierwave (0.5.2) lib/carrierwave/sanitized_file.rb:86:in `size'\ncarrierwave (0.5.2) lib/carrierwave/sanitized_file.rb:127:in`empty?'\ncarrierwave (0.5.2) lib/carrierwave/uploader/cache.rb:92:in `cache!'\ncarrierwave (0.5.2) lib/carrierwave/uploader/download.rb:62:in`download!'\ncarrierwave (0.5.2) lib/carrierwave/mount.rb:314:in `remote_url='\ncarrierwave (0.5.2) lib/carrierwave/mount.rb:194:in`remote_image_url='\n\nSo facebook use redirects from https to http path for a picture and open-uri lib has method .redirectable? wich restricts that kind of redirection.\nThat gives us this error\nredirection forbidden: uri1-> uri2\n yep code inserted badly\nThis is rails stack\nhttps://gist.github.com/853219\nI guess not to use open-uri would be ok. Maybe something else insted.\n\"Failing that, I'd suggest trying to get the redirects out of the URL before giving it to Carrierwave\".\nYou suggest fetch url and then use that url ? \nTo reproduce this bug try to do this\nUser.create!(:remote_image_url =\"https://graph.facebook.com/your_profile_name/picture\") but this time it will fail with 400 bad request error but still it will fail...\n ah ok will try this out\n In case it's not obvious to others having this problem, you an just add an s? to the regex in a monkey patch to get this working:\n\nmodule OpenURI\n  def self.redirectable?(uri1,uri2)\n    uri1.scheme.downcase == uri2.scheme.downcase ||\n    (/\\A(?:https?|ftp)\\z/i =~ uri1.scheme && /\\A(?:https?|ftp)\\z/i =~ uri2.scheme)\n  end \nend   \n  [fog] fix content_type handling\n\nClosed by 430edbdd6e2c7bae2243dda614afd8871837e44f\nClosed by 430edbdd6e2c7bae2243dda614afd8871837e44f\n  [fog] fix content_type handling\n\nClosed by 430edbdd6e2c7bae2243dda614afd8871837e44f\nClosed by 430edbdd6e2c7bae2243dda614afd8871837e44f\n  Hi,\n\nworking with the 0.4-stable branch in Rails 2.3.9 and ree-1.8.7 (production environment),  I noticed that depending on how ruby sorted the mappings hash, the :id_partition was correctly interpolated or not. If the :id interpolation comes before the :id_partition interpolation, whooops! :) We should ensure this doesn't happen.\n\nI've replaced the mappings hash by an array containing arrays with the symbol and its interpolation and implemented a very simple example to test this case.\n\nHope it helps,\n\nMari.\n  Sort of.  Technically it would have just worked, but you wouldn't have been able to specify with just the 'region' key.  I just added that though:\nhttps://github.com/geemus/fog/commit/1397c2d613605db3fb549bb9e61110e181a8c689\nNot sure how quick I'll release though.\n  I added a similar config option to the S3 storage, but I'm unsure if this is how this should be handled in Fog, so I figured geemus or someone might know better.\n\nAlso, if someone can come up with some way of testing this that'd be excellent ;)\n Just depends what you want to test. The outputted url will display the expiry as a query param I believe, so you could check that this was ok.  And if you wanted to check functionality I guess you could set it to 0 or something small and then try to request, expecting it would fail.  That said, it is a pretty simple thing, so maybe additional testing isn't needed.  Should probably add a note to the docs about the option though, just in case.\n  Hi!\n\nThe \"root\" variable was nil when accessed from CarrierWave::Uploader::Url::url (in ruby ruby 1.8.7 ). So i had to write the full \"CarrierWave.root\" for it to work (on my Sinatra project).\n\nI tested my patch on ruby 1.9.2 and all the tests are still passing. But on ruby 1.8.7 i get this error when running the tests: https://gist.github.com/848390 . So i can't seem to test on my side, but feel free tu pull if on your side the tests are still passing.\nLet me know if there's something wrong with my fix.\n\nThanks for CarrierWave :)\n\nJulien\n ## Hi, I think I had a very similar problem but I went with the way to define my own root method in the model and it started working. By the way I was using padrino framework and I didn't notice any problems when I used Rails.\n\nThanks, Ivan Povalyukhin\n Ah well, seems like it's working now without my \"fix\".\nPlease ignore this pull request.\n\nI guess i needed more sleep ;)\n Just wanted to point out too that the fix is actually broken. There's a point to calling root on the instance instead of from CarrierWave.root, this is so that in theory different uploaders can have different roots. This is consistent with how all other settings are configurable on a per-uploader basis.\n  def url\n  if file.respond_to?(:url) and not file.url.blank?\n    file.url\n  elsif current_path\n    File.expand_path(current_path).gsub(File.expand_path(root), '')\n  end\nend\n\nFile.expand_path(root) raises an error since root is nil, if I don't define the root method in my model.\n## I was using the padrino framework + sequel. I suspect that I need to supply some additional configuration hash, but it was not obvious for me why it didn't work by default. If this is my configuration issue, probably, it worth mentioning in the docs the need for some additional config. options.\n\nThanks, Ivan Povalyukhin\n  This tries to solve the long standing issue in Carrierwave that updating a column does not remove the previous file. I have added the code just for ActiveRecord, which relies on ActiveModel::Dirty. Support for other ORMs could be added on demand and then refactored to a common place.\n I kind of dislike the fact that this is ActiveRecord only. It seems like we want to push as little logic as possible into the ORM adapters, if we need to recreated this for every ORM out there, we'll end up producing a lot of unnecessary duplicate code.\n I can refactor the code above into an API contract and move it to the mounter, but I still believe that tracking dirty attributes is an ORM responsibility. I don't think Carrierwave should be concerned about it.\n There we go, pushed a new commit. ORMs just need to implement the read_previous_uploader method and everything should work like a charm.\n This is pretty awesome! I like the read_previous_uploader thing. I suppose Didier and I could add that for Mongoid. \n\nI think we'd still need to test for:\n- uploaders with versions\n- uploaders with dynamic store paths (like this kind of thing: https://github.com/did/carrierwave/commit/b838220#L6R242)\n\nI can't think of anything else at the moment. \n\nJonas, what do you think?\n BTW - I think this would also impact a bunch of stuff listed in the wiki due to \"{column}_will_change!\" being added. \n It's a shame we don't have better integration tests in CarrierWave. It's hard to know what impact this will have without people actually trying it. The pull request looks really good, good job, Jos\u00e9! One tiny nit pick would be that this seems to ignore the :mount_on option which can be set for mount_uploader, though I'm not sure if anyone actually uses that. Still might be worth investigating.\n I'm generally in favour of merging, if you agree, Trevor?\n Yeah, I really like this technique. \n\nSo, I guess there are 3 outstanding issues before merging. \n- tests for uploaders with versions\n- tests for uploaders with dynamic store paths based on model attributes\n- tests for respecting the mount_on option\n\nThen, I could work with Didier on:\n- add support for mongoid\n\nJos\u00e9, let me know if you have time for any of that, or if you'd prefer for me to work on it. \n\nAs for better integration tests, what do you guys think about having adding a dummy rails app with enginex? I thought that might be a smart way to have \"full stack\" tests for complicated stuff like this. I don't know if it's worth the effort or not, though. \n Trevor, please don't wait for me. :)\n\nIn general something like Enginex is worth the effort. The nested attributes bug we discussed yesterday would be really easy to reproduce in a structure like Enginex. The only thing a bit annoying is that you need to setup different load paths for each ORM.\n Continuing the OT ;) How about a Sinatra app for integration tests? Rails might be a bit overkill, imo. \n I'll make some time ASAP, but don't wait for me either! :) I'm doing a lot of traveling lately since my time living in London is ending soon. \n\nOT: I think Enginex with Rails could have Active Record and Mongoid in one app. Then maybe a Sinatra app for DataMapper? I think having Rails would be smart, since it's probably widely used. I don't know, though -- I shouldn't talk so much about this without having coded anything :) If/when I do that, I'll put it in a branch and we can discuss then. \n Even if the path is dynamic, isn't it stored in the database? Wouldn't it be just a question of storing this path in a variable like @initial_path when the uploader is loaded?\n Just pushed a commit to my fork with a possible solution to the problem. About the ability to turn off the feature, I would suggest to do it by passing an option when mounting the uploader. Then we just don't add the callbacks for that specific uploader.\n Awesome, thanks Trevor for your work!\n OK, so I made a lot of progress on this a while ago, but then left it for dead in a branch. If anyone cares to pick it up again and flesh out all these tests etc, please feel free!\n\nhttps://gist.github.com/981743\n\nIn the mean time, I'm closing this pull request. Sorry I've let you all down ;)\n Hey @trevorturk, I am interested in finishing this. What needs to be done?\n If you see the gist I posted, I think the functionality should be\nworking, and I made descriptive test stubs. So, you could review those\ntest stubs and fill them in where you think it makes sense. That would\nbe it, unless you run into problems along the way. If so, let me know\nand I can help out.\n\nOn Sunday, May 22, 2011, josevalim\nreply@reply.github.com\nwrote:\n\n> Hey @trevorturk, I am interested in finishing this. What needs to be done?\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/223#issuecomment-1217004\n BTW the tests should be very easy to run now, but if you have trouble with Ruby Inline, see this pull request: https://github.com/seattlerb/rubyinline/pull/2 -- I just made that change to my own local gems to work around it. \n\nIt may be smart to change the gem deps to use a fork with this fix -- I'm not sure if/when they'll ever pull that in. It's been a long running problem. \n Shit, did I merge this? :(\n Nah, I haven't. It is a github bug because I have changed the original branch. :P I almost had a heart attack. ;)\n Trevor, do you happen to have your work still in a branch? The patch no longer applies, so I need to know the last commit in your branch so I can rollback and rebase.\n lol Jonas ;)\n\nJose - sorry, I should have left the old branch there. I think I have\nthe branch locally but won't have access to push it back up until\ntomorrow. I'll post a comment when I do, otherwise you'd have to\nfigure out what to do with that diff - probably not fun.\n\nOn Sunday, May 22, 2011, josevalim\nreply@reply.github.com\nwrote:\n\n> Trevor, do you happen to have your work still in a branch? The patch no longer applies, so I need to know the last commit in your branch so I can rollback and rebase.\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/jnicklas/carrierwave/pull/223#issuecomment-1217329\n See: https://github.com/jnicklas/carrierwave/pull/326\n  First, thanks for this excellent gem, it just works great and it is very easy to set up and use.\n\nThe issue is that everything works perfect until I try to use several \"versions\" of the uploaded file when I am using \"s3\" as the kind of storage, it raise a \"Permission denied\" error ( just tested so far in Windows ).\n\nConfiguration :\n- Windows XP SP3\n- ImageMagick-6.6.7-Q16\n\nGems :\n\n```\ngem 'rails', '3.0.4'\ngem 'carrierwave', :git => 'git://github.com/jnicklas/carrierwave.git'\ngem 'mini_magick'\ngem 'fog', :git => 'git://github.com/geemus/fog.git'\n```\n\n\"avatar_uploader.rb\" file :\n\n```\nstorage :s3\nprocess :resize_to_fit => [720, 720]\nversion :main do\n  process :resize_to_limit => [130, 130]\nend\nversion :thumb do\n  process :resize_to_limit => [50, 50]\nend\n```\n\nThanks for any help about :)\n PS : It does this \"process :resize_to_fit => [720, 720]\" just fine and uploads the file to the Amazon S3 server, so the issue seems to be when it tries to generate the other \"versions\".\n Hmm... this really should be working. Have you tried the \"s3_access_policy\" config option? It's documented in the s3 module. You should also consider using the released gem version of carrierwave and fog, just in case. \n\nCan you give this another try with the s3_access_policy option? Also, if you could make a sample app for me to test, I can try to reproduce. \n Hello Trevor, thanks for your answer, as you suggested, I added the :\n    s3_access_policy = :public_read\nsentence everywhere gradually but sadly it did not work. I did not added it before because it is set to \":public_read\" as default according to the documentation.\n\nNow my \"config/initializers/carrierwave.rb\" file is :\n\n```\nCarrierWave.configure do |config|\n  config.permissions = 0777\n  config.s3_access_policy = :public_read\n  config.s3_access_key_id = 's3_access_key_id'\n  config.s3_secret_access_key = 's3_secret_access_key'\n  config.s3_bucket = 'my-bucket-for-test-carrierwave'\nend\n```\n\nAnd my \"avatar_uploader.rb\" file is :\n\n```\ns3_access_policy :public_read\nstorage :s3\nprocess :resize_to_fit => [720, 720]\nversion :main do\n  s3_access_policy :public_read\n  process :resize_to_limit => [130, 130]\nend\nversion :thumb do\n  s3_access_policy :public_read\n  process :resize_to_limit => [50, 50]\nend\n```\n\nRegarding to the \"gem version\", I worked with it ( also for \"fog\" ) yesterday, I changed today to the \"git\" version due to this issue with the \"Permission Denied\", I thought that maybe was an issue with the \"gem version\".\n\nThe full error message is :\n\n```\nPermission denied - E:/RubyApps/rails3/mongodb/public/uploads/tmp/20110220-1814-7208-1559/openid.png\n```\n\nIt refers to the file stored in the \"tmp\" folder, maybe the process to deal with the versions try to use this file when it is being uploaded to the Amazon S3 server.\n\nThanks for your help\n Can you post a full backtrace? It seems like maybe the original file can't be read on your filesystem. I've seen another report, I think, about a problem with Windows. Maybe something is going on here with the permissions...? A full backtrace might be helpful. \n Sure, here is the \"Full Trace\" :\n\n```\nErrno::EACCES in ClientsController#create\n\nPermission denied - E:/RubyApps/rails3/mongodb/public/uploads/tmp/20110220-2033-7396-5851/sshot-3.png\n\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:1309:in `unlink'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:1309:in `block in remove_file'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:1317:in `platform_support'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:1308:in `remove_file'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:776:in `remove_file'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:559:in `block in rm'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:558:in `each'\nC:/Ruby192/lib/ruby/1.9.1/fileutils.rb:558:in `rm'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/sanitized_file.rb:210:in `delete'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/uploader/store.rb:60:in `block in store!'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/uploader/store.rb:58:in `store!'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/mount.rb:323:in `store!'\nC:/Ruby192/lib/ruby/gems/1.9.1/bundler/gems/carrierwave-5fd2c171ffc4/lib/carrierwave/mount.rb:214:in `store_avatar!'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:420:in `_run_save_callbacks'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:93:in `run_callbacks'\nmongoid (2.0.0.rc.7) lib/mongoid/persistence/insert.rb:28:in `persist'\nmongoid (2.0.0.rc.7) lib/mongoid/persistence.rb:45:in `insert'\nmongoid (2.0.0.rc.7) lib/mongoid/persistence.rb:146:in `upsert'\napp/controllers/clients_controller.rb:58:in `block in create'\nactionpack (3.0.4) lib/action_controller/metal/mime_responds.rb:264:in `call'\nactionpack (3.0.4) lib/action_controller/metal/mime_responds.rb:264:in `retrieve_response_from_mimes'\nactionpack (3.0.4) lib/action_controller/metal/mime_responds.rb:191:in `respond_to'\napp/controllers/clients_controller.rb:57:in `create'\nactionpack (3.0.4) lib/action_controller/metal/implicit_render.rb:4:in `send_action'\nactionpack (3.0.4) lib/abstract_controller/base.rb:150:in `process_action'\nactionpack (3.0.4) lib/action_controller/metal/rendering.rb:11:in `process_action'\nactionpack (3.0.4) lib/abstract_controller/callbacks.rb:18:in `block in process_action'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:440:in `_run__35015986__process_action__255454383__callbacks'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:409:in `_run_process_action_callbacks'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:93:in `run_callbacks'\nactionpack (3.0.4) lib/abstract_controller/callbacks.rb:17:in `process_action'\nactionpack (3.0.4) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'\nactivesupport (3.0.4) lib/active_support/notifications.rb:52:in `block in instrument'\nactivesupport (3.0.4) lib/active_support/notifications/instrumenter.rb:21:in `instrument'\nactivesupport (3.0.4) lib/active_support/notifications.rb:52:in `instrument'\nactionpack (3.0.4) lib/action_controller/metal/instrumentation.rb:29:in `process_action'\nactionpack (3.0.4) lib/action_controller/metal/rescue.rb:17:in `process_action'\nactionpack (3.0.4) lib/abstract_controller/base.rb:119:in `process'\nactionpack (3.0.4) lib/abstract_controller/rendering.rb:41:in `process'\nactionpack (3.0.4) lib/action_controller/metal.rb:138:in `dispatch'\nactionpack (3.0.4) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'\nactionpack (3.0.4) lib/action_controller/metal.rb:178:in `block in action'\nactionpack (3.0.4) lib/action_dispatch/routing/route_set.rb:62:in `call'\nactionpack (3.0.4) lib/action_dispatch/routing/route_set.rb:62:in `dispatch'\nactionpack (3.0.4) lib/action_dispatch/routing/route_set.rb:27:in `call'\nrack-mount (0.6.13) lib/rack/mount/route_set.rb:148:in `block in call'\nrack-mount (0.6.13) lib/rack/mount/code_generation.rb:93:in `block in recognize'\nrack-mount (0.6.13) lib/rack/mount/code_generation.rb:82:in `optimized_each'\nrack-mount (0.6.13) lib/rack/mount/code_generation.rb:92:in `recognize'\nrack-mount (0.6.13) lib/rack/mount/route_set.rb:139:in `call'\nactionpack (3.0.4) lib/action_dispatch/routing/route_set.rb:492:in `call'\nhaml (3.0.25) lib/sass/plugin/rack.rb:41:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/head.rb:14:in `call'\nrack (1.2.1) lib/rack/methodoverride.rb:24:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/params_parser.rb:21:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/flash.rb:182:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/session/abstract_store.rb:149:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/cookies.rb:302:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'\nactivesupport (3.0.4) lib/active_support/callbacks.rb:415:in `_run_call_callbacks'\nactionpack (3.0.4) lib/action_dispatch/middleware/callbacks.rb:44:in `call'\nrack (1.2.1) lib/rack/sendfile.rb:107:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/show_exceptions.rb:47:in `call'\nrailties (3.0.4) lib/rails/rack/logger.rb:13:in `call'\nrack (1.2.1) lib/rack/runtime.rb:17:in `call'\nactivesupport (3.0.4) lib/active_support/cache/strategy/local_cache.rb:72:in `call'\nrack (1.2.1) lib/rack/lock.rb:11:in `block in call'\n<internal:prelude>:10:in `synchronize'\nrack (1.2.1) lib/rack/lock.rb:11:in `call'\nactionpack (3.0.4) lib/action_dispatch/middleware/static.rb:30:in `call'\nrailties (3.0.4) lib/rails/application.rb:168:in `call'\nrailties (3.0.4) lib/rails/application.rb:77:in `method_missing'\nrailties (3.0.4) lib/rails/rack/log_tailer.rb:14:in `call'\nrack (1.2.1) lib/rack/content_length.rb:13:in `call'\nrack (1.2.1) lib/rack/handler/webrick.rb:52:in `service'\nC:/Ruby192/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'\nC:/Ruby192/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'\nC:/Ruby192/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread'\n```\n Yeah, so here you can see that \"fileutils\" is causing the error, which isn't related to with s3. I think maybe it's just a simple permissions issue where you're allowed to write files but not to delete them...? I'm not sure how to troubleshoot that with Windows, honestly. \n\nI see that we have the option to disable the deleting of the tmp file, though, which might help you in this situation. The \"delete_tmp_file_after_storage\" option can be set to false within CarrierWave.configure do |config| etc...\n\nGive that a shot and see if it helps. I guess having tmp files laying around wouldn't hurt too bad. \n Perfect ! it is working like a charm :) thank you very much for your help Trevor, the :\n    config.delete_tmp_file_after_storage = false\nWorked for me on windows and solved temporally this issue, and as you said, \"having tmp files laying around wouldn't hurt too bad\" :)\n That's great. If you have the time, please do consider trying to get to the bottom of the problem. I think it may be affecting more than just you -- perhaps something to do with Windows. \n I gave a look to this and it seems that the \"delete\" method is called too soon, I mean, it seems that the file is being uploaded when the \"FileUtils.rm\" sentence is called. After the process to upload the files to the Amazon S3 server finish, I am able to use \"FileUtils.rm\" without problems. Is it any way to call the method asynchronously ? Or be called after be sure that the file is free to be removed ? Any ideas ?\n\nThanks\n Here ( https://github.com/glendel/mongodb ) you can find the sources for the app where I am testing \"CarrierWave\". Now I am trying to make it work with delayed_job ( https://github.com/collectiveidea/delayed_job ) in order to upload the files asynchronously. Any idea ?\n\nThanks\n I don't think it's being called at the wrong time, but I'd consider a pull request if you think that there's a better way to do it. \n\nAs for uploading files asynchronously, that's a question for the Google Group. \n I've got the same issue and I've debugged it. I think this issue should be re-opened.\n\nIf  storage :file #all is working fine\n\nwhen \n   storage :fog\n\nthere are no error in:\n\n new_file = storage.store!(@file)\n @file.delete if (delete_tmp_file_after_storage && ! move_to_store)\n\n new_file = storage.store!(@file) is still holding a handle on the tmp file and hence the delete is failing.\n\nIf you try to delete manually, it will also fail. The only way to delete the tmp file is to stop your rails server.\n\nconfig.delete_tmp_file_after_storage = false is a workaround however does not solve the issue. CarrierWave still holds on the temp file.\n Well, it does not look the same to me :)\n  Please remove the forced downcase call here https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/sanitized_file.rb#L254\n\nWhat I'm working on requires that the uploaded file can be downloaded again with the exact same name.\n Hi Jason, I'd be happy to review a pull request (with tests) that added this as a configuration option. If you're interested and need help, just let me know. Thanks!\n I was hoping to tackle this one with my other sanitize changes as well in another pull request.  Is there a reason files get downcased?  My current work changes the default behavior and removes the downcasing.  Will you only accept it as a configuration option?\n I think it's for security...? I really don't know. Sorry! Can you research and decide what you think is best? Maybe Jonas or someone else knows...?\n @jnicklas Can you chime in on this?  I've added this pull request to remove the forced downcasing: https://github.com/jnicklas/carrierwave/pull/318\n If extension_white_list needs to be case insensitive, then make that method case insensitive. When it comes to file names and downloads, case sensitivity of the entire file name _does_ matter, which is why I originally opened this ticket. I still don't quite understand your reasoning behind leaving this in place.\n @jameskilton I suppose we can just temporarily downcase the extension when checking it in the extension_white_list? That way we'd have the security and not have to force downcasing anything. \n Alright I'll get that added to my pull request and make sure there's a test included for the extension_white_list\n @jnicklas Gotcha, thanks for clarifying.\n This should be fixed in master now. Please holler if not. \n  This is another good feature of paperclip, I really use and need to have in carrierwave.\nHow difficult it would be to implement?\nDo you have any plans on it?\n This has been proposed a few times. I don't like how much more complex this makes the interaction between model and uploader. The desired result can be achieved with roughly three lines of code, which I think makes this not worth it as a feature. I'm open to a discussion though.\n Sounds interestingly. Could you, please, give me a suggestion, what these 3 lines would look like? As I know, for now content type and size support are implemented through Rack, by making filesystem calls, aren't they?\n\nWhen all we need is just to show the size and type of one upload, the Rack is good and simple. But what about performance issue in case of repository with lots of files? I ask about it also because I didn't test Rack on this use case and so I don't know it's real speed. May be it can suite for this, may be not.\n\nBut in some usual use cases we may need search and/or sort uploads by size and/or content type. How could one implement search without having these values in database? And how fast is Rack in handling this cases? \n\nWouldn't it rather be better to store these values in database, even with rather complexing the carrierwave?\n In model:\n\n```\nmount_uploader :avatar, AvatarUploader\nbefore_save :set_content_type\n\ndef set_content_type\n  self.content_type = avatar.file.content_type if avatar.file.content_type.present?\nend\n```\n\nThat's off the top of my head, so it might be somewhat wrong. You should also be able to do this in the uploader to make it more reusable, if you want.\n Thanks, Jonas. This really helps me much: with this \"userspace\"-like approach I can do with my models even more than I thought before.\nNow I really like carrierwave! :)\n korobkov, please do consider updating the wiki with example code that you'd come up with. That way, other people can benefit from what you've learned!\n Sorry, but I'm a very newbie in rails. So my code is not of wiki-like quality.\nMay be someone with more skills in rails can do it...\n I just added two columns in my model for content_type and file_size, then in the model itself just add a before_save callback and drop in your code there.\n\nIn model: \n\nmount_uploader :asset, AssetUploader\nbefore_save :update_model_attrs\n\ndef update_model_attrs\n     self.content_type = asset.file.content_type\n     self.file_size = asset.file.size\nend\n trevorturk, it has been added to the wiki as a new section on the home page.  Hope it helps others.\n  [Current sanitizing of a filename](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/sanitized_file.rb#L251) sure enough converts non-latin (such as cyrillic) filenames into \"______.jpg\". It would be nice to set regular expression for sanitizing in a public method.\n I've added this feature in master. Feedback more than welcome. I'm not sure if this is the right way to do this kind of thing. \n Oh, and if/when you use this feature, can you please add a section to the wiki that describes how to do so? This would help other people that are running into the same problem in the future. Thank you!\n Thanks, Trevor! Please review my pull request, it fixes downcasing (I didn't dig into code for what reason filenames are downcased though :) ). I'll add the wiki explanation a little later.\n Something strange: it does nothing!\nI did all as is written in wiki, but seems that it just ignores overriding...\n\n```\ndef sanitize_regexp\n  1 /0\n  #    /[^[:word:]\\.\\-\\+]/\nend\n```\n\nis OK!\nI even don't know, how to properly override it (doing as in wiki isn't considered \"properly\" by sanitized_file...)\nPlease, help...\n @trevorturk, thanks. I think it should be all working. May be it's only my bug. But what it could be a bug in these 3 lines? May be I need to think more and have a rest, but for now I really don't understand, why it's refuse to work!...\n Please, mark as invalid. I've debugged that it's not carrierwave-specific: something strange is happening with other methods too. So it's a someone else's bug (may be my, who knows...).\nThanks, and my regrets for spending your time. \n The way to override sanitize_regexp suggested in the wiki is not working for me either. The method in the Uploader is simply not called. I had to override it in a monkey patch for CarrierWave::SanitizedFile but then I had another error in \nhttps://github.com/jnicklas/carrierwave/blob/951bf30e112ab0789f7afce6c5d3b5cbd42f814e/lib/carrierwave/uploader/cache.rb#L154\nAfter adjusting the regexp there and fixing another bug in ActionDispatch::Http::UploadedFile as reported here\nhttps://rails.lighthouseapp.com/projects/8994/tickets/6470-actiondispatchhttpparameters-force-encoding-of-all-params-but-filename-of-an-uploaded-file\nit finally worked for me. Holy cow, charsets cause trouble everywhere. But the ActionDispatch thing seems really embarrasing in my eyes.\n\nUsing GridFS storage by the way.\n I'm going to re-open. I'll need some help to track this down, though -- I'm pretty busy at the moment. \n Closing in favor of https://github.com/jnicklas/carrierwave/issues/304 -- please correct me if I'm wrong, but it looks like they're related. \n  I just upgraded to 0.5.1 and I get a permission denied error trying to read from the tmp directory when uploading to s3. Everything else works fine including creation of thumbnails. I imagine this is a windows specific issue with carrierwave trying to move an opened file.\n Hmm... any way you could provide some more help in tracking this one down? A backtrace, example app, or maybe you could point to the commit/change that you think is a likely culprit?\n Closing due to lack of feedback. \n I have the same error.\n\nMy Carrierwave config:\n\n```\n  CarrierWave.configure do |config| \n    config.permissions = 0777      \n    config.s3_access_key_id = 'secret_access_key_id'\n    config.s3_secret_access_key = 'secret_access_key'\n    config.s3_bucket = 'backet_name'\n end\n```\n\nIn CarrierWave uploader:\n     class AssetUploader < CarrierWave::Uploader::Base\n        storage :s3\n        ...\n     end\n\nI get a permission denied error:\n\n```\n Errno::EACCES in UploadsController#add_file \n Permission denied - D:/Projects/public/uploads/tmp/20110211-1021-3252-6545 /myfile.txt\n```\n I don't think you're supposed to use \"permissions\" with \"s3\" unless I'm mistaken. Can you try without? Also, putting up an example application would help me try to replicate. \n I try without permissions, result is the same...\n Please upload a sample application that demonstrates the problem. \n i am having the same problem. Was this issue resolved?\n how can make sure i use the master version when installing the GEM?\n  I have some functionality that I only want to run when a particular mounted uploader has been changed, after trying the usual method of checking dirty attributes it would appear that this functionality does not exist at present?\n\n```\nclass Song < ActiveRecord::Base\n\n  mount_uploader :mp3, Mp3Uploader\n\n  before_validation :check_dirty_attributes\n\n  private\n\n    def check_dirty_attributes\n      # never gets raised\n      raise \"mp3 changed\" if self.mp3_changed?\n    end\n\nend\n```\n I don't know to be honest.\n I bumped in to the same thing. Is there another way of checking if a new file has been uploaded, i.e. the old file has been replaced?\n I found a pretty simple way. Just override the setter for the uploader. For an uploader named `avatar`:\n\n```\ndef avatar=(obj)\n  # do something\n  super(obj)\nend\n```\n That sounds like an acceptable workaround to me. If that's OK with you, perhaps you can update the wiki with some instructions for future people that run into this?\n Yes, I think it will do. I added a section on the wiki.\n Thanks!\n I've run into this as well. I think the solution is to call `attribute_will_change options[:mount_on]` in the setter, but I have not verified this.\n\nSee: https://github.com/rails/rails/blob/51a269b2282ec09cf586/activerecord/lib/active_record/attribute_methods/dirty.rb\n Oh, and just wanted to add that this also affects autosave and other standard Rails 3 behavior with accepts_nested_attributes, etc. So this is actually a bigger bug than just being able to detect changes for convenience.\n Ah missed that, sorry. Thanks for the fast response!\n  This follows [issue 107](http://github.com/jnicklas/carrierwave/issues#issue/107).\nI've done three things :\n- Don't move the file when using the file storage but copy. All the other storage engines are keeping the temporary file, I don't see any reason not to do the same when using the standard file storage.\n- Delete the temporary file after storing it (for any storage engine).\n- Add an option to deactivate the deletion of that temporary file.\n This looks right to me, but I'll defer to Jonas for the merge. I'm (still!) having trouble with the tests at the moment. \n Merged - thanks!\n dmathieu, I'm playing with this some more, and it looks like the config option doesn't work correctly. I'm not sure if this is limited to the config option you added, though. I might be doing something wrong. In any case, we should add some documentation to mount.rb. \n\nSee this issue please: http://github.com/jnicklas/carrierwave/issues#issue/150\n\nI'd really appreciate your attention -- thank you!\n deleteting the folder where the files are in would be great too!\n The best way for that would be to fork, do it and make a pull request (with tests) ;)\n  When having a CarrierWave uploader mounted in an embedded document, it doesn't fire (save) at all, but when I move it to the parent, it saves correctly.\n\nThere is no error or message in the embedded document saving.\n any ETA on a solution to this? This will be a blocker bug for me really soon :(\n I ran into this as well.  I'd be happy to contribute a fix, but right now Rails3, Mongoid, and CarrierWave are new to me, so I need to be pointed in the right direction :)\n I'm pretty sure it's the way Mongoid saves the document, you need the ability to call save on the embedded object during save of parent object so that CarrierWave can be triggered to do it's work. I'm not 100% sure if that correct but it's a good place to start.\n That's what I'm thinking as well, but it doesn't make sense to have to call \"save\" on an object that's already being saved.  What about another carrierwave method in the mongoid adapter, something like:\n\naccepts_nested_file_uploads_for :children, :class=>ChildClass\n\nAnd then the before_save, after_save hooks could be wired up to the parent, but act on the children.  \n\nI'm not entirely sure how to accomplish this though, this is just a thought.\n Well, why not add an before save hook to the parent object that calls all the embedded children objects save command, which really should do nothing (maybe run validations) except that's what I'm assuming CarrierWave alias. Not really sure how CarrierWave works when it comes to saving an object.\n It adds 3 hooks to the model's save/delete events:\n\n```\n  after_save \"store_#{column}!\".to_sym\n  before_save \"write_#{column}_identifier\".to_sym\n  after_destroy \"remove_#{column}!\".to_sym\n```\n\nThe parent could execute these on it's children directly, you'd just need to loop over them & send those particular messages to each instance.\n I'm not sure what you mean by this. What is \"The Model\" you're referring to, a parent or child?\n In our case, this is the child object.  But if we added another method on the parent that would execute these methods \"store_#{column}!\", etc on each child I think it would work.\n I would rather see it in the child as the parent shouldn't care that a child would have a file or not (also, developers won't know to look in the parent for a child's function). So we need a way for the parent to always fire a method when it's being saved and embedding it's children, then attached save_#{column}! to that?\n ...or ask the mongoid folks if there's a way for an embedded document to get notified when the parent is saved.\n (actually I think we're saying the same thing)\n I've added the issue to Mongoid:\nhttp://github.com/durran/mongoid/issues/#issue/194\n The main issue here is that the callbacks on the children are not firing in mongoid anymore if you called save on the parent... If you call save on the embedded document it will properly save as callbacks bubble up, but not down. (this is by design.)\n\nI am trying to figure out a workaround for this that I can put in Mongoid... More info as I get there.\n Makes sense, but hoping for a workaround for these scenarios.  Thanks, durran!\n While I am looking into this - your current workaround is to make the save call on the embedded document itself. That will save the file. For example, if you have a person that embeds many addresses, and you have an uploader mounted on address, calling save on the address will save the file. Calling save on person will not.\n I created a hack to bubble down the callbacks from the parent model to the embedded associations of a mongoid document. I created this to get Carrierwave working correctly. Here is quick example of what I did: http://gist.github.com/566242 -- CAUTION, only tested it locally; using Rails 3.0.\n Hack from zerobearing2 doesn't work for me since the prototype of function `run_callbacks` in the snippet is different from `run_callbacks(kind, *args, &block)` in `ActiveSupport::Callbacks`. Also validation callbacks are not supported this way since they are triggered directly by the `valid?` method. Here i've changed the gist from zerobearing2 to fit my needs: http://gist.github.com/574705. Rails 3 + MongoID 2.0.0beta17\n mcasimir: you should be able to add 'validates_associated :name_of_assocation' to the parent model and have it then validate each association when the parent is validated. \n\nthanks for fixing the run_callback method signature too -- i've updated my hack locally and works nicely. cheers! :-)\n It seems i've discovered another issue. When i use `mount_uploader` in embedded documents upload works nice and attachments are saved correctly, but for some reason filename remains blank.. is there anyone that has experienced the same issue?\n Is this still an issue? I'd like to close if possible...? Let me know. mcasimir, it sounds like you've identified another separate issue - could be good to create a new ticket. Thanks!\n Yes, i think it's a different issue, i'm tring to understand if this affects only s3 uploaders or not. I'll open a new ticket anyway.\n I've changed idea: \nI'think the new issue identified depends strictly on this issue and on the solution purposed in zerobearing gist, is it ok to reference this issue into the new ticket?\n\ni've solved that with an `after_save` callback in embedded document model:\n\n```\n    after_save :extract_filename\n\n    def extract_filename\n      self.class.skip_callback(:save, :after, :extract_filename)\n\n      @photo_original_filename = photo.instance_variable_get(\"@original_filename\")\n      if @photo_original_filename.present?\n        self.update_attributes :photo_filename => @photo_original_filename\n      end\n\n      self.class.set_callback(:save, :after, :extract_filename)\n    end\n```\n\n..but i suppose that this still remains an issue, is it correct?\n\nIt seems that carrierwave actually writes `nil` into the `filename` attribute since if i use `before_save` instead of `after_save` `filename` is set correctly at the end of the callback but then it turns back to blank after save.\n\nI can't find a better solution since looking into the sources i can't figure out where and how uploader filenames are set.\n\nThat's all, please tell me if it's needed to open another ticket.\nMaurizio\n After 5 months it is still issue for me. Uploader doesent work in embeded document but if I save object manualy upload works but dosen't set proper filename\n Does the author have any input on this issue?\n I haven't had a need to get this fixed myself. IMHO it's more about an architectural decision in mongoid that may not be the best. If someone can find an elegant workaround, I'd love to accept a patch, but it's not likely that I'll invest my time to fix this. Sorry.\n I'm closing this issue as it seems settled. \n\nFrom what I gather, there is a workaround for this known limitation as mentioned by durran. I'm adding that information to the wiki now. I'd appreciate it if someone would look at the wiki, and possibly provide some code examples etc to help others who may be hit with the same limitation. \n\nIf there's concern about this information being easily found, I can add a note to the readme as well. I'm adding a link to the wiki to the top of the readme now. \n\nIf someone would like take a shot at providing a pull request to improve Carrierwave, we can have another look. \n Since this issue ranks pretty highly on Google I'd like to add that this gem https://github.com/alexeypetrushin/mongoid_misc patches this perfectly and gets embedded Mongoid documents to play nice with CarrierWave. Hope this helps someone.\n This issue is pretty easily solved using `cascade_callbacks`. See https://github.com/mongoid/mongoid/pull/1058 for the pull request. All you need to do is:\n\n``` ruby\nembeds_many :photos, :cascade_callbacks => true\n```\n  I had a little trouble getting random filenames to work by defining the \"filename\" method. I ended up finding a workaround, but I thought it might be worth mentioning in any case:\n\nhttp://pastie.org/804613\n\nI dug around in the gem, but I couldn't seem to figure out if/why the filename was being set twice in my app. \n This seems like good practice anyhow, there is no reason CarrierWave should call the filename only once, memoizing the random value is the right thing to do, imho.\n how would I go about wanting different versions of a file with that same filename? right now, I end up with the original image having a different hex file name then the 2 thumbs it creates. \n Please see the wiki for a technique that should work. In any case, please direct questions like this to the Google Group in the future. \n I am using that example, it calls the filename function for every other version again, thus generating a new hex.\n\nre: question direction, sorry about that, should I move this to the google groups for reference?\n Oh, I see - sorry, that must not work with versions? Please direct this conversation to the google group, as it's not really a bug. If you figure it out, please do consider updating the wiki so other people can benefit!\n What is the correct solution that works with versions? I tried both solutions on the wiki, but I always end up with new random values for each version.\n The following works for me;\n\n``` ruby\nclass ImageUploader < CarrierWave::Uploader::Base\n\n  def filename\n     \"#{secure_token(10)}.#{file.extension}\" if original_filename.present?\n  end\n\n  protected\n    def secure_token(length=16)\n      var = :\"@#{mounted_as}_secure_token\"\n      model.instance_variable_get(var) or model.instance_variable_set(var, SecureRandom.hex(length/2))\n    end\n\nend\n```\n\nEdit; now that I check the wiki, this is the exactly the 2nd example. \n", "text_all_count": 95420, "text_word_token": ["Hello", "I", "use", "storage", "file", "for", "a", "while", "and", "now", "I", "be", "switching", "to", "fog", "NUMBER", "Is", "it", "possible", "to", "keep", "the", "exist", "file", "on", "my", "file", "storage", "and", "generate", "correct", "url", "for", "both", "storage", "types", "with", "just", "one", "uploader", "class", "Thanks", "Is", "there", "a", "way", "to", "override", "the", "host", "name", "in", "the", "uploader", "class", "like", "def", "store_dir", "or", "def", "file_name", "Hi", "i", "ve", "just", "tried", "to", "install", "carrierwave", "with", "Bundler", "version", "NUMBER", "and", "I", "get", "these", "message", "WARNING", "TAG", "NUMBER", "_", "encoding", "utf", "NUMBER", "_", "Gem", "Specification", "NUMBER", "new", "do", "s", "s", "NUMBER", "name", "q", "carrierwave", "s", "NUMBER", "version", "NUMBER", "s", "NUMBER", "required_rubygems_version", "Gem", "Requirement", "NUMBER", "new", "NUMBER", "if", "s", "NUMBER", "respond_to", "required_rubygems_version", "s", "NUMBER", "authors", "Jonas", "Nicklas", "s", "NUMBER", "date", "q", "NUMBER", "NUMBER", "NUMBER", "s", "NUMBER", "description", "q", "Upload", "file", "in", "your", "Ruby", "applications", "map", "them", "to", "a", "range", "of", "ORMs", "store", "them", "on", "different", "backends", "NUMBER", "s", "NUMBER", "email", "jonas", "NUMBER", "nicklas", "gmail", "NUMBER", "com", "s", "NUMBER", "extra_rdoc_files", "README", "NUMBER", "md", "s", "NUMBER", "file", "lib", "carrierwave", "compatibility", "paperclip", "NUMBER", "rb", "lib", "carrierwave", "locale", "en", "NUMBER", "yml", "lib", "carrierwave", "mount", "NUMBER", "rb", "lib", "carrierwave", "orm", "activerecord", "NUMBER", "rb", "lib", "carrierwave", "processing", "mime_types", "NUMBER", "rb", "lib", "carrierwave", "processing", "mini_magick", "NUMBER", "rb", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "lib", "carrierwave", "storage", "abstract", "NUMBER", "rb", "lib", "carrierwave", "storage", "file", "NUMBER", "rb", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "lib", "carrierwave", "test", "matchers", "NUMBER", "rb", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "lib", "carrierwave", "uploader", "configuration", "NUMBER", "rb", "lib", "carrierwave", "uploader", "default_url", "NUMBER", "rb", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "lib", "carrierwave", "uploader", "extension_whitelist", "NUMBER", "rb", "lib", "carrierwave", "uploader", "mountable", "NUMBER", "rb", "lib", "carrierwave", "uploader", "processing", "NUMBER", "rb", "lib", "carrierwave", "uploader", "proxy", "NUMBER", "rb", "lib", "carrierwave", "uploader", "remove", "NUMBER", "rb", "lib", "carrierwave", "uploader", "serialization", "NUMBER", "rb", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "lib", "carrierwave", "uploader", "NUMBER", "rb", "lib", "carrierwave", "validations", "active_model", "NUMBER", "rb", "lib", "carrierwave", "version", "NUMBER", "rb", "lib", "carrierwave", "NUMBER", "rb", "lib", "generators", "template", "uploader", "NUMBER", "rb", "lib", "generators", "uploader_generator", "NUMBER", "rb", "README", "NUMBER", "md", "s", "NUMBER", "homepage", "q", "LINK", "s", "NUMBER", "oc_options", "main", "s", "NUMBER", "require_paths", "lib", "s", "NUMBER", "rubyforge_project", "q", "carrierwave", "s", "NUMBER", "rubygems_version", "q", "NUMBER", "s", "NUMBER", "summary", "q", "Ruby", "file", "upload", "library", "if", "s", "NUMBER", "respond_to", "specification_version", "then", "current_version", "Gem", "Specification", "CURRENT_SPECIFICATION_VERSION", "s", "NUMBER", "specification_version", "NUMBER", "if", "Gem", "Version", "NUMBER", "new", "Gem", "VERSION", "Gem", "Version", "NUMBER", "new", "NUMBER", "then", "s", "NUMBER", "add_runtime_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_runtime_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_development_dependency", "q", "TAG", "NUMBER", "else", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "end", "else", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "YAML", "Syck", "DefaultKey", "NUMBER", "x", "NUMBER", "e", "NUMBER", "e", "NUMBER", "f", "NUMBER", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "s", "NUMBER", "add_dependency", "q", "TAG", "NUMBER", "end", "end", "WARNING", "Invalid", "NUMBER", "gemspec", "format", "in", "Library", "Ruby", "Gems", "NUMBER", "specifications", "carrierwave", "NUMBER", "gemspec", "Could", "not", "find", "carrierwave", "NUMBER", "in", "any", "of", "the", "sources", "This", "be", "my", "list", "of", "gemfiles", "Using", "rake", "NUMBER", "Using", "i", "NUMBER", "n", "NUMBER", "Using", "multi_json", "NUMBER", "Using", "activesupport", "NUMBER", "Using", "builder", "NUMBER", "Using", "activemodel", "NUMBER", "Using", "erubis", "NUMBER", "Using", "journey", "NUMBER", "Using", "rack", "NUMBER", "Using", "rack", "cache", "NUMBER", "Using", "rack", "test", "NUMBER", "Using", "hike", "NUMBER", "Using", "tilt", "NUMBER", "Using", "sprockets", "NUMBER", "Using", "actionpack", "NUMBER", "Using", "mime", "types", "NUMBER", "Using", "polyglot", "NUMBER", "Using", "treetop", "NUMBER", "Using", "mail", "NUMBER", "Using", "actionmailer", "NUMBER", "Using", "arel", "NUMBER", "Using", "tzinfo", "NUMBER", "Using", "activerecord", "NUMBER", "Using", "activeresource", "NUMBER", "Using", "bcrypt", "ruby", "NUMBER", "Using", "bundler", "NUMBER", "Using", "cancan", "NUMBER", "Installing", "carrierwave", "NUMBER", "Using", "coffee", "script", "source", "NUMBER", "Using", "execjs", "NUMBER", "Using", "coffee", "script", "NUMBER", "Using", "rack", "ssl", "NUMBER", "Using", "json", "NUMBER", "Using", "rdoc", "NUMBER", "Using", "thor", "NUMBER", "Using", "railties", "NUMBER", "Using", "coffee", "rails", "NUMBER", "Using", "orm_adapter", "NUMBER", "Using", "warden", "NUMBER", "Using", "devise", "NUMBER", "Using", "gli", "NUMBER", "Using", "jquery", "rails", "NUMBER", "Using", "rest", "client", "NUMBER", "Using", "ya", "NUMBER", "yaml", "NUMBER", "Using", "localeapp", "NUMBER", "Using", "mysql", "NUMBER", "Using", "rails", "NUMBER", "Using", "rails", "i", "NUMBER", "n", "NUMBER", "Using", "sass", "NUMBER", "Using", "sass", "rails", "NUMBER", "Using", "sqlite", "NUMBER", "NUMBER", "Using", "uglifier", "NUMBER", "Using", "web", "app", "theme", "NUMBER", "from", "git", "github", "NUMBER", "com", "pilu", "web", "app", "theme", "NUMBER", "git", "at", "master", "ruby", "version", "ruby", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "patchlevel", "NUMBER", "universal", "darwin", "NUMBER", "Getting", "this", "error", "on", "uploading", "a", "file", "with", "NUMBER", "and", "fog", "NUMBER", "Any", "ideas", "Hey", "man", "I", "m", "on", "rails", "NUMBER", "app", "and", "not", "sure", "it", "will", "allow", "me", "to", "upgrade", "to", "NUMBER", "Can", "you", "give", "a", "suggestion", "for", "doing", "so", "Can", "t", "right", "now", "NUMBER", "Would", "like", "to", "but", "don", "t", "have", "the", "time", "or", "money", "NUMBER", "I", "have", "spent", "a", "bunch", "of", "time", "upgrading", "to", "carrier", "wave", "from", "paperclip", "and", "doing", "multiple", "file", "uploads", "NUMBER", "The", "performance", "be", "really", "really", "bad", "NUMBER", "I", "m", "talking", "NUMBER", "NUMBER", "seconds", "to", "upload", "about", "NUMBER", "MB", "of", "file", "NUMBER", "I", "can", "t", "figure", "out", "and", "hoped", "an", "upgrade", "version", "of", "carrier", "wave", "would", "work", "NUMBER", "was", "there", "any", "issue", "that", "you", "can", "recall", "from", "NUMBER", "Going", "to", "try", "a", "few", "things", "here", "and", "will", "let", "you", "know", "if", "i", "come", "up", "with", "anything", "Thanks", "NUMBER", "be", "a", "long", "week", "NUMBER", "btw", "NUMBER", "do", "you", "know", "what", "the", "version", "of", "fog", "be", "to", "be", "use", "with", "NUMBER", "NUMBER", "works", "well", "but", "NUMBER", "throw", "that", "to_file", "error", "cool", "thanks", "NUMBER", "going", "to", "upgrade", "soon", "but", "wanted", "to", "get", "past", "this", "stuff", "first", "Hello", "NUMBER", "We", "be", "get", "an", "issue", "where", "ReprocessJobs", "be", "fail", "with", "a", "File", "Exists", "error", "NUMBER", "Setup", "be", "Heroku", "App", "with", "Resque", "run", "the", "image", "process", "jobs", "but", "the", "error", "be", "come", "from", "Carrierwave", "NUMBER", "I", "m", "assuming", "there", "might", "be", "an", "issue", "with", "run", "these", "jobs", "in", "parallel", "NUMBER", "It", "seems", "to", "happen", "more", "since", "upgrading", "from", "NUMBER", "I", "cannot", "confirm", "or", "deny", "claims", "it", "was", "happening", "prior", "to", "last", "week", "when", "the", "upgrade", "was", "performed", "NUMBER", "Is", "it", "not", "recommended", "to", "run", "multiple", "reprocess", "jobs", "on", "the", "same", "machine", "or", "be", "there", "a", "configuration", "code", "step", "I", "be", "miss", "to", "safely", "have", "run", "these", "reprocess", "jobs", "in", "parallel", "We", "be", "use", "carrierwave", "NUMBER", "and", "carrierwave", "mongoid", "NUMBER", "with", "Fog", "S", "NUMBER", "configuration", "NUMBER", "Let", "me", "know", "if", "there", "be", "any", "other", "configuration", "elements", "that", "would", "help", "diagnose", "NUMBER", "I", "will", "carry", "on", "looking", "into", "it", "on", "our", "app", "NUMBER", "File", "exists", "app", "public", "uploads", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "mkdir", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "fu_mkdir", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "mkdir_p", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "reverse_each", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "block", "in", "mkdir_p", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "each", "usr", "local", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "mkdir_p", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "mkdir", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "copy_to", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "block", "in", "cache", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache_stored_file", "app", "vendor", "bundle", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "recreate_versions", "app", "vendor", "our_app", "app", "jobs", "image_reprocess_job", "NUMBER", "rb", "NUMBER", "in", "perform", "I", "would", "like", "to", "manually", "set", "the", "location", "of", "an", "asset", "ie", "NUMBER", "LINK", "and", "save", "the", "model", "without", "carrierwave", "downloading", "the", "image", "NUMBER", "The", "reason", "be", "that", "the", "image", "be", "already", "stored", "in", "my", "own", "S", "NUMBER", "bucket", "and", "I", "m", "already", "use", "the", "same", "S", "NUMBER", "bucket", "with", "my", "carrierwave", "upload", "and", "fog", "so", "all", "it", "be", "doing", "be", "downloading", "it", "and", "then", "uploading", "it", "again", "NUMBER", "Also", "I", "m", "not", "performing", "any", "post", "upload", "processing", "of", "the", "file", "so", "downloading", "really", "be", "unnecessary", "NUMBER", "So", "I", "only", "have", "NUMBER", "version", "of", "the", "file", "and", "it", "s", "already", "in", "a", "location", "where", "carrierwave", "fog", "can", "fetch", "it", "NUMBER", "I", "would", "however", "like", "to", "continue", "to", "use", "carrierwave", "fog", "because", "it", "offers", "nice", "getter", "methods", "for", "my", "assets", "from", "S", "NUMBER", "I", "be", "use", "the", "remote_path_url", "method", "to", "set", "the", "url", "but", "I", "know", "that", "carrierwave", "fetches", "the", "image", "before", "uploading", "it", "storing", "it", "NUMBER", "Of", "course", "it", "makes", "sense", "that", "carrierwave", "should", "do", "that", "NUMBER", "of", "the", "time", "but", "this", "be", "the", "NUMBER", "NUMBER", "I", "have", "tried", "overwriting", "the", "setter", "method", "in", "the", "model", "but", "that", "didn", "t", "seem", "to", "persist", "for", "some", "reason", "NUMBER", "Is", "there", "a", "way", "to", "easily", "do", "this", "with", "carrierwave", "that", "you", "can", "think", "of", "I", "just", "notice", "that", "the", "quality", "of", "the", "thumbnails", "generate", "in", "my", "case", "be", "really", "bad", "NUMBER", "After", "playing", "with", "the", "settings", "of", "my", "uploader", "it", "seems", "that", "the", "only", "thing", "that", "fix", "it", "be", "make", "sure", "to", "use", "ImageMagick", "instead", "of", "GraphicsMagick", "NUMBER", "Any", "ideas", "why", "that", "would", "be", "Could", "it", "be", "a", "problem", "with", "MiniMagick", "Opened", "the", "issue", "here", "LINK", "_magick", "issue", "NUMBER", "i", "have", "tried", "this", "receipt", "LINK", "to", "Delete", "cache", "garbage", "directories", "first", "one", "but", "temp", "folders", "were", "not", "delete", "by", "FileUtils", "NUMBER", "rm_rf", "NUMBER", "if", "i", "change", "it", "to", "Dir", "NUMBER", "delete", "i", "have", "an", "error", "specified", "directory", "doesn", "t", "exist", "i", "think", "it", "happens", "because", "cache_id_was", "cache_id", "var", "doesn", "t", "define", "correctly", "any", "suggestions", "fix", "maybe", "i", "miss", "something", "thanks", "in", "advance", "Making", "sure", "NUMBER", "be", "not", "forgotten", "NUMBER", "Its", "pull", "request", "was", "close", "because", "the", "fix", "wasn", "t", "comprehensive", "but", "the", "issue", "itself", "remains", "and", "bensie", "was", "able", "to", "reproduce", "it", "NUMBER", "Running", "under", "rails", "NUMBER", "and", "with", "carrierwave", "NUMBER", "I", "wasn", "t", "experience", "that", "problem", "with", "german", "umlauts", "NUMBER", "Now", "with", "rails", "NUMBER", "and", "carrierwave", "NUMBER", "I", "get", "that", "mini_magick_processing_error", "as", "well", "NUMBER", "Using", "mini_magick", "NUMBER", "in", "both", "cases", "NUMBER", "Hi", "Running", "rails", "NUMBER", "app", "here", "so", "needed", "to", "use", "this", "branch", "NUMBER", "I", "m", "trying", "to", "save", "a", "file", "and", "get", "this", "error", "CarrierWave", "FormNotMultipart", "You", "tried", "to", "assign", "a", "String", "or", "a", "Pathname", "to", "an", "uploader", "for", "security", "reasons", "this", "be", "not", "allow", "NUMBER", "If", "this", "be", "a", "file", "upload", "please", "check", "that", "your", "upload", "form", "be", "multipart", "encoded", "NUMBER", "Here", "s", "the", "params", "list", "ruby", "convicted_of_mis", "no", "multipart", "true", "commit", "Continue", "authenticity_token", "Jk", "NUMBER", "fNxop", "NUMBER", "nFG", "oHaJiIcBxgWIjpC", "NUMBER", "eltNGhKvUh", "NUMBER", "AGw", "employed", "not", "previously", "employed", "disciplined_or_investigated", "No", "id", "application_form", "legal_to_work_in_usa", "yes", "sixteen_or_older", "yes", "email", "uploaded_data", "Comcast_Business_Solutions_", "NUMBER", "pdf", "employer", "NUMBER", "_telephone", "employer", "NUMBER", "_start_date", "phone", "NUMBER", "NUMBER", "and", "so", "on", "NUMBER", "It", "s", "a", "huge", "form", "that", "be", "not", "connected", "to", "a", "model", "NUMBER", "The", "client", "wanted", "an", "online", "job", "application", "but", "didn", "t", "want", "to", "save", "anything", "NUMBER", "So", "the", "app", "grabs", "all", "the", "values", "puts", "them", "into", "an", "email", "and", "sends", "them", "along", "NUMBER", "Now", "they", "want", "to", "have", "to", "ability", "to", "have", "a", "job", "applicant", "upload", "a", "resume", "NUMBER", "Here", "s", "the", "top", "of", "the", "form_tag", "erb", "TAG", "emailer", "action", "sendmail", "id", "application_form", "multipart", "true", "do", "In", "my", "controller", "I", "have", "ruby", "resume", "ResumeUploader", "NUMBER", "new", "resume", "File", "NUMBER", "open", "File", "NUMBER", "join", "Rails", "NUMBER", "root", "tmp", "email", "uploaded_data", "resume", "NUMBER", "cache", "email", "uploaded_data", "I", "ve", "tried", "resume", "NUMBER", "save", "as", "well", "and", "get", "the", "same", "error", "NUMBER", "I", "read", "somewhere", "online", "that", "use", "the", "File", "NUMBER", "join", "commented", "out", "line", "will", "help", "with", "automate", "test", "so", "I", "gave", "it", "a", "try", "and", "said", "it", "can", "t", "find", "the", "file", "which", "I", "guess", "makes", "sense", "if", "it", "s", "not", "get", "uploaded", "NUMBER", "Here", "be", "part", "of", "my", "uploader", "NUMBER", "rb", "file", "ruby", "storage", "file", "storage", "s", "NUMBER", "def", "cache_dir", "RAILS_ROOT", "tmp", "end", "Override", "the", "directory", "where", "uploaded", "file", "will", "be", "stored", "This", "be", "a", "sensible", "default", "for", "uploaders", "that", "be", "meant", "to", "be", "mounted", "def", "store_dir", "uploads", "model", "NUMBER", "class", "NUMBER", "to_s", "NUMBER", "underscore", "mounted_as", "model", "NUMBER", "id", "RAILS_ROOT", "tmp", "end", "I", "love", "this", "gem", "but", "have", "never", "needed", "to", "make", "it", "do", "what", "I", "m", "trying", "to", "do", "in", "this", "case", "NUMBER", "Any", "help", "advice", "would", "be", "appreciated", "NUMBER", "Is", "there", "a", "way", "to", "disable", "the", "error", "method", "Thanks", "NUMBER", "what", "about", "ftp", "storage", "like", "in", "paperclip", "LINK", "looks", "not", "so", "complicated", "LINK", "Hi", "NUMBER", "I", "have", "notice", "that", "the", "order", "that", "field", "appear", "in", "on", "a", "form", "can", "affect", "whether", "the", "field", "values", "be", "set", "in", "the", "model", "variable", "that", "be", "accessible", "in", "the", "uploader", "NUMBER", "to", "reproduce", "put", "a", "field", "w", "carrierwave", "on", "a", "model", "NUMBER", "create", "a", "form", "field", "like", "so", "NUMBER", "in", "this", "case", "a", "Doc", "object", "ruby", "form_for", "doc", "html", "multipart", "true", "class", "form", "vertical", "do", "f", "fieldset", "if", "doc", "NUMBER", "error", "NUMBER", "any", "NUMBER", "alert", "NUMBER", "alert", "block", "NUMBER", "alert", "error", "h", "NUMBER", "alert", "heading", "pluralize", "doc", "NUMBER", "error", "NUMBER", "count", "error", "prohibited", "this", "doc", "from", "be", "saved", "ul", "doc", "NUMBER", "error", "NUMBER", "full_messages", "NUMBER", "each", "do", "msg", "li", "msg", "NUMBER", "control", "group", "f", "NUMBER", "label", "name", "class", "control", "label", "NUMBER", "controls", "f", "NUMBER", "text_field", "name", "NUMBER", "control", "group", "f", "NUMBER", "label", "filetype", "class", "control", "label", "f", "NUMBER", "select", "filetype", "Doc", "FILE_TYPE", "NUMBER", "control", "group", "f", "NUMBER", "label", "file", "URL", "or", "upload", "file", "class", "control", "label", "NUMBER", "controls", "f", "NUMBER", "text_field", "remote_file_url", "class", "input", "placeholder", "LINK", "or", "f", "NUMBER", "file_field", "file", "class", "input", "small", "NUMBER", "control", "group", "f", "NUMBER", "label", "state", "class", "control", "label", "f", "NUMBER", "select", "state", "us_states", "include_blank", "None", "NUMBER", "control", "group", "f", "NUMBER", "label", "description", "class", "control", "label", "NUMBER", "controls", "f", "NUMBER", "text_area", "description", "class", "input", "xlarge", "rows", "NUMBER", "f", "NUMBER", "submit", "Save", "class", "btn", "btn", "primary", "create", "the", "following", "function", "in", "the", "uploader", "to", "read", "out", "the", "model", "variables", "ruby", "def", "create_pdf_version", "puts", "model", "NUMBER", "filetype", "model", "NUMBER", "name", "model", "NUMBER", "ate", "model", "NUMBER", "description", "some", "code", "that", "creates", "a", "pdf", "file", "in", "different", "ways", "based", "on", "the", "model", "NUMBER", "filetype", "end", "version", "pdf", "do", "process", "create_pdf_version", "end", "you", "ll", "notice", "that", "all", "the", "attributes", "in", "the", "form", "above", "the", "file", "field", "be", "set", "and", "prints", "out", "in", "the", "puts", "line", "but", "all", "the", "attributes", "below", "the", "file", "field", "in", "this", "case", "state", "description", "be", "not", "set", "NUMBER", "you", "can", "change", "what", "gets", "set", "by", "moving", "the", "file", "field", "higher", "or", "lower", "on", "the", "form", "NUMBER", "ruby", "NUMBER", "rails", "NUMBER", "As", "discussed", "at", "LINK", "topic", "carrierwave", "AYd", "n", "NUMBER", "DrJKU", "To", "summarize", "the", "mailing", "list", "discussion", "the", "problem", "here", "be", "that", "CW", "writes", "the", "images", "with", "no", "options", "after", "the", "user", "may", "have", "write", "it", "in", "the", "block", "to", "manipulate", "NUMBER", "Here", "be", "an", "example", "from", "the", "wiki", "LINK", "to", "NUMBER", "A", "Specify", "the", "image", "quality", "manipulate", "do", "img", "img", "NUMBER", "write", "current_path", "self", "NUMBER", "quality", "percentage", "unless", "img", "NUMBER", "quality", "percentage", "img", "yield", "img", "if", "block_given", "img", "end", "After", "manipulate", "has", "yielded", "to", "the", "code", "block", "it", "writes", "the", "image", "again", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "if", "options", "format", "frames", "NUMBER", "write", "options", "format", "current_path", "write_block", "else", "frames", "NUMBER", "write", "current_path", "write_block", "end", "This", "be", "not", "a", "problem", "for", "the", "quality", "attribute", "but", "the", "interlace", "option", "be", "not", "carried", "on", "between", "write", "calls", "NUMBER", "So", "maybe", "the", "user", "should", "be", "allow", "to", "pass", "options", "back", "to", "the", "write", "call", "Here", "be", "one", "idea", "for", "how", "this", "could", "look", "instance", "NUMBER", "manipulate", "do", "img", "index", "options", "options", "write", "quality", "NUMBER", "depth", "NUMBER", "img", "end", "Thoughts", "I", "m", "trying", "to", "us", "an", "uploader", "directly", "without", "be", "mounted", "into", "a", "model", "to", "upload", "a", "generate", "image", "ruby", "file", "image", "NUMBER", "write", "tmp", "figure", "NUMBER", "id", "NUMBER", "jpg", "uploader", "FigureUploader", "NUMBER", "new", "project", "uploader", "NUMBER", "ore", "file", "puts", "uploader", "NUMBER", "url", "The", "uploader", "url", "be", "always", "nil", "then", "both", "with", "storage", "fog", "and", "storage", "file", "NUMBER", "Does", "this", "work", "asynchronous", "Magically", "This", "only", "happens", "in", "a", "spec", "when", "I", "switch", "to", "the", "console", "and", "test", "the", "uploader", "manually", "the", "url", "be", "filled", "and", "points", "to", "the", "right", "file", "NUMBER", "Is", "Fog", "NUMBER", "mock", "ed", "by", "default", "in", "test", "The", "idea", "I", "had", "was", "to", "have", "an", "extension", "black", "list", "to", "eliminate", "file", "that", "you", "wouldn", "t", "want", "to", "have", "uploaded", "Say", "like", "an", "NUMBER", "eml", "NUMBER", "tmp", "NUMBER", "jar", "NUMBER", "zip", "file", "uploaded", "NUMBER", "I", "might", "try", "to", "add", "this", "if", "anyone", "thinks", "it", "be", "a", "great", "idea", "and", "would", "want", "to", "include", "it", "NUMBER", "Thanks", "Hey", "James", "NUMBER", "Is", "there", "anyway", "to", "unmount", "and", "remount", "an", "uploader", "NUMBER", "Wanted", "to", "migrate", "data", "to", "a", "new", "model", "and", "then", "mount", "the", "uploader", "and", "recreate", "version", "NUMBER", "Brian", "Bokor", "Sent", "from", "my", "iPhone", "On", "Apr", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "James", "Miller", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "Yes", "please", "do", "It", "s", "be", "request", "a", "number", "of", "times", "in", "the", "past", "NUMBER", "Just", "open", "a", "new", "pull", "request", "when", "it", "s", "ready", "NUMBER", "Thanks", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "I", "have", "put", "the", "mount", "on", "my", "model", "but", "I", "wanted", "to", "move", "my", "images", "from", "one", "model", "to", "another", "NUMBER", "I", "was", "hoping", "to", "move", "the", "image", "field", "filename", "from", "one", "field", "to", "the", "next", "without", "having", "the", "uploader", "then", "add", "the", "uploader", "and", "recreate_versions", "after", "that", "was", "do", "NUMBER", "If", "I", "do", "the", "following", "it", "won", "t", "migrate", "ruby", "mount_uploader", "avatar", "AvatarUploader", "if", "I", "do", "the", "following", "it", "will", "move", "the", "field", "and", "I", "can", "reprocess", "all", "images", "NUMBER", "Thinking", "it", "might", "be", "a", "bug", "but", "not", "sure", "yet", "ruby", "mount_uploader", "avatar", "AvatarUploader", "mount_on", "image", "Figured", "out", "what", "I", "needed", "for", "the", "migration", "ruby", "photo", "Photo", "NUMBER", "create", "attachable", "object", "Polymorphic", "photo", "NUMBER", "write_uploader", "image", "object", "NUMBER", "photo", "photo", "NUMBER", "save", "James", "I", "m", "work", "with", "Engine", "Yard", "and", "my", "environment", "has", "a", "App", "server", "DB", "Server", "and", "Utility", "Server", "NUMBER", "I", "would", "like", "to", "store", "cache", "file", "on", "the", "utility", "server", "NUMBER", "Do", "you", "know", "how", "I", "might", "go", "about", "customizing", "Carrierwave", "to", "do", "this", "I", "m", "really", "in", "a", "bad", "spot", "now", "and", "would", "appreciate", "any", "guidance", "on", "this", "NUMBER", "ank", "you", "so", "much", "Brian", "Bokor", "Owner", "Designwaves", "LLC", "NUMBER", "NUMBER", "NUMBER", "LINK", "On", "Apr", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "James", "Miller", "write", "Yes", "please", "do", "It", "s", "be", "request", "a", "number", "of", "times", "in", "the", "past", "NUMBER", "Just", "open", "a", "new", "pull", "request", "when", "it", "s", "ready", "NUMBER", "Thanks", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Thanks", "NUMBER", "use", "S", "NUMBER", "already", "but", "wanted", "to", "do", "background", "jobs", "for", "the", "processing", "and", "storing", "NUMBER", "Carrierwave", "backgrounder", "works", "well", "but", "not", "for", "an", "environment", "like", "i", "have", "now", "NUMBER", "Can", "t", "access", "the", "file", "on", "the", "application", "server", "Oh", "that", "might", "work", "NUMBER", "How", "would", "I", "defer", "the", "processing", "to", "the", "utility", "server", "for", "the", "additional", "processing", "I", "think", "that", "be", "what", "I", "m", "really", "trying", "to", "do", "NUMBER", "James", "thank", "you", "so", "much", "I", "really", "really", "appreciate", "you", "helping", "me", "on", "this", "NUMBER", "I", "m", "work", "for", "a", "non", "profit", "and", "really", "could", "use", "another", "developer", "or", "two", "NUMBER", "I", "m", "trying", "to", "do", "so", "much", "myself", "and", "can", "t", "always", "get", "everything", "do", "myself", "NUMBER", "You", "have", "be", "more", "than", "helpful", "NUMBER", "Means", "a", "lot", "to", "me", "This", "add", "a", "new", "uploader", "configuration", "option", "directory_permissions", "which", "allows", "to", "set", "the", "permissions", "of", "directories", "created", "by", "the", "uploader", "NUMBER", "This", "do", "NOT", "modify", "the", "permissions", "of", "exist", "directories", "cause", "that", "could", "be", "potentially", "harmful", "NUMBER", "I", "ve", "also", "add", "and", "fix", "relevant", "specs", "NUMBER", "I", "needed", "this", "for", "a", "project", "were", "both", "a", "rails", "app", "and", "a", "daemon", "be", "use", "the", "same", "uploader", "but", "be", "run", "under", "different", "users", "of", "the", "same", "group", "NUMBER", "The", "change", "be", "a", "bit", "too", "much", "repetitive", "for", "my", "taste", "so", "I", "m", "open", "for", "suggestions", "on", "how", "to", "do", "it", "better", "without", "breaking", "backwards", "compatibility", "NUMBER", "I", "also", "fix", "a", "few", "specs", "that", "set", "Uploader", "config", "NUMBER", "permission", "to", "NUMBER", "decimal", "when", "NUMBER", "was", "the", "intended", "setting", "NUMBER", "bensie", "do", "NUMBER", "This", "pull", "request", "pass", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "build", "NUMBER", "merge", "NUMBER", "a", "NUMBER", "d", "NUMBER", "into", "b", "NUMBER", "b", "NUMBER", "Thanks", "Hi", "I", "was", "trying", "out", "the", "remote_url", "functionality", "in", "my", "app", "when", "I", "realized", "there", "were", "no", "validation", "error", "for", "downloads", "NUMBER", "Here", "s", "a", "patch", "that", "include", "a", "DownloadError", "validation", "for", "remote", "file", "in", "the", "same", "vein", "as", "the", "exist", "ProcessingError", "and", "IntegrityError", "validations", "NUMBER", "It", "works", "out", "of", "the", "box", "with", "no", "additional", "configuration", "necessary", "NUMBER", "One", "conscious", "design", "decision", "was", "to", "attach", "the", "error", "message", "to", "the", "original", "column", "rather", "than", "the", "remote_url", "column", "NUMBER", "If", "the", "error", "be", "attached", "on", "the", "remote_url", "column", "the", "original", "column", "could", "still", "show", "other", "validation", "error", "eg", "NUMBER", "cant", "be", "blank", "w", "validates_presence_of", "NUMBER", "On", "one", "hand", "it", "s", "nice", "to", "see", "the", "error", "on", "the", "field", "that", "cause", "it", "on", "the", "other", "it", "s", "nice", "not", "to", "have", "two", "message", "for", "the", "same", "error", "NUMBER", "Couldn", "t", "decide", "so", "I", "chose", "the", "latter", "NUMBER", "This", "pull", "request", "pass", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "build", "NUMBER", "merge", "NUMBER", "b", "NUMBER", "a", "into", "NUMBER", "e", "NUMBER", "c", "NUMBER", "NUMBER", "Squashed", "all", "the", "commit", "into", "one", "but", "for", "some", "reason", "it", "s", "including", "a", "whole", "bunch", "of", "other", "prior", "commit", "as", "part", "of", "the", "pull", "request", "NUMBER", "Might", "have", "be", "cause", "by", "a", "git", "push", "f", "on", "my", "end", "NUMBER", "Does", "this", "merge", "cleanly", "for", "you", "Hello", "I", "be", "use", "jQuery", "File", "Upload", "together", "with", "Carrierwave", "for", "uploading", "images", "NUMBER", "I", "managed", "to", "make", "it", "work", "by", "following", "this", "manual", "and", "it", "works", "perfectly", "well", "for", "uploading", "single", "images", "but", "once", "I", "add", "HTML", "NUMBER", "multiple", "attribute", "to", "allow", "uploading", "multiple", "images", "at", "once", "and", "select", "multiple", "images", "I", "get", "following", "error", "on", "each", "request", "NUMBER", "NoMethodError", "in", "Advertiser", "MediaController", "create", "undefined", "method", "for", "nil", "NilClass", "Every", "request", "seems", "absolutely", "same", "to", "me", "and", "I", "can", "t", "seem", "to", "figure", "out", "why", "it", "can", "t", "upload", "multiple", "images", "but", "can", "upload", "single", "images", "please", "note", "that", "if", "I", "have", "multiple", "attribute", "enable", "I", "can", "t", "even", "upload", "a", "single", "image", "but", "once", "I", "take", "it", "off", "uploading", "works", "once", "again", "NUMBER", "jQuery", "File", "Upload", "be", "perfectly", "capable", "of", "uploading", "multiple", "images", "and", "you", "can", "check", "it", "out", "in", "their", "demo", "NUMBER", "Any", "hints", "on", "where", "to", "dig", "would", "be", "very", "much", "appreciated", "NUMBER", "Thank", "you", "in", "advance", "NUMBER", "Most", "of", "the", "release", "be", "tag", "but", "release", "v", "NUMBER", "be", "not", "NUMBER", "Some", "of", "the", "release", "be", "tag", "with", "the", "format", "vX", "NUMBER", "Y", "NUMBER", "Z", "but", "most", "be", "tag", "with", "the", "format", "X", "NUMBER", "Y", "NUMBER", "Z", "NUMBER", "All", "release", "should", "be", "tag", "including", "v", "NUMBER", "and", "they", "should", "all", "be", "tag", "in", "the", "same", "format", "conventionally", "vX", "NUMBER", "Y", "NUMBER", "Z", "with", "the", "v", "prefix", "NUMBER", "Thanks", "I", "have", "a", "requirement", "to", "dynamically", "set", "the", "FOG", "bucket", "within", "carrierwave", "based", "on", "the", "logged", "in", "user", "NUMBER", "At", "this", "point", "I", "have", "not", "seen", "a", "way", "to", "do", "this", "and", "wanted", "to", "see", "if", "this", "could", "be", "include", "in", "a", "roadmap", "Consider", "a", "model", "with", "the", "following", "default", "scope", "class", "Task", "TAG", "path", "NUMBER", "public_url", "end", "end", "end", "Is", "there", "any", "reason", "why", "the", "public", "url", "be", "use", "always", "https", "I", "would", "think", "that", "http", "would", "be", "a", "more", "reasonable", "default", "Ok", "cool", "NUMBER", "Just", "wanted", "to", "make", "sure", "that", "there", "wasn", "t", "some", "other", "good", "reason", "for", "use", "https", "over", "http", "that", "I", "was", "not", "aware", "of", "NUMBER", "I", "ll", "fork", "and", "put", "in", "a", "pull", "request", "NUMBER", "As", "a", "side", "note", "what", "was", "really", "confusing", "when", "debugging", "this", "was", "that", "the", "above", "code", "was", "in", "storage", "fog", "NUMBER", "rb", "and", "there", "be", "also", "a", "storage", "s", "NUMBER", "rb", "NUMBER", "In", "s", "NUMBER", "rb", "the", "public_url", "looks", "like", "ruby", "def", "public_url", "scheme", "use_ssl", "https", "http", "if", "cnamed", "scheme", "bucket", "path", "NUMBER", "compact", "NUMBER", "join", "else", "scheme", "bucket", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "path", "NUMBER", "compact", "NUMBER", "join", "end", "end", "So", "apparently", "there", "be", "NUMBER", "implementations", "of", "s", "NUMBER", "storage", "one", "in", "fog", "NUMBER", "rb", "and", "one", "in", "s", "NUMBER", "rb", "NUMBER", "The", "s", "NUMBER", "rb", "implementation", "checks", "for", "the", "config", "option", "s", "NUMBER", "_use_ssl", "whereas", "the", "fog", "NUMBER", "rb", "ignores", "this", "option", "NUMBER", "This", "was", "very", "confusing", "since", "I", "was", "setting", "s", "NUMBER", "_use_ssl", "to", "false", "and", "not", "seeing", "any", "result", "NUMBER", "So", "I", "m", "thinking", "of", "change", "the", "fog", "NUMBER", "rb", "implementation", "to", "also", "check", "s", "NUMBER", "_use_ssl", "NUMBER", "I", "ll", "send", "a", "pull", "request", "when", "ready", "NUMBER", "Hi", "I", "needed", "a", "way", "to", "extract", "the", "cover", "of", "a", "PDF", "as", "a", "separate", "version", "NUMBER", "Unfortunately", "the", "current", "multi", "page", "PDF", "support", "in", "the", "RMagick", "processor", "lets", "you", "either", "generate", "all", "pages", "as", "separate", "images", "or", "one", "vertically", "joined", "image", "NUMBER", "This", "patch", "allows", "you", "to", "accept", "an", "additional", "parameter", "zero", "indexed", "page", "number", "from", "the", "manipulate", "block", "NUMBER", "You", "can", "then", "write", "a", "custom", "processor", "like", "this", "ruby", "def", "cover", "manipulate", "do", "frame", "index", "frame", "if", "index", "NUMBER", "zero", "end", "end", "Single", "page", "PDFs", "and", "regular", "images", "will", "receive", "index", "NUMBER", "and", "exist", "processors", "can", "ignore", "the", "index", "parameter", "NUMBER", "This", "patch", "should", "also", "work", "for", "other", "multi", "frame", "file", "such", "as", "animated", "GIFs", "NUMBER", "I", "have", "a", "rails", "app", "which", "uploads", "some", "images", "to", "S", "NUMBER", "My", "user", "be", "able", "to", "export", "all", "his", "pictures", "to", "a", "zip", "NUMBER", "In", "order", "to", "achieve", "this", "I", "first", "have", "to", "download", "all", "images", "and", "later", "zip", "them", "up", "NUMBER", "When", "I", "run", "this", "routine", "however", "ruby", "photos", "NUMBER", "each", "do", "photo", "path", "photo", "NUMBER", "photo", "NUMBER", "path", "file_path", "zip_path", "path", "FileUtils", "NUMBER", "mkdir_p", "File", "NUMBER", "dirname", "file_path", "File", "NUMBER", "open", "file_path", "wb", "do", "file", "file", "NUMBER", "write", "photo", "NUMBER", "photo", "NUMBER", "file", "NUMBER", "read", "end", "end", "My", "application", "experiences", "an", "incredible", "increase", "in", "memory", "usage", "NUMBER", "Is", "there", "a", "way", "to", "prevent", "this", "Photo", "be", "a", "active", "record", "class", "with", "a", "PhotoUploader", "mounted", "NUMBER", "When", "use", "avatar_cache", "in", "order", "to", "display", "the", "uploaded", "file", "in", "case", "of", "a", "form", "redisplay", "if", "a", "validation", "error", "actually", "occur", "the", "temporary", "file", "be", "display", "correctly", "NUMBER", "After", "the", "form", "be", "submitted", "again", "and", "the", "model", "be", "now", "valid", "and", "gets", "saved", "though", "only", "a", "copy", "of", "the", "original", "file", "be", "saved", "not", "all", "the", "version", "i", "created", "NUMBER", "To", "make", "an", "example", "i", "only", "have", "public", "system", "user", "avatar", "NUMBER", "NUMBER", "_", "NUMBER", "jpg", "while", "I", "would", "expect", "to", "have", "public", "system", "user", "avatar", "NUMBER", "medium_", "NUMBER", "_", "NUMBER", "jpg", "public", "system", "user", "avatar", "NUMBER", "thumb_", "NUMBER", "_", "NUMBER", "jpg", "public", "system", "user", "avatar", "NUMBER", "list_", "NUMBER", "_", "NUMBER", "jpg", "This", "be", "my", "AvatarUploader", "encoding", "utf", "NUMBER", "class", "AvatarUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "thumb", "from_version", "medium", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "list", "from_version", "thumb", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "I", "have", "the", "exact", "same", "problem", "I", "m", "uploading", "images", "as", "nested", "resources", "and", "use", "image_cache", "to", "retain", "uploads", "on", "validation", "error", "on", "the", "parent", "resource", "After", "fix", "validation", "error", "on", "the", "parent", "and", "saving", "I", "end", "up", "with", "no", "version", "although", "the", "nested", "image", "be", "saved", "NUMBER", "I", "also", "noted", "that", "other", "processing", "hooks", "be", "also", "skipped", "eg", "NUMBER", "I", "have", "process", "update_checksum", "def", "update_checksum", "model", "NUMBER", "checksum", "crc", "NUMBER", "end", "And", "this", "code", "be", "not", "call", "if", "the", "image", "be", "instantiated", "from", "image_cache", "crc", "NUMBER", "be", "a", "method", "on", "the", "ImageUploader", "that", "calculates", "crc", "NUMBER", "use", "Zlib", "NUMBER", "I", "m", "use", "carrierwave", "NUMBER", "with", "rails", "NUMBER", "Update", "This", "problem", "be", "fix", "by", "gh", "NUMBER", "This", "issue", "happens", "only", "when", "I", "set", "storage", "fog", "in", "my", "Uploader", "class", "NUMBER", "When", "storage", "file", "be", "set", "everything", "goes", "fine", "NUMBER", "I", "have", "a", "form", "with", "a", "two", "step", "submission", "where", "the", "first", "step", "handles", "the", "image", "upload", "and", "the", "second", "one", "handles", "image", "cropping", "NUMBER", "I", "m", "use", "image_cache", "as", "a", "hidden_field", "in", "my", "form", "in", "order", "to", "achieve", "that", "NUMBER", "I", "also", "set", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "in", "my", "fog", "NUMBER", "rb", "initializer", "to", "see", "what", "s", "going", "on", "with", "the", "temp", "file", "In", "the", "first", "submission", "CW", "caches", "the", "file", "in", "the", "following", "directories", "NUMBER", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "medium_IMG", "NUMBER", "JPG", "NUMBER", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "IMG", "NUMBER", "JPG", "But", "in", "the", "second", "submission", "it", "try", "to", "get", "the", "medium_IMG", "NUMBER", "JPG", "file", "from", "the", "wrong", "directory", "please", "see", "full", "trace", "below", "NUMBER", "Actually", "when", "storage", "file", "be", "set", "CW", "caches", "another", "two", "file", "because", "of", "the", "second", "step", "form", "submission", "and", "everything", "works", "NUMBER", "But", "with", "storage", "fog", "CW", "doesn", "t", "cache", "the", "file", "again", "NUMBER", "Errno", "ENOENT", "in", "AvatarsController", "update", "No", "such", "file", "or", "directory", "NUMBER", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "medium_IMG", "NUMBER", "JPG", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "initialize", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "open", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "read", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store_versions", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "each", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "store_versions", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_callbacks", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "each", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_image", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__save__", "NUMBER", "__callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "__run_callback", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "in", "create_or_update", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "rollback_active_record_state", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "save", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "block", "in", "update_attributes", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "update_attributes", "app", "controllers", "avatars_controller", "NUMBER", "rb", "NUMBER", "in", "update", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "in", "send_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__process_action__", "NUMBER", "__callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "__run_callback", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_process_action_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "params_wrapper", "NUMBER", "rb", "NUMBER", "in", "process_action", "activerecord", "NUMBER", "lib", "active_record", "railties", "controller_runtime", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "block", "in", "action", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "journey", "NUMBER", "lib", "journey", "router", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "journey", "NUMBER", "lib", "journey", "router", "NUMBER", "rb", "NUMBER", "in", "each", "journey", "NUMBER", "lib", "journey", "router", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "catch", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "etag", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "conditionalget", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "session", "abstract", "id", "NUMBER", "rb", "NUMBER", "in", "context", "rack", "NUMBER", "lib", "rack", "session", "abstract", "id", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "in", "call", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "call", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection_pool", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__call__", "NUMBER", "__callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "__run_callback", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_call_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "reloader", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "debug_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call_app", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "request_id", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "home", "rafael", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "home", "rafael", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "home", "rafael", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "Parameters", "utf", "NUMBER", "_method", "put", "authenticity_token", "GOWxcQqMOvkPyyZNU", "NUMBER", "xF", "Fx", "NUMBER", "TMIHXU", "NUMBER", "TgGCvjPpJ", "NUMBER", "eg", "avatar", "image_cache", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "IMG", "NUMBER", "JPG", "crop_x", "NUMBER", "crop_y", "NUMBER", "crop_w", "NUMBER", "crop_h", "NUMBER", "commit", "Update", "locale", "en", "user_id", "NUMBER", "app", "uploaders", "image_uploader", "NUMBER", "rb", "ruby", "class", "ImageUploader", "TAG", "NUMBER", "nil", "def", "scale", "width", "height", "resize_to_limit", "width", "height", "if", "model", "NUMBER", "valid", "end", "version", "medium", "do", "process", "crop", "resize_to_fill", "NUMBER", "NUMBER", "end", "def", "crop", "if", "model", "NUMBER", "crop_x", "NUMBER", "present", "resize_to_limit", "NUMBER", "nil", "manipulate", "do", "img", "x", "model", "NUMBER", "crop_x", "NUMBER", "to_i", "y", "model", "NUMBER", "crop_y", "NUMBER", "to_i", "w", "model", "NUMBER", "crop_w", "NUMBER", "to_i", "h", "model", "NUMBER", "crop_h", "NUMBER", "to_i", "img", "NUMBER", "crop", "x", "y", "w", "h", "end", "end", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "app", "models", "avatar", "NUMBER", "rb", "ruby", "class", "Avatar", "TAG", "true", "attr_accessor", "crop_x", "crop_y", "crop_w", "crop_h", "after_save", "crop_image", "def", "crop_image", "image", "NUMBER", "recreate_versions", "if", "crop_x", "NUMBER", "present", "end", "end", "I", "tried", "to", "investigate", "further", "but", "I", "m", "not", "too", "experienced", "with", "Rails", "Ruby", "NUMBER", "I", "ve", "get", "this", "exact", "same", "issue", "NUMBER", "I", "m", "trying", "out", "master", "right", "now", "to", "see", "if", "it", "works", "NUMBER", "Yep", "that", "worked", "NUMBER", "I", "digged", "in", "the", "code", "and", "figured", "out", "a", "solution", "NUMBER", "The", "code", "above", "be", "a", "simplified", "version", "of", "the", "one", "I", "m", "work", "on", "which", "generates", "version", "conditionally", "when", "the", "second", "submission", "occur", "use", "recreate_versions", "NUMBER", "I", "guess", "this", "be", "relate", "to", "NUMBER", "So", "I", "applied", "two", "modifications", "regard", "NUMBER", "store", "in", "Fog", "class", "try", "to", "store", "file", "that", "be", "not", "cached", "that", "s", "why", "I", "was", "get", "the", "Errno", "ENOENT", "error", "NUMBER", "cache_stored_file", "may", "raise", "TypeError", "Exception", "can", "t", "convert", "File", "into", "String", "if", "storage", "be", "set", "to", "Fog", "As", "I", "m", "not", "much", "experienced", "I", "don", "t", "feel", "comfortable", "to", "evaluate", "if", "this", "solution", "be", "reasonable", "probably", "be", "not", "an", "elegant", "one", "but", "it", "seems", "to", "work", "here", "NUMBER", "I", "will", "let", "the", "issue", "opened", "if", "someone", "would", "like", "to", "comment", "something", "NUMBER", "ruby", "module", "CarrierWave", "module", "Storage", "class", "Fog", "TAG", "NUMBER", "f", "end", "end", "end", "module", "Uploader", "module", "Cache", "def", "cache_stored_file", "opened_file", "file", "NUMBER", "read", "NUMBER", "is_a", "String", "file", "File", "NUMBER", "open", "file", "NUMBER", "read", "sanitized", "SanitizedFile", "NUMBER", "new", "tempfile", "StringIO", "NUMBER", "new", "opened_file", "NUMBER", "read", "filename", "File", "NUMBER", "basename", "path", "content_type", "file", "NUMBER", "content_type", "cache", "sanitized", "end", "end", "end", "end", "bensie", "you", "were", "pretty", "fast", "handle", "the", "issue", "lol", "NUMBER", "didn", "t", "worked", "for", "me", "maybe", "because", "of", "my", "conditional", "version", "NUMBER", "But", "thanks", "anyway", "I", "had", "a", "similar", "issue", "with", "model", "validation", "error", "fog", "storage", "and", "the", "cache", "file", "NUMBER", "With", "the", "recent", "gem", "update", "things", "seem", "to", "be", "work", "ok", "even", "after", "a", "validation", "error", "NUMBER", "However", "some", "process", "methods", "weren", "t", "be", "call", "reprocessed", "NUMBER", "Had", "to", "do", "the", "following", "to", "reprocess", "things", "after", "a", "validation", "error", "and", "when", "the", "file", "be", "already", "cached", "after", "retrieve_from_cache", "do_something_to_model", "I", "recently", "run", "into", "a", "problem", "when", "trying", "to", "add", "both", "Carrierwave", "LINK", "and", "Tire", "LINK", "to", "one", "of", "my", "models", "NUMBER", "The", "problem", "seems", "to", "be", "cause", "by", "the", "serializable_hash", "method", "which", "be", "use", "by", "both", "gems", "NUMBER", "I", "have", "include", "a", "link", "to", "the", "relate", "SO", "post", "LINK", "tire", "conflicting", "It", "s", "worth", "to", "be", "mention", "what", "that", "bug", "makes", "impossible", "to", "retrieve", "cached", "version", "if", "instance", "saving", "fail", "NUMBER", "NUMBER", "This", "fix", "the", "problem", "for", "me", "NUMBER", "NUMBER", "Please", "pull", "this", "change", "version", "NUMBER", "x", "be", "broken", "pretty", "badly", "without", "it", "IMO", "If", "there", "s", "a", "plus", "in", "say", "an", "S", "NUMBER", "sign", "request", "generate", "by", "fog", "and", "it", "gets", "unescaped", "you", "ll", "get", "a", "NUMBER", "when", "you", "try", "and", "hit", "it", "NUMBER", "I", "was", "get", "similar", "symptoms", "to", "NUMBER", "whenever", "my", "sign", "request", "to", "S", "NUMBER", "had", "a", "plus", "in", "them", "this", "fix", "that", "NUMBER", "I", "d", "like", "to", "make", "sure", "it", "doesn", "t", "break", "urls", "for", "folks", "if", "there", "s", "a", "plus", "in", "the", "non", "params", "NUMBER", "Another", "possibility", "and", "one", "that", "I", "m", "actually", "doing", "on", "my", "side", "of", "things", "be", "to", "get", "smarter", "about", "how", "params", "be", "handle", "in", "a", "remote_url", "NUMBER", "I", "m", "having", "to", "explicitly", "strip", "off", "params", "in", "my", "fork", "of", "carrierwave_direct", "LINK", "_direct", "blob", "c", "NUMBER", "c", "NUMBER", "a", "NUMBER", "f", "NUMBER", "adffa", "NUMBER", "b", "NUMBER", "d", "NUMBER", "fa", "NUMBER", "c", "NUMBER", "e", "NUMBER", "lib", "carrierwave_direct", "uploader", "NUMBER", "rb", "L", "NUMBER", "otherwise", "my", "generate", "version", "have", "the", "params", "include", "in", "their", "name", "NUMBER", "This", "be", "on", "my", "list", "of", "things", "to", "investigate", "post", "launch", "whether", "this", "be", "cw", "direct", "or", "cw", "s", "responsibility", "NUMBER", "Thanks", "Not", "sure", "which", "version", "of", "carrierwave", "makes", "these", "instructions", "obsolete", "otherwise", "I", "would", "edit", "this", "wiki", "page", "myself", "but", "with", "the", "latest", "version", "of", "carrierwave", "NUMBER", "you", "can", "simply", "call", "recreate_versions", "just", "like", "with", "non", "fog", "storage", "NUMBER", "LINK", "to", "NUMBER", "A", "Recreate", "and", "reprocess", "your", "file", "stored", "on", "fog", "Can", "we", "add", "a", "note", "saying", "for", "carrierwave", "version", "NUMBER", "X", "and", "lower", "After", "use", "NUMBER", "successfully", "and", "run", "bundle", "update", "I", "now", "get", "this", "NUMBER", "error", "after", "deploy", "Installed", "New", "Relic", "Browser", "Monitoring", "middleware", "data", "foobackend", "release", "NUMBER", "config", "initializers", "carrierwave", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "undefined", "method", "s", "NUMBER", "_access_key_id", "for", "CarrierWave", "Uploader", "Base", "Class", "NoMethodError", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "configuration", "NUMBER", "rb", "NUMBER", "in", "configure", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "NUMBER", "rb", "NUMBER", "in", "configure", "from", "data", "foobackend", "release", "NUMBER", "config", "initializers", "carrierwave", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "load", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load_dependency", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "TAG", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "each", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "instance_exec", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "run", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run_initializers", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "each", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "run_initializers", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "railtie", "configurable", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "data", "foobackend", "release", "NUMBER", "config", "environment", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "require", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "require", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load_dependency", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "require", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "require_environment", "from", "data", "foobackend", "shared", "bundled_gems", "ruby", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "I", "be", "use", "Fog", "NUMBER", "Here", "be", "my", "carrierwave", "NUMBER", "rb", "file", "CarrierWave", "NUMBER", "configure", "do", "config", "S", "NUMBER", "doesn", "t", "allow", "for", "or", "NUMBER", "CarrierWave", "SanitizedFile", "NUMBER", "sanitize_regexp", "word", "NUMBER", "config", "NUMBER", "root", "Rails", "NUMBER", "root", "NUMBER", "join", "tmp", "config", "NUMBER", "cache_dir", "carrierwave", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "ENV", "XXXXXXX", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "ENV", "XXXXXXX", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "XXXXXXXXX", "aws_secret_access_key", "XXXXXX", "region", "eu", "west", "NUMBER", "if", "Rails", "NUMBER", "env", "NUMBER", "production", "config", "NUMBER", "s", "NUMBER", "_bucket", "ENV", "foo", "production", "config", "NUMBER", "fog_directory", "foo", "production", "elsif", "Rails", "NUMBER", "env", "NUMBER", "aging", "config", "NUMBER", "s", "NUMBER", "_bucket", "ENV", "foo", "staging", "config", "NUMBER", "fog_directory", "foo", "staging", "else", "config", "NUMBER", "s", "NUMBER", "_bucket", "ENV", "foo", "development", "config", "NUMBER", "fog_directory", "foo", "development", "end", "end", "Thanks", "very", "much", "TAG", "Loading", "development", "environment", "Rails", "NUMBER", "ProductImageUploader", "NUMBER", "new", "NUMBER", "recreate_versions", "NoMethodError", "undefined", "method", "read", "for", "nil", "NilClass", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache_stored_file", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "recreate_versions", "from", "irb", "NUMBER", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "Product", "NUMBER", "all", "NUMBER", "each", "p", "p", "NUMBER", "image", "NUMBER", "recreate_versions", "Product", "Load", "NUMBER", "ms", "SELECT", "products", "NUMBER", "FROM", "products", "ORDER", "BY", "products", "NUMBER", "name", "NoMethodError", "undefined", "method", "read", "for", "nil", "NilClass", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache_stored_file", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "recreate_versions", "from", "irb", "NUMBER", "in", "block", "in", "irb_binding", "from", "irb", "NUMBER", "in", "each", "from", "irb", "NUMBER", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "sekrett", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "perf", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "TAG", "The", "same", "error", "even", "without", "paperclip", "compatibility", "NUMBER", "Yes", "you", "be", "right", "NUMBER", "But", "I", "wonder", "why", "the", "first", "way", "to", "recreate", "version", "do", "not", "work", "NUMBER", "It", "be", "easy", "to", "add", "return", "if", "file", "NUMBER", "nil", "Ok", "but", "please", "explain", "how", "one", "could", "test", "against", "nil", "in", "this", "piece", "of", "code", "TAG", "instance", "MyUploader", "NUMBER", "new", "instance", "NUMBER", "recreate_versions", "TAG", "It", "be", "from", "your", "documentation", "NUMBER", "I", "will", "never", "understand", "that", "NUMBER", "If", "documentation", "be", "not", "how", "you", "do", "it", "then", "what", "s", "the", "use", "of", "mentioning", "that", "I", "don", "t", "see", "below", "in", "readme", "what", "you", "say", "NUMBER", "Very", "mystic", "thing", "NUMBER", "There", "be", "a", "word", "or", "which", "means", "both", "ways", "should", "be", "good", "but", "the", "first", "be", "not", "what", "I", "should", "do", "the", "second", "needs", "patching", "to", "work", "NUMBER", "You", "refuse", "to", "patch", "the", "plugin", "or", "to", "correct", "the", "readme", "NUMBER", "Impossible", "to", "understand", "for", "me", "NUMBER", "Now", "I", "know", "how", "to", "deal", "with", "this", "but", "other", "people", "should", "read", "this", "close", "issue", "to", "understand", "I", "see", "another", "solution", "NUMBER", "Since", "methods", "with", "bang", "should", "raise", "exception", "on", "failure", "the", "behavior", "be", "correct", "NUMBER", "Maybe", "it", "would", "be", "nice", "to", "add", "recreate_version", "without", "bang", "which", "returns", "true", "false", "NUMBER", "In", "case", "one", "do", "not", "care", "he", "can", "use", "this", "approach", "instead", "NUMBER", "And", "only", "after", "that", "some", "additions", "to", "readme", "would", "be", "nice", "NUMBER", "What", "do", "you", "think", "about", "this", "I", "could", "write", "a", "pull", "request", "next", "week", "NUMBER", "This", "fix", "a", "bug", "I", "hit", "use", "Tire", "which", "also", "makes", "use", "of", "serializable_hash", "Specifically", "the", "current", "implementation", "breaks", "if", "we", "call", "record", "NUMBER", "serializable_hash", "I", "have", "also", "rewritten", "the", "method", "to", "function", "more", "like", "ActiveRecord", "s", "implementation", "NUMBER", "Namely", "it", "now", "uses", "Array", "NUMBER", "wrap", "and", "change", "everything", "to", "strings", "NUMBER", "ha", "all", "these", "test", "fail", "without", "it", "NUMBER", "Firstly", "if", "there", "be", "no", "options", "provide", "it", "will", "fail", "Secondly", "if", "the", "option", "be", "not", "provide", "as", "an", "array", "it", "will", "also", "fail", "I", "have", "this", "Domain", "Name", "point", "to", "s", "NUMBER", "bucket", "da", "NUMBER", "ii", "NUMBER", "cvf", "NUMBER", "u", "NUMBER", "cloudfront", "NUMBER", "net", "with", "NUMBER", "CNAMES", "pinscdn", "NUMBER", "pintureka", "NUMBER", "com", "pinscdn", "NUMBER", "pintureka", "NUMBER", "com", "pinscdn", "NUMBER", "pintureka", "NUMBER", "com", "pinscdn", "NUMBER", "pintureka", "NUMBER", "com", "and", "my", "image", "work", "fine", "if", "I", "write", "LINK", "_dc", "NUMBER", "accba", "ed", "NUMBER", "d", "NUMBER", "a", "NUMBER", "f", "NUMBER", "a", "NUMBER", "e", "NUMBER", "e", "NUMBER", "da", "NUMBER", "dcdd", "NUMBER", "jpg", "and", "if", "I", "write", "LINK", "pro", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "uploads", "pins", "medium_dc", "NUMBER", "accba", "ed", "NUMBER", "d", "NUMBER", "a", "NUMBER", "f", "NUMBER", "a", "NUMBER", "e", "NUMBER", "e", "NUMBER", "da", "NUMBER", "dcdd", "NUMBER", "jpg", "but", "the", "image", "be", "not", "find", "fine", "if", "I", "write", "LINK", "_dc", "NUMBER", "accba", "ed", "NUMBER", "d", "NUMBER", "a", "NUMBER", "f", "NUMBER", "a", "NUMBER", "e", "NUMBER", "e", "NUMBER", "da", "NUMBER", "dcdd", "NUMBER", "jpg", "My", "cnames", "work", "fine", "with", "assets", "in", "production", "mode", "you", "can", "see", "e", "NUMBER", "g", "NUMBER", "my", "js", "asset", "LINK", "NUMBER", "efb", "NUMBER", "ccac", "NUMBER", "b", "NUMBER", "bbdcd", "NUMBER", "js", "Why", "do", "not", "works", "fine", "my", "CNAMES", "with", "carrierwave", "Thank", "you", "for", "me", "its", "the", "same", "result", "with", "fog_public", "false", "that", "fog_public", "true", "NUMBER", "You", "can", "see", "the", "problem", "in", "LINK", "not", "work", "for", "me", "with", "config", "fog", "public", "true", "with", "carrierwave", "I", "don", "t", "know", "how", "fix", "this", "problem", "Hi", "Rails", "NUMBER", "carrierwave", "NUMBER", "fog", "NUMBER", "Everything", "works", "fine", "with", "local", "storage", "and", "S", "NUMBER", "with", "config", "NUMBER", "fog_public", "true", "as", "soon", "as", "I", "set", "config", "NUMBER", "fog_public", "false", "I", "get", "this", "on", "the", "view", "display", "ArgumentError", "wrong", "number", "of", "argument", "NUMBER", "for", "NUMBER", "This", "be", "in", "my", "view", "TAG", "User", "has_one", "Profile", "field", "be", "picture", "Uploader", "class", "PictureUploader", "TAG", "NUMBER", "NUMBER", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "initializer", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "xxx", "required", "aws_secret_access_key", "yyy", "required", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "attachprod", "required", "config", "NUMBER", "fog_public", "false", "optional", "defaults", "to", "true", "end", "Now", "I", "have", "be", "able", "to", "fix", "this", "by", "change", "line", "NUMBER", "in", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "file", "NUMBER", "rb", "to", "def", "url", "expires", "x", "instead", "of", "def", "url", "expires", "but", "that", "seems", "weird", "and", "not", "sure", "if", "that", "will", "break", "something", "else", "it", "appears", "to", "work", "fine", "now", "NUMBER", "Here", "s", "my", "full", "stack", "of", "the", "error", "ArgumentError", "wrong", "number", "of", "argument", "NUMBER", "for", "NUMBER", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "file", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "authenticated_url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "default_url", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "to_s", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "boudewijnvandongen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "This", "a", "bug", "in", "Fog", "or", "be", "I", "doing", "something", "wrong", "many", "thanks", "Thanks", "upgrading", "Fog", "solve", "the", "issue", "NUMBER", "On", "NUMBER", "April", "NUMBER", "NUMBER", "NUMBER", "James", "Miller", "TAG", "write", "I", "ve", "add", "note", "to", "the", "Readme", "that", "specify", "the", "Fog", "version", "requirement", "df", "NUMBER", "b", "NUMBER", "af", "NUMBER", "e", "NUMBER", "eb", "NUMBER", "dca", "NUMBER", "a", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "I", "haven", "t", "be", "able", "to", "isolate", "this", "precisely", "but", "performing", "an", "update", "from", "NUMBER", "NUMBER", "gives", "unexplained", "error", "in", "my", "factories", "NUMBER", "The", "code", "works", "fine", "but", "the", "factories", "break", "NUMBER", "Anyone", "experience", "something", "similar", "I", "can", "build", "a", "new", "project", "and", "try", "to", "recreate", "it", "NUMBER", "hmm", "I", "ve", "tried", "creating", "a", "sample", "app", "no", "problem", "NUMBER", "Will", "have", "to", "experiment", "some", "more", "work", "out", "the", "problem", "NUMBER", "ok", "I", "ve", "find", "the", "real", "issue", "NUMBER", "it", "be", "with", "serializable_hash", "will", "post", "a", "new", "issue", "in", "a", "minute", "the", "issue", "be", "come", "just", "push", "my", "fix", "NUMBER", "I", "be", "run", "ruby", "NUMBER", "via", "rvm", "Rails", "NUMBER", "and", "carrierwave", "gem", "rmagick", "and", "for", "this", "code", "version", "thumb", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "I", "get", "this", "error", "Users", "vestimir", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "resize_to_fit", "Users", "vestimir", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "manipulate", "Users", "vestimir", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "in", "read", "C", "level", "backtrace", "information", "NOTE", "You", "may", "have", "encountered", "a", "bug", "in", "the", "Ruby", "interpreter", "or", "extension", "libraries", "NUMBER", "Bug", "report", "be", "welcome", "NUMBER", "For", "details", "LINK", "lang", "NUMBER", "org", "bugreport", "NUMBER", "html", "Abort", "trap", "NUMBER", "Then", "the", "server", "be", "shut", "down", "and", "image", "be", "not", "resized", "NUMBER", "Installed", "imagick", "via", "homebrew", "and", "it", "s", "work", "fine", "from", "the", "console", "NUMBER", "reinstalling", "imagemagick", "on", "mac", "os", "x", "with", "this", "line", "brew", "install", "f", "imagemagick", "disable", "openmp", "fix", "the", "problem", "I", "be", "seeing", "a", "recent", "deploy", "of", "NUMBER", "on", "heroku", "completely", "blow", "up", "when", "bundler", "try", "to", "install", "it", "NUMBER", "Tons", "of", "error", "due", "to", "gemspec", "NUMBER", "Not", "sure", "what", "be", "wrong", "there", "but", "downgrading", "to", "NUMBER", "and", "everything", "worked", "perfect", "NUMBER", "Is", "there", "an", "issue", "with", "the", "NUMBER", "version", "I", "see", "nothing", "here", "about", "it", "NUMBER", "just", "wondering", "what", "that", "might", "be", "from", "cause", "by", "NUMBER", "Please", "provide", "more", "details", "for", "example", "the", "error", "you", "see", "NUMBER", "Here", "be", "a", "gist", "with", "some", "of", "the", "log", "results", "NUMBER", "LINK", "I", "too", "be", "seeing", "problem", "though", "my", "app", "isn", "t", "on", "Heroku", "NUMBER", "Getting", "the", "following", "output", "when", "run", "the", "precompile", "rake", "task", "on", "deploy", "LINK", "Sorry", "NUMBER", "I", "have", "not", "use", "REE", "in", "a", "long", "time", "NUMBER", "I", "do", "use", "NUMBER", "and", "on", "occasion", "NUMBER", "I", "just", "update", "to", "NUMBER", "for", "rubygems", "NUMBER", "will", "see", "what", "happens", "NUMBER", "Bamboo", "MRI", "NUMBER", "Just", "submitted", "pr", "NUMBER", "to", "fix", "this", "NUMBER", "Hopefully", "fix", "by", "LINK", "I", "ve", "test", "this", "with", "my", "fork", "on", "github", "and", "rubygems", "NUMBER", "and", "after", "that", "the", "generate", "gemspec", "looked", "fine", "NUMBER", "Any", "chance", "of", "provide", "some", "context", "and", "test", "here", "I", "m", "not", "sure", "what", "this", "be", "trying", "to", "accomplish", "NUMBER", "i", "m", "use", "ruby", "NUMBER", "p", "NUMBER", "Rails", "NUMBER", "rspec", "NUMBER", "and", "carrierwave", "NUMBER", "My", "test", "looks", "like", "this", "it", "should", "make", "the", "image", "readable", "only", "to", "the", "owner", "and", "not", "executable", "do", "uploader", "NUMBER", "should", "have_permissions", "NUMBER", "end", "when", "file", "premissions", "be", "not", "NUMBER", "expected", "rspec", "error", "message", "be", "expected", "path", "to", "file", "to", "have", "permissions", "NUMBER", "but", "they", "were", "NUMBER", "but", "it", "fail", "with", "error", "TypeError", "can", "t", "convert", "nil", "into", "String", "If", "you", "look", "into", "lib", "carrierwave", "test", "matchers", "NUMBER", "rb", "you", "can", "notice", "that", "method", "failure_message", "in", "all", "classes", "except", "HavePermissions", "uses", "actual", "NUMBER", "current_path", "NUMBER", "inspect", "for", "retriving", "filename", "and", "in", "HavePermissions", "class", "method", "looks", "like", "def", "failure_message", "expected", "actual", "NUMBER", "inspect", "to", "have", "permissions", "expected", "NUMBER", "to_s", "NUMBER", "but", "they", "were", "File", "NUMBER", "at", "actual", "NUMBER", "path", "NUMBER", "mode", "NUMBER", "NUMBER", "to_s", "NUMBER", "end", "actual", "NUMBER", "inspect", "raises", "this", "error", "and", "should", "be", "fix", "Thanks", "syzspectroom", "love", "that", "avatar", "BTW", "Hello", "I", "don", "t", "know", "if", "this", "be", "the", "right", "place", "but", "I", "have", "a", "suggestion", "Allow", "Base", "NUMBER", "encoded", "strings", "for", "uploads", "NUMBER", "This", "feature", "alone", "would", "open", "up", "whole", "new", "doors", "for", "Carrierwave", "as", "it", "would", "allow", "for", "easy", "API", "support", "NUMBER", "For", "instance", "a", "simple", "POST", "request", "could", "be", "made", "with", "a", "JSON", "body", "that", "Carrierwave", "would", "then", "convert", "whatever", "field", "be", "designated", "as", "the", "Uploader", "back", "into", "the", "file", "and", "then", "continue", "processing", "it", "NUMBER", "I", "ve", "be", "trying", "to", "hack", "my", "way", "through", "add", "this", "feature", "to", "my", "API", "but", "haven", "t", "really", "made", "any", "progress", "so", "I", "thought", "I", "would", "suggest", "it", "as", "I", "m", "sure", "others", "have", "tried", "to", "do", "it", "as", "well", "NUMBER", "Thanks", "I", "m", "use", "LINK", "File", "Upload", "with", "carrierwave", "NUMBER", "Determining", "file", "sizes", "on", "S", "NUMBER", "via", "fog", "be", "really", "slow", "NUMBER", "It", "seems", "to", "be", "proportionate", "to", "the", "size", "of", "the", "file", "NUMBER", "For", "example", "determining", "that", "a", "file", "be", "NUMBER", "MB", "can", "take", "the", "page", "NUMBER", "or", "NUMBER", "seconds", "to", "render", "while", "a", "NUMBER", "KB", "will", "be", "pretty", "quick", "NUMBER", "When", "I", "use", "storage", "s", "NUMBER", "directly", "the", "file", "size", "didn", "t", "slow", "render", "speed", "at", "all", "NUMBER", "Any", "ideas", "about", "this", "one", "geemus", "trevorturk", "not", "sure", "off", "hand", "could", "use", "a", "bit", "more", "info", "context", "NUMBER", "cyrusstoller", "what", "method", "or", "methods", "be", "you", "use", "to", "do", "the", "size", "lookup", "A", "gist", "or", "paste", "of", "a", "short", "example", "could", "help", "a", "lot", "toward", "track", "this", "down", "NUMBER", "Thanks", "I", "have", "a", "DataFile", "model", "with", "a", "FileUploader", "NUMBER", "Sorry", "I", "should", "have", "include", "this", "earlier", "NUMBER", "Thanks", "for", "looking", "into", "this", "NUMBER", "TAG", "TAG", "TAG", "TAG", "filename", "TAG", "TAG", "size", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "_blank", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "None", "have", "be", "add", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "cyrusstoller", "thanks", "for", "the", "extra", "info", "NUMBER", "Not", "having", "much", "luck", "figuring", "out", "the", "problem", "though", "NUMBER", "Carrierwave", "appears", "to", "be", "use", "content_length", "which", "should", "be", "available", "without", "needing", "to", "pull", "the", "actual", "body", "as", "you", "can", "see", "here", "LINK", "L", "NUMBER", "Is", "the", "performance", "different", "if", "you", "leave", "the", "rest", "but", "omit", "the", "d", "NUMBER", "file", "NUMBER", "size", "line", "I", "m", "wondering", "if", "it", "be", "that", "specifically", "or", "if", "it", "be", "actually", "part", "of", "a", "larger", "issue", "somehow", "NUMBER", "Thanks", "geemus", "I", "only", "notice", "the", "issue", "after", "uploading", "a", "NUMBER", "MB", "file", "NUMBER", "I", "m", "wondering", "whether", "Rails", "be", "downloading", "the", "file", "into", "the", "cache", "or", "something", "before", "report", "the", "file", "size", "because", "I", "don", "t", "see", "see", "content_length", "as", "a", "field", "in", "my", "DataFile", "model", "NUMBER", "When", "I", "get", "rid", "of", "the", "d", "NUMBER", "file", "NUMBER", "size", "line", "I", "don", "t", "experience", "any", "slow", "down", "NUMBER", "In", "case", "this", "helps", "I", "m", "run", "carrierwave", "NUMBER", "and", "fog", "NUMBER", "cyrusstoller", "interesting", "thanks", "for", "the", "info", "NUMBER", "I", "think", "I", "might", "have", "some", "insight", "into", "a", "fix", "from", "that", "NUMBER", "trevorturk", "I", "suspect", "that", "LINK", "L", "NUMBER", "the", "get", "could", "should", "be", "change", "to", "head", "NUMBER", "If", "you", "want", "the", "actual", "body", "back", "it", "will", "require", "an", "extra", "request", "that", "way", "but", "I", "think", "most", "people", "be", "going", "to", "be", "accessing", "via", "url", "so", "that", "use", "head", "which", "be", "faster", "to", "just", "get", "the", "url", "and", "stuff", "would", "be", "better", "NUMBER", "I", "didn", "t", "have", "much", "luck", "get", "a", "setup", "on", "my", "machine", "where", "I", "could", "get", "the", "exist", "test", "suite", "passing", "though", "let", "alone", "one", "with", "change", "NUMBER", "Mind", "taking", "that", "change", "and", "trying", "it", "out", "Thanks", "bensie", "do", "thanks", "for", "the", "reminder", "NUMBER", "trevorturk", "make", "the", "change", "I", "mention", "above", "should", "speed", "it", "up", "I", "believe", "and", "all", "test", "pass", "with", "it", "NUMBER", "I", "m", "not", "sure", "if", "the", "coverage", "be", "complete", "though", "in", "the", "test", "and", "I", "m", "not", "actively", "use", "carrierwave", "so", "I", "m", "reticent", "to", "try", "this", "change", "on", "my", "own", "NUMBER", "Could", "you", "help", "me", "figure", "out", "how", "to", "make", "sure", "that", "this", "change", "wouldn", "t", "have", "more", "far", "reaching", "impact", "Thanks", "bensie", "ditto", "Hmm", "confusing", "Sorry", "about", "that", "I", "push", "a", "fix", "but", "it", "be", "on", "the", "fog", "head", "branch", "not", "master", "NUMBER", "So", "it", "isn", "t", "really", "close", "yet", "NUMBER", "I", "wanted", "to", "leave", "it", "there", "so", "you", "guys", "could", "check", "it", "out", "NUMBER", "I", "m", "going", "to", "release", "fog", "and", "bump", "the", "dep", "here", "now", "so", "that", "you", "can", "have", "passing", "specs", "NUMBER", "I", "m", "get", "SSL", "Error", "when", "try", "to", "access", "S", "NUMBER", "hosted", "file", "NUMBER", "Chrome", "This", "be", "probably", "not", "the", "site", "you", "be", "looking", "for", "Firefox", "This", "Connection", "be", "Untrusted", "My", "carrierwave", "initializer", "has", "region", "sa", "east", "NUMBER", "S\u00e3o", "Paulo", "Brazil", "NUMBER", "I", "notice", "my", "bucket", "name", "be", "in", "subdomain", "on", "the", "url", "created", "by", "carrierwave", "NUMBER", "LINK", "The", "AWS", "Management", "Console", "shows", "me", "the", "following", "url", "to", "my", "file", "NUMBER", "LINK", "sa", "east", "NUMBER", "amazonaws", "NUMBER", "com", "my", "NUMBER", "bucket", "NUMBER", "name", "path", "to", "my", "file", "NUMBER", "xxx", "bensie", "I", "went", "back", "and", "forth", "relate", "to", "this", "with", "some", "people", "prior", "to", "the", "last", "release", "NUMBER", "You", "be", "correct", "about", "the", "certificate", "I", "believe", "but", "LINK", "sa", "east", "NUMBER", "amazonaws", "NUMBER", "com", "also", "doesn", "t", "match", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "NUMBER", "I", "think", "if", "you", "use", "the", "the", "path", "version", "it", "just", "redirects", "to", "this", "version", "NUMBER", "Unless", "I", "just", "misunderstood", "something", "there", "didn", "t", "seem", "to", "be", "a", "good", "way", "to", "actually", "get", "this", "work", "on", "non", "default", "regions", "NUMBER", "It", "be", "certainly", "possible", "that", "I", "misunderstood", "though", "NUMBER", "bensie", "I", "replace", "the", "dots", "by", "hyphens", "and", "work", "fine", "NUMBER", "Thanks", "bensie", "hmm", "NUMBER", "Do", "you", "know", "what", "you", "be", "supposed", "to", "do", "with", "buckets", "that", "have", "dots", "then", "Like", "I", "said", "I", "don", "t", "think", "path", "style", "will", "work", "outside", "us", "east", "NUMBER", "Just", "tell", "people", "not", "to", "do", "it", "bensie", "thanks", "for", "the", "info", "I", "ll", "keep", "that", "in", "mind", "in", "case", "it", "comes", "up", "again", "over", "on", "fog", "NUMBER", "The", "eval", "d", "serializable_hash", "that", "be", "injected", "in", "the", "ActiveRecord", "ORM", "adapter", "ignores", "any", "options", "that", "be", "pass", "NUMBER", "There", "can", "be", "a", "significant", "penalty", "in", "serialization", "if", "you", "aren", "t", "ask", "for", "the", "mounted", "uploader", "and", "you", "have", "multiple", "version", "stored", "in", "a", "private", "bucket", "on", "S", "NUMBER", "like", "we", "do", "NUMBER", "ruby", "def", "serializable_hash", "options", "nil", "hash", "self", "NUMBER", "class", "NUMBER", "uploaders", "NUMBER", "each", "do", "column", "uploader", "hash", "column", "NUMBER", "to_s", "_mounter", "column", "NUMBER", "uploader", "NUMBER", "serializable_hash", "end", "super", "options", "NUMBER", "merge", "hash", "end", "I", "don", "t", "have", "MySQL", "install", "but", "will", "look", "into", "supplying", "a", "patch", "when", "I", "can", "NUMBER", "Say", "you", "have", "a", "user", "model", "that", "has", "an", "email", "column", "and", "a", "mounted", "avatar", "ruby", "class", "User", "TAG", "url", "assets", "avatar_default", "NUMBER", "png", "email", "NUMBER", "Since", "I", "update", "fog", "to", "NUMBER", "I", "can", "t", "access", "to", "my", "upload", "file", "with", "carrierwave", "NUMBER", "Images", "be", "upload", "on", "S", "NUMBER", "but", "i", "can", "t", "asses", "with", "url", "AWSAccessKeyId", "and", "signature", "url", "sample", "LINK", "upload", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "uploads", "picture", "image", "NUMBER", "TinyGrab_Screen_Shot_", "NUMBER", "NUMBER", "NUMBER", "_", "NUMBER", "jpg", "AWSAccessKeyId", "AKIAJD", "NUMBER", "FPWEX", "NUMBER", "NI", "NUMBER", "HJ", "NUMBER", "Q", "Signature", "NUMBER", "CwjLUPqd", "NUMBER", "nG", "NUMBER", "q", "NUMBER", "s", "NUMBER", "yo", "NUMBER", "BiipzPjw", "NUMBER", "D", "Expires", "NUMBER", "return", "code", "TAG", "SignatureDoesNotMatch", "TAG", "TAG", "The", "request", "signature", "we", "calculated", "do", "not", "match", "the", "signature", "you", "provide", "NUMBER", "Check", "your", "key", "and", "signing", "method", "NUMBER", "TAG", "I", "downgrade", "fog", "to", "NUMBER", "and", "upload", "work", "NUMBER", "Any", "idea", "why", "fog", "NUMBER", "not", "work", "bensie", "I", "think", "it", "might", "be", "subdomain", "vs", "path", "inclusion", "of", "the", "bucket", "NUMBER", "It", "be", "work", "ok", "for", "me", "though", "with", "my", "directories", "file", "NUMBER", "menkel", "Are", "the", "file", "in", "us", "east", "Can", "you", "include", "a", "sample", "of", "what", "the", "work", "URLs", "look", "like", "for", "comparison", "Thanks", "just", "hoping", "to", "narrow", "things", "down", "a", "bit", "to", "make", "it", "easier", "to", "fix", "up", "NUMBER", "bensie", "I", "think", "it", "might", "have", "to", "do", "with", "the", "in", "the", "bucket", "name", "but", "not", "certain", "NUMBER", "geemus", "the", "file", "be", "in", "eu", "west", "NUMBER", "url", "generate", "with", "fog", "NUMBER", "LINK", "upload", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "uploads", "picture", "image", "NUMBER", "thumb_TinyGrab_Screen_Shot_", "NUMBER", "NUMBER", "NUMBER", "_", "NUMBER", "jpg", "AWSAccessKeyId", "AKIAJD", "NUMBER", "FPWEX", "NUMBER", "NI", "NUMBER", "HJ", "NUMBER", "Q", "Signature", "jR", "NUMBER", "FRQz", "NUMBER", "FUoWQ", "NUMBER", "LlOdeUjJM", "NUMBER", "kcLh", "NUMBER", "NUMBER", "D", "Expires", "NUMBER", "url", "generate", "with", "fog", "NUMBER", "LINK", "eu", "west", "NUMBER", "amazonaws", "NUMBER", "com", "viarezo", "upload", "uploads", "picture", "image", "NUMBER", "TinyGrab_Screen_Shot_", "NUMBER", "NUMBER", "NUMBER", "_", "NUMBER", "jpg", "AWSAccessKeyId", "AKIAJD", "NUMBER", "FPWEX", "NUMBER", "NI", "NUMBER", "HJ", "NUMBER", "Q", "Signature", "WeFrRDh", "NUMBER", "sRbXV", "NUMBER", "NUMBER", "B", "NUMBER", "NUMBER", "Fu", "NUMBER", "qCOCNsPo", "NUMBER", "D", "Expires", "NUMBER", "Thank", "you", "for", "your", "help", "menkel", "thanks", "for", "the", "clarification", "and", "urls", "that", "actually", "made", "it", "super", "clear", "what", "was", "going", "on", "NUMBER", "While", "trying", "to", "fix", "some", "issue", "relate", "to", "this", "we", "accidentally", "hardcoded", "the", "host", "to", "use", "the", "us", "east", "region", "NUMBER", "I", "just", "push", "a", "fix", "to", "fog", "here", "LINK", "I", "also", "release", "v", "NUMBER", "which", "should", "have", "that", "fix", "NUMBER", "Let", "me", "know", "if", "you", "run", "into", "any", "other", "problem", "though", "NUMBER", "Thanks", "It", "s", "work", "geemus", "Thank", "you", "for", "the", "rapid", "fix", "menkel", "awesome", "great", "to", "hear", "NUMBER", "Like", "I", "said", "once", "I", "knew", "about", "the", "region", "difference", "and", "saw", "the", "urls", "it", "was", "pretty", "clear", "exactly", "what", "the", "problem", "was", "NUMBER", "Glad", "to", "help", "out", "NUMBER", "Thanks", "NameError", "uninitialized", "constant", "Sprockets", "Helpers", "It", "should", "be", "Sprockets", "Rails", "Helpers", "Yes", "because", "there", "be", "no", "integrated", "sprockets", "in", "rails", "anymore", "NUMBER", "It", "s", "sprockets", "rails", "gem", "now", "NUMBER", "CarrierWave", "Storage", "Fog", "File", "NUMBER", "size", "change", "to", "return", "zero", "size", "when", "file", "physically", "do", "not", "exist", "NUMBER", "So", "that", "I", "will", "not", "get", "strange", "error", "like", "this", "undefined", "method", "content_length", "for", "nil", "NilClass", "carrierwave", "NUMBER", "a", "NUMBER", "b", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "size", "We", "re", "use", "carrier", "wave", "with", "this", "Mongomapper", "ORM", "LINK", "mongomapper", "NUMBER", "Here", "s", "our", "setup", "LINK", "We", "be", "use", "ElasticSearch", "and", "awesome_print", "NUMBER", "For", "users", "that", "have", "a", "photo", "uploaded", "all", "be", "fine", "NUMBER", "But", "for", "those", "that", "do", "when", "get", "the", "uploader", "column", "it", "returns", "nothing", "in", "the", "console", "NUMBER", "The", "class", "be", "correct", "but", "because", "the", "output", "be", "Nothing", "awesome_print", "breaks", "which", "cause", "me", "to", "have", "to", "hack", "awesome_print", "here", "LINK", "_print", "NUMBER", "ElasticSearch", "also", "won", "t", "index", "it", "because", "of", "this", "as", "well", "NUMBER", "Seems", "logical", "that", "the", "photo", "attribute", "should", "just", "return", "nil", "for", "those", "that", "haven", "t", "uploaded", "a", "photo", "no", "Here", "s", "some", "hopefully", "helpful", "debug", "Ruby", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "brandon", "NUMBER", "photo", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "brandon", "NUMBER", "photo", "false", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "brandon", "NUMBER", "photo", "NUMBER", "nil", "false", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "brandon", "NUMBER", "photo", "false", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "brandon", "NUMBER", "photo", "NUMBER", "class", "PhotoUploader", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "chris", "NUMBER", "photo", "LINK", "redacted", "IMG_", "NUMBER", "_", "NUMBER", "_bigger", "NUMBER", "jpg", "irb", "main", "NUMBER", "NUMBER", "User", "NUMBER", "chris", "NUMBER", "photo", "NUMBER", "class", "PhotoUploader", "I", "made", "this", "change", "on", "a", "fork", "and", "it", "resolve", "the", "issue", "but", "this", "seems", "kind", "of", "like", "a", "hack", "NUMBER", "LINK", "We", "moved", "to", "Paperclip", "as", "a", "result", "so", "it", "probably", "wouldn", "t", "be", "anytime", "soon", "NUMBER", "However", "if", "I", "find", "some", "time", "I", "ll", "take", "a", "stab", "at", "it", "NUMBER", "It", "would", "be", "ideal", "to", "have", "much", "like", "the", "extension_white_list", "method", "a", "extension_black_list", "method", "NUMBER", "I", "want", "to", "allow", "users", "to", "upload", "any", "file", "they", "want", "for", "storage", "but", "I", "want", "to", "block", "out", "potentially", "dangerous", "filetypes", "such", "as", "NUMBER", "exe", "NUMBER", "js", "etc", "NUMBER", "I", "think", "a", "better", "behaviour", "will", "be", "to", "define", "remove_", "column", "as", "an", "after_commit", "callback", "defined", "only", "on", "destroy", "not", "as", "an", "after_destroy", "because", "callbacks", "may", "raise", "rollback", "and", "the", "DB", "will", "no", "longer", "reflect", "the", "FS", "data", "consistently", "NUMBER", "Example", "class", "Document", "TAG", "Document", "NUMBER", "create", "name", "name", "file", "File", "NUMBER", "open", "File", "NUMBER", "join", "Rails", "NUMBER", "root", "public", "NUMBER", "html", "NUMBER", "ms", "BEGIN", "SQL", "NUMBER", "ms", "INSERT", "INTO", "documents", "created_at", "file", "name", "updated_at", "VALUES", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "html", "name", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "ms", "COMMIT", "TAG", "The", "document", "model", "be", "saved", "and", "the", "file", "be", "uploaded", "NUMBER", "irb", "main", "NUMBER", "NUMBER", "Document", "NUMBER", "last", "NUMBER", "destroy", "Document", "Load", "NUMBER", "ms", "SELECT", "documents", "NUMBER", "FROM", "documents", "ORDER", "BY", "documents", "NUMBER", "id", "DESC", "LIMIT", "NUMBER", "NUMBER", "ms", "BEGIN", "SQL", "NUMBER", "ms", "DELETE", "FROM", "documents", "WHERE", "documents", "NUMBER", "id", "NUMBER", "NUMBER", "ms", "ROLLBACK", "nil", "Rollback", "be", "triggered", "by", "the", "after_destroy", "callback", "from", "Document", "model", "NUMBER", "Although", "the", "model", "be", "not", "delete", "from", "DB", "the", "document", "be", "destroyed", "from", "FS", "The", "file", "destruction", "be", "do", "by", "the", "callback", "after_destroy", "remove_", "column", "defined", "in", "carrierwave", "in", "lib", "carrierwave", "orm", "activerecord", "NUMBER", "rb", "on", "line", "NUMBER", "NUMBER", "Let", "me", "know", "if", "you", "want", "me", "to", "make", "a", "pull", "request", "NUMBER", "I", "m", "build", "an", "app", "use", "Rails", "NUMBER", "LINK", "it", "will", "remain", "public", "for", "about", "another", "week", "I", "created", "a", "directory", "to", "match", "the", "README", "instructions", "at", "lib", "carrierwave", "storage", "and", "placed", "the", "fog", "NUMBER", "rb", "file", "there", "NUMBER", "After", "re", "starting", "my", "local", "server", "I", "get", "the", "following", "routing", "error", "uninitialized", "constant", "CarrierWave", "Storage", "Fog", "Moving", "the", "fog", "NUMBER", "rb", "file", "into", "the", "config", "initializers", "directory", "and", "re", "starting", "the", "server", "fix", "things", "NUMBER", "I", "went", "back", "and", "forth", "several", "times", "to", "confirm", "the", "behavior", "NUMBER", "Am", "not", "sure", "if", "this", "be", "something", "unique", "to", "my", "app", "or", "not", "NUMBER", "the", "Engine", "Yard", "doc", "LINK", "carrierwave", "and", "optionally", "fog", "to", "upload", "and", "store", "file", "NUMBER", "html", "update", "NUMBER", "also", "says", "to", "place", "the", "file", "in", "the", "initializers", "directory", "NUMBER", "Apologies", "NUMBER", "Since", "the", "other", "issue", "was", "about", "update", "the", "README", "only", "I", "thought", "it", "should", "be", "separated", "NUMBER", "I", "think", "that", "a", "region", "be", "miss", "NUMBER", "There", "a", "S", "NUMBER", "in", "S\u00e3o", "Paulo", "Brazil", "South", "America", "NUMBER", "So", "please", "include", "that", "NUMBER", "You", "re", "right", "For", "others", "who", "want", "the", "S\u00e3o", "Paulo", "s", "code", "sa", "east", "NUMBER", "UPDATED", "I", "m", "build", "an", "app", "use", "Rails", "NUMBER", "LINK", "it", "will", "remain", "public", "for", "about", "another", "week", "I", "created", "a", "directory", "to", "match", "the", "README", "instructions", "at", "lib", "carrierwave", "storage", "and", "placed", "the", "fog", "NUMBER", "rb", "file", "there", "NUMBER", "After", "re", "starting", "my", "local", "server", "I", "get", "the", "following", "routing", "error", "uninitialized", "constant", "CarrierWave", "Storage", "Fog", "Moving", "the", "fog", "NUMBER", "rb", "file", "into", "the", "config", "initializers", "directory", "and", "re", "starting", "the", "server", "fix", "things", "NUMBER", "I", "went", "back", "and", "forth", "several", "times", "to", "confirm", "the", "behavior", "NUMBER", "Am", "not", "sure", "if", "this", "be", "something", "unique", "to", "my", "app", "or", "not", "NUMBER", "the", "Engine", "Yard", "doc", "LINK", "carrierwave", "and", "optionally", "fog", "to", "upload", "and", "store", "file", "NUMBER", "html", "update", "NUMBER", "also", "says", "to", "place", "the", "file", "in", "the", "initializers", "directory", "NUMBER", "ORIGINAL", "ISSUE", "I", "implement", "Fog", "AWS", "per", "your", "README", "instructions", "and", "get", "a", "nil", "class", "error", "when", "reloading", "the", "index", "view", "for", "the", "relate", "resource", "class", "I", "have", "a", "class", "call", "Document", "that", "Carrierwave", "be", "attaching", "file", "to", "NUMBER", "After", "googling", "around", "I", "find", "this", "Engine", "Yard", "doc", "LINK", "carrierwave", "and", "optionally", "fog", "to", "upload", "and", "store", "file", "NUMBER", "html", "update", "NUMBER", "that", "suggested", "putting", "the", "fog", "NUMBER", "rb", "file", "directly", "into", "the", "config", "initializers", "directory", "NUMBER", "At", "the", "same", "time", "I", "re", "start", "my", "local", "dev", "server", "NUMBER", "Everything", "immediately", "start", "work", "which", "I", "attributed", "to", "the", "change", "in", "location", "for", "the", "fog", "NUMBER", "rb", "file", "NUMBER", "However", "after", "moving", "it", "back", "to", "the", "original", "location", "everything", "still", "worked", "NUMBER", "So", "NUMBER", "it", "seems", "you", "just", "need", "to", "re", "start", "your", "server", "NUMBER", "This", "may", "be", "painfully", "obvious", "to", "even", "a", "modestly", "competent", "dev", "but", "as", "a", "beginner", "it", "get", "me", "NUMBER", "Perhaps", "a", "footnote", "reminding", "people", "to", "do", "this", "would", "be", "a", "helpful", "addition", "NUMBER", "I", "ve", "never", "revised", "or", "suggested", "change", "to", "a", "README", "before", "so", "feel", "free", "to", "direct", "me", "to", "instruction", "on", "how", "to", "do", "this", "in", "a", "more", "appropriate", "easy", "for", "you", "manner", "NUMBER", "Also", "thank", "you", "so", "much", "for", "the", "work", "you", "ve", "do", "on", "this", "gem", "NUMBER", "I", "m", "in", "NYC", "and", "every", "available", "worthwhile", "dev", "class", "sells", "out", "immediately", "especially", "for", "Ruby", "RoR", "NUMBER", "Easy", "to", "use", "and", "effective", "tool", "like", "CarrierWave", "mean", "a", "lot", "to", "those", "of", "us", "that", "be", "new", "to", "programming", "DEPRECATION", "WARNING", "ActiveSupport", "Memoizable", "be", "deprecate", "and", "will", "be", "remove", "in", "future", "release", "simply", "use", "Ruby", "memoization", "pattern", "instead", "NUMBER", "call", "from", "TAG", "at", "home", "adrian", "example", "config", "environment", "NUMBER", "rb", "NUMBER", "Added", "to", "allow", "for", "choosing", "from", "a", "set", "of", "asset", "hosts", "NUMBER", "This", "be", "useful", "for", "alleviating", "the", "bottleneck", "that", "can", "occur", "from", "request", "a", "bunch", "of", "static", "assets", "up", "front", "NUMBER", "I", "m", "trying", "to", "use", "s", "NUMBER", "and", "cloudfront", "to", "serve", "a", "lot", "of", "images", "NUMBER", "I", "m", "struggling", "with", "get", "the", "urls", "to", "round", "robin", "be", "random", "NUMBER", "be", "that", "what", "this", "be", "intended", "for", "Yep", "NUMBER", "This", "allows", "you", "to", "do", "something", "like", "config", "NUMBER", "fog_host", "proc", "LINK", "rand", "NUMBER", "NUMBER", "ceil", "NUMBER", "myhost", "NUMBER", "com", "Doing", "it", "this", "way", "makes", "it", "simple", "enough", "that", "if", "you", "just", "need", "a", "shuffling", "of", "asset", "hosts", "you", "can", "use", "the", "rand", "example", "above", "but", "flexible", "enough", "that", "if", "you", "needed", "a", "_true_", "round", "robin", "approach", "you", "can", "just", "code", "it", "in", "NUMBER", "EDIT", "add", "LINK", "to", "the", "example", "dude", "worked", "perfectly", "NUMBER", "thanks", "NUMBER", "For", "me", "not", "work", "I", "have", "in", "fog", "NUMBER", "rb", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "key", "aws_secret_access_key", "key", "region", "eu", "west", "NUMBER", "config", "NUMBER", "fog_directory", "pro", "config", "NUMBER", "fog_host", "proc", "LINK", "rand", "NUMBER", "NUMBER", "ceil", "NUMBER", "domain", "NUMBER", "com", "config", "NUMBER", "fog_public", "false", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "end", "But", "I", "see", "the", "images", "routes", "to", "LINK", "eu", "west", "NUMBER", "amazonaws", "NUMBER", "com", "pro", "NUMBER", "However", "my", "assets", "js", "css", "and", "images", "assets", "works", "fine", "I", "see", "LINK", "NUMBER", "cbddb", "NUMBER", "d", "NUMBER", "e", "NUMBER", "f", "NUMBER", "fffa", "NUMBER", "f", "NUMBER", "b", "NUMBER", "png", "What", "be", "I", "doing", "wrong", "with", "carrierwave", "NUMBER", "and", "replace", "it", "with", "the", "default", "background", "color", "NUMBER", "This", "happens", "when", "the", "extent", "command", "crops", "the", "image", "NUMBER", "From", "the", "LINK", "extent", "Note", "that", "extent", "works", "by", "use", "the", "same", "overlay", "technique", "that", "both", "the", "Border", "and", "Frame", "operators", "uses", "NUMBER", "As", "such", "by", "default", "use", "it", "with", "a", "image", "containing", "transparency", "will", "replace", "the", "transparency", "with", "the", "current", "background", "color", "NUMBER", "The", "file", "config", "initializers", "carrierwave", "NUMBER", "rb", "configures", "the", "rail", "environments", "NUMBER", "These", "should", "be", "correctly", "do", "in", "environment", "TAG", "NUMBER", "rb", "This", "causes", "the", "problem", "where", "carrierwaver", "processing", "for", "RMagic", "be", "turned", "off", "and", "the", "developer", "do", "not", "what", "be", "happening", "NUMBER", "I", "had", "the", "problem", "of", "the", "system", "work", "well", "on", "development", "but", "when", "use", "capistrano", "the", "same", "system", "did", "not", "work", "in", "staging", "on", "a", "different", "server", "NUMBER", "After", "several", "hours", "the", "problem", "was", "that", "carrierwave", "was", "configuring", "the", "environment", "in", "this", "unexpect", "place", "initializers", "carrierwave", "NUMBER", "I", "believe", "this", "problem", "would", "have", "be", "solve", "earlier", "if", "the", "initialization", "had", "happened", "in", "the", "right", "file", "NUMBER", "I", "see", "a", "few", "threads", "with", "this", "problem", "online", "but", "without", "solution", "NUMBER", "Hi", "NUMBER", "I", "be", "use", "fog", "NUMBER", "carrierwave", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "and", "rails", "NUMBER", "I", "keep", "get", "this", "error", "no", "matter", "what", "I", "do", "yup", "I", "checked", "the", "actual", "doc", "not", "readme", "as", "well", "NUMBER", "I", "ve", "be", "mulling", "over", "it", "for", "a", "few", "days", "now", "and", "tried", "everything", "on", "the", "web", "and", "I", "can", "t", "seem", "to", "fix", "it", "NUMBER", "Thanks", "NUMBER", "carrierwave", "NUMBER", "rb", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "ENV", "code", "aws_secret_access_key", "ENV", "secret_code", "provider", "AWS", "if", "Rails", "NUMBER", "env", "NUMBER", "test", "Rails", "NUMBER", "env", "NUMBER", "cucumber", "config", "NUMBER", "orage", "file", "config", "NUMBER", "enable_processing", "false", "config", "NUMBER", "root", "Rails", "NUMBER", "root", "tmp", "else", "config", "NUMBER", "orage", "fog", "end", "config", "NUMBER", "cache_dir", "Rails", "NUMBER", "root", "tmp", "uploads", "config", "NUMBER", "fog_directory", "ENV", "bucket", "config", "NUMBER", "fog_public", "true", "end", "uploader", "class", "GiftImageUploader", "TAG", "NUMBER", "NUMBER", "end", "end", "I", "have", "an", "image", "uploader", "that", "resizes", "images", "to", "a", "standard", "version", "and", "stores", "via", "fog", "on", "s", "NUMBER", "version", "standard", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "Everything", "be", "fine", "until", "I", "add", "this", "to", "my", "uploader", "def", "filename", "Time", "NUMBER", "now", "NUMBER", "to_i", "NUMBER", "_", "super", "if", "original_filename", "end", "The", "original", "file", "be", "still", "publicly", "readable", "on", "s", "NUMBER", "but", "the", "standard", "version", "be", "not", "access", "denied", "from", "s", "NUMBER", "in", "web", "browser", "NUMBER", "If", "I", "comment", "out", "the", "filename", "method", "ie", "go", "back", "to", "default", "filename", "the", "standard", "version", "be", "publicly", "readable", "NUMBER", "I", "believe", "you", "have", "a", "typo", "in", "your", "code", "NUMBER", "It", "should", "be", "Time", "NUMBER", "now", "NUMBER", "to_i", "unless", "you", "ve", "extend", "the", "Time", "class", "with", "a", "toi", "method", "I", "believe", "that", "s", "markdown", "syntax", "eating", "my", "underscores", "and", "display", "italics", "NUMBER", "Let", "me", "try", "again", "NUMBER", "def", "filename", "Time", "NUMBER", "now", "NUMBER", "to_i", "NUMBER", "_", "super", "if", "original_filename", "end", "ahh", "I", "see", "NUMBER", "What", "about", "this", "probably", "not", "the", "best", "way", "to", "do", "this", "but", "a", "quick", "solution", "which", "can", "be", "refactored", "later", "ruby", "def", "filename", "super", "end", "version", "standard", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "def", "full_filename", "for_file", "model", "NUMBER", "file", "Time", "NUMBER", "now", "NUMBER", "to_i", "NUMBER", "_", "sanitize", "original_filename", "if", "original_filename", "end", "end", "The", "problem", "be", "not", "that", "the", "filename", "doesn", "t", "get", "change", "it", "s", "that", "the", "permissions", "be", "messed", "up", "NUMBER", "I", "want", "both", "version", "to", "have", "the", "timestamp", "thingy", "in", "the", "name", "and", "my", "method", "did", "that", "NUMBER", "The", "problem", "be", "that", "when", "I", "change", "the", "name", "like", "this", "the", "permissions", "of", "the", "version", "file", "was", "different", "than", "when", "I", "didn", "t", "change", "the", "name", "NUMBER", "It", "seems", "to", "me", "that", "carrierwave", "has", "a", "problem", "with", "just", "that", "particular", "method", "NUMBER", "If", "you", "log", "into", "your", "s", "NUMBER", "bucket", "be", "you", "able", "to", "view", "the", "standard", "version", "file", "Also", "how", "be", "you", "querying", "that", "file", "When", "I", "connect", "to", "the", "bucket", "with", "authentication", "both", "the", "original", "and", "the", "version", "be", "there", "NUMBER", "They", "should", "both", "be", "public", "but", "when", "the", "version", "be", "accessed", "via", "the", "public", "http", "url", "access", "be", "denied", "NUMBER", "The", "original", "be", "accessible", "via", "plain", "http", "NUMBER", "hmm", "NUMBER", "can", "you", "paste", "in", "your", "fog", "config", "initializer", "file", "I", "know", "in", "the", "carrierwave", "fog", "instructions", "it", "says", "to", "do", "this", "config", "NUMBER", "fog_public", "false", "but", "i", "m", "pretty", "sure", "it", "should", "be", "config", "NUMBER", "fog_public", "true", "Here", "you", "go", "NUMBER", "Some", "bits", "change", "to", "protect", "the", "guilty", "NUMBER", "ruby", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "permissions", "NUMBER", "config", "NUMBER", "orage", "fog", "config", "NUMBER", "s", "NUMBER", "_access_policy", "public_read", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "blahblahblahackackack", "aws_secret_access_key", "morphalotaelephantsgoingroundandround", "if", "Rails", "NUMBER", "env", "NUMBER", "production", "config", "NUMBER", "fog_directory", "prod", "NUMBER", "oinkoink", "elsif", "Rails", "NUMBER", "env", "NUMBER", "test", "config", "NUMBER", "fog_directory", "test", "NUMBER", "oinkoink", "else", "config", "NUMBER", "fog_directory", "dev", "NUMBER", "oinkoink", "end", "config", "NUMBER", "fog_host", "LINK", "config", "NUMBER", "fog_directory", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "true", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "What", "if", "you", "remove", "the", "permissions", "and", "s", "NUMBER", "_access_policy", "options", "Fog", "as", "far", "as", "I", "know", "do", "not", "support", "s", "NUMBER", "_access_policy", "like", "aws", "s", "NUMBER", "did", "instead", "sets", "it", "with", "fog_public", "NUMBER", "bensie", "i", "m", "seeing", "the", "same", "issue", "as", "the", "pdk", "setting", "config", "NUMBER", "fog_attributes", "acl", "authenticated", "read", "do", "not", "appear", "to", "work", "NUMBER", "Reading", "through", "the", "code", "it", "looks", "like", "the", "key", "has", "to", "be", "x", "amz", "acl", "but", "_that_", "do", "not", "work", "either", "NUMBER", "bensie", "I", "can", "t", "say", "for", "sure", "NUMBER", "my", "app", "do", "mess", "around", "with", "generating", "a", "custom", "filename", "and", "path", "NUMBER", "The", "original", "file", "be", "not", "accessible", "as", "well", "NUMBER", "In", "my", "case", "I", "m", "trying", "to", "make", "it", "the", "file", "on", "s", "NUMBER", "be", "read", "accessible", "by", "anonymous", "users", "clients", "so", "have", "be", "banging", "my", "head", "trying", "various", "combinations", "to", "communicate", "what", "the", "acl", "of", "the", "uploaded", "file", "and", "version", "should", "be", "see", "my", "previous", "comment", "Here", "s", "the", "current", "incarnation", "of", "my", "carrier", "wave", "config", "ruby", "s", "NUMBER", "YAML", "NUMBER", "load_file", "Rails", "NUMBER", "root", "NUMBER", "join", "config", "amazon_s", "NUMBER", "yml", "Rails", "NUMBER", "env", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "permissions", "NUMBER", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "s", "NUMBER", "access_key_id", "aws_secret_access_key", "s", "NUMBER", "secret_access_key", "config", "NUMBER", "fog_public", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "x", "amz", "acl", "public", "read", "end", "If", "the", "posts", "I", "find", "on", "the", "web", "be", "to", "be", "believed", "it", "should", "be", "setting", "the", "ACLs", "on", "the", "uploaded", "file", "like", "I", "need", "to", "it", "doesn", "t", "I", "wonder", "if", "maybe", "the", "issue", "lies", "in", "the", "way", "fog", "be", "use", "by", "carrierwave", "or", "fog", "itself", "NUMBER", "I", "ve", "setup", "carrierwave", "like", "so", "ruby", "CarrierWave", "NUMBER", "configure", "do", "config", "NUMBER", "Choose", "what", "kind", "of", "storage", "to", "use", "for", "this", "uploader", "config", "NUMBER", "orage", "fog", "config", "NUMBER", "fog_credentials", "NUMBER", "config", "NUMBER", "fog_directory", "bucket_name", "config", "NUMBER", "fog_public", "false", "config", "NUMBER", "fog_host", "bucket_host", "end", "However", "whenever", "I", "access", "the", "private", "file", "I", "m", "sent", "to", "the", "stock", "s", "NUMBER", "url", "instead", "of", "the", "cnamed", "version", "NUMBER", "Had", "a", "quick", "poke", "around", "in", "CarrierWave", "Storage", "S", "NUMBER", "and", "notice", "that", "unlike", "public_url", "authenticated_url", "uses", "fog", "to", "generate", "the", "url", "NUMBER", "ruby", "def", "authenticated_url", "connection", "NUMBER", "get_object_https_url", "bucket", "path", "Time", "NUMBER", "now", "authentication_timeout", "end", "Looking", "in", "the", "fog", "gem", "it", "seems", "that", "it", "only", "uses", "a", "custom", "host", "if", "the", "host", "option", "be", "provide", "when", "the", "connection", "be", "created", "which", "currently", "isn", "t", "happening", "ruby", "connection", "Fog", "Storage", "NUMBER", "new", "aws_access_key_id", "uploader", "NUMBER", "s", "NUMBER", "_access_key_id", "aws_secret_access_key", "uploader", "NUMBER", "s", "NUMBER", "_secret_access_key", "provider", "AWS", "region", "uploader", "NUMBER", "s", "NUMBER", "_region", "Sorry", "my", "mistake", "NUMBER", "I", "ll", "have", "another", "sweep", "through", "to", "see", "if", "what", "the", "problem", "be", "NUMBER", "For", "the", "record", "it", "seems", "that", "be", "was", "the", "problem", "the", "code", "that", "was", "linked", "to", "was", "only", "add", "recently", "and", "isn", "t", "in", "the", "latest", "release", "of", "the", "gem", "NUMBER", "Currently", "my", "uploaded", "project", "be", "call", "with", "asset", "NUMBER", "document", "which", "returns", "a", "full", "URL", "to", "the", "file", "s", "location", "on", "S", "NUMBER", "However", "in", "the", "database", "the", "document", "property", "consists", "only", "of", "the", "filename", "on", "S", "NUMBER", "The", "full", "URL", "be", "generate", "by", "Carrierwave", "combining", "the", "S", "NUMBER", "host", "bucket", "information", "and", "other", "store_directory", "settings", "NUMBER", "That", "works", "fine", "NUMBER", "But", "I", "d", "like", "to", "know", "if", "it", "s", "possible", "instead", "to", "store", "the", "full", "URL", "in", "the", "document", "property", "NUMBER", "Any", "ideas", "Hello", "I", "really", "have", "no", "time", "to", "investigate", "carrierwave", "s", "code", "I", "just", "create", "really", "simple", "test", "and", "fix", "it", "NUMBER", "Also", "fix", "NoMethodError", "undefined", "method", "remove_previously_stored_files_after_update", "for", "nil", "NilClass", "It", "s", "works", "for", "me", "now", "NUMBER", "Hi", "I", "m", "trying", "to", "convert", "a", "JPG", "to", "a", "PNG", "with", "a", "transparet", "background", "NUMBER", "Here", "the", "code", "I", "m", "use", "process", "convert", "png", "def", "filename", "filename", "filename", "NUMBER", "split", "NUMBER", "NUMBER", "first", "NUMBER", "png", "end", "version", "thumb", "do", "process", "resize_and_pad", "NUMBER", "NUMBER", "end", "But", "the", "generate", "thumbs", "have", "not", "a", "transparent", "background", "NUMBER", "By", "the", "way", "if", "i", "upload", "a", "PNG", "file", "it", "gets", "a", "transparent", "background", "NUMBER", "My", "enviroment", "rmagick", "NUMBER", "carrierwave", "NUMBER", "rails", "NUMBER", "Any", "idea", "I", "have", "this", "uploader", "LINK", "call", "in", "this", "model", "LINK", "NUMBER", "When", "I", "do", "a", "member", "NUMBER", "to_json", "The", "return", "be", "like", "javascript", "_id", "NUMBER", "f", "NUMBER", "ff", "NUMBER", "cc", "NUMBER", "b", "NUMBER", "a", "NUMBER", "artist_id", "NUMBER", "f", "NUMBER", "ff", "NUMBER", "cc", "NUMBER", "a", "NUMBER", "a", "NUMBER", "avatar", "avatar", "NUMBER", "jpg", "created_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "instrument", "asdasd", "name", "asdas", "period", "null", "updated_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "I", "d", "like", "to", "get", "the", "full", "path", "for", "the", "file", "on", "this", "json", "be", "this", "possible", "Also", "I", "m", "use", "mongoid", "but", "I", "guess", "this", "be", "the", "normal", "behavior", "NUMBER", "Hmm", "ok", "I", "point", "to", "master", "and", "it", "fix", "the", "problem", "inside", "a", "controller", "NUMBER", "Just", "one", "thing", "left", "me", "scratching", "my", "head", "NUMBER", "shell", "rafa", "at", "frost", "in", "Projects", "magnafm", "on", "master", "rails", "c", "Loading", "development", "environment", "Rails", "NUMBER", "NUMBER", "p", "NUMBER", "NUMBER", "m", "Member", "NUMBER", "first", "TAG", "NUMBER", "p", "NUMBER", "NUMBER", "m", "NUMBER", "to_json", "_id", "NUMBER", "f", "NUMBER", "ffdb", "NUMBER", "cc", "NUMBER", "c", "NUMBER", "artist_id", "NUMBER", "f", "NUMBER", "ffd", "NUMBER", "cc", "NUMBER", "c", "NUMBER", "a", "NUMBER", "avatar", "avatar", "NUMBER", "jpg", "created_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "instrument", "adad", "name", "adsad", "period", "null", "updated_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "NUMBER", "p", "NUMBER", "NUMBER", "m", "NUMBER", "avatar", "uploads", "artists", "amigas", "lesbicas", "nao", "andam", "de", "maos", "dadas", "members", "NUMBER", "f", "NUMBER", "ffdb", "NUMBER", "cc", "NUMBER", "c", "NUMBER", "avatar", "NUMBER", "jpg", "Outside", "the", "controller", "context", "when", "I", "call", "the", "to_json", "method", "it", "still", "returns", "only", "the", "filename", "even", "though", "I", "can", "see", "by", "calling", "m", "NUMBER", "avatar", "that", "carrierwave", "be", "doing", "its", "job", "NUMBER", "That", "makes", "sense", "Thanks", "a", "lot", "This", "be", "driving", "me", "nuts", "even", "use", "carrierwave", "s", "master", "I", "m", "still", "not", "able", "to", "acess", "the", "avatar", "s", "full", "path", "unless", "I", "do", "something", "like", "this", "in", "my", "controller", "ruby", "render", "json", "member", "NUMBER", "as_json", "include", "artist", "methods", "avatar", "I", "know", "I", "said", "it", "was", "work", "but", "that", "was", "a", "mistake", "NUMBER", "Without", "the", "methods", "avatar", "it", "goes", "back", "to", "showing", "just", "the", "filename", "NUMBER", "bensie", "Maybe", "I", "can", "help", "to", "port", "that", "to", "mongoid", "can", "you", "give", "me", "some", "guidance", "on", "that", "matter", "Ok", "I", "add", "it", "in", "LINK", "mongoid", "blob", "master", "lib", "carrierwave", "mongoid", "NUMBER", "rb", "And", "now", "I", "get", "Loading", "development", "environment", "Rails", "NUMBER", "NUMBER", "p", "NUMBER", "perf", "NUMBER", "m", "Member", "NUMBER", "first", "TAG", "NUMBER", "p", "NUMBER", "perf", "NUMBER", "m", "NUMBER", "to_json", "_id", "NUMBER", "f", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "f", "NUMBER", "artist_id", "NUMBER", "f", "NUMBER", "ffd", "NUMBER", "cc", "NUMBER", "c", "NUMBER", "a", "NUMBER", "avatar", "url", "uploads", "artists", "amigas", "lesbicas", "nao", "andam", "de", "maos", "dadas", "members", "NUMBER", "f", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "f", "NUMBER", "avatar", "NUMBER", "jpg", "thumb", "url", "uploads", "artists", "amigas", "lesbicas", "nao", "andam", "de", "maos", "dadas", "members", "NUMBER", "f", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "f", "NUMBER", "thumb_avatar", "NUMBER", "jpg", "profile", "url", "uploads", "artists", "amigas", "lesbicas", "nao", "andam", "de", "maos", "dadas", "members", "NUMBER", "f", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "f", "NUMBER", "profile_avatar", "NUMBER", "jpg", "created_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "instrument", "asdad", "name", "asdad", "period", "null", "updated_at", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "Which", "be", "right", "but", "I", "wasn", "t", "able", "to", "make", "it", "work", "inside", "the", "specs", "NUMBER", "LINK", "mongoid", "blob", "master", "lib", "carrierwave", "mongoid", "NUMBER", "rb", "L", "NUMBER", "be", "giving", "me", "shell", "NoMethodError", "undefined", "method", "serializable_hash", "for", "uploads", "test", "NUMBER", "jpg", "MongoUploader", "unfortunately", "I", "don", "t", "know", "how", "to", "proceed", "from", "here", "NUMBER", "Any", "ideas", "Since", "this", "be", "evolving", "into", "a", "debugging", "session", "we", "can", "move", "this", "to", "another", "place", "if", "you", "like", "I", "ve", "bundled", "the", "carrierwave", "mongoid", "NUMBER", "gemspec", "before", "test", "so", "it", "was", "run", "against", "NUMBER", "Against", "master", "it", "s", "run", "fine", "for", "the", "mongoid_spec", "NUMBER", "rb", "but", "a", "lot", "of", "other", "test", "be", "blowing", "up", "NUMBER", "I", "ll", "add", "the", "test", "later", "today", "and", "send", "a", "pull", "request", "with", "those", "change", "NUMBER", "When", "I", "use", "rackspace", "as", "carrierwave", "s", "storage", "the", "objects", "stored", "in", "the", "container", "all", "have", "a", "uploads", "prepended", "to", "the", "filenames", "NUMBER", "Is", "there", "a", "setting", "that", "can", "be", "change", "to", "get", "rid", "of", "that", "Thanks", "NUMBER", "That", "s", "it", "I", "had", "to", "use", "nil", "instead", "of", "and", "empty", "string", "to", "get", "no", "leading", "slashes", "but", "it", "works", "now", "NUMBER", "Thanks", "NUMBER", "I", "was", "setting", "a", "custom", "filename", "including", "the", "file", "extension", "with", "NUMBER", "model", "NUMBER", "picture", "NUMBER", "file", "NUMBER", "extension", "use", "local", "storage", "and", "it", "worked", "well", "NUMBER", "But", "once", "I", "switched", "to", "Fog", "Rackspace", "I", "get", "this", "error", "undefined", "method", "extension", "for", "TAG", "Anyone", "have", "any", "idea", "how", "to", "access", "the", "file", "s", "extension", "again", "Thanks", "NUMBER", "Perfect", "NUMBER", "Here", "s", "how", "I", "have", "it", "work", "now", "model", "NUMBER", "picture", "NUMBER", "file", "NUMBER", "path", "NUMBER", "split", "NUMBER", "NUMBER", "last", "picture", "be", "the", "model", "s", "image", "attribute", "Thanks", "NUMBER", "I", "suspect", "this", "be", "a", "documentation", "issue", "more", "than", "an", "actual", "bug", "as", "when", "I", "thought", "about", "the", "implementation", "I", "realised", "what", "was", "probably", "happening", "NUMBER", "Anyway", "I", "have", "a", "number", "of", "NUMBER", "gifs", "uploaded", "NUMBER", "I", "add", "a", "ruby", "process", "format", "png", "def", "filename", "super", "NUMBER", "chomp", "File", "NUMBER", "extname", "super", "NUMBER", "png", "end", "to", "my", "uploader", "NUMBER", "I", "then", "call", "recreate_versions", "on", "my", "uploaded", "images", "NUMBER", "Versions", "get", "recreated", "as", "NUMBER", "png", "but", "the", "actual", "image", "path", "in", "my", "model", "isn", "t", "update", "NUMBER", "Going", "to", "try", "a", "couple", "of", "workarounds", "delete", "image", "manually", "store", "from", "tempfile", "and", "will", "let", "you", "know", "if", "that", "helps", "NUMBER", "Rails", "NUMBER", "REE", "NUMBER", "Carrierwave", "NUMBER", "Here", "s", "my", "workaround", "NUMBER", "Took", "a", "while", "to", "get", "it", "right", "NUMBER", "ruby", "temp_path", "File", "NUMBER", "join", "tmp", "File", "NUMBER", "basename", "store", "NUMBER", "companylogo", "NUMBER", "path", "FileUtils", "NUMBER", "cp", "store", "NUMBER", "companylogo", "NUMBER", "path", "temp_path", "store", "NUMBER", "remove_companylogo", "true", "store", "NUMBER", "save", "store", "NUMBER", "reload", "store", "NUMBER", "remove_companylogo", "false", "store", "NUMBER", "companylogo", "File", "NUMBER", "open", "temp_path", "store", "NUMBER", "save", "FileUtils", "NUMBER", "rm", "temp_path", "It", "s", "not", "immediately", "obvious", "that", "the", "version", "can", "t", "be", "tracked", "separately", "from", "the", "original", "ie", "you", "can", "t", "have", "a", "NUMBER", "png", "version", "and", "a", "NUMBER", "gif", "original", "because", "CW", "be", "only", "storing", "the", "filename", "of", "the", "original", "NUMBER", "This", "be", "probably", "a", "separate", "documentation", "issue", "and", "I", "also", "believe", "that", "if", "you", "process", "convert", "in", "a", "version", "block", "or", "any", "other", "action", "that", "would", "imply", "a", "filename", "change", "it", "should", "error", "NUMBER", "In", "our", "case", "we", "only", "use", "the", "original", "for", "archival", "all", "request", "be", "to", "the", "version", "NUMBER", "As", "such", "recreate_versions", "be", "what", "I", "wanted", "but", "I", "wanted", "it", "to", "track", "the", "filename", "change", "from", "the", "convert", "NUMBER", "I", "also", "didn", "t", "want", "to", "change", "the", "filename", "of", "the", "version", "and", "then", "ignore", "it", "NUMBER", "Would", "a", "pull", "request", "for", "a", "recreate_image", "method", "or", "similar", "be", "worthwhile", "I", "have", "applied", "the", "validations", "of", "this", "wiki", "LINK", "to", "NUMBER", "A", "Validate", "uploads", "with", "Active", "Record", "Now", "if", "I", "upload", "a", "corrupted", "jpg", "file", "for", "example", "text", "file", "with", "the", "jpg", "extension", "CarrierWave", "will", "throw", "this", "error", "en", "NUMBER", "error", "NUMBER", "message", "NUMBER", "mini_magick_processing_error", "I", "m", "use", "the", "cache", "to", "display", "the", "submitted", "image", "and", "it", "be", "showing", "a", "non", "existent", "file", "so", "it", "shows", "a", "question", "mark", "inside", "a", "box", "in", "Safari", "NUMBER", "If", "a", "valid", "image", "was", "uploaded", "before", "it", "will", "be", "overwritten", "with", "the", "corrupted", "file", "NUMBER", "It", "seems", "a", "bug", "to", "me", "NUMBER", "I", "have", "search", "through", "the", "issue", "and", "I", "have", "find", "NUMBER", "to", "be", "the", "exact", "problem", "I", "have", "find", "NUMBER", "I", "m", "use", "latest", "CarrierWave", "version", "NUMBER", "with", "MiniMagick", "NUMBER", "on", "Rails", "NUMBER", "Mac", "OS", "X", "Lion", "NUMBER", "I", "would", "do", "it", "but", "right", "now", "I", "m", "not", "use", "CarrierWave", "anymore", "I", "m", "doing", "it", "by", "myself", "from", "scratch", "because", "I", "have", "short", "deadlines", "NUMBER", "Just", "to", "let", "you", "know", "about", "the", "issue", "NUMBER", "When", "l", "try", "and", "do", "the", "following", "version", "thumb", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "The", "entire", "app", "crashed", "but", "works", "fine", "without", "it", "NUMBER", "I", "have", "rmagick", "gem", "and", "everything", "install", "and", "be", "run", "rails", "NUMBER", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "working_title", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "BUG", "Segmentation", "fault", "Worked", "a", "treat", "thanks", "This", "be", "usually", "taken", "care", "of", "when", "use", "carrierwave", "with", "rails", "but", "when", "including", "in", "a", "project", "outside", "of", "rails", "you", "need", "to", "declare", "the", "mime", "types", "dependency", "yourself", "NUMBER", "I", "don", "t", "think", "it", "s", "required", "unless", "you", "re", "use", "it", "specifically", "NUMBER", "See", "the", "Setting", "the", "content", "type", "section", "of", "the", "readme", "NUMBER", "If", "that", "s", "wrong", "we", "should", "set", "the", "gem", "dependency", "though", "NUMBER", "Ah", "gotcha", "thanks", "for", "the", "quick", "response", "NUMBER", "In", "NUMBER", "we", "could", "set", "config", "NUMBER", "s", "NUMBER", "_access_policy", "authenticated_read", "so", "that", "cloud", "front", "sign", "urls", "would", "allow", "access", "to", "private", "content", "NUMBER", "This", "would", "automatically", "add", "Authenicated", "User", "s", "with", "read", "permissions", "to", "uploaded", "file", "NUMBER", "Using", "the", "latest", "git", "version", "I", "have", "tried", "setting", "config", "NUMBER", "fog_policy", "false", "and", "config", "NUMBER", "fog_attributes", "x", "amz", "acl", "authenticated", "read", "but", "it", "do", "not", "set", "the", "read", "permissions", "for", "uploaded", "file", "NUMBER", "How", "do", "I", "set", "this", "policy", "for", "uploaded", "file", "creddy", "I", "think", "what", "you", "want", "be", "config", "NUMBER", "fog_attributes", "acl", "authenticated", "read", "NUMBER", "Sorry", "for", "the", "confusion", "but", "I", "think", "that", "should", "solve", "your", "problem", "NUMBER", "Thanks", "For", "performance", "reasons", "when", "you", "be", "work", "with", "big", "file", "it", "makes", "sense", "if", "possible", "start", "processing", "the", "file", "from", "a", "small", "version", "instead", "of", "use", "the", "original", "one", "NUMBER", "I", "NUMBER", "e", "NUMBER", "version", "thumb", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "small", "from_version", "thumb", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "Added", "Any", "comments", "be", "welcome", "Here", "you", "have", "I", "broke", "the", "build", "for", "NUMBER", "and", "NUMBER", "version", "NUMBER", "Let", "me", "fix", "it", "Thanks", "man", "You", "have", "to", "fix", "also", "the", "step", "definition", "that", "uses", "File", "NUMBER", "write", "Is", "there", "any", "way", "to", "run", "the", "build", "again", "manually", "It", "s", "so", "strange", "because", "that", "step", "pass", "in", "my", "laptop", "in", "Ruby", "NUMBER", "NUMBER", "NUMBER", "p", "NUMBER", "which", "be", "the", "same", "as", "Travis", "runs", "and", "Ruby", "NUMBER", "p", "NUMBER", "bensie", "awesome", "just", "let", "me", "know", "if", "you", "have", "question", "or", "need", "help", "and", "I", "can", "probably", "at", "least", "put", "you", "in", "touch", "with", "the", "right", "people", "NUMBER", "Thanks", "This", "request", "replaces", "NUMBER", "Simply", "gsub", "the", "improperly", "unescaped", "brackets", "after", "normal", "uri", "sanitization", "NUMBER", "Covered", "by", "test", "and", "also", "pass", "my", "field", "test", "on", "my", "current", "project", "NUMBER", "Looking", "good", "but", "what", "do", "you", "think", "about", "moving", "the", "URI", "NUMBER", "escape", "URI", "NUMBER", "unescape", "uri", "NUMBER", "gsub", "NUMBER", "B", "NUMBER", "gsub", "NUMBER", "D", "NUMBER", "uff", "into", "a", "new", "method", "that", "s", "the", "only", "line", "in", "process_uri", "NUMBER", "That", "s", "a", "good", "point", "oh", "you", "mean", "without", "the", "parse", "Meh", "it", "s", "short", "and", "I", "think", "it", "falls", "under", "process", "uri", "as", "a", "concept", "NUMBER", "What", "would", "be", "the", "point", "Monkeypatching", "No", "I", "m", "just", "be", "dumb", "NUMBER", "Merged", "thanks", "When", "use", "carrierwave", "in", "combination", "with", "ActiveRecord", "be", "there", "a", "way", "to", "keep", "the", "uploaded", "file", "when", "destroying", "the", "model", "This", "seems", "like", "a", "hack", "surely", "there", "must", "be", "a", "cleaner", "way", "of", "intercepting", "the", "removal", "of", "the", "file", "In", "fact", "i", "be", "use", "act", "as", "paranoid", "but", "the", "problem", "be", "that", "the", "file", "get", "delete", "anyway", "Add", "this", "to", "your", "model", "skip_callback", "destroy", "after", "remove_avatar", "where", "avatar", "be", "the", "name", "of", "your", "mount_uploader", "mount_uploader", "avatar", "AvatarUploader", "Square", "bracket", "uris", "cannot", "be", "use", "to", "upload", "an", "image", "via", "carrierwave", "NUMBER", "This", "be", "because", "of", "a", "bug", "in", "ruby", "whose", "fix", "has", "be", "rejected", "NUMBER", "I", "believe", "that", "a", "reasonable", "approach", "be", "to", "delegate", "the", "duty", "of", "sanitizing", "URIs", "to", "the", "user", "i", "NUMBER", "e", "NUMBER", "developer", "use", "the", "library", "NUMBER", "That", "way", "they", "can", "use", "whatever", "practice", "they", "be", "comfortable", "with", "to", "sanitize", "URIs", "NUMBER", "In", "my", "case", "that", "cause", "this", "patch", "I", "have", "a", "list", "of", "URIs", "from", "a", "trusted", "source", "and", "I", "be", "doing", "a", "bulk", "import", "NUMBER", "Carrierwave", "be", "incredibly", "good", "at", "this", "except", "for", "URIs", "with", "brackets", "in", "them", "NUMBER", "This", "patch", "pass", "all", "test", "because", "it", "change", "the", "expectations", "of", "the", "library", "as", "seen", "in", "the", "diff", "NUMBER", "If", "an", "invalid", "URI", "be", "pass", "to", "carrierwave", "URI", "will", "raise", "a", "URI", "InvalidURIError", "which", "be", "test", "for", "in", "the", "specs", "NUMBER", "This", "will", "easily", "alert", "the", "developer", "to", "the", "cause", "of", "the", "problem", "NUMBER", "Thanks", "xoxo", "ngauthier", "Wouldn", "t", "exist", "apps", "need", "to", "upgrade", "their", "gem", "to", "become", "broken", "So", "put", "a", "warning", "in", "the", "changelog", "When", "I", "upgrade", "a", "gem", "I", "check", "the", "changelog", "NUMBER", "Alternatively", "we", "could", "have", "an", "intermediate", "warning", "that", "spat", "an", "error", "out", "but", "that", "s", "pretty", "annoying", "NUMBER", "Perhaps", "make", "a", "different", "method", "ruby", "object", "NUMBER", "remote_avatar_url", "this", "can", "be", "unsafe", "object", "NUMBER", "raw_remote_avatar_url", "this", "better", "be", "safe", "How", "can", "it", "be", "overridden", "per", "uploader", "I", "couldn", "t", "figure", "it", "out", "except", "for", "monkeypatching", "a", "private", "method", "NUMBER", "We", "could", "always", "save", "this", "for", "a", "large", "release", "and", "in", "the", "mean", "time", "people", "searching", "for", "a", "solution", "can", "use", "my", "fork", "NUMBER", "ngauthier", "On", "Feb", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "PM", "James", "Miller", "TAG", "write", "It", "depends", "on", "which", "release", "it", "be", "I", "avoid", "violating", "semver", "whenever", "possible", "NUMBER", "So", "there", "was", "a", "patch", "submitted", "to", "ruby", "stdlib", "for", "URI", "that", "fix", "bracket", "support", "and", "it", "was", "rejected", "Lame", "sauce", "NUMBER", "Care", "to", "chime", "in", "trevorturk", "I", "agree", "that", "CW", "shouldn", "t", "be", "responsible", "for", "sanitizing", "but", "it", "s", "already", "in", "there", "yay", "code", "debt", "and", "be", "easy", "enough", "to", "override", "per", "uploader", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Honestly", "I", "don", "t", "see", "the", "problem", "with", "CW", "doing", "sanitization", "NUMBER", "If", "we", "can", "get", "things", "work", "with", "URLs", "with", "square", "brackets", "I", "say", "let", "s", "do", "it", "NUMBER", "If", "not", "then", "fuck", "it", "let", "s", "remove", "support", "in", "the", "next", "version", "NUMBER", "Remember", "we", "haven", "t", "hit", "NUMBER", "yet", "so", "we", "have", "some", "liberties", "wink", "NUMBER", "So", "we", "could", "setup", "a", "special", "case", "gsub", "after", "the", "unescape", "escape", "that", "just", "handles", "the", "square", "bracket", "issue", "NUMBER", "Everyone", "ok", "with", "that", "On", "Wed", "Feb", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "Trevor", "Turk", "TAG", "write", "Honestly", "I", "don", "t", "see", "the", "problem", "with", "CW", "doing", "sanitization", "NUMBER", "If", "we", "can", "get", "things", "work", "with", "URLs", "with", "square", "brackets", "I", "say", "let", "s", "do", "it", "NUMBER", "If", "not", "then", "fuck", "it", "let", "s", "remove", "support", "in", "the", "next", "version", "NUMBER", "Remember", "we", "haven", "t", "hit", "NUMBER", "yet", "so", "we", "have", "some", "liberties", "wink", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Yeah", "I", "might", "suggest", "moving", "the", "url", "sanitization", "into", "a", "new", "method", "to", "keep", "things", "tidy", "but", "that", "s", "the", "basic", "idea", "NUMBER", "If", "we", "can", "get", "things", "work", "let", "s", "go", "for", "it", "NUMBER", "Closing", "in", "favor", "of", "NUMBER", "This", "pretty", "much", "says", "it", "all", "jruby", "NUMBER", "NUMBER", "g", "NUMBER", "remote_photo_url", "LINK", "_com", "images", "srpr", "logo", "NUMBER", "w", "NUMBER", "png", "NoMethodError", "from", "org", "jruby", "RubyStringIO", "NUMBER", "java", "NUMBER", "in", "path", "from", "org", "jruby", "RubyBasicObject", "NUMBER", "java", "NUMBER", "in", "__send__", "from", "org", "jruby", "RubyKernel", "NUMBER", "java", "NUMBER", "in", "send", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "path", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "exists", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "copy_to", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "NUMBER", "in", "download", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "remote_url", "from", "Users", "peter", "NUMBER", "rvm", "gems", "jruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "remote_photo_url", "From", "looking", "at", "the", "source", "file", "be", "be", "sent", "path", "which", "it", "doesn", "t", "have", "def", "path", "unless", "file", "NUMBER", "blank", "if", "is_path", "File", "NUMBER", "expand_path", "file", "elsif", "file", "NUMBER", "respond_to", "path", "and", "not", "file", "NUMBER", "path", "NUMBER", "blank", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "path", "File", "NUMBER", "expand_path", "file", "NUMBER", "path", "end", "end", "end", "Respond", "to", "isin", "t", "overridden", "be", "it", "LINK", "method_missing", "and", "respond_to", "to", "create", "dynamic", "methods", "EDIT", "Some", "more", "debugging", "output", "file", "TAG", "file", "TAG", "And", "StringIO", "be", "not", "supposed", "to", "have", "a", "method", "path", "LINK", "method", "path", "for", "stringio", "in", "ruby", "also", "this", "happens", "when", "setting", "storage", "type", "to", "file", "NoMethodError", "undefined", "method", "path", "for", "TAG", "Do", "you", "know", "what", "would", "be", "involved", "for", "jruby", "support", "Is", "this", "issue", "certainly", "a", "jruby", "one", "I", "m", "experience", "other", "very", "mysterious", "issue", "but", "only", "on", "staging", "production", "NUMBER", "Do", "you", "think", "carrierwave", "could", "be", "the", "problem", "LINK", "corruption", "on", "upload", "to", "s", "NUMBER", "production", "only", "carrierwave", "engineyard", "Thanks", "This", "may", "be", "fix", "with", "NUMBER", "Many", "NUMBER", "mode", "encoding", "bug", "fix", "in", "String", "Regexp", "StringIO", "and", "YAML", "LINK", "topic", "jruby", "users", "fIL", "NUMBER", "NyNh", "NUMBER", "vo", "Short", "story", "ruby", "post", "has", "an", "image", "uploader", "Each", "example", "will", "raise", "ActiveSupport", "JSON", "Encoding", "CircularReferenceError", "object", "references", "itself", "post", "NUMBER", "image", "NUMBER", "to_json", "data", "post", "NUMBER", "image", "NUMBER", "to_json", "Fix", "Adding", "as_json", "method", "to", "CarrierWave", "Uploader", "Serialization", "NUMBER", "Long", "story", "Calling", "to_json", "directly", "on", "the", "uploader", "works", "fine", "it", "s", "implement", "in", "CarrierWave", "NUMBER", "However", "when", "we", "add", "uploader", "instance", "to", "any", "collection", "to_json", "be", "never", "call", "on", "the", "uploader", "NUMBER", "ActiveSupport", "calls", "as_json", "method", "on", "each", "object", "of", "the", "collection", "NUMBER", "Since", "this", "method", "was", "not", "implement", "original", "as_json", "add", "to", "Object", "see", "here", "LINK", "_support", "json", "encoding", "NUMBER", "rb", "L", "NUMBER", "be", "call", "exposing", "all", "instance", "variables", "of", "the", "uploader", "NUMBER", "Since", "one", "of", "them", "be", "model", "containing", "the", "very", "same", "uploader", "we", "re", "in", "a", "circular", "reference", "NUMBER", "This", "bug", "be", "also", "cause", "stack", "level", "too", "deep", "error", "in", "Mongoid", "models", "NUMBER", "to_xml", "works", "in", "a", "different", "way", "and", "be", "much", "more", "complicated", "NUMBER", "Currently", "any", "of", "the", "following", "calls", "ruby", "post", "NUMBER", "image", "NUMBER", "to_xml", "data", "post", "NUMBER", "image", "NUMBER", "to_xml", "will", "raise", "ArgumentError", "wrong", "number", "of", "argument", "NUMBER", "for", "NUMBER", "NUMBER", "It", "s", "because", "ActiveSupport", "expects", "all", "to_xml", "methods", "to", "take", "one", "optional", "argument", "NUMBER", "Fixing", "the", "declaration", "in", "CarrierWave", "Uploader", "Serialization", "makes", "the", "error", "go", "away", "but", "the", "XML", "returned", "in", "the", "above", "two", "cases", "be", "kind", "of", "empty", "For", "array", "xml", "TAG", "TAG", "TAG", "For", "hash", "xml", "TAG", "TAG", "TAG", "I", "ll", "need", "to", "look", "deeper", "to", "find", "the", "cause", "NUMBER", "Should", "I", "post", "follow", "up", "commit", "here", "or", "should", "I", "make", "a", "new", "pull", "request", "for", "xml", "relate", "fix", "Looks", "like", "to_xml", "just", "needed", "to", "respect", "first", "parameter", "and", "pass", "it", "to", "serializable_hash", "NUMBER", "to_xml", "NUMBER", "So", "XML", "serialization", "be", "fix", "as", "well", "NUMBER", "I", "be", "having", "an", "issue", "with", "having", "too", "many", "open", "file", "when", "run", "carrierwave", "in", "our", "test", "NUMBER", "When", "use", "something", "like", "Fabricator", "or", "FactoryGirl", "the", "former", "in", "our", "case", "NUMBER", "We", "end", "up", "with", "thousands", "of", "entries", "of", "open", "file", "which", "sometime", "overflow", "into", "a", "getcwd", "too", "many", "file", "open", "error", "NUMBER", "Fabricator", "ruby", "NOTE", "this", "be", "necessary", "to", "prevent", "thousands", "of", "open", "file", "to", "the", "same", "image", "lsof", "profile_image", "Rack", "Test", "UploadedFile", "NUMBER", "new", "Rails", "NUMBER", "root", "spec", "fixture", "file", "rails", "NUMBER", "png", "image", "png", "true", "Fabricator", "user", "do", "name", "Faker", "Name", "NUMBER", "name", "email", "Faker", "Internet", "NUMBER", "email", "picture", "Rack", "Test", "UploadedFile", "NUMBER", "new", "Rails", "NUMBER", "root", "spec", "fixture", "file", "rails", "NUMBER", "png", "image", "png", "true", "end", "NOTE", "I", "have", "tried", "setting", "picture", "profile_image", "to", "get", "it", "to", "reuse", "the", "same", "uploaded", "Tempfile", "but", "that", "do", "not", "seem", "to", "work", "it", "effectively", "sets", "the", "picture", "to", "nil", "with", "all", "sub", "version", "also", "set", "to", "nil", "even", "when", "setting", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "NUMBER", "lsof", "grep", "ruby", "output", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "r", "NUMBER", "z", "NUMBER", "pruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "sxde", "NUMBER", "truby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "wxqngi", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "mp", "NUMBER", "wa", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "xgzgv", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "gp", "NUMBER", "i", "NUMBER", "y", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "pea", "NUMBER", "j", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "l", "NUMBER", "knkpruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "cetyyh", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "ts", "NUMBER", "w", "NUMBER", "z", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "di", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "b", "NUMBER", "lk", "NUMBER", "y", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "mb", "NUMBER", "xz", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "fggsgx", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "en", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "o", "NUMBER", "hfb", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "mjnlgn", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "mo", "NUMBER", "fak", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "oyzlj", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "re", "NUMBER", "wt", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "qluw", "NUMBER", "e", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "gerk", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "yk", "NUMBER", "dcy", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "caisea", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "dgroqf", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "klb", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "pikg", "NUMBER", "q", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "fvyr", "NUMBER", "f", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "khv", "NUMBER", "lt", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "q", "NUMBER", "fbon", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "ng", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "kte", "NUMBER", "t", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "a", "NUMBER", "zg", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "tsvrlx", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "vcejh", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "og", "NUMBER", "jsc", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "sl", "NUMBER", "fz", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "krpdim", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "tlvyn", "NUMBER", "ruby", "NUMBER", "justinsmestad", "NUMBER", "u", "REG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "private", "var", "folders", "NUMBER", "r", "NUMBER", "zwcwrj", "NUMBER", "pl", "NUMBER", "hvqc", "NUMBER", "jf_zzy", "NUMBER", "gn", "T", "rails", "NUMBER", "png", "NUMBER", "NUMBER", "NUMBER", "oo", "NUMBER", "slw", "I", "have", "also", "posted", "this", "issue", "over", "on", "the", "Fabrication", "gem", "GH", "issue", "tracker", "LINK", "cc", "paulelliott", "bensie", "it", "seems", "that", "you", "have", "git", "locked", "to", "activemodel", "NUMBER", "could", "you", "losen", "this", "dep", "so", "I", "can", "try", "it", "on", "Rails", "NUMBER", "This", "probably", "will", "not", "change", "anything", "NUMBER", "I", "be", "use", "file", "store", "in", "test", "mode", "NUMBER", "But", "seems", "like", "the", "same", "issue", "with", "the", "file", "not", "get", "close", "after", "reading", "NUMBER", "bensie", "this", "doesnt", "seem", "to", "fix", "the", "issue", "NUMBER", "Can", "you", "look", "at", "closing", "the", "file", "after", "store", "be", "call", "in", "the", "file", "adapter", "SanatizedFile", "do", "not", "have", "access", "to", "file", "NUMBER", "close", "it", "looks", "like", "NUMBER", "I", "have", "the", "same", "issue", "when", "run", "a", "rake", "task", "to", "migrate", "a", "lot", "of", "media", "use", "carrierwave", "NUMBER", "Seems", "like", "all", "the", "file", "remain", "open", "until", "my", "mac", "pukes", "NUMBER", "I", "m", "use", "the", "remote_attr_url", "feature", "to", "migrate", "the", "media", "from", "one", "server", "to", "a", "carrierwave", "backed", "solution", "NUMBER", "Using", "carrierwave", "NUMBER", "carrierwave", "datamapper", "NUMBER", "and", "DataMapper", "NUMBER", "on", "Ruby", "NUMBER", "p", "NUMBER", "and", "be", "noticing", "that", "resource", "NUMBER", "uploader", "NUMBER", "filename", "always", "returns", "nil", "NUMBER", "However", "I", "can", "get", "the", "original", "filename", "by", "accessing", "the", "underlying", "identifier", "column", "resource", "NUMBER", "attribute_get", "uploader", "NUMBER", "LINK", "This", "previously", "wasn", "t", "expose", "NUMBER", "Ok", "sure", "I", "ll", "submit", "another", "pull", "request", "I", "was", "going", "with", "the", "least", "invasive", "but", "you", "might", "as", "well", "rewrite", "the", "whole", "Carrierwave", "Storage", "Fog", "File", "layer", "if", "you", "want", "to", "make", "that", "point", "since", "every", "single", "call", "to", "size", "content_length", "etc", "calls", "the", "file", "function", "which", "loads", "the", "whole", "file", "which", "I", "assumed", "you", "had", "determined", "was", "necessary", "NUMBER", "If", "not", "you", "should", "be", "calling", "file", "NUMBER", "head", "for", "those", "function", "also", "NUMBER", "This", "pull", "be", "more", "like", "a", "RFC", "than", "an", "actual", "fix", "NUMBER", "When", "storing", "a", "file", "use", "fog", "the", "method", "CarrierWave", "Storage", "Fog", "File", "store", "leaves", "a", "file", "descriptor", "open", "and", "can", "possibly", "exceed", "OS", "file", "descriptor", "count", "limit", "NUMBER", "A", "valid", "use", "case", "be", "when", "you", "create", "a", "new", "version", "in", "an", "uploader", "and", "wants", "to", "generate", "it", "for", "all", "entries", "in", "your", "database", "NUMBER", "store", "leaves", "NUMBER", "fd", "open", "for", "each", "version", "including", "the", "original", "and", "Linux", "for", "example", "limits", "open", "fd", "s", "to", "NUMBER", "so", "you", "can", "quickly", "exceed", "that", "in", "a", "batch", "operation", "use", "recreate_versions", "Actually", "it", "may", "be", "that", "CarrierWave", "SanitizedFile", "to_file", "be", "to", "blame", "because", "it", "File", "NUMBER", "open", "s", "and", "then", "delegates", "to", "the", "caller", "the", "responsibility", "to", "close", "the", "file", "NUMBER", "I", "know", "that", "behavior", "from", "C", "function", "but", "I", "m", "not", "sure", "if", "it", "s", "the", "correct", "design", "here", "because", "I", "lack", "the", "knowledge", "on", "CarrierWave", "and", "be", "left", "with", "unanswered", "question", "which", "entity", "should", "know", "the", "state", "of", "the", "open", "d", "file", "It", "seems", "SanitizedFile", "can", "be", "initialized", "with", "a", "File", "object", "and", "to_file", "simply", "forwards", "it", "if", "that", "s", "the", "case", "so", "be", "it", "safe", "to", "close", "it", "from", "outside", "The", "current", "implementation", "makes", "it", "impossible", "to", "decide", "since", "to_file", "either", "returns", "file", "if", "it", "s", "a", "File", "or", "a", "brand", "new", "object", "from", "File", "NUMBER", "open", "NUMBER", "Since", "it", "seems", "to_file", "was", "exclusively", "created", "to", "be", "use", "in", "store", "there", "s", "only", "a", "single", "occurrence", "of", "a", "to_file", "call", "and", "it", "s", "inside", "store", "maybe", "it", "would", "be", "better", "to", "remove", "the", "whole", "to_file", "method", "pass", "only", "the", "path", "and", "the", "client", "opens", "and", "close", "it", "In", "this", "fix", "I", "chose", "the", "laziest", "approach", "and", "close", "the", "file", "from", "outside", "NUMBER", "Also", "I", "didn", "t", "write", "any", "specs", "because", "I", "wasn", "t", "sure", "what", "was", "to", "be", "test", "the", "way", "it", "be", "now", "to_file", "throw", "the", "open", "d", "file", "and", "forgets", "NUMBER", "So", "it", "comes", "down", "to", "test", "that", "there", "be", "zero", "open", "file", "descriptors", "after", "callers", "of", "to_file", "be", "do", "which", "sounds", "like", "implement", "a", "james", "bond", "test", "like", "a", "kernel", "module", "NUMBER", "Or", "be", "I", "wrong", "If", "it", "matters", "I", "pinned", "that", "File", "NUMBER", "open", "down", "use", "rbtrace", "LINK", "on", "a", "call", "to", "recreate_versions", "tracer", "use", "LINK", "and", "the", "output", "LINK", "of", "it", "interesting", "lines", "in", "the", "output", "NUMBER", "NUMBER", "and", "monitoring", "proc", "TAG", "fd", "and", "a", "lot", "of", "code", "reading", "of", "course", "NUMBER", "NUMBER", "for", "this", "patch", "NUMBER", "I", "don", "t", "know", "how", "we", "could", "spec", "this", "one", "maybe", "checking", "if", "every", "File", "NUMBER", "open", "has", "a", "File", "NUMBER", "close", "NUMBER", "But", "this", "problem", "can", "easily", "be", "avoided", "adopting", "Ruby", "best", "practices", "always", "use", "block", "syntax", "when", "work", "with", "file", "to", "ensure", "that", "the", "file", "will", "be", "close", "NUMBER", "And", "for", "this", "to", "happen", "need", "to", "always", "keep", "the", "File", "NUMBER", "open", "within", "the", "scope", "of", "the", "method", "to", "not", "leave", "any", "open", "doors", "NUMBER", "So", "maybe", "it", "s", "a", "good", "idea", "to", "extract", "to_file", "from", "SanitizedFile", "as", "NUMBER", "k", "suggested", "NUMBER", "bensie", "this", "be", "probably", "an", "issue", "that", "should", "be", "applied", "to", "file", "stores", "as", "well", "correct", "it", "would", "be", "nice", "to", "have", "this", "include", "in", "a", "NUMBER", "release", "NUMBER", "I", "can", "t", "upgrade", "to", "NUMBER", "because", "I", "can", "t", "upgrade", "to", "rails", "NUMBER", "and", "it", "s", "pretty", "serious", "NUMBER", "bensie", "thanks", "it", "seems", "like", "there", "be", "no", "way", "to", "check", "whether", "the", "remote", "file", "actually", "exists", "via", "carrierwave", "fog", "without", "doing", "some", "sort", "of", "file", "NUMBER", "size", "that", "will", "throw", "an", "exception", "would", "be", "nice", "to", "have", "this", "be", "part", "of", "the", "standard", "suite", "NUMBER", "It", "looks", "like", "the", "gravity", "option", "for", "resize_to_fill", "was", "miss", "from", "the", "ClassMethods", "NUMBER", "For", "instance", "setting", "up", "a", "version", "like", "this", "ruby", "version", "large", "do", "resize_to_fill", "NUMBER", "NUMBER", "North", "end", "would", "result", "in", "a", "wrong", "number", "of", "argument", "error", "NUMBER", "I", "couldn", "t", "find", "a", "set", "of", "test", "which", "use", "the", "public", "ClassMethods", "but", "all", "exist", "test", "still", "pass", "after", "this", "addition", "NUMBER", "Let", "me", "know", "if", "there", "s", "anything", "I", "should", "change", "try", "NUMBER", "if", "i", "try", "to", "use", "resize_to_fit", "from", "RMagick", "module", "at", "version", "process", "method", "see", "uploader", "file", "it", "crashes", "app", "NUMBER", "code", "version", "thumb", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "it", "isnt", "compatible", "trace", "header", "Users", "fagnermoura", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "rc", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "BUG", "Segmentation", "fault", "ruby", "NUMBER", "dev", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "Control", "frame", "information", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "read", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "fagnermoura", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "rc", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "fagnermoura", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "rc", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "fagnermoura", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "rc", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "processing", "NUMBER", "rb", "NUMBER", "i", "already", "try", "to", "reinstall", "imagemagick", "but", "NUMBER", "not", "works", "NUMBER", "via", "homebrew", "i", "think", "this", "be", "a", "common", "issue", "when", "use", "rmagick", "use", "resize", "image", "therefore", "i", "believe", "that", "this", "error", "not", "exists", "NUMBER", "but", "im", "not", "sure", "NUMBER", "but", "it", "can", "be", "frustrating", "to", "carrierwave", "users", "try", "to", "use", "rmagick", "anyway", "NUMBER", "ill", "try", "to", "use", "minimagick", "tks", "yep", "i", "agree", "NUMBER", "i", "just", "replace", "it", "by", "minimagick", "and", "works", "fine", "NUMBER", "tks", "bensie", "Hi", "I", "ve", "be", "discussing", "this", "error", "issue", "NUMBER", "and", "I", "be", "not", "able", "to", "bypass", "it", "NUMBER", "Is", "it", "possible", "to", "reopen", "issue", "NUMBER", "LINK", "Thanks", "in", "advance", "NUMBER", "Hi", "bensie", "this", "issue", "be", "not", "relate", "to", "mongoid", "NUMBER", "bensie", "you", "be", "right", "it", "s", "issue", "NUMBER", "LINK", "I", "ve", "describe", "a", "possible", "solution", "that", "in", "my", "case", "resolve", "it", "when", "developing", "on", "vagrant", "vms", "NUMBER", "I", "think", "commit", "NUMBER", "e", "NUMBER", "ae", "broke", "the", "serialization", "of", "Mongoid", "models", "with", "a", "carrierwave", "uploader", "mounted", "NUMBER", "It", "throw", "the", "following", "when", "trying", "to", "render", "the", "NUMBER", "json", "ActiveSupport", "JSON", "Encoding", "CircularReferenceError", "in", "Advertising", "BrandsController", "show", "object", "references", "itself", "When", "I", "use", "the", "stable", "gem", "all", "be", "fine", "when", "I", "run", "master", "it", "breaks", "NUMBER", "Test", "case", "Gemfile", "gem", "carrierwave", "git", "git", "github", "NUMBER", "com", "jnicklas", "carrierwave", "NUMBER", "git", "gem", "carrierwave", "mongoid", "require", "carrierwave", "mongoid", "Mount", "Uploader", "on", "Model", "try", "to", "render", "JSON", "for", "that", "model", "NUMBER", "I", "see", "I", "posted", "it", "here", "because", "the", "commit", "that", "broke", "it", "was", "made", "on", "this", "repo", "But", "I", "understand", "the", "reasoning", "NUMBER", "Thanks", "Is", "possible", "to", "have", "a", "pre", "version", "on", "rubygems", "Thanks", "I", "have", "a", "scenario", "where", "i", "be", "uploading", "file", "dynamically", "use", "ajax", "remotipart", "then", "later", "i", "assign", "those", "uploaded", "file", "to", "any", "model", "NUMBER", "I", "have", "such", "settings", "in", "uploader", "NUMBER", "ruby", "class", "DocumentUploader", "TAG", "true", "validates", "document", "presence", "true", "validates", "description", "presence", "true", "end", "class", "Post", "TAG", "documentable", "end", "When", "i", "upload", "a", "document", "without", "provide", "documentable", "source", "it", "uploads", "the", "file", "to", "uploads", "documents", "uploaded_file", "NUMBER", "doc", "But", "when", "i", "assign", "that", "document", "to", "some", "other", "model", "like", "post", "Post", "NUMBER", "first", "post", "NUMBER", "documents", "TAG", "If", "not", "then", "this", "could", "just", "memoize", "as", "fog", "or", "whatever", "instead", "of", "a", "hash", "NUMBER", "Did", "you", "mean", "use", "only", "one", "fog", "credentials", "in", "the", "app", "I", "don", "t", "expect", "that", "fog", "credentials", "will", "change", "dynamically", "but", "may", "use", "two", "or", "more", "credentials", "for", "each", "uploader", "class", "NUMBER", "labocho", "Yep", "I", "did", "mean", "having", "just", "one", "NUMBER", "I", "wasn", "t", "sure", "what", "was", "common", "practice", "or", "not", "NUMBER", "Since", "it", "seems", "like", "there", "could", "be", "many", "different", "cases", "I", "guess", "the", "easiest", "will", "probably", "be", "to", "just", "use", "the", "whole", "hash", "as", "a", "key", "NUMBER", "It", "be", "a", "big", "hash", "key", "but", "it", "should", "always", "work", "and", "that", "be", "more", "important", "NUMBER", "Sorry", "for", "the", "confusion", "and", "thanks", "for", "the", "patch", "bensie", "Thanks", "for", "bouncing", "the", "ideas", "around", "with", "me", "for", "a", "bit", "NUMBER", "Upon", "further", "consideration", "I", "think", "the", "simplest", "be", "to", "merge", "as", "be", "NUMBER", "I", "don", "t", "generally", "like", "use", "a", "hash", "as", "a", "key", "in", "another", "hash", "but", "it", "be", "less", "likely", "to", "cause", "other", "issue", "if", "we", "just", "go", "with", "that", "here", "I", "think", "NUMBER", "Thanks", "bensie", "geemus", "Hi", "guys", "I", "be", "encountering", "this", "really", "weird", "issue", "NUMBER", "My", "code", "ruby", "class", "ImageUploader", "TAG", "is_avatar", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "full", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "protected", "def", "is_avatar", "image", "return", "model", "NUMBER", "is_avatar", "end", "end", "My", "model", "has", "an", "attribute", "call", "is_avatar", "NUMBER", "It", "be", "boolean", "NUMBER", "I", "checked", "its", "status", "by", "setting", "the", "filename", "to", "model", "NUMBER", "user", "NUMBER", "id", "model", "NUMBER", "is_avatar", "and", "every", "time", "the", "file", "name", "turned", "up", "to", "be", "NUMBER", "true", "when", "the", "other", "version", "be", "saved", "NUMBER", "So", "I", "can", "be", "sure", "that", "is_avatar", "be", "actually", "TRUE", "NUMBER", "Yet", "version", "avatar", "be", "never", "run", "NUMBER", "I", "be", "completely", "gobsmacked", "NUMBER", "It", "do", "run", "NUMBER", "If", "I", "just", "return", "a", "string", "it", "runs", "the", "avatar", "NUMBER", "But", "if", "i", "try", "to", "use", "model", "NUMBER", "is_avatar", "boolean", "which", "returns", "true", "it", "doesnt", "run", "avatar", "NUMBER", "bensie", "Yeah", "I", "ll", "take", "a", "look", "NUMBER", "Bit", "busy", "at", "the", "moment", "but", "I", "ll", "do", "my", "best", "to", "find", "some", "time", "in", "the", "next", "few", "days", "NUMBER", "bensie", "sorry", "not", "sure", "how", "that", "fell", "off", "my", "radar", "NUMBER", "Will", "revisit", "probably", "early", "next", "week", "NUMBER", "bensie", "short", "answer", "mime", "type", "be", "calculated", "and", "set", "in", "the", "request", "when", "you", "save", "an", "object", "but", "currently", "it", "do", "not", "propogate", "this", "info", "back", "up", "to", "the", "model", "NUMBER", "So", "if", "you", "reloaded", "the", "fog", "model", "after", "the", "save", "the", "test", "would", "pass", "but", "checking", "the", "content", "type", "directly", "after", "saving", "it", "won", "t", "have", "change", "it", "yet", "NUMBER", "Need", "to", "think", "about", "the", "proper", "fix", "I", "want", "the", "request", "to", "work", "on", "it", "s", "own", "and", "I", "d", "rather", "not", "have", "to", "do", "the", "content", "type", "checking", "twice", "NUMBER", "bensie", "sorry", "again", "for", "the", "delay", "NUMBER", "Fixed", "here", "LINK", "I", "ll", "try", "to", "roll", "a", "release", "tomorrow", "or", "at", "least", "this", "week", "NUMBER", "bensie", "my", "pleasure", "NUMBER", "It", "helped", "reveal", "a", "couple", "rather", "long", "standing", "edge", "case", "bug", "in", "fogs", "file", "models", "that", "be", "good", "to", "finally", "fix", "NUMBER", "I", "have", "this", "in", "my", "controller", "respond_to", "do", "format", "format", "NUMBER", "json", "render", "json", "picture", "format", "NUMBER", "xml", "render", "xml", "picture", "end", "My", "json", "renders", "something", "like", "image", "url", "uploads", "picture", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "c", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "a", "NUMBER", "af", "NUMBER", "e", "NUMBER", "d", "NUMBER", "c", "NUMBER", "jpg", "small", "url", "uploads", "picture", "NUMBER", "NUMBER", "NUMBER", "small_", "NUMBER", "c", "NUMBER", "f", "NUMBER", "cc", "NUMBER", "a", "NUMBER", "af", "NUMBER", "e", "NUMBER", "d", "NUMBER", "c", "NUMBER", "jpg", "while", "my", "xml", "format", "renders", "something", "like", "lt", "image", "d", "NUMBER", "af", "NUMBER", "d", "NUMBER", "b", "NUMBER", "a", "NUMBER", "b", "NUMBER", "fa", "NUMBER", "dbf", "NUMBER", "c", "NUMBER", "jpg", "lt", "image", "I", "believe", "it", "s", "a", "know", "issue", "that", "to_xml", "and", "to_json", "don", "t", "match", "NUMBER", "LINK", "_spec", "NUMBER", "rb", "L", "NUMBER", "Any", "help", "in", "this", "would", "be", "most", "appreciated", "FWIW", "issue", "NUMBER", "was", "about", "this", "as", "well", "NUMBER", "BTW", "awesome", "work", "this", "weekend", "bensie", "tada", "Btw", "since", "Rails", "NUMBER", "both", "to_xml", "and", "to_json", "calls", "serializable", "hash", "NUMBER", "Does", "this", "help", "solve", "any", "problem", "Here", "be", "the", "thing", "you", "cannot", "really", "rely", "on", "ActiveModel", "API", "for", "serialization", "NUMBER", "ActiveModel", "do", "not", "say", "anything", "about", "serialization", "it", "just", "provide", "some", "default", "behavior", "but", "it", "do", "not", "force", "ORMs", "to", "implement", "it", "opposite", "to", "persisted", "to_key", "and", "other", "methods", "that", "be", "required", "and", "their", "behavior", "enforced", "NUMBER", "This", "means", "that", "any", "ORM", "can", "implement", "whatever", "they", "want", "so", "there", "isn", "t", "an", "unified", "way", "that", "Carrierwave", "could", "take", "advantage", "for", "NUMBER", "Would", "it", "be", "better", "if", "AcitveRecord", "and", "ActiveModel", "serialization", "behavior", "were", "more", "similar", "Yes", "it", "would", "NUMBER", "We", "can", "focus", "on", "it", "as", "long", "as", "it", "be", "clear", "that", "their", "APIs", "_can_", "be", "different", "NUMBER", "That", "said", "have", "you", "checked", "if", "to_xml", "in", "ActiveRecord", "be", "calling", "serializable_hash", "or", "be", "it", "simply", "ignoring", "it", "How", "can", "I", "get", "the", "with", "and", "height", "of", "the", "current", "instance", "of", "carrierwave", "something", "like", "this", "NUMBER", "ruby", "car_images", "NUMBER", "each", "do", "image", "image_tag", "image", "NUMBER", "photo_url", "width", "image", "NUMBER", "photo_width", "height", "image", "NUMBER", "photo_height", "end", "unfortunately", "image", "NUMBER", "photo_width", "and", "image", "NUMBER", "photo_height", "be", "not", "work", "I", "need", "to", "specify", "the", "width", "and", "height", "of", "the", "images", "it", "be", "required", "on", "the", "jquery", "plugin", "I", "m", "use", "NUMBER", "Thanks", "NUMBER", "I", "think", "the", "wiki", "has", "some", "info", "about", "that", "NUMBER", "Yes", "there", "be", "I", "already", "write", "this", "in", "my", "upload", "def", "get_version_dimensions", "width", "height", "identify", "format", "wx", "h", "file", "NUMBER", "path", "NUMBER", "split", "x", "end", "but", "still", "the", "docs", "didn", "t", "mention", "on", "how", "to", "get", "the", "value", "when", "you", "need", "it", "in", "the", "view", "NUMBER", "You", "ll", "want", "to", "store", "it", "yourself", "in", "the", "database", "NUMBER", "I", "recently", "migrated", "my", "carrierwave", "from", "file", "storage", "to", "Amazon", "S", "NUMBER", "use", "fog", "NUMBER", "I", "copied", "the", "directory", "structure", "from", "my", "uploaded", "file", "to", "a", "bucket", "and", "configured", "carrierwave", "NUMBER", "It", "be", "all", "work", "since", "new", "file", "be", "uploading", "properly", "NUMBER", "However", "my", "exist", "file", "instances", "be", "nil", "NUMBER", "How", "can", "I", "generate", "carrierwave", "objects", "for", "all", "my", "uploader", "file", "instances", "so", "as", "to", "prevent", "having", "to", "re", "upload", "all", "my", "file", "again", "What", "do", "you", "mean", "the", "file", "instances", "be", "nil", "The", "file", "aren", "t", "accessible", "on", "s", "NUMBER", "Maybe", "it", "s", "permissions", "NUMBER", "Maybe", "the", "file", "IDs", "have", "change", "I", "m", "not", "clear", "what", "s", "wrong", "NUMBER", "Please", "be", "a", "bit", "more", "specific", "NUMBER", "On", "Jan", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "brewster", "NUMBER", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "I", "recently", "migrated", "my", "carrierwave", "from", "file", "storage", "to", "Amazon", "S", "NUMBER", "use", "fog", "NUMBER", "I", "copied", "the", "directory", "structure", "from", "my", "uploaded", "file", "to", "a", "bucket", "and", "configured", "carrierwave", "NUMBER", "It", "be", "all", "work", "since", "new", "file", "be", "uploading", "properly", "NUMBER", "However", "my", "exist", "file", "instances", "be", "nil", "NUMBER", "How", "can", "I", "generate", "carrierwave", "objects", "for", "all", "my", "uploader", "file", "instances", "so", "as", "to", "prevent", "having", "to", "re", "upload", "all", "my", "file", "again", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "maybe", "showing", "code", "be", "the", "best", "explanation", "initializer", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "orage", "fog", "config", "NUMBER", "cache_dir", "Rails", "NUMBER", "root", "tmp", "uploads", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "ENV", "AWS_ACCESS_KEY_ID", "aws_secret_access_key", "ENV", "AWS_SECRET_ACCESS_KEY", "config", "NUMBER", "fog_directory", "ENV", "FOG_DIRECTORY", "end", "model", "class", "User", "include", "Mongoid", "Document", "mount_uploader", "avatar", "AvatarUploader", "end", "console", "from", "a", "migrated", "user", "avatar", "uploaded", "while", "use", "storage", "file", "User", "NUMBER", "first", "NUMBER", "avatar", "NUMBER", "class", "AvatarUploader", "User", "NUMBER", "first", "NUMBER", "avatar", "NUMBER", "file", "nil", "from", "a", "new", "user", "avatar", "uploaded", "after", "moving", "to", "storage", "fog", "User", "NUMBER", "last", "NUMBER", "avatar", "NUMBER", "file", "TAG", "path", "uploads", "avatars", "NUMBER", "f", "NUMBER", "fa", "NUMBER", "f", "NUMBER", "d", "IMG_", "NUMBER", "JPG", "the", "User", "IDs", "be", "still", "the", "same", "as", "the", "directory", "names", "its", "just", "that", "there", "be", "no", "file", "object", "for", "the", "users", "that", "were", "migrated", "over", "NUMBER", "here", "be", "what", "i", "find", "from", "the", "mongo", "shell", "NUMBER", "_id", "ObjectId", "NUMBER", "e", "NUMBER", "a", "NUMBER", "a", "NUMBER", "c", "NUMBER", "cc", "NUMBER", "avatar_filename", "img_", "NUMBER", "jpg", "_id", "ObjectId", "NUMBER", "f", "NUMBER", "fa", "NUMBER", "f", "NUMBER", "d", "avatar", "IMG_", "NUMBER", "JPG", "the", "first", "object", "be", "User", "NUMBER", "first", "NUMBER", "the", "second", "be", "User", "NUMBER", "last", "NUMBER", "the", "attribute", "for", "the", "filename", "change", "NUMBER", "Ah", "I", "think", "that", "s", "the", "problem", "NUMBER", "The", "column", "name", "default", "for", "mongoid", "was", "change", "at", "some", "point", "NUMBER", "You", "should", "run", "a", "migration", "of", "some", "kind", "to", "make", "those", "all", "match", "up", "NUMBER", "On", "Jan", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "brewster", "NUMBER", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "here", "be", "what", "i", "find", "from", "the", "mongo", "shell", "NUMBER", "_id", "ObjectId", "NUMBER", "e", "NUMBER", "a", "NUMBER", "a", "NUMBER", "c", "NUMBER", "cc", "NUMBER", "avatar_filename", "img_", "NUMBER", "jpg", "_id", "ObjectId", "NUMBER", "f", "NUMBER", "fa", "NUMBER", "f", "NUMBER", "d", "avatar", "IMG_", "NUMBER", "JPG", "the", "first", "object", "be", "User", "NUMBER", "first", "NUMBER", "the", "second", "be", "User", "NUMBER", "last", "NUMBER", "the", "attribute", "for", "the", "filename", "change", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "when", "i", "start", "use", "the", "carrierwave", "mongoid", "gem", "it", "exposes", "a", "mount_on", "method", "to", "prevent", "having", "to", "migrate", "NUMBER", "i", "just", "had", "to", "do", "mount", "avatar", "mount_on", "avatar_filename", "and", "its", "back", "run", "Glad", "to", "hear", "it", "thanks", "for", "update", "this", "ticket", "with", "your", "solution", "NUMBER", "Hi", "there", "I", "m", "use", "carrierwave", "in", "my", "app", "it", "s", "pretty", "nice", "NUMBER", "But", "when", "I", "try", "to", "upload", "file", "which", "path", "contains", "some", "Chinese", "it", "rails", "mini_magick_processing_error", "NUMBER", "Then", "I", "tried", "the", "uploader", "store", "method", "and", "pass", "a", "file", "which", "opened", "use", "UTF", "NUMBER", "but", "still", "get", "the", "same", "error", "NUMBER", "When", "I", "digged", "deepper", "I", "find", "the", "current_path", "was", "the", "reason", "to", "cause", "the", "problem", "NUMBER", "So", "I", "forced", "it", "to", "UTF", "NUMBER", "and", "it", "worked", "NUMBER", "And", "when", "read", "upload", "file", "out", "say", "picture", "NUMBER", "url", "still", "suffered", "with", "the", "encoding", "issue", "NUMBER", "I", "m", "tried", "not", "offend", "the", "source", "code", "so", "I", "did", "this", "and", "it", "worked", "ruby", "class", "PictureUploader", "TAG", "git", "github", "NUMBER", "com", "jnicklas", "carrierwave", "NUMBER", "git", "and", "it", "still", "fail", "when", "accessing", "image", "version", "NUMBER", "this", "bit", "LINK", "here", "s", "the", "NUMBER", "rc", "NUMBER", "output", "of", "an", "asset", "LINK", "here", "s", "the", "NUMBER", "output", "of", "the", "same", "asset", "LINK", "only", "change", "here", "was", "to", "gem", "file", "to", "toggle", "Rails", "version", "NUMBER", "gemfile", "NUMBER", "lock", "full", "gist", "LINK", "and", "LINK", "just", "to", "make", "sure", "it", "s", "not", "an", "awesome_print", "problem", "NUMBER", "This", "be", "still", "an", "issue", "for", "me", "too", "I", "think", "that", "commit", "be", "in", "the", "NUMBER", "NUMBER", "stable", "branch", "as", "well", "NUMBER", "The", "commit", "be", "definitely", "in", "NUMBER", "NUMBER", "stable", "and", "made", "it", "into", "the", "release", "of", "NUMBER", "Yet", "this", "problem", "with", "NUMBER", "NoMethodError", "undefined", "method", "remove_previously_stored_files_after_update", "for", "nil", "NilClass", "Still", "be", "an", "issue", "NUMBER", "I", "ll", "have", "a", "look", "into", "it", "this", "weekend", "NUMBER", "I", "d", "like", "to", "move", "to", "Rails", "NUMBER", "ASAP", "to", "keep", "up", "and", "I", "think", "this", "be", "the", "last", "thing", "on", "my", "list", "to", "check", "off", "NUMBER", "fyi", "my", "output", "be", "use", "awesome_print", "to", "prettify", "object", "dumps", "not", "Rails", "NUMBER", "bensie", "I", "m", "seeing", "the", "wrong", "behavior", "too", "In", "NUMBER", "final", "this", "be", "what", "I", "get", "for", "a", "User", "ActiveRecord", "model", "with", "mount_uploader", "avatar", "AvatarUploader", "User", "NUMBER", "find", "NUMBER", "NUMBER", "avatar", "NUMBER", "class", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "DEBUG", "ActiveRecord", "Base", "User", "Load", "NUMBER", "ms", "SELECT", "users", "NUMBER", "FROM", "users", "WHERE", "users", "NUMBER", "id", "NUMBER", "LIMIT", "NUMBER", "id", "NUMBER", "String", "TAG", "show", "source", "User", "NUMBER", "find", "NUMBER", "NUMBER", "avatar", "From", "home", "nixme", "Projects", "manymoon", "deathstar", "vendor", "bundle", "ruby", "NUMBER", "bundler", "g", "ems", "carrierwave", "NUMBER", "a", "NUMBER", "b", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "line", "NUMBER", "Number", "of", "lines", "NUMBER", "Owner", "User", "Visibility", "public", "def", "column", "super", "end", "def", "column", "new_file", "super", "end", "RUBY", "NUMBER", "So", "it", "seems", "the", "super", "call", "be", "hitting", "the", "original", "accessor", "and", "not", "the", "include", "Module", "that", "s", "created", "in", "mount", "NUMBER", "rb", "right", "underneath", "those", "lines", "NUMBER", "I", "understand", "NUMBER", "work", "on", "an", "extraction", "right", "now", "NUMBER", "Our", "app", "be", "pretty", "large", "but", "I", "just", "wanted", "to", "point", "out", "we", "re", "seeing", "it", "too", "NUMBER", "I", "can", "post", "my", "Gemfile", "but", "it", "s", "also", "very", "long", "and", "don", "t", "think", "it", "ll", "help", "too", "many", "libs", "NUMBER", "But", "I", "investigated", "further", "looking", "at", "the", "inheritance", "chain", "of", "User", "avatar", "NUMBER", "In", "NUMBER", "my", "User", "model", "has", "the", "following", "inheritance", "chain", "and", "whether", "or", "not", "the", "method", "avatar", "be", "defined", "User", "true", "TAG", "true", "CarrierWave", "Validations", "ActiveModel", "HelperMethods", "false", "CarrierWave", "Validations", "ActiveModel", "false", "TAG", "true", "CarrierWave", "Mount", "Extension", "false", "NUMBER", "In", "NUMBER", "the", "same", "model", "shows", "the", "following", "User", "true", "TAG", "false", "CarrierWave", "Validations", "ActiveModel", "HelperMethods", "false", "CarrierWave", "Validations", "ActiveModel", "false", "TAG", "true", "CarrierWave", "Mount", "Extension", "false", "NUMBER", "So", "the", "super", "call", "at", "L", "NUMBER", "of", "mount", "NUMBER", "rb", "ends", "up", "hitting", "that", "first", "Module", "in", "Rails", "NUMBER", "and", "doesn", "t", "in", "NUMBER", "cause", "avatar", "s", "not", "defined", "in", "that", "module", "NUMBER", "The", "second", "nameless", "module", "be", "the", "one", "defined", "in", "mount_uploader", "in", "mount", "NUMBER", "rb", "where", "we", "d", "expect", "super", "to", "hit", "NUMBER", "So", "what", "s", "in", "that", "module", "show", "source", "self", "NUMBER", "class", "NUMBER", "ancestors", "NUMBER", "avatar", "From", "home", "nixme", "Projects", "manymoon", "deathstar", "vendor", "bundle", "ruby", "NUMBER", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "read", "NUMBER", "rb", "line", "NUMBER", "Number", "of", "lines", "NUMBER", "Owner", "TAG", "Visibility", "public", "def", "__temp__", "internal_attribute_access_code", "attr_name", "cast_code", "end", "While", "in", "NUMBER", "it", "s", "not", "defined", "although", "avatar_before_type_cast", "avatar_changed", "avatar_change", "avatar_will_change", "avatar_was", "and", "reset_avatar", "be", "defined", "in", "that", "Module", "I", "m", "still", "work", "on", "an", "extraction", "that", "exhibits", "the", "behavior", "NUMBER", "Hi", "guys", "I", "also", "have", "these", "issue", "NUMBER", "After", "upgrading", "Rails", "to", "NUMBER", "and", "Ruby", "to", "NUMBER", "I", "get", "also", "this", "error", "message", "NUMBER", "undefined", "method", "thumb", "for", "Grand_Canyon__Arizona__USA", "NUMBER", "jpg", "String", "Is", "there", "already", "a", "solution", "available", "Or", "do", "someone", "know", "why", "that", "error", "appears", "I", "m", "seeing", "this", "newly", "upgrade", "to", "NUMBER", "LINK", "There", "s", "the", "Gemfile", "and", "Gemfile", "NUMBER", "lock", "NUMBER", "I", "m", "seeing", "ActiveModel", "MissingAttributeError", "can", "t", "write", "unknown", "attribute", "avatar", "I", "guess", "we", "all", "have", "avatars", "out", "of", "any", "code", "that", "touches", "the", "user", "model", "significantly", "the", "avatar", "uploader", "be", "defined", "as", "mount_uploader", "avatar", "FileUploader", "FileUploader", "looks", "like", "this", "ruby", "class", "FileUploader", "TAG", "png", "def", "store_dir", "p", "model", "NUMBER", "to_param", "if", "p", "NUMBER", "p", "model", "NUMBER", "class", "NUMBER", "model_name", "NUMBER", "downcase", "end", "Rails", "NUMBER", "root", "Rails", "NUMBER", "env", "NUMBER", "test", "tmp", "public", "images", "dat", "mounted_as", "p", "NUMBER", "p", "end", "def", "filename", "p", "model", "NUMBER", "to_param", "if", "p", "NUMBER", "p", "model", "NUMBER", "class", "NUMBER", "model_name", "NUMBER", "downcase", "end", "model", "NUMBER", "to_param", "NUMBER", "png", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "bensie", "here", "be", "my", "gemfile", "LINK", "and", "my", "gemfile", "NUMBER", "lock", "LINK", "I", "hope", "it", "helps", "you", "Ran", "into", "the", "same", "issue", "and", "traced", "it", "down", "to", "an", "old", "version", "of", "kaminari", "NUMBER", "Bumping", "fix", "it", "NUMBER", "tada", "smoking", "gun", "checkered_flag", "Awesome", "NUMBER", "Even", "with", "Kaminari", "NUMBER", "I", "m", "still", "seeing", "this", "error", "NUMBER", "Error", "test_registration_with_facebook_is_silky_smooth", "TestRegistrationWithFacebook", "ActiveModel", "MissingAttributeError", "can", "t", "write", "unknown", "attribute", "avatar", "app", "controllers", "users", "omniauth_callbacks_controller", "NUMBER", "rb", "NUMBER", "in", "facebook", "test", "integration", "registration_with_facebook_test", "NUMBER", "rb", "NUMBER", "in", "test_registration_with_facebook_is_silky_smooth", "I", "m", "assuming", "I", "have", "some", "other", "plugin", "stepping", "on", "inherited", "but", "I", "wanted", "to", "leave", "this", "comment", "here", "so", "that", "it", "s", "know", "for", "others", "that", "upgrading", "Kaminari", "isn", "t", "the", "canonical", "fix", "NUMBER", "Update", "Full", "unsilenced", "backtrace", "here", "LINK", "file_backtrace", "NUMBER", "log", "top", "of", "my", "model", "here", "LINK", "file_user", "NUMBER", "rb", "NUMBER", "I", "m", "use", "_carrierwave_", "from", "Git", "at", "SHA", "NUMBER", "a", "NUMBER", "ce", "NUMBER", "I", "have", "ruled", "out", "_role_model_", "as", "cause", "the", "error", "although", "they", "do", "have", "a", "similar", "inherited", "method", "but", "it", "doesn", "t", "appear", "to", "conflict", "NUMBER", "Curiously", "this", "be", "just", "_one_", "of", "four", "uploaders", "in", "my", "application", "and", "the", "others", "appear", "to", "work", "as", "expected", "NUMBER", "I", "can", "t", "isolate", "what", "be", "special", "about", "my", "user", "model", "except", "for", "_devise_", "I", "have", "tried", "with", "devise", "NUMBER", "x", "and", "NUMBER", "same", "problem", "with", "both", "NUMBER", "I", "have", "also", "tried", "with", "and", "without", "_role_model_", "bensie", "turned", "out", "to", "be", "an", "unmigrated", "database", "and", "a", "bad", "schema", "merge", "masking", "miss", "migrations", "I", "assume", "as", "the", "fallback", "for", "our", "test", "cases", "be", "gravatar", "and", "the", "test", "avatar", "and", "the", "gravatar", "images", "were", "the", "same", "I", "dare", "say", "it", "s", "never", "worked", "thank", "god", "we", "re", "not", "in", "production", "yet", "I", "have", "some", "code", "in", "nested", "formtastic", "form", "TAG", "images", "do", "i", "TAG", "file", "TAG", "hidden", "Remove", "TAG", "TAG", "remove_image", "doesn", "t", "work", "yes", "i", "have", "attr_accessible", "remove_image", "in", "model", "remove_image", "in", "view", "work", "half", "way", "because", "it", "remove", "file", "but", "doesn", "t", "remove", "image", "from", "model", "It", "s", "going", "to", "be", "hard", "to", "track", "this", "down", "without", "more", "information", "NUMBER", "Can", "you", "tell", "if", "this", "be", "only", "a", "problem", "with", "nested", "form", "I", "wonder", "if", "that", "could", "be", "an", "issue", "NUMBER", "Please", "do", "some", "more", "test", "and", "let", "us", "know", "if", "you", "find", "anything", "interesting", "NUMBER", "If", "you", "could", "provide", "a", "sample", "application", "that", "would", "be", "cool", "too", "NUMBER", "Hello", "I", "be", "having", "a", "similar", "issue", "with", "remove", "and", "with", "the", "cache", "in", "a", "nested", "form", "NUMBER", "Here", "be", "the", "code", "for", "the", "parent", "and", "child", "models", "NUMBER", "ruby", "class", "Company", "TAG", "destroy", "attr_accessible", "name", "logo", "remove_logo", "logo_cache", "images_attributes", "mount_uploader", "logo", "LogoUploader", "accepts_nested_attributes_for", "images", "allow_destroy", "true", "end", "ruby", "class", "Image", "TAG", "AWS", "aws_access_key_id", "XXXX", "aws_secret_access_key", "XXXX", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "site_images", "required", "config", "NUMBER", "fog_public", "true", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "When", "i", "change", "the", "storage", "to", "file", "not", "fog", "then", "i", "do", "not", "get", "error", "NUMBER", "Are", "there", "any", "other", "fog", "settings", "i", "be", "skipping", "or", "miss", "NUMBER", "Any", "help", "greatly", "appreciated", "NUMBER", "Is", "that", "the", "whole", "content", "of", "the", "avatar_uploader", "file", "looking", "at", "the", "README", "it", "looks", "like", "it", "should", "be", "more", "along", "the", "lines", "of", "class", "AvatarUploader", "TAG", "process", "convert_svg", "def", "convert_svg", "manipulate", "do", "img", "if", "img", "format", "SVG", "img", "NUMBER", "format", "PNG", "end", "img", "end", "end", "def", "filename", "secure_token", "NUMBER", "file", "NUMBER", "extension", "NUMBER", "gsub", "svg", "PNG", "NUMBER", "gsub", "SVG", "PNG", "if", "original_filename", "end", "TAG", "and", "then", "doing", "TAG", "version", "thumb", "do", "process", "resize_to_limit_with_gif_fix", "NUMBER", "NUMBER", "end", "TAG", "will", "result", "in", "the", "version", "be", "generate", "use", "manipulate", "from", "the", "SVG", "version", "of", "the", "file", "rather", "than", "the", "PNG", "version", "NUMBER", "Which", "be", "awkward", "because", "SVG", "resize", "operations", "take", "forever", "not", "to", "mention", "the", "slight", "detail", "of", "the", "NUMBER", "gigabytes", "of", "RAM", "a", "simple", "NUMBER", "kb", "SVG", "requires", "to", "be", "resized", "NUMBER", "What", "I", "m", "trying", "to", "do", "be", "have", "the", "SVG", "converted", "to", "a", "PNG", "takes", "NUMBER", "seconds", "and", "nearly", "no", "RAM", "which", "works", "but", "then", "have", "the", "version", "use", "the", "PNG", "version", "of", "the", "image", "for", "their", "operations", "which", "amount", "to", "a", "resize", "or", "in", "the", "case", "of", "GIFs", "coalesce", "resize", "optimize", "NUMBER", "I", "m", "use", "MiniMagick", "throughout", "NUMBER", "Is", "this", "functionality", "present", "in", "CarrierWave", "and", "I", "m", "just", "overlooking", "it", "or", "be", "this", "not", "something", "that", "can", "be", "do", "at", "present", "This", "be", "a", "fix", "to", "the", "issue", "describe", "in", "LINK", "I", "add", "a", "spec", "under", "the", "processing_spec", "NUMBER", "rb", "file", "NUMBER", "It", "s", "just", "test", "that", "converting", "a", "multi_page", "pdf", "with", "RMagick", "doesn", "t", "throw", "an", "error", "NUMBER", "The", "fix", "modifies", "the", "manipulate", "method", "so", "that", "if", "it", "s", "call", "on", "a", "multi", "page", "document", "without", "a", "block", "it", "will", "return", "the", "raw", "list", "of", "frames", "without", "trying", "to", "call", "a", "non", "existent", "block", "on", "them", "Today", "all", "of", "a", "sudden", "i", "get", "a", "bug", "when", "i", "attempted", "to", "upload", "my", "images", "with", "carrier", "NUMBER", "BUG", "Segmentation", "fault", "and", "the", "server", "crashed", "NUMBER", "I", "really", "couldnt", "understand", "what", "the", "problem", "was", "so", "i", "find", "a", "fix", "on", "this", "NUMBER", "In", "terminal", "brew", "unlink", "imagemagick", "AND", "AFTER", "brew", "install", "force", "imagemagick", "disable", "openmp", "This", "will", "uninstall", "the", "imagemagick", "and", "install", "it", "with", "proper", "settings", "NUMBER", "Hope", "this", "helps", "someone", "with", "the", "same", "problem", "NUMBER", "Best", "regards", "Forsberg", "This", "also", "has", "nothing", "to", "do", "with", "Carrierwave", "it", "be", "an", "imagemagick", "or", "rmagick", "problem", "NUMBER", "Hi", "I", "ve", "just", "run", "into", "a", "bug", "when", "use", "Carrierwave", "with", "the", "Padrino", "framework", "NUMBER", "This", "was", "report", "previously", "but", "the", "issue", "was", "hard", "to", "understand", "from", "the", "bug", "report", "given", "LINK", "I", "ll", "try", "to", "explain", "a", "bit", "further", "NUMBER", "Basically", "Carrierwave", "works", "very", "well", "with", "Padrino", "and", "I", "hadn", "t", "notice", "this", "problem", "until", "today", "because", "I", "ve", "always", "include", "something", "like", "this", "in", "my", "uploaders", "def", "root", "Padrino", "NUMBER", "root", "public", "end", "Starting", "on", "a", "new", "project", "I", "run", "into", "a", "weird", "problem", "today", "where", "uploads", "worked", "but", "attempts", "to", "access", "upload", "NUMBER", "file", "NUMBER", "url", "in", "a", "view", "was", "inexplicably", "blowing", "up", "NUMBER", "TAG", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "v", "NUMBER", "original_file", "NUMBER", "url", "TypeError", "can", "t", "convert", "nil", "into", "String", "from", "Users", "dave", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "expand_path", "The", "problem", "as", "seen", "from", "the", "stack", "trace", "be", "in", "line", "NUMBER", "of", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "File", "NUMBER", "expand_path", "root", "in", "that", "line", "doesn", "t", "work", "in", "Padrino", "because", "root", "be", "nil", "NUMBER", "I", "ll", "fork", "the", "gem", "and", "take", "a", "look", "at", "fix", "it", "then", "send", "a", "pull", "request", "NUMBER", "I", "imagine", "that", "it", "just", "needs", "something", "like", "an", "if", "defined", "Padrino", "somewhere", "NUMBER", "I", "ve", "do", "up", "a", "bug", "proof", "with", "a", "fail", "spec", "in", "a", "github", "repo", "LINK", "bug", "demo", "Padrino", "and", "Carrierwave", "be", "an", "ideal", "combination", "of", "light", "weight", "and", "ease", "of", "use", "fix", "this", "will", "hopefully", "help", "somebody", "else", "it", "was", "a", "bit", "of", "a", "head", "scratcher", "for", "me", "for", "an", "hour", "or", "so", "NUMBER", "Hm", "it", "may", "be", "a", "little", "more", "complex", "than", "I", "thought", "to", "fix", "this", "NUMBER", "I", "ve", "be", "looking", "at", "this", "code", "in", "carrierwave", "NUMBER", "rb", "elsif", "defined", "Sinatra", "CarrierWave", "NUMBER", "root", "if", "Sinatra", "Application", "NUMBER", "respond_to", "public_folder", "Sinatra", "NUMBER", "Sinatra", "Application", "NUMBER", "public_folder", "else", "Sinatra", "TAG", "w", "carrierwave", "carrierwave", "orm", "activerecord", "Ok", "thanks", "for", "the", "tips", "DAddYE", "Over", "in", "LINK", "framework", "issue", "NUMBER", "DAddYE", "says", "that", "the", "right", "thing", "to", "do", "in", "the", "case", "of", "CarrierWave", "would", "be", "to", "use", "this", "form", "in", "the", "CarrierWave", "init", "code", "ruby", "elsif", "defined", "Padrino", "CarrierWave", "NUMBER", "root", "File", "NUMBER", "join", "PADRINO_ROOT", "public", "end", "I", "ll", "do", "up", "a", "pull", "request", "for", "the", "initializer", "and", "also", "the", "documentation", "NUMBER", "Ok", "the", "pull", "request", "be", "here", "LINK", "The", "wiki", "page", "be", "at", "LINK", "to", "NUMBER", "A", "Make", "CarrierWave", "work", "with", "Padrino", "I", "ve", "linked", "it", "from", "the", "CarrierWave", "wiki", "front", "page", "as", "it", "ll", "keep", "people", "out", "of", "trouble", "for", "the", "moment", "NUMBER", "If", "the", "pull", "request", "be", "accepted", "I", "will", "take", "the", "note", "about", "setting", "CarrierWave", "NUMBER", "root", "out", "of", "the", "wiki", "page", "as", "it", "ll", "then", "be", "superfluous", "NUMBER", "Hi", "guys", "Please", "have", "a", "look", "at", "fix", "for", "storages", "with", "File", "url", "methods", "not", "accepting", "params", "NUMBER", "Related", "commit", "add", "query", "options", "for", "s", "NUMBER", "to", "support", "response", "headers", "overwriting", "LINK", "commitcomment", "NUMBER", "Best", "regards", "Mateusz", "In", "case", "you", "or", "anyone", "be", "looking", "to", "tackle", "this", "a", "few", "things", "I", "ve", "find", "NUMBER", "NUMBER", "Rubinius", "be", "fine", "there", "s", "a", "problem", "with", "the", "current", "build", "of", "rbx", "on", "Travis", "it", "works", "fine", "locally", "with", "the", "latest", "master", "rbx", "NUMBER", "Travis", "guys", "said", "they", "be", "going", "to", "push", "out", "a", "new", "build", "soon", "NUMBER", "NUMBER", "NUMBER", "has", "an", "issue", "that", "came", "from", "something", "Rails", "introduce", "between", "NUMBER", "and", "NUMBER", "rc", "NUMBER", "So", "bizarre", "that", "it", "only", "fail", "on", "NUMBER", "NUMBER", "and", "ruby", "head", "be", "fine", "NUMBER", "NUMBER", "Rails", "NUMBER", "rc", "NUMBER", "and", "rails", "master", "have", "a", "whole", "bunch", "of", "failures", "all", "surrounding", "the", "same", "line", "of", "code", "see", "issue", "NUMBER", "for", "info", "NUMBER", "For", "the", "Rails", "NUMBER", "rc", "NUMBER", "stuff", "I", "m", "pretty", "sure", "it", "has", "something", "to", "do", "with", "the", "way", "that", "the", "add_config", "methods", "get", "generate", "NUMBER", "The", "class_eval", "might", "be", "change", "NUMBER", "I", "ll", "look", "into", "it", "NUMBER", "Thanks", "I", "m", "starting", "to", "look", "into", "it", "as", "well", "NUMBER", "I", "ve", "update", "Travis", "to", "test", "Rails", "NUMBER", "NUMBER", "stable", "NUMBER", "NUMBER", "stable", "and", "NUMBER", "NUMBER", "stable", "on", "all", "rubies", "so", "it", "s", "easier", "to", "see", "where", "we", "re", "at", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "An", "update", "to", "MiniMagick", "made", "things", "a", "bit", "more", "strict", "when", "it", "comes", "to", "argument", "on", "the", "mogrify", "commands", "NUMBER", "They", "need", "to", "be", "strings", "NUMBER", "Since", "Travis", "do", "a", "bundle", "install", "from", "scratch", "each", "time", "without", "a", "lock", "file", "it", "always", "pulls", "the", "latest", "NUMBER", "And", "now", "back", "to", "where", "I", "was", "yesterday", "NUMBER", "in", "cache_stored_file", "file", "NUMBER", "read", "sometimes", "returns", "returns", "a", "File", "object", "NUMBER", "This", "seems", "to", "happen", "when", "you", "upload", "a", "new", "file", "which", "be", "cached", "between", "form", "displays", "then", "save", "the", "model", "and", "then", "a", "recreate_version", "be", "executed", "in", "an", "after_save", "NUMBER", "I", "use", "this", "to", "create", "custom", "crops", "in", "my", "version", "NUMBER", "It", "seems", "like", "an", "ugly", "fix", "but", "I", "don", "t", "really", "know", "how", "to", "solve", "it", "in", "a", "better", "way", "NUMBER", "Here", "s", "some", "debugging", "output", "that", "might", "give", "some", "clues", "NUMBER", "rdb", "NUMBER", "self", "TAG", "rdb", "NUMBER", "attributes", "body", "TAG", "content_type", "nil", "key", "uploads", "development", "video", "screenshot", "NUMBER", "image", "NUMBER", "jpg", "cache_control", "max", "age", "NUMBER", "x", "amz", "id", "NUMBER", "XXXXX", "x", "amz", "request", "id", "XXXXXX", "Date", "Thu", "NUMBER", "Dec", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "GMT", "etag", "NUMBER", "bad", "NUMBER", "a", "NUMBER", "e", "NUMBER", "bfd", "NUMBER", "c", "NUMBER", "c", "NUMBER", "e", "NUMBER", "content_length", "NUMBER", "Server", "AmazonS", "NUMBER", "rdb", "NUMBER", "body", "TAG", "Would", "you", "mind", "add", "one", "or", "more", "test", "for", "this", "I", "m", "not", "sure", "I", "m", "really", "understanding", "the", "problem", "here", "NUMBER", "Guys", "sorry", "for", "the", "delay", "NUMBER", "I", "was", "away", "for", "a", "while", "and", "then", "I", "had", "a", "lot", "of", "trouble", "exposing", "this", "bug", "in", "a", "spec", "NUMBER", "I", "m", "not", "quite", "sure", "how", "to", "fit", "this", "into", "the", "exist", "specs", "but", "this", "should", "expose", "the", "bug", "ruby", "describe", "Fog", "S", "NUMBER", "bug", "support", "LINK", "do", "before", "do", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "reset_config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "xxxx", "aws_secret_access_key", "xxxx", "region", "eu", "west", "NUMBER", "config", "NUMBER", "fog_directory", "eu", "NUMBER", "orage", "end", "class", "ScreenshotUploader", "TAG", "true", "do", "up", "ScreenshotUploader", "NUMBER", "new", "up", "NUMBER", "cache", "File", "NUMBER", "open", "file_path", "portrait", "NUMBER", "jpg", "up", "NUMBER", "ore", "up", "NUMBER", "recreate_versions", "end", "end", "trevorturk", "bensie", "please", "let", "me", "know", "if", "you", "need", "anything", "else", "NUMBER", "I", "d", "like", "to", "integrate", "this", "spec", "with", "the", "exist", "specs", "for", "S", "NUMBER", "fog", "based", "uploaders", "but", "I", "had", "some", "trouble", "understanding", "how", "those", "work", "NUMBER", "The", "exist", "specs", "seem", "to", "use", "S", "NUMBER", "directly", "not", "through", "fog", "NUMBER", "I", "don", "t", "have", "time", "to", "look", "at", "this", "now", "but", "I", "ll", "reopen", "at", "least", "NUMBER", "NUMBER", "looks", "relate", "Yes", "it", "s", "the", "same", "issue", "NUMBER", "I", "think", "your", "fix", "be", "cleaner", "than", "mine", "NUMBER", "On", "Tue", "Jan", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "Joel", "Nimety", "TAG", "write", "NUMBER", "looks", "relate", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "I", "m", "closing", "this", "pull", "request", "jnimety", "s", "fix", "seems", "better", "NUMBER", "I", "didn", "t", "provide", "a", "fix", "NUMBER", "doh", "Sorry", "guys", "I", "should", "look", "twice", "before", "I", "comment", "NUMBER", "Anyway", "I", "_do_", "still", "think", "it", "s", "the", "same", "issue", "Thanks", "for", "this", "NUMBER", "I", "think", "this", "should", "mean", "I", "can", "upgrade", "off", "of", "NUMBER", "Was", "another", "ticket", "opened", "for", "this", "issue", "NUMBER", "and", "NUMBER", "still", "fail", "with", "TypeError", "Exception", "can", "t", "convert", "File", "into", "String", "when", "calling", "StringIO", "NUMBER", "new", "file", "NUMBER", "read", "in", "cache_stored_file", "I", "haven", "t", "had", "the", "time", "to", "look", "into", "the", "test", "NUMBER", "I", "m", "still", "run", "my", "own", "fork", "Hi", "there", "NUMBER", "I", "have", "a", "bunch", "of", "icons", "about", "NUMBER", "that", "I", "wish", "to", "serve", "over", "Rackspace", "Cloud", "Files", "NUMBER", "It", "takes", "an", "extremely", "long", "time", "to", "get", "this", "going", "when", "transferring", "them", "one", "by", "one", "NUMBER", "So", "to", "speed", "up", "the", "process", "I", "tried", "to", "use", "threads", "Using", "the", "Parallel", "LINK", "library", "This", "will", "significantly", "reduced", "the", "process", "time", "but", "it", "keep", "raising", "exception", "at", "around", "the", "NUMBER", "icon", "NUMBER", "I", "tried", "transferring", "in", "NUMBER", "threads", "NUMBER", "threads", "NUMBER", "threads", "but", "every", "time", "I", "use", "threads", "it", "seems", "to", "raise", "exception", "with", "the", "following", "error", "Excon", "Errors", "SocketError", "getaddrinfo", "nodename", "nor", "servname", "provide", "or", "not", "know", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "getaddrinfo", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "connect", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "ssl_socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "aws", "storage", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "aws", "request", "storage", "put_object", "NUMBER", "rb", "NUMBER", "in", "put_object", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "aws", "models", "storage", "file", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "collection", "NUMBER", "rb", "NUMBER", "in", "create", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "NUMBER", "NUMBER", "levels", "NUMBER", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_cascading_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "modification", "NUMBER", "rb", "NUMBER", "in", "prepare", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "operations", "update", "NUMBER", "rb", "NUMBER", "in", "persist", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "update", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "upsert", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "block", "in", "update_database", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "call", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "call_with_index", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "work_in_threads", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "loop", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "block", "in", "work_in_threads", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "in_threads", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "So", "instead", "I", "tried", "transferring", "the", "file", "in", "multiple", "processes", "also", "NUMBER", "NUMBER", "NUMBER", "and", "this", "seem", "to", "work", "for", "a", "while", "but", "eventually", "it", "also", "start", "raising", "exception", "such", "as", "Excon", "Errors", "SocketError", "No", "route", "to", "host", "connect", "NUMBER", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "connect_nonblock", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "block", "in", "connect", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "connect", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "ssl_socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "rackspace", "storage", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "rackspace", "request", "storage", "put_object", "NUMBER", "rb", "NUMBER", "in", "put_object", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "rackspace", "models", "storage", "file", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "collection", "NUMBER", "rb", "NUMBER", "in", "create", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "NUMBER", "NUMBER", "levels", "NUMBER", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "process_incoming_jobs", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "block", "in", "worker", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "fork", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "worker", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "block", "in", "work_in_processes", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "map", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "work_in_processes", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "map", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "parallel", "NUMBER", "lib", "parallel", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "update_database", "from", "irb", "NUMBER", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "So", "just", "for", "the", "sake", "of", "trying", "I", "swapped", "out", "Rackspace", "Cloud", "Files", "for", "Amazon", "S", "NUMBER", "to", "see", "if", "the", "issue", "was", "tied", "directly", "to", "Cloud", "Files", "but", "the", "same", "error", "occur", "when", "transferring", "to", "Amazon", "S", "NUMBER", "Prior", "to", "this", "I", "was", "use", "MongoDB", "s", "GridFS", "and", "stored", "all", "NUMBER", "icons", "directly", "in", "GridFS", "without", "any", "issue", "use", "the", "same", "threaded", "approach", "NUMBER", "However", "my", "app", "will", "be", "hosted", "on", "Heroku", "and", "it", "turns", "out", "I", "find", "out", "later", "that", "all", "request", "would", "have", "go", "through", "the", "Ruby", "layer", "to", "access", "the", "DB", "and", "return", "the", "icons", "NUMBER", "Seeing", "as", "every", "page", "loads", "maybe", "NUMBER", "icons", "it", "cause", "a", "lot", "of", "noise", "in", "the", "logs", "and", "I", "think", "it", "might", "also", "not", "be", "very", "performant", "compared", "to", "Cloud", "Files", "CDN", "NUMBER", "So", "I", "m", "trying", "Rackspace", "but", "it", "s", "taking", "hours", "to", "upload", "just", "NUMBER", "small", "NUMBER", "NUMBER", "kb", "file", "without", "threads", "while", "it", "took", "only", "NUMBER", "NUMBER", "minutes", "when", "use", "threads", "in", "GridFS", "NUMBER", "I", "m", "not", "sure", "whether", "this", "issue", "be", "be", "cause", "by", "CarrierWave", "or", "Fog", "seeing", "as", "it", "s", "an", "Excon", "error", "and", "GridFS", "worked", "I", "d", "say", "it", "s", "a", "Fog", "issue", "NUMBER", "Is", "there", "any", "advice", "you", "could", "give", "or", "do", "you", "know", "of", "any", "alternative", "ways", "for", "cutting", "down", "the", "overall", "process", "time", "Thanks", "Note", "I", "will", "submit", "a", "ticket", "to", "Fog", "s", "GitHub", "repository", "referring", "to", "this", "one", "NUMBER", "Alright", "I", "will", "explain", "what", "I", "know", "so", "far", "which", "doesn", "t", "exactly", "solve", "the", "issue", "but", "maybe", "it", "can", "help", "us", "narrow", "it", "down", "NUMBER", "Excon", "stores", "most", "stuff", "in", "instance", "variables", "which", "should", "get", "duplicate", "across", "in", "the", "thread", "creation", "no", "problem", "NUMBER", "It", "stores", "sockets", "in", "thread", "local", "variables", "which", "mean", "that", "a", "socket", "should", "not", "get", "duplicate", "into", "a", "new", "thread", "NUMBER", "This", "prevents", "having", "more", "than", "one", "thread", "write", "to", "the", "same", "socket", "NUMBER", "So", "far", "so", "good", "NUMBER", "The", "problem", "appears", "to", "be", "that", "in", "one", "of", "the", "new", "threads", "it", "sees", "it", "do", "not", "have", "a", "socket", "and", "it", "then", "proceeds", "to", "try", "and", "create", "one", "NUMBER", "This", "shouldn", "t", "be", "a", "problem", "in", "and", "of", "itself", "there", "be", "even", "a", "test", "in", "the", "excon", "project", "for", "this", "situation", "which", "be", "still", "passing", "NUMBER", "For", "some", "reason", "in", "your", "setup", "however", "when", "it", "try", "to", "create", "the", "new", "sockets", "it", "be", "passing", "in", "invalid", "or", "perhaps", "unknown", "values", "NUMBER", "i", "NUMBER", "e", "NUMBER", "you", "can", "easily", "duplicate", "this", "error", "by", "doing", "this", "require", "socket", "This", "one", "be", "what", "I", "would", "expect", "and", "should", "work", "Socket", "NUMBER", "getaddrinfo", "google", "NUMBER", "com", "NUMBER", "nil", "Socket", "Constants", "SOCK_STREAM", "This", "one", "be", "wrong", "and", "returns", "the", "error", "you", "be", "seeing", "Socket", "NUMBER", "getaddrinfo", "nil", "nil", "nil", "Socket", "Constants", "SOCKSTREAM", "Now", "in", "terms", "of", "what", "that", "means", "toward", "fix", "it", "I", "m", "not", "exactly", "sure", "NUMBER", "Before", "I", "dig", "too", "deep", "there", "though", "could", "you", "update", "the", "version", "of", "excon", "you", "be", "use", "I", "ve", "do", "a", "few", "release", "since", "then", "so", "I", "d", "first", "like", "to", "ensure", "it", "isn", "t", "a", "bug", "I", "have", "already", "solve", "and", "that", "it", "be", "behaving", "the", "same", "way", "against", "the", "latest", "version", "NUMBER", "Otherwise", "I", "m", "afraid", "I", "might", "end", "up", "chasing", "the", "wrong", "thing", "or", "in", "the", "wrong", "way", "NUMBER", "Let", "me", "know", "what", "that", "looks", "like", "for", "you", "and", "we", "ll", "go", "from", "there", "NUMBER", "Thanks", "geemus", "thanks", "for", "your", "reply", "Yes", "the", "first", "thing", "I", "did", "was", "update", "fog", "excon", "fog", "to", "the", "latest", "version", "but", "the", "issue", "still", "occur", "NUMBER", "I", "have", "be", "experimenting", "a", "bit", "with", "it", "NUMBER", "I", "tried", "JRuby", "and", "use", "JRuby", "threads", "NUMBER", "I", "guess", "because", "they", "provide", "true", "concurrency", "this", "seem", "to", "work", "fine", "NUMBER", "Although", "it", "doesn", "t", "solve", "the", "issue", "with", "my", "current", "setup", "because", "my", "current", "setup", "will", "not", "work", "with", "JRuby", "and", "wasn", "t", "intended", "to", "NUMBER", "Though", "I", "m", "not", "entirely", "sure", "if", "it", "s", "safe", "to", "say", "that", "it", "went", "NUMBER", "smooth", "and", "worked", "because", "I", "add", "some", "basic", "checks", "such", "as", "if", "file", "NUMBER", "nil", "and", "File", "NUMBER", "exist", "file", "before", "it", "worked", "NUMBER", "So", "I", "m", "also", "not", "sure", "whether", "NUMBER", "of", "the", "file", "were", "actually", "transferred", "or", "not", "the", "file", "were", "overwriting", "each", "other", "because", "of", "all", "my", "attempts", "so", "it", "s", "hard", "to", "tell", "if", "any", "potential", "nil", "values", "were", "actually", "file", "that", "were", "already", "uploaded", "I", "will", "have", "to", "test", "this", "some", "more", "NUMBER", "I", "also", "tried", "spinning", "up", "multiple", "Ruby", "processes", "instead", "of", "threads", "NUMBER", "This", "be", "obviously", "not", "what", "I", "want", "to", "be", "doing", "due", "to", "insane", "memory", "usage", "compare", "to", "spinning", "up", "threads", "but", "also", "use", "the", "if", "file", "NUMBER", "nil", "and", "File", "NUMBER", "exist", "file", "it", "seem", "to", "work", "NUMBER", "Again", "I", "would", "have", "to", "do", "a", "clean", "NUMBER", "transfer", "in", "a", "new", "container", "to", "see", "if", "all", "NUMBER", "file", "be", "be", "transferred", "NUMBER", "Further", "more", "I", "notice", "that", "when", "use", "a", "lot", "of", "threads", "processes", "jruby", "threads", "like", "NUMBER", "it", "will", "also", "fail", "to", "connect", "NUMBER", "I", "forgot", "the", "actual", "exception", "something", "along", "the", "lines", "of", "Excon", "CouldNotConnect", "or", "something", "NUMBER", "Though", "that", "might", "be", "expected", "due", "to", "the", "high", "amount", "of", "API", "request", "at", "the", "same", "time", "NUMBER", "In", "any", "case", "the", "only", "time", "that", "it", "seem", "to", "get", "far", "or", "fully", "complete", "was", "with", "either", "Ruby", "Processes", "or", "JRuby", "Threads", "not", "with", "Ruby", "Threads", "that", "cause", "it", "to", "die", "pretty", "much", "a", "few", "seconds", "in", "every", "time", "NUMBER", "I", "will", "create", "a", "new", "container", "on", "Cloud", "Files", "and", "see", "if", "I", "can", "do", "a", "NUMBER", "transfer", "from", "scratch", "use", "the", "file", "NUMBER", "nil", "and", "File", "NUMBER", "exist", "file", "though", "I", "doubt", "it", "because", "that", "means", "that", "the", "file", "will", "never", "for", "that", "object", "unless", "somehow", "nil", "objects", "were", "somehow", "throw", "in", "to", "the", "array", "NUMBER", "But", "I", "ll", "test", "it", "out", "again", "with", "Ruby", "Threads", "Ruby", "Processes", "and", "JRuby", "threads", "just", "to", "see", "what", "results", "it", "yields", "NUMBER", "Thanks", "for", "the", "informative", "response", "Sure", "I", "wish", "I", "could", "have", "be", "even", "more", "helpful", "but", "I", "haven", "t", "really", "do", "a", "lot", "with", "large", "thread", "counts", "so", "I", "haven", "t", "run", "into", "this", "personally", "NUMBER", "Hopefully", "what", "you", "said", "will", "get", "you", "a", "bit", "further", "along", "NUMBER", "With", "the", "Excon", "CouldNotConnect", "you", "may", "be", "hitting", "a", "limit", "to", "the", "number", "of", "sockets", "file", "descriptors", "that", "the", "system", "will", "allow", "simultaneously", "NUMBER", "By", "no", "means", "be", "I", "certain", "of", "that", "but", "it", "seems", "at", "least", "somewhat", "feasible", "NUMBER", "Let", "me", "know", "how", "your", "change", "work", "out", "and", "we", "can", "hopefully", "work", "from", "there", "NUMBER", "Thanks", "So", "every", "attempt", "thus", "far", "has", "fail", "NUMBER", "I", "decided", "to", "try", "to", "run", "it", "without", "threads", "or", "sub", "processes", "just", "wrapped", "it", "in", "a", "single", "each", "loop", "and", "let", "it", "upload", "file", "one", "by", "one", "NUMBER", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "runner", "NUMBER", "rb", "NUMBER", "in", "eval", "getaddrinfo", "nodename", "nor", "servname", "provide", "or", "not", "know", "Excon", "Errors", "SocketError", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "connect", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "ssl_socket", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "rackspace", "NUMBER", "rb", "NUMBER", "in", "authenticate", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "rackspace", "storage", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "service", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "service", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "connection", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "connection", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "directory", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store_versions", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "store_versions", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_icon", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_cascading_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "modification", "NUMBER", "rb", "NUMBER", "in", "prepare", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "operations", "update", "NUMBER", "rb", "NUMBER", "in", "persist", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "update", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "upsert", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "update_database", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "block", "in", "update_database", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "each_with_index", "from", "Users", "Michael", "Desktop", "garlond", "app", "models", "item", "NUMBER", "rb", "NUMBER", "in", "update_database", "from", "eval", "NUMBER", "in", "TAG", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "runner", "NUMBER", "rb", "NUMBER", "in", "eval", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "runner", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "require", "from", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "This", "happened", "when", "trying", "to", "upload", "the", "NUMBER", "icon", "NUMBER", "I", "tried", "to", "reproduce", "this", "again", "and", "again", "the", "same", "icon", "NUMBER", "fail", "NUMBER", "At", "first", "I", "thought", "maybe", "it", "was", "the", "icon", "itself", "NUMBER", "The", "I", "tried", "to", "myarray", "NUMBER", "NUMBER", "to", "see", "if", "it", "would", "die", "at", "that", "icon", "again", "when", "it", "isn", "t", "the", "NUMBER", "but", "it", "didn", "t", "fail", "NUMBER", "Instead", "it", "again", "fail", "at", "whatever", "was", "the", "NUMBER", "file", "transfer", "NUMBER", "Then", "I", "tried", "it", "once", "more", "with", "a", "totally", "different", "array", "of", "icons", "and", "again", "on", "the", "NUMBER", "transfer", "the", "above", "exception", "be", "raise", "NUMBER", "So", "basically", "a", "single", "ruby", "process", "only", "gets", "to", "NUMBER", "file", "transfers", "before", "the", "above", "exception", "be", "raise", "NUMBER", "If", "you", "start", "a", "new", "ruby", "process", "and", "continue", "from", "where", "you", "left", "off", "NUMBER", "then", "it", "continues", "till", "NUMBER", "and", "raises", "the", "exception", "at", "the", "NUMBER", "NUMBER", "Correction", "NUMBER", "Because", "I", "m", "make", "NUMBER", "version", "of", "each", "file", "that", "s", "be", "uploaded", "with", "Carrierwave", "it", "actually", "fail", "at", "the", "NUMBER", "file", "through", "Carrierwave", "NUMBER", "I", "decided", "to", "use", "Fog", "directly", "without", "Carrierwave", "to", "see", "what", "happens", "and", "it", "seems", "that", "it", "isn", "t", "dying", "at", "the", "NUMBER", "file", "transfer", "NUMBER", "At", "the", "time", "of", "write", "it", "s", "at", "NUMBER", "and", "still", "going", "not", "threaded", "and", "no", "sub", "processes", "NUMBER", "I", "m", "pretty", "sure", "it", "would", "reach", "the", "NUMBER", "file", "transfer", "but", "didn", "t", "wait", "it", "out", "cause", "it", "would", "take", "too", "long", "NUMBER", "Instead", "I", "tried", "to", "use", "NUMBER", "Ruby", "threads", "Ruby", "NUMBER", "by", "the", "way", "and", "then", "get", "the", "getaddrinfo", "nodename", "nor", "servname", "provide", "or", "not", "know", "Excon", "Errors", "SocketError", "shortly", "after", "the", "process", "start", "at", "the", "NUMBER", "NUMBER", "file", "or", "so", "NUMBER", "Then", "I", "tried", "to", "use", "NUMBER", "Ruby", "processes", "instead", "of", "threads", "and", "then", "it", "simply", "transferred", "all", "NUMBER", "file", "NUMBER", "Still", "took", "a", "while", "and", "isn", "t", "memory", "efficient", "but", "it", "finished", "without", "any", "error", "NUMBER", "Now", "what", "I", "need", "to", "test", "be", "if", "I", "use", "NUMBER", "ruby", "processes", "with", "Carrierwave", "whether", "that", "would", "still", "fail", "NUMBER", "So", "run", "NUMBER", "ruby", "processes", "with", "Carrierwave", "causes", "the", "Users", "Michael", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "runner", "NUMBER", "rb", "NUMBER", "in", "eval", "getaddrinfo", "nodename", "nor", "servname", "provide", "or", "not", "know", "Excon", "Errors", "SocketError", "exception", "to", "be", "raise", "again", "and", "it", "happens", "at", "the", "NUMBER", "file", "transfer", "NUMBER", "This", "be", "basically", "what", "the", "code", "looks", "like", "very", "simple", "ruby", "Parallel", "NUMBER", "each", "Item", "NUMBER", "all", "NUMBER", "to_a", "in_processes", "NUMBER", "do", "item", "item", "NUMBER", "remote_icon_url", "item", "NUMBER", "source_icon_url", "item", "NUMBER", "save", "end", "So", "it", "downloads", "the", "icon", "from", "a", "remote", "source", "then", "processes", "it", "so", "I", "have", "NUMBER", "version", "of", "the", "original", "and", "then", "it", "transfers", "these", "NUMBER", "file", "to", "Cloud", "Files", "NUMBER", "After", "about", "NUMBER", "file", "transfers", "the", "above", "exception", "be", "raise", "NUMBER", "Thanks", "for", "all", "the", "detailed", "data", "but", "I", "m", "at", "a", "bit", "of", "a", "loss", "still", "NUMBER", "I", "d", "say", "that", "it", "was", "perhaps", "just", "some", "sort", "of", "race", "condition", "or", "the", "like", "but", "I", "doubt", "it", "would", "act", "quite", "that", "predictably", "in", "that", "case", "NUMBER", "trevorturk", "yeah", "it", "s", "a", "bit", "hard", "to", "figure", "out", "what", "exactly", "be", "cause", "this", "issue", "NUMBER", "Prior", "to", "Rackspace", "I", "was", "use", "MongoDB", "s", "GridFS", "instead", "and", "it", "simply", "worked", "NUMBER", "I", "think", "I", "use", "around", "NUMBER", "threads", "to", "download", "import", "the", "NUMBER", "small", "icons", "without", "any", "issue", "massively", "parallel", "NUMBER", "I", "have", "a", "feeling", "that", "it", "s", "just", "the", "Rackspace", "service", "that", "s", "blocking", "it", "when", "it", "gets", "a", "bunch", "of", "file", "in", "a", "row", "NUMBER", "If", "you", "resume", "from", "where", "you", "left", "off", "it", "will", "just", "continue", "anyway", "and", "the", "fact", "that", "it", "stops", "after", "a", "certain", "amount", "of", "file", "have", "be", "transferred", "be", "also", "odd", "NUMBER", "But", "as", "you", "said", "while", "it", "s", "not", "normal", "wrapping", "it", "in", "rescue", "blocks", "to", "just", "keep", "retrying", "until", "all", "of", "the", "file", "succeed", "be", "probably", "the", "best", "you", "can", "do", "in", "such", "cases", "if", "Rackspace", "or", "w", "e", "provider", "be", "indeed", "actually", "blocking", "it", "in", "some", "way", "NUMBER", "Eventually", "I", "will", "have", "to", "update", "all", "the", "images", "and", "at", "that", "time", "I", "ll", "have", "to", "see", "if", "I", "can", "get", "it", "to", "retry", "on", "fail", "and", "see", "if", "will", "eventually", "finish", "NUMBER", "Via", "Gemnasium", "Gemnasium", "be", "a", "service", "to", "help", "developers", "keep", "up", "to", "date", "on", "their", "projects", "gem", "dependencies", "NUMBER", "They", "re", "in", "constant", "flux", "and", "knowing", "the", "status", "of", "your", "project", "can", "help", "to", "stay", "on", "top", "of", "upgrading", "NUMBER", "It", "s", "also", "helpful", "to", "demonstrate", "to", "your", "users", "how", "up", "to", "date", "you", "be", "with", "the", "latest", "gem", "dependency", "version", "NUMBER", "This", "image", "be", "just", "a", "snapshot", "of", "carrierwave", "s", "status", "from", "LINK", "Fine", "to", "have", "it", "available", "as", "a", "service", "but", "I", "don", "t", "see", "the", "need", "for", "a", "badge", "in", "the", "readme", "either", "NUMBER", "Hi", "NUMBER", "Rails", "NUMBER", "Ruby", "NUMBER", "p", "NUMBER", "CarrierWave", "NUMBER", "with", "carrierwave", "mongoid", "NUMBER", "Here", "s", "what", "I", "get", "while", "saving", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "t", "TrackedAsset", "NUMBER", "edit", "NUMBER", "edaad", "NUMBER", "d", "NUMBER", "fe", "NUMBER", "d", "NUMBER", "a", "NUMBER", "snip", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "t", "NUMBER", "avatar", "File", "NUMBER", "new", "Rails", "NUMBER", "root", "tmp", "xhr_uploads", "NUMBER", "c", "NUMBER", "ee", "NUMBER", "eaed", "NUMBER", "b", "NUMBER", "f", "NUMBER", "_cni", "NUMBER", "png", "r", "TAG", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "t", "NUMBER", "save", "TypeError", "can", "t", "convert", "nil", "into", "String", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "expand_path", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "default_url", "NUMBER", "rb", "NUMBER", "in", "url", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "url", "NUMBER", "rb", "NUMBER", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "block", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "check_for_circular_references", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "block", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "map", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "block", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "check_for_circular_references", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "as_json", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "json", "encoding", "NUMBER", "rb", "NUMBER", "in", "block", "in", "as_json", "NUMBER", "NUMBER", "levels", "NUMBER", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run_callbacks", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_cascading_callbacks", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "modification", "NUMBER", "rb", "NUMBER", "in", "prepare", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "operations", "update", "NUMBER", "rb", "NUMBER", "in", "persist", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "update", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "console", "gems", "mongoid", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "upsert", "from", "irb", "NUMBER", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "erase", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "I", "also", "get", "the", "error", "multiple", "times", "while", "creating", "documents", "randomly", "NUMBER", "This", "happens", "randomly", "Works", "sometimes", "Can", "you", "provide", "a", "fail", "test", "I", "ve", "had", "some", "similar", "problem", "use", "Fog", "S", "NUMBER", "I", "fix", "it", "by", "change", "the", "cache_stored_file", "method", "a", "little", "NUMBER", "def", "cache_stored_file", "_content", "file", "NUMBER", "read", "if", "_content", "NUMBER", "is_a", "File", "could", "be", "if", "storage", "be", "Fog", "_tempfile", "_content", "NUMBER", "read", "else", "_tempfile", "StringIO", "NUMBER", "new", "_content", "end", "sanitized", "SanitizedFile", "NUMBER", "new", "tempfile", "_tempfile", "filename", "File", "NUMBER", "basename", "path", "content_type", "file", "NUMBER", "content_type", "cache", "sanitized", "end", "Sorry", "about", "the", "late", "reply", "NUMBER", "I", "gave", "a", "look", "at", "this", "issue", "yesterday", "again", "and", "it", "was", "work", "NUMBER", "I", "can", "t", "reproduce", "the", "bug", "anymore", "NUMBER", "I", "haven", "t", "change", "something", "in", "the", "uploaders", "setup", "nor", "mongoid", "just", "let", "a", "week", "pass", "while", "work", "on", "other", "parts", "of", "my", "app", "I", "can", "t", "reproduce", "the", "bug", "anymore", "and", "don", "t", "have", "any", "fail", "test", "or", "more", "logs", "Sorry", "thanks", "for", "the", "great", "work", "NUMBER", "The", "default", "behavior", "like", "this", "TAG", "uploader", "NUMBER", "url", "url", "to", "my_file", "NUMBER", "png", "uploader", "NUMBER", "umb", "NUMBER", "url", "url", "to", "thumb_my_file", "NUMBER", "png", "TAG", "But", "what", "I", "want", "for", "example", "be", "that", "uploader", "NUMBER", "umb", "NUMBER", "url", "will", "return", "url", "to", "my_file", "NUMBER", "png_thumb", "There", "s", "a", "wiki", "on", "how", "to", "move", "the", "version", "name", "to", "the", "end", "of", "the", "file", "NUMBER", "Maybe", "you", "can", "use", "that", "as", "your", "starting", "point", "NUMBER", "Hi", "guys", "Thank", "you", "for", "Carrierwave", "NUMBER", "We", "use", "carrierwave", "with", "s", "NUMBER", "storage", "and", "it", "works", "nice", "NUMBER", "However", "we", "need", "to", "use", "query", "params", "which", "let", "us", "override", "response", "headers", "NUMBER", "I", "have", "add", "this", "functionality", "NUMBER", "In", "the", "same", "time", "I", "be", "creating", "a", "pull", "request", "for", "fog", "project", "NUMBER", "Carrierwave", "would", "require", "first", "change", "on", "fog", "to", "work", "correctly", "that", "s", "why", "I", "have", "left", "in", "carrierwave", "s", "Gemfile", "dependency", "to", "fog", "forked", "on", "autohaus", "NUMBER", "Please", "let", "me", "know", "if", "the", "change", "be", "on", "acceptable", "level", "and", "if", "there", "be", "anything", "that", "could", "be", "do", "better", "NUMBER", "Best", "regards", "Mateusz", "Juraszek", "autohaus", "NUMBER", "de", "of", "course", "NUMBER", "I", "also", "don", "t", "want", "you", "to", "depend", "on", "any", "fork", "I", "will", "let", "you", "know", "as", "fast", "as", "change", "get", "to", "fog", "project", "Hi", "my", "change", "to", "fog", "has", "be", "accepted", "and", "merge", "LINK", "NUMBER", "days", "ago", "to", "master", "NUMBER", "I", "guess", "it", "ll", "be", "officially", "release", "with", "new", "gem", "version", "NUMBER", "So", "we", "wait", "until", "then", "right", "or", "we", "can", "use", "that", "time", "to", "review", "pull", "request", "and", "change", "something", "if", "necessary", "what", "do", "you", "prefer", "Making", "him", "submit", "a", "new", "request", "isn", "t", "very", "helpful", "for", "users", "who", "also", "seek", "this", "functionality", "NUMBER", "If", "you", "reuse", "the", "exist", "request", "we", "can", "enable", "notifications", "for", "this", "pull", "request", "NUMBER", "Otherwise", "we", "have", "to", "continually", "monitor", "all", "new", "pull", "request", "until", "Fog", "release", "his", "change", "as", "a", "gem", "and", "you", "therefore", "allow", "him", "to", "submit", "a", "new", "pull", "request", "NUMBER", "This", "pull", "request", "can", "be", "referenced", "in", "the", "new", "one", "NUMBER", "meceo", "When", "you", "do", "submit", "a", "new", "request", "please", "squash", "your", "change", "to", "a", "single", "commit", "NUMBER", "Ah", "ok", "I", "didn", "t", "realize", "that", "NUMBER", "Thanks", "NUMBER", "Also", "meceo", "thanks", "for", "this", "functionality", "NUMBER", "I", "be", "currently", "use", "your", "fork", "and", "it", "be", "work", "splendidly", "exactly", "what", "I", "needed", "NUMBER", "I", "thought", "I", "was", "going", "to", "have", "to", "dig", "my", "heels", "in", "for", "a", "few", "hours", "and", "implement", "it", "myself", "and", "was", "very", "pleased", "to", "see", "that", "someone", "already", "had", "NUMBER", "bensie", "I", "will", "do", "squash", "now", "and", "make", "pull", "request", "again", "NUMBER", "jsuwo", "I", "be", "glad", "I", "could", "help", "NUMBER", "Hi", "I", "m", "build", "an", "online", "safe", "based", "on", "carrierwave", "and", "a", "personal", "cipher", "library", "NUMBER", "My", "needs", "be", "quite", "simple", "I", "want", "a", "user", "to", "upload", "a", "file", "my", "Rails", "app", "encrypt", "it", "then", "store", "it", "use", "Fog", "in", "any", "datacenter", "NUMBER", "Then", "when", "retrieving", "the", "file", "my", "app", "needs", "to", "decrypt", "it", "from", "cache", "and", "send", "it", "to", "the", "user", "NUMBER", "My", "uploader", "ruby", "class", "EncryptorUploader", "TAG", "root", "base_path", "File", "NUMBER", "expand_path", "current_path", "NUMBER", "gsub", "File", "NUMBER", "expand_path", "root_path", "end", "end", "I", "wouldn", "t", "use", "Rails", "NUMBER", "root", "directly", "there", "for", "the", "path", "as", "it", "dumps", "things", "into", "folders", "in", "your", "root", "dir", "but", "you", "can", "put", "whatever", "be", "needed", "in", "there", "NUMBER", "Any", "reason", "why", "this", "be", "the", "case", "It", "seems", "strange", "given", "that", "everything", "else", "be", "customisable", "NUMBER", "Having", "had", "a", "decent", "plough", "through", "the", "code", "I", "can", "t", "see", "any", "reason", "why", "it", "should", "be", "NUMBER", "It", "s", "cause", "a", "problem", "for", "me", "because", "I", "want", "to", "have", "a", "mounted", "uploader", "decide", "where", "to", "store", "a", "file", "either", "grid_fs", "or", "filesystem", "in", "this", "example", "and", "there", "doesn", "t", "seem", "to", "be", "any", "workaround", "NUMBER", "You", "also", "can", "t", "just", "change", "the", "class", "variable", "with", "something", "like", "the", "before_save", "callback", "because", "this", "will", "cause", "concurrency", "issue", "in", "a", "multi", "threaded", "production", "server", "NUMBER", "Anyone", "know", "the", "latest", "compatible", "version", "of", "carrierwave", "that", "works", "with", "the", "old", "cloudfiles", "gem", "and", "not", "this", "new", "fog", "interface", "We", "along", "with", "others", "be", "get", "some", "very", "strange", "problem", "and", "would", "prefer", "to", "just", "revert", "until", "it", "s", "fix", "NUMBER", "Relevant", "fog", "issue", "LINK", "LINK", "Thanks", "for", "tackling", "this", "Could", "you", "please", "release", "a", "new", "version", "to", "Rubygems", "NUMBER", "org", "Now", "that", "Rails", "NUMBER", "be", "out", "there", "get", "that", "deprecation", "warning", "be", "slightly", "annoying", "and", "also", "misleading", "since", "the", "call", "trace", "only", "points", "at", "your", "app", "s", "environment", "NUMBER", "rb", "NUMBER", "I", "only", "managed", "to", "figure", "out", "that", "it", "s", "from", "CarrierWave", "after", "monkey", "plugging", "into", "the", "deprecation", "inside", "ActiveSupport", "NUMBER", "Thanks", "Hello", "I", "believe", "there", "was", "a", "tag", "version", "mention", "NUMBER", "Can", "I", "has", "Still", "no", "fix", "NUMBER", "I", "understand", "that", "may", "be", "it", "s", "still", "to", "early", "to", "think", "about", "rails", "NUMBER", "but", "it", "may", "help", "in", "future", "NUMBER", "Right", "now", "NUMBER", "test", "fail", "on", "master", "branch", "NUMBER", "First", "fail", "be", "on", "CarrierWave", "Mount", "NUMBER", "mount_uploader", "image_url", "should", "get", "the", "url", "from", "a", "cached", "file", "s", "version", "Full", "trace", "NUMBER", "CarrierWave", "Mount", "NUMBER", "mount_uploader", "image_url", "should", "get", "the", "url", "from", "a", "cached", "file", "s", "version", "Failure", "Error", "instance", "NUMBER", "image", "stub_file", "test", "NUMBER", "jpg", "NoMethodError", "undefined", "method", "parent_cache_id", "for", "uploader", "TAG", "options", "Hash", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "block", "in", "assign_parent_cache_id", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "each", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "assign_parent_cache_id", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_callbacks", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "each", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "cache", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "image", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "image", "NUMBER", "spec", "mount_spec", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "TAG", "I", "m", "trying", "to", "find", "why", "it", "happens", "but", "still", "have", "no", "idea", "NUMBER", "I", "haven", "t", "looked", "at", "Rails", "master", "with", "Carrierwave", "recently", "but", "will", "definitely", "take", "a", "look", "soon", "NUMBER", "Thanks", "for", "report", "all", "error", "LINK", "Ok", "NUMBER", "What", "i", "ve", "find", "NUMBER", "NUMBER", "Problem", "only", "appears", "when", "use", "version", "NUMBER", "NUMBER", "There", "be", "should", "be", "object", "at", "place", "where", "test", "crashes", "instead", "of", "hash", "NUMBER", "And", "i", "don", "t", "know", "why", "it", "returns", "hashes", "NUMBER", "The", "required", "object", "exists", "in", "this", "hash", "under", "uploader", "key", "but", "it", "still", "miss", "some", "methods", "including", "parent_cache_id", "EDIT", "Any", "ideas", "will", "be", "helpful", "issue", "goes", "away", "when", "use", "uploader", "uploader", "instead", "of", "uploader", "and", "moving", "attr_accessor", "parent_cache_id", "from", "include", "block", "to", "module", "ClassMethods", "in", "uploader", "verisions", "NUMBER", "but", "this", "be", "not", "right", "way", "to", "fix", "it", "NUMBER", "find", "commit", "which", "produces", "this", "issue", "LINK", "revert", "it", "allows", "almost", "all", "test", "to", "pass", "except", "one", "CarrierWave", "ActiveRecord", "mount_uploader", "image", "should", "return", "valid", "XML", "when", "to_xml", "be", "call", "when", "image", "be", "present", "but", "it", "s", "another", "issue", "Hope", "Aaron", "can", "tell", "us", "what", "s", "happening", "here", "cc", "tenderlove", "slbug", "What", "do", "you", "mean", "when", "you", "say", "issue", "goes", "away", "when", "use", "uploader", "uploader", "instead", "of", "uploader", "Mind", "pasting", "a", "gist", "of", "that", "Already", "trashed", "it", "but", "it", "s", "just", "about", "change", "LINK", "L", "NUMBER", "from", "uploader", "NUMBER", "parent_cache_id", "to", "uploader", "uploader", "NUMBER", "parent_cache_id", "NUMBER", "same", "change", "in", "other", "places", "too", "and", "moving", "attr_accessor", "parent_cache_id", "from", "line", "NUMBER", "to", "line", "NUMBER", "but", "it", "breaks", "everything", "on", "stable", "rails", "so", "it", "s", "not", "a", "fix", "Finally", "having", "a", "look", "at", "CW", "on", "Rails", "master", "before", "I", "dig", "deeper", "were", "you", "able", "to", "find", "anything", "else", "worth", "sharing", "slbug", "I", "ve", "confirmed", "that", "the", "Rails", "commit", "that", "you", "referenced", "LINK", "cause", "this", "issue", "NUMBER", "Reverting", "it", "in", "Rails", "fix", "the", "problem", "but", "I", "ve", "be", "unable", "to", "come", "up", "with", "a", "fail", "test", "case", "for", "ActiveSupport", "though", "to", "match", "the", "situation", "happening", "in", "CarrierWave", "NUMBER", "This", "be", "a", "blocker", "for", "support", "Rails", "NUMBER", "and", "beyond", "NUMBER", "cc", "trevorturk", "jnicklas", "tenderlove", "Just", "opened", "a", "Rails", "pull", "request", "for", "this", "that", "will", "hopefully", "be", "merge", "and", "ported", "to", "NUMBER", "NUMBER", "stable", "LINK", "bensie", "thanks", "I", "ve", "merge", "the", "pull", "request", "to", "rails", "master", "and", "NUMBER", "NUMBER", "stable", "NUMBER", "after", "accepting", "this", "pull", "request", "LINK", "all", "cucumber", "test", "pass", "and", "all", "specs", "pass", "except", "just", "one", "NUMBER", "TAG", "Failures", "NUMBER", "CarrierWave", "ActiveRecord", "mount_uploader", "image", "should", "return", "valid", "XML", "when", "to_xml", "be", "call", "when", "image", "be", "present", "Failure", "Error", "Hash", "NUMBER", "from_xml", "event", "NUMBER", "to_xml", "event", "arclass", "image", "NUMBER", "should", "test", "NUMBER", "jpeg", "expected", "test", "NUMBER", "jpeg", "get", "nil", "use", "NUMBER", "spec", "orm", "activerecord_spec", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "top", "required", "TAG", "I", "get", "this", "error", "undefined", "method", "remove_previously_stored_files_after_update", "for", "nil", "NilClass", "Here", "be", "the", "error", "gist", "git", "gist", "NUMBER", "github", "NUMBER", "com", "NUMBER", "git", "Important", "point", "I", "was", "use", "mongoid", "and", "change", "it", "to", "ActiveRecord", "NUMBER", "Before", "doing", "this", "I", "upgrade", "to", "rails", "NUMBER", "and", "created", "new", "gemset", "with", "rvm", "NUMBER", "What", "can", "be", "the", "problem", "Also", "here", "be", "the", "project", "code", "LINK", "Hi", "as", "far", "as", "I", "understand", "be", "the", "storage", "configuration", "shared", "among", "all", "uploaders", "and", "uploader", "instances", "NUMBER", "While", "there", "be", "a", "storage", "member", "variable", "on", "each", "uploader", "it", "s", "private", "NUMBER", "Can", "we", "made", "this", "changeable", "from", "the", "outside", "e", "NUMBER", "g", "NUMBER", "some", "applications", "would", "like", "to", "use", "per", "user", "S", "NUMBER", "Accounts", "Dropbox", "Session", "credentials", "etc", "NUMBER", "this", "would", "be", "very", "very", "handy", "NUMBER", "thanks", "Asset", "pipeline", "generator", "compatibility", "Should", "be", "all", "good", "to", "go", "now", "trevorturk", "Yeah", "I", "have", "a", "feeling", "that", "the", "issue", "run", "deeper", "as", "well", "NUMBER", "I", "ll", "take", "some", "time", "this", "weekend", "and", "step", "through", "it", "with", "the", "debugger", "and", "see", "what", "I", "find", "NUMBER", "Cheers", "NUMBER", "I", "guess", "this", "works", "for", "now", "since", "I", "don", "t", "have", "anything", "better", "to", "offer", "but", "this", "really", "breaks", "MVC", "in", "my", "mind", "NUMBER", "We", "re", "encouraging", "that", "people", "use", "view", "methods", "in", "the", "model", "with", "this", "NUMBER", "Heya", "I", "have", "a", "multipage", "file", "pdf", "and", "I", "d", "like", "to", "store", "previews", "for", "all", "pages", "NUMBER", "What", "be", "the", "recommended", "method", "for", "this", "Ideally", "I", "d", "like", "to", "have", "pdf", "NUMBER", "file", "TAG", "nil", "Looks", "like", "CarrierWave", "be", "doing", "its", "magic", "on", "before_save", "and", "our", "callback", "be", "executed", "after", "CarrierWave", "s", "NUMBER", "So", "if", "we", "do", "our", "business", "on", "after_validation", "then", "all", "be", "happy", "NUMBER", "copied", "into", "LINK", "Issues", "This", "pull", "request", "fix", "NUMBER", "yes", "to", "stub", "the", "file", "NUMBER", "Any", "other", "Idea", "to", "stub", "file", "access", "or", "change", "the", "file", "yep", "that", "s", "the", "only", "really", "needed", "change", "to", "fix", "the", "bug", "NUMBER", "hope", "you", "like", "this", "change", "edit", "btw", "i", "believe", "we", "should", "never", "forget", "about", "the", "test", "NUMBER", "Don", "t", "really", "like", "to", "change", "History", "but", "here", "we", "go", "NUMBER", "Changing", "history", "feels", "ugly", "when", "you", "re", "work", "off", "master", "use", "a", "topic", "branch", "next", "time", "and", "it", "really", "doesn", "t", "hurt", "anything", "NUMBER", "Squashing", "your", "commit", "for", "a", "pull", "request", "be", "a", "pretty", "common", "request", "NUMBER", "what", "about", "an", "minor", "release", "I", "agree", "that", "this", "doesn", "t", "warrant", "a", "release", "just", "yet", "just", "use", "git", "master", "in", "your", "gemfile", "for", "now", "NUMBER", "Do", "you", "consider", "make", "option", "to", "create", "image", "version", "on", "demand", "instead", "on", "create", "Hi", "i", "get", "an", "undefined", "method", "chomp", "in", "sanitized_file", "NUMBER", "LINK", "_file", "NUMBER", "rb", "L", "NUMBER", "when", "attaching", "msword", "file", "to", "carrierwave", "observed", "field", "NUMBER", "undefined", "method", "chomp", "for", "application", "msword", "MIME", "Type", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "content_type", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "copy_to", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "block", "in", "cache", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "file", "Users", "ben", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "orm", "activerecord", "NUMBER", "rb", "NUMBER", "in", "file", "Quickfix", "idea", "make", "sure", "content_type", "be", "an", "String", "and", "call", "to_s", "on", "file", "NUMBER", "content_type", "before", "chomping", "NUMBER", "oh", "hell", "NUMBER", "It", "s", "relate", "to", "Paperclip", "Upfile", "NUMBER", "The", "PaperClip", "implementation", "dosn", "t", "always", "give", "an", "String", "back", "and", "CarrierWave", "calls", "the", "content_type", "method", "NUMBER", "Right", "now", "i", "have", "no", "clue", "how", "to", "test", "this", "NUMBER", "No", "problem", "I", "ll", "check", "it", "out", "NUMBER", "Cool", "I", "m", "digging", "in", "now", "NUMBER", "Closed", "by", "ceebf", "NUMBER", "dc", "NUMBER", "c", "NUMBER", "d", "NUMBER", "b", "NUMBER", "cac", "NUMBER", "fd", "NUMBER", "cfbde", "NUMBER", "ec", "NUMBER", "fddc", "NUMBER", "f", "Also", "not", "sure", "what", "the", "deal", "be", "with", "NUMBER", "p", "NUMBER", "on", "Travis", "NUMBER", "It", "build", "fine", "for", "me", "locally", "NUMBER", "I", "m", "thinking", "a", "Travis", "problem", "LINK", "ci", "NUMBER", "org", "jnicklas", "carrierwave", "Sure", "I", "m", "on", "it", "NUMBER", "Nope", "I", "m", "not", "NUMBER", "jnicklas", "Ping", "Thanks", "NUMBER", "History", "be", "update", "all", "ready", "for", "you", "to", "release", "NUMBER", "Any", "word", "from", "the", "travis", "guys", "Passing", "on", "NUMBER", "fail", "on", "NUMBER", "passing", "on", "ruby", "head", "NUMBER", "Nice", "NUMBER", "Cool", "I", "will", "thx", "NUMBER", "Hi", "Would", "you", "like", "to", "point", "out", "the", "required", "steps", "to", "implement", "a", "new", "kind", "of", "storage", "NUMBER", "We", "re", "developing", "a", "S", "NUMBER", "ish", "internal", "file", "service", "and", "I", "would", "like", "to", "implement", "a", "storage", "for", "this", "service", "NUMBER", "Any", "guidance", "would", "be", "greatly", "appreciated", "NUMBER", "Regards", "Sandro", "Sorry", "NUMBER", "WIll", "do", "NUMBER", "When", "use", "process", "convert", "jpg", "on", "a", "multipage", "PDF", "carrierwave", "throw", "a", "LocaJumpError", "NUMBER", "The", "reason", "be", "that", "convert", "calls", "manipulate", "but", "do", "not", "pass", "in", "a", "block", "NUMBER", "A", "possible", "solution", "be", "to", "replace", "the", "current", "manipulate", "method", "under", "lib", "carrierwave", "processing", "rmagick", "NUMBER", "rb", "with", "the", "following", "ruby", "def", "manipulate", "options", "cache_stored_file", "if", "cached", "image", "Magick", "Image", "NUMBER", "read", "current_path", "frames", "if", "image", "NUMBER", "size", "NUMBER", "list", "Magick", "ImageList", "NUMBER", "new", "image", "NUMBER", "each", "do", "frame", "list", "TAG", "e", "raise", "CarrierWave", "ProcessingError", "I", "NUMBER", "n", "NUMBER", "translate", "error", "NUMBER", "message", "NUMBER", "rmagick_processing_error", "e", "e", "end", "This", "turns", "the", "multipage", "image", "into", "a", "single", "page", "image", "if", "no", "block", "be", "provide", "NUMBER", "Not", "sure", "if", "this", "be", "the", "best", "solution", "though", "as", "I", "think", "multilayer", "images", "will", "not", "convert", "properly", "use", "this", "approach", "in", "theory", "they", "re", "just", "throw", "an", "error", "on", "convert", "though", "anway", "NUMBER", "I", "actually", "just", "run", "into", "the", "same", "issue", "and", "attempted", "to", "use", "the", "code", "above", "NUMBER", "It", "didn", "t", "work", "for", "me", "NUMBER", "I", "stopped", "my", "rails", "server", "replaced", "the", "appropriate", "method", "and", "then", "start", "my", "server", "again", "no", "luck", "same", "error", "NUMBER", "counterbeing", "did", "you", "try", "my", "fork", "LINK", "not", "ready", "for", "a", "pull", "request", "but", "let", "me", "know", "if", "it", "works", "for", "you", "and", "then", "I", "will", "move", "in", "that", "direction", "NUMBER", "Hey", "there", "I", "didn", "t", "try", "your", "fork", "NUMBER", "I", "ended", "up", "playing", "with", "the", "manipulate", "function", "myself", "but", "I", "d", "love", "to", "give", "it", "a", "shot", "I", "probably", "will", "try", "it", "some", "time", "soon", "because", "I", "definitely", "sacrificed", "some", "functionality", "of", "the", "plugin", "NUMBER", "Specifically", "use", "pages", "other", "than", "the", "first", "NUMBER", "That", "be", "a", "functionality", "I", "plan", "on", "add", "at", "some", "point", "soon", "so", "I", "m", "going", "to", "have", "to", "NUMBER", "Currently", "struggling", "with", "something", "else", "that", "be", "currently", "more", "important", "to", "get", "do", "on", "time", "FYI", "I", "havent", "pull", "from", "carrierwave", "master", "since", "I", "created", "it", "Nov", "NUMBER", "NUMBER", "I", "just", "don", "t", "have", "time", "right", "now", "to", "make", "any", "promises", "NUMBER", "If", "I", "come", "into", "some", "time", "I", "will", "send", "you", "a", "patch", "and", "you", "can", "remove", "it", "from", "know", "issue", "NUMBER", "Merry", "Christmas", "I", "would", "also", "love", "to", "spend", "some", "time", "on", "it", "NUMBER", "For", "now", "it", "might", "be", "good", "to", "throw", "in", "the", "know", "issue", "NUMBER", "Once", "I", "m", "do", "with", "this", "project", "I", "will", "have", "a", "little", "time", "to", "work", "on", "it", "NUMBER", "Aaron", "let", "me", "know", "if", "you", "d", "like", "some", "help", "On", "Dec", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "Aaron", "Cruz", "write", "I", "just", "don", "t", "have", "time", "right", "now", "to", "make", "any", "promises", "NUMBER", "If", "I", "come", "into", "some", "time", "I", "will", "send", "you", "a", "patch", "and", "you", "can", "remove", "it", "from", "know", "issue", "NUMBER", "Merry", "Christmas", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "trevorturk", "I", "have", "no", "idea", "how", "to", "write", "specs", "for", "this", "NUMBER", "Do", "you", "have", "any", "advice", "I", "don", "t", "know", "much", "about", "write", "specs", "but", "I", "was", "sort", "of", "thinking", "that", "you", "would", "have", "the", "ability", "to", "specify", "a", "particular", "page", "of", "the", "pdf", "to", "work", "with", "or", "else", "it", "would", "default", "to", "the", "first", "page", "of", "the", "pdf", "Anyone", "else", "have", "any", "thoughts", "on", "that", "On", "Dec", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "Aaron", "Cruz", "write", "trevorturk", "I", "have", "no", "idea", "how", "to", "write", "specs", "for", "this", "NUMBER", "Do", "you", "have", "any", "advice", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "I", "add", "a", "pull", "request", "for", "this", "issue", "here", "LINK", "It", "s", "just", "implement", "the", "code", "in", "the", "original", "post", "NUMBER", "It", "will", "result", "in", "the", "covert", "method", "sticking", "each", "frame", "of", "the", "pdf", "one", "after", "the", "other", "vertically", "when", "it", "s", "converted", "I", "assume", "this", "be", "the", "desired", "behavior", "NUMBER", "I", "test", "this", "on", "a", "live", "app", "I", "have", "up", "and", "I", "add", "a", "spec", "which", "just", "test", "whether", "the", "convert", "method", "of", "CarrierWave", "Rmagick", "throw", "an", "error", "on", "a", "multi", "page", "pdf", "NUMBER", "counterbeing", "what", "was", "the", "error", "you", "were", "get", "with", "the", "original", "code", "when", "you", "tried", "it", "I", "was", "a", "bit", "unsure", "of", "what", "the", "proper", "way", "to", "test", "this", "was", "so", "I", "add", "an", "actual", "multi", "page", "pdf", "into", "the", "fixture", "and", "add", "a", "spec", "into", "processing_specs", "NUMBER", "rb", "NUMBER", "chanind", "I", "m", "sorry", "it", "was", "so", "long", "ago", "I", "don", "t", "even", "know", "what", "I", "was", "trying", "at", "that", "point", "anymore", "NUMBER", "But", "I", "see", "you", "ve", "add", "a", "pull", "request", "which", "I", "m", "actually", "test", "out", "NUMBER", "I", "had", "previously", "add", "your", "solution", "to", "my", "uploader", "and", "it", "seem", "to", "be", "work", "NUMBER", "Thanks", "a", "bunch", "Hi", "there", "I", "m", "run", "a", "Rails", "NUMBER", "application", "and", "be", "get", "an", "ArgumentError", "exception", "saying", "invalid", "byte", "sequence", "in", "US", "ASCII", "NUMBER", "I", "ve", "find", "this", "be", "cause", "by", "what", "I", "think", "be", "a", "bug", "in", "carrierwave", "NUMBER", "First", "I", "ve", "a", "Photo", "model", "like", "this", "class", "Photo", "TAG", "true", "end", "Now", "when", "a", "user", "uploads", "a", "file", "with", "a", "name", "containing", "a", "non", "ascii", "letter", "the", "above", "error", "happens", "when", "evaluating", "photo", "NUMBER", "image", "NUMBER", "url", "the", "uploading", "itself", "works", "just", "fine", "because", "carrierwave", "assigns", "an", "US", "ASCII", "encoding", "to", "the", "string", "where", "UTF", "NUMBER", "should", "be", "NUMBER", "Here", "s", "a", "rails", "console", "session", "illustrating", "the", "problem", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "uploads", "photo", "image", "NUMBER", "CIMG", "NUMBER", "\u00e4", "NUMBER", "JPG", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "NUMBER", "url", "uploads", "photo", "image", "NUMBER", "CIMG", "NUMBER", "xC", "NUMBER", "xA", "NUMBER", "JPG", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "NUMBER", "url", "NUMBER", "encoding", "TAG", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "NUMBER", "url", "NUMBER", "force_encoding", "UTF", "NUMBER", "uploads", "photo", "image", "NUMBER", "CIMG", "NUMBER", "\u00e4", "NUMBER", "JPG", "As", "you", "can", "see", "a", "workaround", "be", "to", "use", "String", "force_encoding", "but", "I", "doubt", "this", "be", "the", "regular", "usecase", "NUMBER", "Some", "information", "on", "my", "environment", "ruby", "v", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "linux", "rails", "v", "Rails", "NUMBER", "gem", "v", "NUMBER", "carrierwave", "version", "NUMBER", "database", "engine", "sqlite", "NUMBER", "The", "application", "isn", "t", "online", "yet", "there", "I", "ll", "be", "use", "postgres", "OS", "Arch", "Linux", "NUMBER", "bits", "Valete", "Marvin", "Isn", "t", "this", "fix", "within", "NUMBER", "And", "in", "a", "short", "test", "any", "of", "\u00e4\u00f6\u00fc", "be", "replaced", "with", "_", "within", "the", "filename", "NUMBER", "And", "in", "a", "short", "test", "any", "of", "\u00e4\u00f6\u00fc", "be", "replaced", "with", "_", "within", "the", "filename", "NUMBER", "I", "can", "t", "confirm", "this", "NUMBER", "I", "ve", "just", "re", "test", "with", "carrierwave", "NUMBER", "and", "the", "issue", "still", "persists", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "uploads", "photo", "image", "NUMBER", "CIMG", "NUMBER", "\u00e4", "NUMBER", "JPG", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "NUMBER", "url", "uploads", "photo", "image", "NUMBER", "CIMG", "NUMBER", "xC", "NUMBER", "xA", "NUMBER", "JPG", "irb", "main", "NUMBER", "NUMBER", "photo", "NUMBER", "image", "NUMBER", "url", "NUMBER", "encoding", "TAG", "Here", "s", "what", "I", "did", "NUMBER", "Updated", "carrierwave", "to", "NUMBER", "NUMBER", "Uploaded", "a", "photo", "NUMBER", "Entered", "the", "above", "rails", "console", "session", "Maybe", "I", "m", "use", "it", "incorrectly", "Here", "s", "the", "ImageUploader", "class", "LINK", "rails", "v", "Rails", "NUMBER", "Valete", "Marvin", "Hang", "on", "a", "second", "be", "this", "covered", "in", "the", "Filenames", "and", "unicode", "chars", "section", "of", "the", "readme", "I", "ve", "get", "this", "at", "the", "end", "of", "my", "config", "application", "NUMBER", "rb", "I", "didn", "t", "know", "where", "else", "to", "put", "it", "and", "it", "seem", "like", "a", "global", "option", "Allow", "non", "ascii", "letters", "in", "uploaded", "filenames", "CarrierWave", "SanitizedFile", "NUMBER", "sanitize_regexp", "word", "NUMBER", "Seems", "it", "doesn", "t", "do", "the", "trick", "NUMBER", "Vale", "Marvin", "I", "have", "the", "same", "problem", "while", "it", "worked", "there", "few", "days", "ago", "NUMBER", "The", "following", "line", "in", "the", "file", "config", "initializers", "carrierwave", "NUMBER", "rb", "CarrierWave", "SanitizedFile", "NUMBER", "sanitize_regexp", "word", "NUMBER", "I", "think", "the", "problem", "came", "with", "the", "ruby", "language", "upgrade", "to", "NUMBER", "but", "I", "don", "t", "know", "how", "to", "resolv", "this", "NUMBER", "Thank", "you", "for", "the", "help", "Quintus", "check", "out", "the", "readme", "and", "see", "if", "that", "helps", "NUMBER", "I", "think", "it", "should", "be", "a", "solve", "issue", "but", "maybe", "not", "NUMBER", "I", "_did_", "check", "out", "the", "README", "and", "it", "says", "this", "Another", "security", "issue", "you", "should", "care", "for", "be", "the", "file", "names", "see", "Ruby", "On", "Rails", "Security", "Guide", "NUMBER", "By", "default", "CarrierWave", "provides", "only", "English", "letters", "arabic", "numerals", "and", "_", "NUMBER", "symbols", "as", "white", "listed", "characters", "in", "the", "file", "name", "NUMBER", "If", "you", "want", "to", "support", "local", "scripts", "Cyrillic", "letters", "letters", "with", "diacritics", "and", "so", "on", "you", "have", "to", "override", "sanitize_regexp", "method", "NUMBER", "It", "should", "return", "regular", "expression", "which", "would", "match", "all", "non", "allow", "symbols", "NUMBER", "With", "Ruby", "NUMBER", "and", "higher", "you", "can", "simply", "write", "as", "it", "has", "Oniguruma", "build", "in", "CarrierWave", "SanitizedFile", "NUMBER", "sanitize_regexp", "word", "NUMBER", "I", "however", "add", "it", "to", "the", "end", "of", "config", "application", "NUMBER", "rb", "but", "further", "down", "the", "README", "recommends", "config", "initializers", "carrierwave", "NUMBER", "rb", "so", "I", "ll", "give", "that", "a", "try", "tomorrow", "NUMBER", "Vale", "Marvin", "The", "problem", "become", "from", "a", "ruby", "NUMBER", "bug", "see", "LINK", "lang", "NUMBER", "org", "issue", "NUMBER", "a", "a", "NUMBER", "encoding", "Encoding", "UTF", "NUMBER", "a", "a", "NUMBER", "encoding", "Encoding", "UTF", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "linux", "IMO", "this", "be", "not", "releated", "to", "ruby", "from", "RVM", "just", "for", "head", "Cannot", "reproduce", "on", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "linux", "Thus", "be", "ruby", "relate", "NUMBER", "Same", "error", "on", "head", "NUMBER", "Also", "with", "rails", "workaround", "relate", "to", "ruby", "bug", "NUMBER", "LINK", "_view", "template", "NUMBER", "rb", "L", "NUMBER", "Closing", "for", "now", "NUMBER", "If", "someone", "can", "confirm", "that", "this", "be", "in", "fact", "a", "Carrierwave", "issue", "feel", "free", "to", "add", "details", "to", "this", "conversation", "NUMBER", "I", "have", "the", "same", "problem", "NUMBER", "I", "m", "use", "Russian", "NUMBER", "Rails", "NUMBER", "ruby", "NUMBER", "carrierwave", "NUMBER", "put", "in", "the", "photo_uploader", "NUMBER", "rb", "CarrierWave", "SanitizedFile", "NUMBER", "sanitize_regexp", "word", "NUMBER", "it", "do", "not", "help", "lagox", "try", "ruby", "NUMBER", "p", "NUMBER", "not", "p", "NUMBER", "thanks", "i", "did", "so", "Just", "find", "this", "p", "Person", "NUMBER", "new", "p", "NUMBER", "remote_avatar_url", "LINK", "editor", "NUMBER", "org", "images", "wordpress", "NUMBER", "png", "p", "NUMBER", "change", "false", "The", "main", "problem", "be", "that", "if", "you", "have", "an", "exist", "record", "and", "try", "to", "only", "update", "the", "remote_url", "it", "won", "t", "trigger", "a", "save", "NUMBER", "Right", "now", "I", "m", "just", "setting", "another", "attribute", "to", "get", "it", "to", "work", "but", "I", "ll", "see", "if", "I", "can", "find", "a", "real", "fix", "for", "it", "NUMBER", "I", "run", "into", "the", "issue", "on", "a", "nested", "form", "so", "yes", "it", "s", "probably", "just", "limited", "to", "saving", "associated", "records", "NUMBER", "Good", "lookin", "After", "calling", "MyModel", "NUMBER", "save", "a", "NoMethodError", "be", "throw", "NUMBER", "I", "be", "on", "Rails", "NUMBER", "Ruby", "NUMBER", "only", "test", "this", "in", "IRB", "but", "the", "error", "occur", "when", "assigning", "a", "file", "like", "this", "m", "MyModel", "NUMBER", "new", "m", "NUMBER", "file", "File", "NUMBER", "open", "blabla", "m", "NUMBER", "save", "Sorry", "forgot", "the", "backtrace", "and", "version", "NUMBER", "Backtrace", "LINK", "Gem", "Version", "carrierwave", "NUMBER", "Thanks", "a", "lot", "Closing", "due", "to", "inactivity", "NUMBER", "This", "sounds", "like", "it", "s", "probably", "a", "question", "for", "the", "Google", "Group", "if", "you", "re", "just", "trying", "to", "get", "up", "and", "run", "with", "CarrierWave", "NUMBER", "I", "get", "this", "problem", "too", "on", "the", "production", "server", "NUMBER", "Trying", "to", "re", "trigger", "the", "bug", "on", "my", "dev", "machine", "now", "NUMBER", "Have", "no", "clue", "why", "this", "happens", "NUMBER", "well", "i", "ve", "find", "the", "cause", "of", "my", "problem", "NUMBER", "i", "mistakenly", "put", "the", "mount_upload", "call", "after", "the", "validates", "thumb", "call", "NUMBER", "I", "have", "this", "problem", "when", "the", "uploader", "be", "in", "the", "model", "of", "a", "nested", "form", "NUMBER", "Allows", "to", "set", "version", "type", "and", "processing", "it", "later", "NUMBER", "Main", "purpose", "be", "to", "create", "version", "in", "background", "with", "resque", "or", "delay_job", "NUMBER", "Example", "We", "have", "uploader", "with", "version", "preview", "that", "have", "type", "delayed", "ruby", "class", "MyUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "preview", "type", "delayed", "do", "process", "scale", "NUMBER", "NUMBER", "end", "end", "When", "file", "be", "cached", "version", "preview", "will", "not", "be", "created", "NUMBER", "And", "we", "can", "create", "it", "later", "ruby", "instance", "NUMBER", "create_versions", "delayed", "also", "we", "can", "create", "all", "version", "for", "this", "uploader", "by", "passing", "all", "to", "the", "method", "ruby", "instance", "NUMBER", "create_versions", "all", "and", "we", "can", "create", "few", "version", "by", "passing", "multiple", "version", "types", "to", "the", "method", "ruby", "instance", "NUMBER", "create_versions", "delayed", "other_version", "Having", "different", "version", "we", "can", "create", "version", "by", "priorities", "NUMBER", "I", "like", "the", "idea", "of", "be", "able", "to", "specify", "version", "in", "the", "uploader", "and", "process", "them", "later", "but", "I", "m", "not", "a", "fan", "of", "your", "API", "NUMBER", "How", "about", "passing", "delayed", "true", "to", "an", "options", "hash", "instead", "of", "type", "delayed", "to", "args", "Thanks", "for", "your", "comment", "I", "ve", "finally", "get", "it", "Your", "idea", "be", "good", "actually", "I", "had", "the", "same", "idea", "but", "when", "I", "ve", "start", "to", "code", "it", "I", "ve", "change", "my", "mind", "NUMBER", "Sorry", "for", "bad", "explanation", "of", "my", "idea", "I", "ll", "try", "to", "explain", "better", "NUMBER", "The", "main", "idea", "of", "this", "implementation", "be", "that", "we", "can", "use", "different", "type", "for", "each", "version", "and", "then", "create", "this", "version", "when", "we", "want", "and", "by", "different", "priorities", "NUMBER", "For", "example", "I", "need", "to", "create", "four", "version", "of", "file", "thumb", "should", "be", "processed", "when", "file", "uploaded", "preview", "should", "be", "processed", "as", "soon", "as", "possible", "big_preview", "should", "be", "processed", "but", "it", "doesn", "t", "meter", "when", "NUMBER", "black_n_white", "should", "be", "created", "on", "user", "request", "may", "not", "be", "created", "When", "I", "use", "this", "uploader", "ruby", "class", "MyUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "preview", "type", "critical", "do", "process", "scale", "NUMBER", "NUMBER", "end", "version", "big_preview", "type", "low", "do", "process", "long_process", "end", "version", "black_and_white", "type", "on_user_demand", "do", "process", "long_process", "end", "end", "then", "thumb", "version", "will", "be", "created", "on", "file", "cached", "NUMBER", "And", "preview", "and", "big_preview", "version", "will", "be", "created", "by", "a", "deamon", "Resque", "for", "example", "ruby", "queue", "critical", "NUMBER", "instance", "NUMBER", "create_versions", "critical", "NUMBER", "and", "other", "ruby", "NUMBER", "queue", "low", "NUMBER", "instance", "NUMBER", "create_versions", "low", "and", "run", "resque", "QUEUES", "critical", "low", "rake", "resque", "work", "And", "if", "user", "will", "want", "black", "and", "white", "and", "other", "rare", "types", "ruby", "instance", "NUMBER", "create_versions", "on_user_demand", "I", "still", "don", "t", "like", "the", "type", "critical", "API", "NUMBER", "I", "don", "t", "think", "it", "s", "too", "much", "duplication", "to", "declare", "version", "and", "then", "declare", "types", "of", "version", "on", "top", "of", "that", "NUMBER", "An", "API", "like", "this", "would", "work", "for", "me", "ruby", "class", "MyUploader", "TAG", "usr", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "sprockets", "helpers", "rails_helper", "NUMBER", "rb", "NUMBER", "in", "asset_paths", "usr", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "sprockets", "helpers", "rails_helper", "NUMBER", "rb", "NUMBER", "in", "asset_path", "app", "uploaders", "photo_uploader", "NUMBER", "rb", "NUMBER", "in", "default_url", "usr", "lib", "ruby", "gems", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "default_url", "NUMBER", "rb", "NUMBER", "in", "url", "app", "helpers", "users_helper", "NUMBER", "rb", "NUMBER", "in", "username_with_icon", "Can", "you", "try", "and", "isolate", "the", "problem", "with", "a", "small", "example", "app", "I", "have", "the", "same", "problem", "NUMBER", "Related", "question", "what", "be", "the", "best", "way", "to", "add", "the", "full", "root_url", "or", "the", "S", "NUMBER", "path", "in", "the", "default_url", "method", "I", "had", "the", "same", "issue", "and", "fix", "it", "the", "following", "way", "I", "ve", "add", "this", "to", "methods", "to", "my", "Uploader", "def", "config", "Rails", "NUMBER", "application", "NUMBER", "config", "NUMBER", "action_controller", "end", "def", "controller", "nil", "end", "I", "get", "the", "idea", "from", "LINK", "_helper", "NUMBER", "rb", "I", "tracked", "the", "change", "in", "sprockets", "between", "NUMBER", "and", "NUMBER", "since", "that", "update", "broke", "it", "for", "me", "I", "worked", "around", "this", "by", "just", "including", "NUMBER", "ruby", "include", "Sprockets", "Helpers", "IsolatedHelper", "So", "it", "will", "look", "something", "like", "NUMBER", "ruby", "class", "AvatarUploader", "TAG", "newmana", "For", "which", "provider", "be", "you", "run", "in", "to", "this", "With", "S", "NUMBER", "at", "least", "I", "have", "no", "problem", "overwriting", "exist", "file", "NUMBER", "Thanks", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Thanks", "for", "the", "heads", "up", "I", "had", "not", "realized", "that", "the", "ninefold", "storage", "semantics", "varied", "NUMBER", "It", "appears", "that", "fog", "attempts", "to", "deal", "with", "this", "issue", "as", "you", "can", "see", "here", "LINK", "L", "NUMBER", "It", "will", "PUT", "POST", "as", "appropriate", "given", "whether", "or", "not", "the", "object", "has", "an", "id", "set", "NUMBER", "That", "said", "in", "carrierwave", "currently", "it", "do", "not", "check", "before", "hand", "to", "see", "if", "the", "object", "already", "exists", "as", "you", "point", "out", "NUMBER", "I", "m", "reticent", "to", "add", "a", "check", "like", "you", "suggest", "though", "as", "it", "would", "double", "the", "number", "of", "request", "required", "even", "though", "it", "be", "not", "needed", "in", "many", "cases", "NUMBER", "It", "might", "be", "better", "therefore", "to", "just", "deal", "with", "the", "exceptional", "case", "NUMBER", "Perhaps", "use", "a", "rescue", "retry", "in", "the", "case", "of", "Ninefold", "in", "particular", "I", "think", "it", "would", "make", "sense", "for", "that", "to", "occur", "in", "carrierwave", "at", "least", "as", "a", "stop", "gap", "but", "I", "m", "not", "sure", "if", "that", "behavior", "be", "expected", "required", "in", "fog", "itself", "NUMBER", "I", "welcome", "your", "thoughts", "on", "it", "but", "that", "be", "where", "I", "m", "at", "so", "far", "after", "a", "little", "research", "NUMBER", "Thanks", "newmana", "I", "believe", "this", "should", "accomodate", "overwriting", "file", "and", "therefore", "be", "more", "consistent", "LINK", "Not", "sure", "how", "soon", "I", "ll", "get", "a", "release", "out", "though", "NUMBER", "I", "ll", "go", "ahead", "and", "close", "this", "as", "the", "issue", "be", "solve", "but", "not", "release", "yet", "NUMBER", "Thank", "you", "NUMBER", "This", "fix", "has", "mean", "an", "unmodified", "carrierwave", "NUMBER", "works", "with", "the", "current", "HEAD", "of", "Fog", "NUMBER", "Hi", "I", "was", "get", "random", "error", "in", "my", "application", "and", "I", "hunted", "them", "down", "to", "be", "because", "of", "this", "problem", "NUMBER", "In", "an", "uploader", "which", "uses", "file", "storage", "I", "have", "overriden", "filename", "with", "a", "timestamp", "dependent", "implementation", "ruby", "def", "filename", "T", "Time", "NUMBER", "current", "NUMBER", "to_i", "_", "original_filename", "if", "original_filename", "end", "Sometimes", "the", "same", "filename", "doesn", "t", "get", "write", "to", "file", "system", "and", "database", "but", "the", "one", "of", "the", "next", "second", "and", "obviously", "then", "the", "app", "can", "t", "locate", "it", "NUMBER", "You", "can", "reproduce", "it", "always", "if", "you", "go", "down", "to", "microseconds", "with", "Time", "NUMBER", "current", "NUMBER", "usec", "NUMBER", "I", "m", "use", "carrierwave", "NUMBER", "I", "was", "about", "to", "investigate", "and", "fix", "it", "myself", "but", "before", "doing", "so", "i", "wanted", "to", "check", "with", "you", "if", "there", "s", "something", "wrong", "with", "that", "timestamp", "dependent", "overriding", "NUMBER", "BTW", "if", "someone", "be", "bitten", "by", "this", "I", "worked", "it", "around", "in", "my", "app", "memoizing", "the", "filename", "method", "ruby", "def", "filename", "memoized_filename", "T", "Time", "NUMBER", "current", "NUMBER", "to_i", "_", "original_filename", "if", "original_filename", "end", "Maybe", "it", "isn", "t", "NUMBER", "I", "think", "a", "method", "that", "generates", "something", "that", "be", "supposed", "to", "be", "unique", "should", "only", "be", "call", "once", "but", "the", "workaround", "be", "so", "easy", "that", "it", "might", "not", "be", "worth", "the", "time", "and", "effort", "to", "fix", "it", "NUMBER", "Thank", "you", "Actually", "there", "be", "a", "wiki", "page", "about", "this", "at", "LINK", "to", "NUMBER", "A", "Create", "random", "and", "unique", "filenames", "for", "all", "version", "file", "I", "ll", "add", "some", "emphasis", "on", "the", "importance", "of", "memoizing", "the", "method", "NUMBER", "It", "seems", "that", "this", "isn", "t", "even", "sufficient", "NUMBER", "It", "gets", "call", "every", "time", "the", "host", "model", "be", "saved", "so", "it", "update", "the", "filename", "incorrectly", "NUMBER", "It", "s", "as", "if", "we", "actually", "need", "to", "persist", "the", "timestamp", "in", "the", "model", "or", "be", "I", "miss", "something", "Yeah", "you", "d", "want", "to", "persist", "it", "I", "think", "NUMBER", "I", "would", "expect", "filename", "to", "work", "with", "memoization", "for", "version", "but", "I", "guess", "it", "doesn", "t", "NUMBER", "Is", "there", "no", "other", "way", "of", "solving", "this", "without", "persisting", "the", "value", "it", "did", "actually", "seem", "to", "work", "with", "memoization", "NUMBER", "we", "run", "into", "some", "other", "problem", "that", "led", "me", "to", "believe", "i", "needed", "to", "persist", "NUMBER", "Ultimately", "i", "decided", "to", "persist", "it", "just", "in", "case", "as", "I", "didn", "t", "understand", "all", "the", "cases", "NUMBER", "Fog", "support", "streaming", "uploads", "if", "pass", "a", "File", "object", "NUMBER", "Added", "SanitizedFile", "to_file", "method", "that", "returns", "a", "File", "object", "NUMBER", "This", "works", "for", "file", "system", "based", "SanitizedFile", "File", "Tempfile", "Hash", "etc", "StringIO", "must", "still", "be", "read", "into", "memory", "before", "be", "pass", "to", "fog", "NUMBER", "Other", "than", "that", "one", "thing", "it", "looks", "good", "basically", "the", "main", "difference", "be", "passing", "a", "file", "handle", "ie", "File", "NUMBER", "open", "path", "instead", "of", "string", "and", "it", "certainly", "do", "this", "NUMBER", "NUMBER", "Seems", "reasonable", "I", "think", "NUMBER", "Sorry", "I", "only", "test", "in", "NUMBER", "I", "m", "get", "these", "same", "failures", "in", "NUMBER", "I", "ll", "look", "into", "it", "and", "send", "a", "new", "pull", "request", "NUMBER", "I", "be", "use", "MiniMagick", "to", "convert", "uploaded", "images", "to", "PNG", "and", "resizing", "them", "NUMBER", "If", "I", "convert", "the", "image", "first", "and", "then", "resize", "in", "the", "code", "it", "doesn", "t", "make", "it", "into", "a", "PNG", "and", "the", "MIME", "type", "be", "set", "to", "that", "of", "the", "original", "NUMBER", "If", "I", "do", "it", "the", "other", "way", "around", "the", "conversion", "goes", "through", "but", "the", "MIME", "type", "be", "still", "not", "image", "png", "when", "it", "uploads", "to", "S", "NUMBER", "which", "I", "m", "use", "as", "storage", "NUMBER", "This", "be", "what", "my", "uploader", "looked", "like", "first", "class", "ImageUploader", "TAG", "png", "process", "resize_to_limit", "NUMBER", "NUMBER", "version", "thumb", "do", "process", "convert", "png", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "NUMBER", "end", "During", "the", "conversion", "above", "CarrierWave", "saves", "the", "PNG", "version", "to", "the", "same", "filename", "keep", "the", "extension", "of", "the", "original", "file", "e", "NUMBER", "g", "NUMBER", "NUMBER", "jpg", "NUMBER", "Then", "when", "it", "do", "the", "resize", "MiniMagick", "seems", "to", "use", "the", "file", "extension", "to", "select", "the", "output", "format", "JPEG", "I", "test", "this", "use", "mogrify", "NUMBER", "Finally", "when", "uploading", "to", "S", "NUMBER", "CarrierWave", "MimeTypes", "infers", "the", "MIME", "type", "based", "on", "the", "file", "extension", "image", "jpeg", "NUMBER", "I", "think", "the", "filename", "use", "for", "processing", "should", "be", "update", "as", "the", "image", "be", "converted", "in", "order", "for", "the", "resizing", "to", "be", "do", "in", "the", "correct", "format", "and", "setting", "the", "correct", "MIME", "type", "NUMBER", "I", "temporarily", "bypassed", "this", "issue", "by", "doing", "the", "conversion", "after", "the", "resizing", "to", "avoid", "the", "resize", "output", "becoming", "the", "same", "format", "as", "the", "original", "and", "forcing", "the", "MIME", "type", "by", "add", "a", "custom", "processor", "callback", "NUMBER", "The", "update", "uploader", "class", "ImageUploader", "TAG", "NUMBER", "NUMBER", "process", "convert", "png", "process", "set_png_content_type", "version", "thumb", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "process", "convert", "png", "end", "def", "set_png_content_type", "file", "NUMBER", "content_type", "image", "png", "end", "NUMBER", "end", "trevorturk", "where", "can", "I", "find", "Using", "RMagick", "Yeah", "I", "use", "the", "filename", "method", "in", "my", "uploader", "to", "set", "a", "NUMBER", "png", "filename", "didn", "t", "include", "it", "above", "but", "CarrierWave", "only", "seems", "to", "use", "it", "to", "set", "the", "filename", "for", "the", "S", "NUMBER", "file", "NUMBER", "When", "I", "use", "u", "NUMBER", "avatar", "NUMBER", "url", "This", "return", "url", "to", "file", "NUMBER", "png", "this", "be", "a", "app", "path", "for", "the", "object", "not", "a", "url", "NUMBER", "But", "I", "need", "get", "LINK", "NUMBER", "Because", "this", "be", "a", "real", "url", "NUMBER", "Maybe", "a", "public_url", "method", "its", "the", "soluction", "NUMBER", "so", "what", "be", "the", "correct", "way", "call", "a", "url", "to", "a", "photo", "stored", "on", "s", "NUMBER", "how", "do", "one", "tell", "carrierwave", "to", "automatically", "append", "the", "s", "NUMBER", "url", "to", "the", "beginning", "of", "the", "image", "path", "only", "a", "relative", "URL", "gets", "stored", "in", "the", "DB", "so", "either", "the", "url", "needs", "to", "be", "prepended", "to", "path", "stored", "not", "preferable", "or", "get", "add", "automatically", "by", "carrierwave", "NUMBER", "where", "do", "i", "configure", "this", "as", "it", "carrierwave", "s", "NUMBER", "be", "very", "common", "i", "can", "t", "be", "the", "only", "one", "with", "this", "issue", "NUMBER", "Hi", "I", "m", "looking", "for", "solution", "to", "be", "able", "resize", "images", "depending", "on", "my", "model", "settings", "NUMBER", "Something", "like", "that", "would", "be", "what", "I", "m", "looking", "for", "but", "it", "be", "not", "work", "version", "thumb", "do", "process", "resize_to_limit", "model", "NUMBER", "umb_size", "end", "I", "know", "you", "can", "access", "model", "setting", "when", "setting", "the", "store_dir", "but", "not", "for", "version", "NUMBER", "Is", "this", "a", "bug", "or", "be", "there", "a", "way", "to", "do", "this", "Your", "help", "would", "be", "greatly", "appreciated", "I", "see", "a", "lot", "of", "people", "turning", "to", "dragonfly", "for", "the", "lack", "of", "this", "feature", "of", "creating", "dynamic", "version", "sizes", "in", "carrierwave", "NUMBER", "It", "s", "a", "shame", "because", "carrierwave", "be", "a", "really", "great", "solution", "NUMBER", "Trevor", "what", "would", "it", "cost", "to", "have", "you", "build", "this", "feature", "I", "still", "hitting", "NUMBER", "with", "latest", "carrierwave", "version", "so", "decided", "to", "send", "pull", "request", "by", "myself", "NUMBER", "This", "looks", "good", "to", "me", "NUMBER", "You", "get", "my", "vote", "NUMBER", "Thanks", "for", "jumping", "on", "this", "NUMBER", "You", "re", "parsing", "the", "to_json", "output", "and", "converting", "it", "to", "xml", "why", "This", "was", "my", "quick", "and", "dirty", "hack", "suggestion", "originally", "on", "the", "NUMBER", "thread", "NUMBER", "There", "be", "some", "discussion", "there", "about", "to_xml", "not", "having", "an", "as_xml", "equivalent", "of", "as_json", "NUMBER", "This", "technique", "basically", "launders", "your", "hash", "through", "as_json", "which", "handles", "the", "original", "nil", "issue", "NUMBER", "I", "haven", "t", "test", "this", "but", "perhaps", "a", "better", "solution", "would", "be", "def", "to_xml", "options", "nil", "self", "NUMBER", "as_json", "NUMBER", "to_xml", "end", "Please", "see", "issue", "NUMBER", "for", "complete", "details", "NUMBER", "This", "be", "a", "resubmitted", "pull", "request", "on", "that", "topic", "NUMBER", "This", "needs", "to", "be", "rebased", "with", "master", "doesn", "t", "merge", "cleanly", "NUMBER", "What", "s", "the", "best", "way", "to", "accomplish", "that", "The", "first", "commit", "in", "this", "pull", "request", "b", "NUMBER", "bc", "NUMBER", "bd", "NUMBER", "a", "NUMBER", "e", "NUMBER", "dac", "NUMBER", "a", "NUMBER", "f", "NUMBER", "c", "NUMBER", "d", "NUMBER", "was", "previously", "merge", "into", "master", "as", "NUMBER", "c", "NUMBER", "d", "NUMBER", "e", "NUMBER", "b", "NUMBER", "b", "NUMBER", "ab", "NUMBER", "f", "NUMBER", "e", "NUMBER", "c", "NUMBER", "and", "later", "revert", "by", "another", "commit", "NUMBER", "c", "NUMBER", "dbed", "NUMBER", "d", "NUMBER", "db", "NUMBER", "f", "NUMBER", "a", "NUMBER", "ebc", "NUMBER", "da", "NUMBER", "b", "NUMBER", "b", "NUMBER", "f", "NUMBER", "The", "original", "code", "needs", "to", "be", "re", "merge", "back", "in", "NUMBER", "tips", "Currently", "the", "URLs", "in", "Carrierwave", "be", "broken", "when", "use", "S", "NUMBER", "with", "CNAME", "and", "SSL", "options", "due", "to", "the", "SSL", "certificates", "not", "matching", "up", "with", "the", "domain", "NUMBER", "The", "URL", "Carrierwave", "returns", "for", "example", "sorry", "for", "the", "length", "LINK", "or", "if", "you", "use", "the", "S", "NUMBER", "subdomain", "format", "LINK", "In", "at", "least", "the", "latest", "Safari", "Firefox", "and", "Chrome", "version", "they", "ll", "all", "appear", "broken", "unless", "you", "manually", "view", "the", "image", "and", "confirm", "that", "it", "s", "ok", "NUMBER", "The", "small", "change", "I", "made", "was", "to", "make", "it", "so", "any", "calls", "to", "the", "S", "NUMBER", "storage", "modules", "public_url", "will", "return", "the", "Amazon", "path", "URL", "rather", "than", "the", "subdomain", "or", "CNAME", "when", "SSL", "be", "enable", "NUMBER", "Using", "the", "above", "URL", "example", "it", "will", "return", "LINK", "which", "loads", "fine", "NUMBER", "Ack", "sorry", "didn", "t", "see", "it", "had", "be", "deprecate", "NUMBER", "The", "fog_host", "option", "will", "work", "perfectly", "thanks", "Hello", "I", "just", "start", "to", "use", "carrierwave", "and", "love", "it", "so", "far", "Thanks", "for", "the", "great", "work", "NUMBER", "Just", "one", "thing", "when", "I", "was", "saving", "an", "object", "associated", "to", "a", "picture", "without", "any", "change", "on", "the", "picture", "for", "instance", "u", "user", "NUMBER", "first", "u", "NUMBER", "name", "oyoyoy", "u", "NUMBER", "save", "I", "was", "get", "an", "error", "in", "the", "filename", "function", "I", "find", "in", "the", "documentation", "TypeError", "can", "t", "convert", "nil", "into", "String", "from", "app", "uploaders", "picture_uploader", "NUMBER", "rb", "NUMBER", "in", "extname", "from", "app", "uploaders", "picture_uploader", "NUMBER", "rb", "NUMBER", "in", "filename", "I", "just", "change", "the", "definition", "from", "def", "filename", "super", "NUMBER", "chomp", "File", "NUMBER", "extname", "super", "NUMBER", "png", "end", "to", "def", "filename", "super", "NUMBER", "chomp", "File", "NUMBER", "extname", "super", "NUMBER", "png", "unless", "super", "NUMBER", "nil", "end", "and", "everything", "seems", "to", "work", "great", "now", "NUMBER", "Cheers", "Alex", "Hi", "Jonas", "this", "patch", "allows", "one", "to", "rais", "CarrierWave", "error", "with", "custom", "message", "NUMBER", "Prior", "to", "this", "patch", "all", "processing", "error", "would", "read", "fail", "to", "be", "processed", "even", "when", "one", "raises", "a", "CarrierWave", "processing", "error", "with", "a", "custom", "message", "NUMBER", "Similarly", "CarrierWave", "s", "own", "integrity", "error", "message", "be", "replaced", "with", "the", "rather", "short", "be", "not", "an", "allow", "file", "type", "w", "o", "explaining", "what", "extensions", "be", "accepted", "NUMBER", "I", "hope", "you", "ll", "accept", "this", "patch", "NUMBER", "Could", "you", "add", "some", "test", "for", "this", "behaviour", "not", "sure", "I", "quite", "understand", "what", "this", "be", "doing", "Jonas", "I", "ve", "add", "test", "cases", "and", "I", "NUMBER", "n", "all", "error", "message", "NUMBER", "Give", "it", "try", "NUMBER", "See", "if", "you", "can", "force", "a", "MIME", "InvalidContentType", "error", "that", "be", "the", "only", "one", "miss", "NUMBER", "trevorturk", "conflict", "resolve", "NUMBER", "I", "do", "hope", "jnicklas", "will", "merge", "the", "change", "as", "the", "current", "code", "doesn", "t", "allow", "for", "custom", "error", "message", "NUMBER", "These", "change", "allow", "for", "custom", "error", "message", "while", "preserving", "i", "NUMBER", "n", "NUMBER", "When", "CarrierWave", "be", "loaded", "the", "Configuration", "module", "be", "loaded", "prior", "to", "setting", "CarrierWave", "NUMBER", "root", "NUMBER", "At", "the", "time", "the", "configuration", "defaults", "be", "established", "CarrierWave", "NUMBER", "root", "be", "nil", "cause", "Uploader", "instances", "to", "initially", "carry", "a", "root", "value", "of", "nil", "unless", "config", "NUMBER", "root", "be", "explicitly", "configured", "either", "globally", "or", "on", "the", "Uploader", "instance", "NUMBER", "This", "condition", "was", "also", "difficult", "to", "test", "for", "and", "in", "fact", "an", "exist", "test", "for", "this", "was", "hiding", "the", "error", "NUMBER", "During", "test", "setup", "in", "spec_helper", "NUMBER", "rb", "a", "value", "be", "explicitly", "set", "for", "CarrierWave", "NUMBER", "root", "_before_", "any", "of", "the", "modules", "including", "Configuration", "be", "loaded", "NUMBER", "This", "causes", "the", "test", "in", "paths_spec", "NUMBER", "rb", "to", "give", "false", "positives", "NUMBER", "In", "normal", "operation", "the", "Configuration", "module", "loads", "before", "CarrierWave", "NUMBER", "root", "be", "set", "near", "the", "end", "of", "carrierwave", "NUMBER", "rb", "NUMBER", "Rather", "than", "re", "order", "the", "initialization", "process", "and", "module", "loading", "I", "change", "the", "Configuration", "module", "to", "accept", "Proc", "values", "for", "configuration", "values", "NUMBER", "This", "has", "the", "add", "bonus", "of", "allowing", "configuration", "values", "to", "be", "dynamically", "evaluated", "at", "runtime", "rather", "than", "at", "startup", "NUMBER", "I", "have", "set", "the", "default", "value", "of", "config", "NUMBER", "root", "as", "a", "Proc", "to", "resolve", "the", "race", "condition", "NUMBER", "Additionally", "I", "have", "correct", "the", "paths_spec", "NUMBER", "rb", "unit", "test", "to", "ensure", "the", "exist", "test", "fail", "exposing", "the", "error", "and", "a", "new", "test", "has", "be", "add", "to", "ensure", "that", "the", "Proc", "execution", "resolve", "correctly", "on", "the", "uploader", "instance", "NUMBER", "The", "pull", "request", "was", "based", "off", "of", "stable", "code", "v", "NUMBER", "All", "test", "pass", "with", "the", "exception", "of", "one", "test", "I", "left", "fail", "to", "demonstrate", "the", "error", "NUMBER", "I", "will", "remove", "the", "fail", "test", "since", "it", "was", "not", "properly", "test", "the", "condition", "for", "which", "it", "was", "intended", "to", "test", "NUMBER", "If", "you", "ll", "reopen", "the", "pull", "request", "I", "will", "submit", "my", "change", "shortly", "NUMBER", "He", "didn", "t", "break", "the", "build", "it", "s", "be", "broken", "on", "JRuby", "for", "awhile", "now", "NUMBER", "You", "just", "haven", "t", "gotten", "the", "emails", "until", "now", "Resubmitted", "pull", "request", "as", "NUMBER", "Oh", "ok", "you", "re", "right", "NUMBER", "Cool", "if", "we", "remove", "JRuby", "for", "now", "I", "m", "not", "sure", "how", "to", "fix", "and", "it", "would", "be", "nice", "to", "get", "accurate", "emails", "for", "build", "status", "NUMBER", "With", "regards", "to", "the", "discussion", "start", "here", "LINK", "_thread", "thread", "NUMBER", "cd", "NUMBER", "b", "NUMBER", "d", "NUMBER", "c", "NUMBER", "This", "change", "improves", "the", "interchangeability", "of", "File", "and", "Fog", "storage", "providers", "by", "allowing", "the", "File", "storage", "mechanism", "to", "target", "a", "subdirectory", "of", "CarrierWave", "NUMBER", "root", "which", "for", "practical", "purposes", "and", "compatibility", "should", "probably", "always", "be", "Rails", "NUMBER", "public_path", "NUMBER", "This", "change", "would", "allow", "for", "example", "the", "Fog", "storage", "mechanism", "to", "be", "use", "in", "production", "while", "the", "File", "storage", "mechanism", "can", "be", "use", "in", "development", "NUMBER", "I", "do", "not", "believe", "this", "issue", "be", "relate", "to", "NUMBER", "This", "was", "meant", "to", "make", "the", "path", "within", "the", "store", "generate", "by", "store_path", "more", "consistent", "between", "different", "storage", "providers", "NUMBER", "Specifically", "the", "file", "mechanism", "assumed", "a", "base", "path", "of", "Rails", "NUMBER", "public_path", "by", "default", "NUMBER", "I", "needed", "a", "way", "to", "make", "the", "file", "storage", "mechanism", "store", "file", "within", "a", "sub", "directory", "of", "public", "NUMBER", "However", "setting", "CarrierWave", "NUMBER", "root", "or", "config", "NUMBER", "root", "to", "my", "preferred", "base", "path", "cause", "conflict", "when", "I", "use", "file", "storage", "in", "development", "and", "fog", "in", "production", "NUMBER", "This", "change", "add", "a", "config", "NUMBER", "file_directory", "option", "similar", "to", "what", "config", "NUMBER", "fog_directory", "provides", "NUMBER", "This", "patch", "add", "a", "config", "option", "named", "base_url", "that", "be", "use", "as", "prefix", "in", "Uploader", "url", "if", "file", "url", "be", "not", "present", "NUMBER", "If", "use", "Rails", "base_url", "defaults", "to", "ENV", "RAILS_RELATIVE_URL_ROOT", "so", "CarrierWave", "s", "local", "file", "storage", "now", "plays", "nicely", "with", "Rails", "apps", "deployed", "to", "subdirectories", "NUMBER", "I", "think", "this", "be", "good", "but", "would", "you", "mind", "reworking", "the", "naming", "to", "use", "base_path", "instead", "This", "will", "keep", "consistent", "with", "the", "way", "Rails", "defines", "routing", "for", "URLs", "and", "paths", "this", "base", "path", "do", "not", "contain", "the", "scheme", "or", "domain", "NUMBER", "Thanks", "Thanks", "for", "your", "suggestion", "I", "renamed", "the", "option", "accordingly", "NUMBER", "Thanks", "I", "rebased", "the", "commit", "NUMBER", "I", "don", "t", "think", "that", "this", "intereferes", "with", "NUMBER", "I", "m", "not", "completely", "sure", "about", "that", "however", "NUMBER", "It", "s", "meant", "for", "the", "case", "where", "the", "rails", "application", "as", "a", "whole", "be", "deployed", "to", "a", "subdirectory", "say", "myhost", "NUMBER", "com", "foobar", "and", "thus", "any", "url", "must", "be", "prefixed", "with", "foobar", "NUMBER", "I", "ve", "add", "a", "section", "to", "the", "README", "that", "explains", "how", "to", "use", "CarrierWave", "MimeTypes", "to", "set", "more", "specific", "content", "type", "values", "NUMBER", "One", "small", "comment", "NUMBER", "Carrierwave", "try", "to", "call", "content_type", "on", "the", "file", "pass", "in", "to", "get", "the", "content", "type", "or", "it", "also", "can", "look", "at", "the", "extension", "of", "the", "file", "to", "allow", "very", "basic", "guessing", "NUMBER", "If", "none", "of", "this", "works", "it", "just", "leaves", "the", "content", "type", "blank", "NUMBER", "I", "believe", "then", "Amazon", "S", "NUMBER", "for", "example", "sets", "a", "default", "content", "type", "of", "binary", "octet_stream", "NUMBER", "So", "it", "s", "not", "Carrierwave", "setting", "that", "NUMBER", "Then", "the", "processor", "actually", "uses", "the", "mime", "types", "gem", "to", "get", "the", "content", "type", "by", "actually", "looking", "at", "the", "mime", "type", "encoding", "of", "the", "file", "instead", "of", "the", "basic", "stuff", "describe", "above", "that", "carrierwave", "do", "NUMBER", "Thanks", "for", "the", "detailed", "explanation", "Steve", "NUMBER", "I", "ll", "try", "to", "update", "the", "pull", "request", "tonight", "with", "that", "info", "NUMBER", "Updated", "Let", "me", "know", "what", "you", "think", "NUMBER", "You", "re", "welcome", "mate", "NUMBER", "Thanks", "for", "the", "great", "gem", "if", "you", "have", "ssl", "enable", "use", "a", "cname", "or", "even", "the", "subdomain", "style", "bucketname", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "will", "cause", "issue", "NUMBER", "Therefore", "if", "use_ssl", "be", "set", "use", "the", "valid", "s", "NUMBER", "amazonaws", "NUMBER", "com", "domain", "NUMBER", "Hi", "I", "start", "carrieerwave", "use", "in", "our", "project", "for", "uploading", "file", "before", "that", "i", "was", "use", "simple", "file", "upload", "methods", "find", "its", "intesting", "But", "problem", "be", "for", "allready", "build", "data", "we", "dont", "have", "record", "values", "for", "serialization_column", "in", "our", "model", "thats", "why", "when", "i", "was", "firing", "update", "query", "its", "giving", "error", "of", "NOMETHOD", "ERROR", "serialization_column", "_changed", "means", "eg", "avtara_changed", "i", "edit", "the", "file", "lib", "carrierwave", "mount", "NUMBER", "rb", "and", "write", "a", "method", "serialization_column", "_changed", "i", "gving", "value", "for", "it", "false", "in", "side", "it", "but", "its", "not", "a", "fix", "may", "be", "it", "can", "create", "problem", "in", "other", "process", "and", "i", "current", "ly", "not", "get", "how", "handle", "this", "condition", "can", "anybody", "suggest", "me", "solution", "for", "it", "Thanks", "Ketan", "Muneshwart", "I", "have", "the", "same", "problem", "NUMBER", "It", "seems", "to", "be", "in", "my", "case", "limited", "to", "Rails", "NUMBER", "rc", "NUMBER", "My", "uploader", "be", "call", "PhotoUploader", "and", "I", "m", "mounting", "it", "in", "my", "AR", "model", "as", "photo", "NUMBER", "On", "update", "an", "error", "be", "raise", "saying", "that", "photo_changed", "be", "undefined", "NUMBER", "Has", "this", "meta", "method", "be", "remove", "in", "Rails", "NUMBER", "Issue", "solve", "Column", "didn", "t", "migrate", "correctly", "NUMBER", "I", "have", "a", "custom", "processor", "use", "MiniMagick", "s", "manipulate", "method", "NUMBER", "Here", "s", "a", "summary", "of", "my", "code", "ruby", "class", "PhotoUploader", "TAG", "NUMBER", "output", "mogrify", "invalid", "argument", "for", "option", "x", "NUMBER", "resize", "error", "mogrify", "NUMBER", "c", "MogrifyImageCommand", "NUMBER", "n", "essentially", "it", "seems", "that", "it", "be", "be", "wrapping", "the", "command", "line", "argument", "in", "quotes", "oops", "NUMBER", "forgot", "to", "include", "yield", "img", "if", "block_given", "NUMBER", "now", "its", "work", "fine", "NUMBER", "perhaps", "its", "the", "same", "issue", "for", "willcodeforfoo", "Didn", "t", "seem", "to", "make", "a", "difference", "for", "me", "current_path", "be", "still", "NUMBER", "trevorturk", "I", "use", "your", "sample", "Sinatra", "app", "posted", "on", "the", "Engine", "Yard", "blog", "recently", "as", "a", "basis", "for", "a", "simple", "app", "that", "demonstrates", "the", "issue", "LINK", "That", "did", "work", "So", "the", "keys", "for", "processors", "be", "NUMBER", "Call", "method", "directly", "on", "exist", "img", "rather", "than", "assigning", "to", "img", "NUMBER", "Make", "sure", "to", "yield", "if", "a", "block", "be", "given", "img", "yield", "img", "if", "block_given", "NUMBER", "Return", "img", "at", "the", "end", "of", "the", "processor", "lib", "carrierwave", "processing", "mini_magick", "NUMBER", "rb", "should", "probably", "be", "edit", "to", "reflect", "this", "as", "it", "was", "where", "I", "was", "get", "the", "code", "from", "thinking", "that", "img", "img", "NUMBER", "foo", "would", "work", "Or", "create", "your", "own", "helpers", "with", "the", "powerful", "manipulate", "method", "NUMBER", "Check", "out", "the", "ImageMagick", "docs", "at", "LINK", "line", "options", "NUMBER", "php", "for", "more", "info", "class", "MyUploader", "TAG", "NUMBER", "def", "do_stuff", "blur_factor", "manipulate", "do", "img", "img", "img", "NUMBER", "sepiatone", "img", "img", "NUMBER", "auto_orient", "img", "img", "NUMBER", "radial_blur", "blur_factor", "end", "end", "end", "Would", "you", "like", "a", "pull", "request", "for", "this", "change", "I", "ll", "see", "about", "make", "a", "wiki", "page", "for", "custom", "processing", "actions", "NUMBER", "The", "details", "of", "this", "Wiki", "addition", "should", "also", "be", "reflected", "in", "the", "RDOC", "output", "as", "find", "here", "LINK", "LINK", "be", "no", "longer", "update", "Native", "sqlite", "NUMBER", "looks", "to", "have", "outbound", "memory", "access", "issue", "and", "it", "causes", "JVM", "to", "SEGV", "NUMBER", "C", "ext", "version", "doesn", "t", "scale", "well", "with", "multi", "threads", "on", "JRuby", "so", "use", "jdbc", "sqlite", "NUMBER", "gem", "instead", "of", "native", "sqlite", "NUMBER", "gem", "NUMBER", "DEPRECATION", "WARNING", "ActiveSupport", "Memoizable", "be", "deprecate", "and", "will", "be", "remove", "in", "future", "release", "simply", "use", "Ruby", "memoization", "pattern", "instead", "NUMBER", "call", "from", "extend", "at", "Users", "kain", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "preview", "NUMBER", "bundler", "gems", "carrierwave", "c", "NUMBER", "b", "NUMBER", "f", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "Thanks", "saw", "this", "a", "few", "weeks", "ago", "NUMBER", "Tried", "reading", "through", "the", "AS", "Memoizable", "code", "to", "see", "exactly", "what", "we", "ll", "need", "to", "change", "to", "get", "the", "equivalent", "but", "it", "was", "confusing", "so", "I", "m", "procrastinating", "NUMBER", "Deprecated", "in", "NUMBER", "remove", "after", "that", "correct", "You", "re", "correct", "we", "still", "have", "plenty", "of", "time", "to", "get", "that", "fix", "I", "ll", "try", "taking", "a", "look", "but", "I", "m", "really", "with", "my", "head", "into", "another", "type", "of", "codebase", "at", "the", "moment", "thanks", "NUMBER", "still", "outstanding", "Yes", "still", "outstanding", "NUMBER", "Is", "there", "a", "release", "stable", "version", "I", "can", "use", "with", "this", "fix", "It", "doesn", "t", "appear", "that", "NUMBER", "has", "this", "patch", "I", "m", "looking", "at", "the", "NUMBER", "install", "on", "my", "system", "and", "the", "require", "in", "carrierwave", "NUMBER", "rb", "and", "the", "extend", "ActiveSupport", "Memoizable", "in", "carrierwave", "mount", "NUMBER", "rb", "etc", "NUMBER", "be", "all", "still", "there", "NUMBER", "And", "I", "m", "still", "get", "the", "DEPRECATION", "WARNING", "with", "NUMBER", "Having", "my", "gem", "fix", "to", "NUMBER", "stable", "branch", "seem", "to", "work", "NUMBER", "I", "had", "NUMBER", "before", "that", "vsanta", "Right", "I", "only", "wanted", "to", "give", "bensie", "the", "feedback", "that", "NUMBER", "do", "not", "appear", "to", "have", "this", "fix", "since", "he", "said", "above", "that", "he", "thought", "it", "did", "NUMBER", "In", "case", "something", "further", "needs", "to", "be", "do", "so", "it", "gets", "into", "NUMBER", "It", "s", "not", "an", "urgent", "issue", "for", "me", "NUMBER", "you", "re", "right", "targeting", "the", "NUMBER", "stable", "branch", "remove", "the", "warning", "ruby", "gem", "carrierwave", "git", "git", "github", "NUMBER", "com", "jnicklas", "carrierwave", "NUMBER", "git", "branch", "NUMBER", "stable", "gem", "carrierwave", "mongoid", "require", "carrierwave", "mongoid", "Can", "we", "have", "a", "gemrelease", "for", "this", "Please", "NUMBER", "Gem", "release", "would", "be", "great", "NUMBER", "NUMBER", "Gem", "release", "pl", "NUMBER", "x", "NUMBER", "for", "Gem", "release", "was", "thinking", "about", "posting", "time", "to", "release", "a", "new", "gem", "for", "weeks", "NUMBER", "NUMBER", "for", "gem", "release", "NUMBER", "for", "gem", "release", "NUMBER", "for", "gem", "release", "I", "think", "it", "s", "not", "a", "good", "practice", "to", "have", "a", "gem", "release", "just", "for", "a", "warning", "it", "s", "super", "annoying", "I", "know", "NUMBER", "But", "at", "least", "give", "us", "some", "insight", "on", "when", "you", "ll", "do", "it", "or", "why", "you", "didn", "t", "already", "did", "it", "NUMBER", "There", "be", "really", "a", "lot", "of", "people", "ask", "for", "it", "NUMBER", "Thank", "you", "very", "much", "for", "work", "on", "this", "gem", "NUMBER", "It", "s", "indispensable", "for", "me", "NUMBER", "bensie", "Thank", "you", "for", "the", "quick", "response", "and", "clarification", "And", "for", "the", "awesome", "job", "on", "this", "awesome", "gem", "clap", "clap", "bensie", "Any", "chance", "of", "a", "NUMBER", "release", "to", "incorporate", "this", "as", "well", "We", "d", "like", "to", "resolve", "the", "warning", "in", "carrierwave", "mongoid", "before", "we", "fix", "compatibility", "against", "carrierwave", "NUMBER", "See", "jnicklas", "carrierwave", "mongoid", "NUMBER", "I", "overrode", "the", "filename", "method", "according", "to", "the", "docs", "to", "create", "a", "unique", "random", "filename", "NUMBER", "The", "problem", "be", "that", "the", "filename", "saved", "to", "S", "NUMBER", "via", "fog", "differs", "from", "what", "be", "be", "saved", "to", "the", "database", "NUMBER", "def", "filename", "SecureRandom", "NUMBER", "uuid", "NUMBER", "file", "NUMBER", "extension", "if", "original_filename", "NUMBER", "present", "end", "Echoing", "filename", "while", "saving", "the", "corresponding", "model", "shows", "that", "filenames", "be", "generate", "NUMBER", "times", "NUMBER", "The", "NUMBER", "filename", "be", "what", "be", "saved", "to", "S", "NUMBER", "but", "the", "NUMBER", "filename", "be", "what", "be", "saved", "to", "the", "database", "NUMBER", "This", "corresponds", "with", "the", "fact", "that", "original_filename", "NUMBER", "present", "still", "returns", "true", "even", "after", "the", "model", "be", "saved", "meaning", "that", "calling", "filename", "will", "generate", "a", "new", "name", "NUMBER", "I", "m", "guessing", "you", "re", "referring", "to", "this", "page", "LINK", "to", "NUMBER", "A", "Create", "random", "and", "unique", "filenames", "for", "all", "version", "file", "I", "edit", "the", "page", "to", "set", "the", "instance", "variable", "name", "instead", "of", "just", "returning", "the", "random", "GUID", "NUMBER", "It", "seems", "to", "work", "now", "NUMBER", "Is", "this", "correct", "This", "was", "write", "off", "as", "something", "that", "Mini_Magick", "doesn", "t", "support", "but", "I", "have", "tried", "remove", "pieces", "of", "Validations", "that", "would", "block", "an", "image", "from", "be", "saved", "in", "CarrierWave", "and", "Mini_Magick", "works", "just", "fine", "NUMBER", "I", "commented", "out", "validates_with", "ProcessingValidator", "_merge_attributes", "attr_names", "on", "line", "NUMBER", "of", "lib", "carrierwave", "validations", "active_model", "NUMBER", "rb", "and", "these", "lines", "in", "the", "same", "file", "class", "ProcessingValidator", "TAG", "Actual", "NUMBER", "Unauthorized", "it", "s", "because", "you", "need", "to", "point", "to", "the", "london", "api", "server", "NUMBER", "config", "NUMBER", "fog_credentials", "provider", "Rackspace", "rackspace_username", "test", "rackspace_api_key", "NUMBER", "rackspace_auth_url", "lon", "NUMBER", "auth", "NUMBER", "api", "NUMBER", "rackspacecloud", "NUMBER", "com", "Maybe", "it", "would", "be", "nice", "to", "point", "it", "out", "in", "the", "documentation", "Sure", "Here", "we", "go", "hope", "it", "s", "clear", "enough", "LINK", "In", "production", "mode", "all", "images", "in", "asset", "folder", "have", "an", "additional", "hash", "value", "add", "to", "their", "name", "but", "the", "fallback", "image", "url", "provide", "by", "carrierwave", "url", "helper", "don", "t", "have", "it", "so", "that", "fallback", "images", "be", "not", "display", "in", "production", "NUMBER", "I", "just", "say", "that", "if", "images", "for", "fallback", "be", "in", "the", "folder", "app", "assets", "images", "fallback", "they", "be", "not", "display", "in", "production", "environment", "will", "create", "a", "demo", "a", "little", "later", "I", "m", "going", "to", "hold", "off", "on", "looking", "at", "this", "until", "after", "Rails", "NUMBER", "be", "release", "or", "at", "least", "until", "a", "more", "stable", "RC", "be", "out", "NUMBER", "The", "asset", "pipeline", "be", "such", "a", "moving", "target", "right", "now", "that", "it", "would", "be", "very", "tough", "to", "get", "this", "fix", "with", "confidence", "that", "it", "won", "t", "break", "NUMBER", "That", "said", "a", "fail", "test", "and", "or", "sample", "app", "would", "be", "very", "helpful", "NUMBER", "I", "assume", "fuksito", "be", "referring", "to", "the", "default_url", "for", "display", "a", "fallback", "image", "when", "an", "image", "be", "not", "uploaded", "NUMBER", "bensie", "yes", "right", "default_url", "method", "has", "a", "default", "path", "to", "start", "with", "assets", "fallback", "so", "I", "call", "this", "a", "fallback", "image", "Here", "be", "the", "demo", "rails", "application", "LINK", "Rails", "rc", "NUMBER", "assets", "display", "problem", "default", "image", "needs", "to", "run", "through", "rails", "image_path", "method", "to", "pick", "up", "the", "correct", "name", "of", "the", "compiled", "asset", "in", "the", "asset", "pipeline", "Yep", "now", "that", "NUMBER", "be", "officially", "release", "I", "will", "look", "into", "this", "as", "soon", "as", "I", "can", "NUMBER", "Thanks", "James", "keep", "us", "posted", "NUMBER", "this", "be", "a", "problem", "for", "me", "too", "I", "can", "t", "seem", "to", "make", "default_url", "do", "anything", "under", "dev", "production", "since", "upgrading", "to", "Rails", "NUMBER", "I", "find", "a", "workaround", "for", "this", "be", "to", "include", "Sprockets", "Helpers", "RailsHelper", "into", "my", "uploader", "and", "use", "asset_path", "method", "to", "define", "fallback", "image", "path", "ruby", "class", "AvatarUploader", "TAG", "NUMBER", "The", "solution", "from", "fuksito", "didn", "t", "work", "for", "me", "I", "don", "t", "know", "if", "that", "s", "because", "I", "put", "it", "into", "my", "base", "class", "from", "which", "my", "up", "loaders", "inherit", "or", "if", "I", "m", "doing", "something", "wrong", "at", "the", "view", "layer", "ruby", "class", "FileUploader", "TAG", "png", "def", "default_url", "asset_path", "images", "fallback", "mounted_as", "version_name", "default", "NUMBER", "png", "NUMBER", "compact", "NUMBER", "join", "_", "or", "asset_path", "fallback", "mounted_as", "version_name", "default", "NUMBER", "png", "NUMBER", "compact", "NUMBER", "join", "_", "end", "end", "ruby", "class", "ShowPosterUploader", "TAG", "NUMBER", "NUMBER", "end", "end", "haml", "image_tag", "show", "NUMBER", "poster", "NUMBER", "umb", "NUMBER", "url", "class", "show", "image", "width", "NUMBER", "height", "NUMBER", "Tips", "would", "be", "appreciated", "in", "lieu", "of", "an", "official", "fix", "thanks", "NUMBER", "leehambley", "I", "had", "a", "similar", "issue", "it", "was", "because", "file", "was", "not", "on", "place", "in", "precompiled", "assets", "NUMBER", "Be", "sure", "that", "you", "ve", "run", "rake", "assets", "precompile", "Also", "try", "to", "run", "rake", "assets", "clean", "before", "precompiling", "fuksito", "thanks", "for", "the", "tip", "peculiarly", "this", "be", "development", "mode", "though", "so", "I", "m", "not", "sure", "what", "I", "m", "miss", "I", "ll", "give", "it", "a", "shot", "Thanks", "I", "m", "also", "having", "issue", "with", "the", "default_url", "setting", "in", "Rails", "NUMBER", "Shouldn", "t", "the", "following", "test", "work", "ruby", "Factory", "NUMBER", "create", "app", "NUMBER", "screenshot_url", "NUMBER", "should", "assets", "yourapp", "NUMBER", "png", "My", "uploader", "looks", "like", "this", "ruby", "class", "ScreenshotUploader", "TAG", "NUMBER", "NUMBER", "process", "something_happened", "end", "def", "something_happened", "i", "NUMBER", "puts", "Something", "happened", "i", "time", "for", "version_name", "original", "file", "i", "NUMBER", "end", "end", "This", "ruby", "uploader", "TestImageUploader", "NUMBER", "new", "uploader", "NUMBER", "cache", "File", "NUMBER", "open", "spec", "fixture", "small", "NUMBER", "png", "uploader", "NUMBER", "ore", "Outputs", "this", "Some", "thing", "happens", "NUMBER", "time", "for", "original", "file", "Some", "thing", "happens", "NUMBER", "time", "for", "base", "And", "this", "ruby", "uploader", "TestImageUploader", "NUMBER", "new", "uploader", "NUMBER", "ore", "File", "NUMBER", "open", "spec", "fixture", "small", "NUMBER", "png", "Outputs", "this", "Some", "thing", "happens", "NUMBER", "time", "for", "original", "file", "Some", "thing", "happens", "NUMBER", "time", "for", "base", "Some", "thing", "happens", "NUMBER", "time", "for", "base", "So", "version", "base", "be", "processed", "twice", "I", "put", "puts", "calls", "to", "the", "beginning", "of", "cache", "and", "store", "NUMBER", "The", "following", "method", "chain", "be", "executed", "for", "last", "case", "store", "call", "for", "original", "file", "cache", "call", "for", "original", "file", "cache", "call", "for", "base", "store", "call", "for", "base", "cache", "call", "for", "base", "I", "think", "last", "cache", "be", "call", "for", "already", "cached", "version", "because", "the", "new", "file", "be", "pass", "to", "all", "store", "calls", "in", "version", "tree", "NUMBER", "I", "also", "think", "that", "fix", "this", "will", "close", "NUMBER", "ruby", "uploader", "cache", "NUMBER", "rb", "def", "store", "new_file", "nil", "cache", "new_file", "if", "new_file", "NUMBER", "end", "Yes", "I", "be", "worknig", "on", "it", "NUMBER", "But", "I", "do", "not", "know", "how", "to", "fix", "this", "issue", "NUMBER", "The", "simpliest", "way", "be", "to", "pass", "parent", "s", "cache_id", "to", "underlying", "cache", "calls", "and", "recache", "version", "only", "if", "parent", "s", "cache_id", "change", "NUMBER", "Such", "this", "ruby", "def", "store", "new_file", "nil", "new_cache_id", "nil", "cache", "new_file", "if", "new_file", "new_cache_id", "NUMBER", "blank", "cache_id", "new_cache_id", "if", "file", "and", "cache_id", "with_callbacks", "store", "new_file", "cache_id", "do", "end", "NUMBER", "end", "But", "this", "way", "requires", "to", "change", "all", "callbacks", "prototypes", "NUMBER", "It", "be", "no", "problem", "for", "internal", "carrierwave", "s", "methods", "but", "it", "will", "break", "all", "custom", "user", "callbacks", "after", "update", "on", "new", "version", "NUMBER", "The", "workaround", "be", "to", "check", "callback", "s", "arity", "before", "call", "NUMBER", "Like", "this", "ruby", "def", "with_callbacks", "kind", "args", "self", "NUMBER", "class", "NUMBER", "_before_callbacks", "kind", "NUMBER", "each", "c", "send", "c", "args", "NUMBER", "slice", "NUMBER", "self", "NUMBER", "class", "NUMBER", "method", "c", "NUMBER", "arity", "NUMBER", "end", "But", "it", "be", "not", "clear", "NUMBER", "May", "be", "the", "clearest", "way", "be", "to", "have", "topmost_version", "accessor", "with", "the", "reference", "to", "uploader", "who", "initiated", "the", "cache", "store", "process", "NUMBER", "Thank", "you", "NUMBER", "I", "ll", "try", "to", "implement", "this", "accessor", "and", "send", "you", "a", "pull", "request", "NUMBER", "Failing", "test", "do", "NUMBER", "Working", "on", "fix", "NUMBER", "LINK", "Hi", "This", "be", "a", "patch", "to", "allow", "write", "over", "previously", "assigned", "file", "when", "retrieving", "file", "from", "remote", "url", "see", "LINK", "topic", "carrierwave", "IMs", "NUMBER", "kYOur", "NUMBER", "E", "discussion", "NUMBER", "In", "the", "second", "commit", "I", "ve", "add", "a", "configuration", "option", "to", "make", "this", "new", "behavior", "optional", "so", "that", "the", "default", "behavior", "do", "not", "change", "NUMBER", "I", "agree", "that", "we", "don", "t", "need", "a", "configuration", "option", "for", "this", "in", "my", "mind", "the", "expected", "behavior", "would", "be", "to", "always", "overwrite", "the", "previously", "assigned", "file", "NUMBER", "Merging", "the", "first", "commit", "thanks", "Hi", "I", "wanted", "to", "display", "just", "the", "filename", "of", "the", "uploaded", "file", "and", "had", "to", "dig", "through", "the", "docs", "for", "the", "commit", "NUMBER", "ac", "NUMBER", "af", "NUMBER", "a", "NUMBER", "bf", "NUMBER", "b", "NUMBER", "e", "NUMBER", "f", "NUMBER", "a", "NUMBER", "e", "NUMBER", "aa", "NUMBER", "b", "NUMBER", "that", "introduce", "a", "way", "to", "do", "so", "NUMBER", "I", "ve", "add", "the", "NUMBER", "identifier", "to", "what", "I", "think", "be", "the", "relevant", "section", "that", "would", "have", "helped", "me", "NUMBER", "Thanks", "Kevin", "Fixed", "and", "merge", "in", "NUMBER", "b", "NUMBER", "eb", "NUMBER", "b", "NUMBER", "f", "NUMBER", "c", "NUMBER", "d", "NUMBER", "c", "NUMBER", "cb", "NUMBER", "d", "NUMBER", "c", "NUMBER", "thanks", "Yup", "it", "should", "be", "_", "instead", "of", "NUMBER", "I", "be", "use", "an", "application", "that", "stores", "file", "inside", "version", "mongoid", "documents", "with", "carrierwave", "hooking", "in", "as", "uploader", "and", "storing", "into", "gridfs", "NUMBER", "The", "documents", "carriewave", "be", "mounted", "into", "uses", "mongoids", "builtin", "document", "version", "NUMBER", "Before", "update", "to", "carrierwave", "NUMBER", "everything", "worked", "fine", "as", "expected", "Whenever", "I", "update", "an", "existent", "document", "by", "a", "new", "file", "mongoid", "created", "a", "new", "version", "and", "carrierwave", "stored", "the", "correct", "file", "informations", "into", "the", "new", "document", "version", "and", "the", "file", "into", "gridfs", "NUMBER", "Old", "file", "from", "document", "version", "before", "were", "still", "reachable", "by", "ask", "the", "specific", "documents", "version", "url", "and", "then", "fetching", "the", "file", "from", "gridfs", "NUMBER", "Now", "after", "update", "to", "NUMBER", "carrierwave", "still", "stores", "fine", "into", "a", "new", "document", "version", "but", "now", "deletes", "the", "old", "file", "from", "the", "version", "before", "from", "gridfs", "NUMBER", "The", "old", "document", "version", "then", "points", "to", "a", "non", "exist", "gridfs", "path", "NUMBER", "I", "can", "eliminate", "this", "behavior", "by", "downgrading", "to", "NUMBER", "where", "eveything", "works", "fine", "with", "version", "and", "reproduce", "the", "unwanted", "deletion", "when", "update", "back", "to", "NUMBER", "The", "app", "runs", "under", "Rails", "NUMBER", "with", "mongoid", "NUMBER", "Haven", "t", "looked", "into", "the", "carrierwave", "code", "yet", "but", "I", "assume", "it", "must", "come", "with", "the", "new", "function", "of", "deleting", "old", "file", "when", "update", "an", "document", "NUMBER", "which", "isn", "t", "wanted", "when", "use", "an", "uploader", "mounted", "into", "version", "documents", "NUMBER", "Thanks", "for", "the", "quick", "reply", "I", "will", "check", "with", "the", "option", "you", "have", "mention", "NUMBER", "Didn", "t", "know", "there", "be", "such", "a", "new", "option", "NUMBER", "But", "I", "agree", "I", "think", "the", "default", "should", "be", "to", "not", "delete", "previously", "file", "because", "otherwise", "this", "option", "be", "pretty", "destructive", "for", "a", "default", "one", "NUMBER", "I", "will", "ping", "in", "this", "thread", "if", "the", "option", "workes", "out", "for", "me", "or", "take", "a", "look", "at", "a", "new", "pull", "request", "NUMBER", "The", "config", "option", "solve", "my", "problem", "NUMBER", "Now", "NUMBER", "also", "leaves", "old", "file", "in", "place", "when", "creating", "new", "document", "version", "NUMBER", "Thats", "fine", "for", "me", "thank", "you", "But", "I", "would", "appreciate", "if", "this", "change", "of", "default", "behavior", "from", "one", "version", "to", "antother", "could", "be", "documented", "somewhere", "history", "NUMBER", "txt", "would", "be", "fine", "NUMBER", "And", "at", "least", "thanks", "for", "the", "great", "work", "on", "this", "great", "plugin", "Great", "stuff", "When", "trying", "to", "use", "CarrierWave", "on", "a", "Globalize", "NUMBER", "Column", "ActiveRecords", "the", "app", "crashes", "with", "an", "error", "undefined", "method", "attribute_will_change", "The", "combination", "of", "Carrierwave", "and", "Globalize", "NUMBER", "can", "be", "very", "useful", "if", "the", "admin", "wants", "to", "upload", "different", "images", "for", "different", "locales", "NUMBER", "I", "be", "use", "rails", "NUMBER", "All", "you", "really", "need", "to", "do", "to", "reproduce", "the", "problem", "be", "install", "Globalize", "NUMBER", "and", "Carrierwave", "then", "call", "translate", "on", "one", "of", "your", "columns", "in", "your", "model", "and", "run", "the", "Globalize", "migration", "This", "basically", "create", "a", "new", "table", "call", "model_name_translations", "with", "the", "column", "you", "specified", "and", "a", "row", "for", "each", "locale", "If", "you", "use", "one", "of", "those", "text", "columns", "with", "Carrierwave", "you", "get", "undefined", "method", "attribute_will_change", "error", "Globalize", "NUMBER", "hides", "the", "fact", "that", "your", "column", "be", "in", "a", "different", "table", "by", "allowing", "you", "to", "access", "it", "use", "model_name", "NUMBER", "col", "while", "Globalize", "NUMBER", "fetch", "the", "current", "value", "for", "your", "current", "locale", "and", "I", "guess", "this", "be", "where", "CarrierWave", "doesn", "t", "get", "along", "with", "Globalize", "NUMBER", "Here", "be", "an", "example", "how", "to", "make", "translated", "attachments", "If", "you", "have", "different", "images", "in", "different", "languages", "ruby", "class", "Page", "TAG", "activemodel", "NUMBER", "lib", "active_model", "attribute_methods", "NUMBER", "rb", "NUMBER", "in", "method_missing", "mongoid", "NUMBER", "lib", "mongoid", "attributes", "NUMBER", "rb", "NUMBER", "in", "method_missing", "carrierwave", "NUMBER", "lib", "carrierwave", "orm", "mongoid", "NUMBER", "rb", "NUMBER", "in", "urls", "mongoid", "NUMBER", "lib", "mongoid", "attributes", "processing", "NUMBER", "rb", "NUMBER", "in", "process_attribute", "mongoid", "NUMBER", "lib", "mongoid", "attributes", "processing", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process", "mongoid", "NUMBER", "lib", "mongoid", "attributes", "processing", "NUMBER", "rb", "NUMBER", "in", "each_pair", "mongoid", "NUMBER", "lib", "mongoid", "attributes", "processing", "NUMBER", "rb", "NUMBER", "in", "process", "mongoid", "NUMBER", "lib", "mongoid", "document", "NUMBER", "rb", "NUMBER", "in", "block", "in", "initialize", "mongoid", "NUMBER", "lib", "mongoid", "relations", "builders", "NUMBER", "rb", "NUMBER", "in", "build", "mongoid", "NUMBER", "lib", "mongoid", "document", "NUMBER", "rb", "NUMBER", "in", "initialize", "app", "controllers", "images_controller", "NUMBER", "rb", "NUMBER", "in", "new", "Line", "NUMBER", "of", "images_controller", "NUMBER", "rb", "ruby", "image", "Image", "NUMBER", "new", "params", "image", "It", "works", "fine", "with", "mongoid", "NUMBER", "Hi", "It", "seems", "that", "this", "method", "has", "be", "remove", "in", "this", "commit", "LINK", "in", "favor", "of", "use", "ActiveModel", "Dirty", "methods", "NUMBER", "So", "it", "should", "be", "safe", "to", "remove", "it", "from", "the", "Carrierwave", "codebase", "Carrierwave", "will", "only", "work", "with", "mongoid", "NUMBER", "in", "that", "case", "NUMBER", "In", "fact", "I", "made", "the", "necessary", "change", "in", "my", "fork", "LINK", "and", "it", "seems", "to", "work", "well", "so", "far", "at", "least", "all", "the", "specs", "pass", "NUMBER", "That", "s", "great", "this", "separated", "gem", "will", "be", "useless", "for", "me", "since", "I", "don", "t", "actually", "use", "CarrierWave", "with", "Mongoid", "models", "I", "only", "have", "Mongoid", "models", "but", "without", "uploader", "but", "since", "Mongoid", "support", "be", "currently", "include", "into", "CarrierWave", "it", "made", "my", "specs", "break", "NUMBER", "With", "the", "Mongoid", "support", "extracted", "from", "CarrierWave", "I", "will", "not", "have", "to", "worry", "anymore", "about", "this", "That", "s", "good", "thanks", "I", "have", "just", "push", "pull", "request", "for", "carrierwave", "mongoid", "then", "we", "can", "cleanup", "mongoid", "from", "this", "gem", "NUMBER", "You", "could", "check", "it", "guys", "NUMBER", "When", "it", "will", "be", "merge", "it", "needs", "to", "bump", "version", "of", "these", "gems", "NUMBER", "Thanks", "NUMBER", "Merged", "the", "carrierwave", "mongoid", "pull", "request", "NUMBER", "So", "merge", "this", "one", "as", "well", "NUMBER", "I", "m", "looking", "back", "and", "see", "that", "I", "have", "extracted", "gridfs", "storage", "too", "but", "this", "storage", "can", "be", "useful", "in", "MongoMapper", "NUMBER", "Maybe", "MongoMapper", "support", "will", "be", "in", "a", "separate", "gem", "with", "his", "own", "gridfs", "storage", "or", "we", "can", "return", "gridfs", "to", "this", "repo", "NUMBER", "What", "be", "you", "think", "guys", "CarrierWave", "should", "support", "storing", "and", "retrieving", "large", "file", "without", "exhausting", "the", "available", "memory", "NUMBER", "Currently", "CarrierWave", "retrieves", "a", "file", "from", "remote", "storage", "by", "reading", "it", "wholesale", "into", "memory", "NUMBER", "This", "can", "quickly", "exhaust", "available", "memory", "especially", "if", "a", "deployment", "caps", "the", "memory", "available", "to", "any", "given", "Rails", "process", "e", "NUMBER", "g", "NUMBER", "four", "cores", "with", "four", "NUMBER", "MB", "processes", "one", "per", "core", "on", "a", "small", "server", "and", "multiple", "attached", "file", "in", "the", "tens", "to", "hundreds", "of", "MB", "NUMBER", "CarrierWave", "should", "offer", "an", "additional", "streaming", "API", "where", "it", "will", "retrieve", "the", "remote", "file", "in", "chunks", "of", "a", "certain", "size", "and", "immediately", "steam", "the", "bytes", "to", "disk", "possibly", "a", "Tempfile", "backed", "SanitizedFile", "NUMBER", "Only", "that", "amount", "of", "memory", "would", "be", "consumed", "at", "any", "time", "and", "no", "more", "NUMBER", "Likewise", "for", "writes", "CarrierWave", "should", "offer", "an", "additional", "streaming", "API", "for", "writes", "where", "it", "will", "write", "a", "remote", "file", "from", "a", "Tempfile", "backed", "SanitizedFile", "be", "chunks", "of", "a", "certain", "size", "NUMBER", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "reaming_chunk_size", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "MB", "end", "class", "MyModel", "include", "Mongoid", "Document", "or", "any", "other", "support", "mount_uploader", "attachment", "AttachmentUploader", "end", "my_tempfile", "MyModel", "NUMBER", "find", "NUMBER", "NUMBER", "attachment", "NUMBER", "ream_to_tempfile", "tempfile_open_args", "do_something_with", "my_tempfile", "MyModel", "NUMBER", "find", "NUMBER", "NUMBER", "attachment", "NUMBER", "ream_from_tempfile", "my_tempfile", "There", "already", "be", "a", "CarrierWave", "Uploader", "Cache", "module", "and", "the", "actual", "API", "for", "streaming", "reads", "writes", "from", "to", "remote", "file", "could", "simply", "be", "the", "Cache", "API", "with", "the", "Cache", "internals", "update", "for", "streaming", "reads", "writes", "NUMBER", "form", "remote", "true", "returns", "html", "instead", "of", "js", "this", "be", "true", "only", "when", "a", "file", "be", "uploaded", "when", "a", "link", "be", "provide", "it", "works", "NUMBER", "Any", "idea", "what", "be", "cause", "this", "would", "be", "nice", "if", "carrierwave", "provide", "once", "such", "workarounds", "out", "of", "the", "box", "NUMBER", "bensie", "I", "m", "totally", "stumped", "on", "this", "I", "have", "a", "regular", "remote", "true", "form", "with", "a", "CarrierWave", "file", "upload", "and", "it", "won", "t", "go", "to", "the", "javascript", "response", "just", "HTML", "NUMBER", "When", "I", "take", "out", "the", "format", "NUMBER", "html", "to", "try", "and", "force", "the", "js", "response", "I", "just", "get", "a", "blank", "screen", "and", "Completed", "NUMBER", "Not", "Acceptable", "in", "the", "log", "NUMBER", "What", "be", "the", "workarounds", "you", "speak", "of", "Thanks", "Are", "these", "alternatives", "to", "CarrierWave", "Or", "would", "I", "use", "them", "alongside", "it", "You", "would", "use", "them", "alongside", "it", "NUMBER", "AJAX", "be", "code", "on", "the", "client", "side", "NUMBER", "Carrierwave", "Rails", "be", "code", "on", "the", "server", "side", "NUMBER", "we", "switched", "from", "RMagick", "to", "ImageScience", "and", "all", "our", "specs", "that", "require", "processing", "fail", "due", "to", "miss", "the", "RMagick", "library", "NUMBER", "This", "be", "due", "to", "the", "default", "ImageLoader", "behavior", "in", "CarrierWave", "Test", "Matcher", "which", "defaults", "to", "RMagick", "unless", "MiniMagick", "be", "defined", "as", "it", "do", "not", "have", "a", "wrapper", "for", "ImageScience", "NUMBER", "I", "tried", "to", "write", "an", "ImageScience", "wrapper", "myself", "use", "class", "ScienceWrapper", "nodoc", "attr_reader", "image", "def", "width", "image", "NUMBER", "width", "end", "def", "height", "image", "NUMBER", "height", "end", "def", "initialize", "filename", "image", "ImageScience", "NUMBER", "with_image", "filename", "do", "img", "img", "end", "end", "end", "but", "I", "was", "unable", "to", "query", "the", "width", "and", "height", "get", "TypeError", "Bitmap", "has", "already", "be", "freed", "As", "a", "workaround", "we", "ve", "had", "to", "disable", "our", "specs", "that", "require", "processing", "NUMBER", "If", "anybody", "knows", "how", "to", "create", "an", "ImageScience", "wrapper", "that", "would", "be", "useful", "NUMBER", "potatosalad", "carrierwave", "NUMBER", "a", "NUMBER", "ef", "NUMBER", "e", "NUMBER", "e", "NUMBER", "d", "NUMBER", "af", "NUMBER", "e", "NUMBER", "b", "NUMBER", "contains", "the", "fix", "and", "specs", "that", "test", "the", "problem", "below", "be", "an", "example", "that", "causes", "the", "exception", "ruby", "class", "ExampleUploader", "TAG", "NUMBER", "NUMBER", "end", "end", "class", "LevelOne", "end", "class", "LevelTwo", "end", "class", "LevelThree", "end", "class", "LevelFour", "end", "class", "LevelOne", "include", "Mongoid", "Document", "embeds_one", "level_two", "end", "class", "LevelTwo", "include", "Mongoid", "Document", "embedded_in", "level_one", "embeds_many", "level_threes", "end", "class", "LevelThree", "include", "Mongoid", "Document", "embedded_in", "level_two", "embeds_many", "level_fours", "end", "class", "LevelFour", "include", "Mongoid", "Document", "embedded_in", "level_three", "mount_uploader", "image", "ExampleUploader", "end", "level_one", "LevelOne", "NUMBER", "new", "level_two", "LevelTwo", "NUMBER", "new", "level_one", "NUMBER", "level_two", "level_two", "level_three", "level_two", "NUMBER", "level_threes", "NUMBER", "build", "level_four", "level_three", "NUMBER", "level_fours", "NUMBER", "build", "level_four", "NUMBER", "image", "open", "LINK", "_of_july", "NUMBER", "hp", "NUMBER", "jpg", "level_four", "NUMBER", "save", "level_one", "LevelOne", "NUMBER", "last", "level_two", "level_one", "NUMBER", "level_two", "level_three", "level_two", "NUMBER", "level_threes", "NUMBER", "last", "level_four", "level_three", "NUMBER", "level_fours", "NUMBER", "last", "level_four", "NUMBER", "image", "open", "LINK", "hp", "NUMBER", "jpg", "level_four", "NUMBER", "save", "raises", "Mongoid", "Errors", "InvalidCollection", "Access", "to", "the", "collection", "for", "LevelThree", "be", "not", "allow", "since", "it", "be", "an", "embedded", "document", "please", "access", "a", "collection", "from", "the", "root", "document", "NUMBER", "TAG", "This", "should", "help", "with", "situations", "where", "a", "file", "has", "multiple", "version", "and", "at", "least", "one", "of", "the", "version", "be", "of", "a", "different", "format", "than", "the", "master", "version", "NUMBER", "This", "scenario", "be", "documented", "in", "issue", "NUMBER", "as", "well", "as", "in", "issue", "NUMBER", "and", "possibly", "others", "NUMBER", "Simply", "pass", "rename", "true", "to", "the", "exist", "convert", "helper", "method", "and", "the", "file", "will", "be", "renamed", "as", "well", "as", "converted", "NUMBER", "Existing", "functionality", "be", "preserved", "i", "NUMBER", "e", "NUMBER", "the", "default", "be", "to", "not", "rename", "the", "image", "NUMBER", "When", "use", "Fog", "as", "the", "storage", "provider", "you", "can", "utilize", "process", "set_content_type", "to", "detect", "the", "new", "MIME", "type", "and", "have", "that", "relayed", "to", "the", "cloud", "storage", "provider", "NUMBER", "FYI", "without", "this", "patch", "if", "you", "were", "to", "call", "any", "processing", "commands", "_after_", "a", "convert", "call", "the", "file", "would", "be", "converted", "back", "to", "it", "s", "original", "format", "NUMBER", "For", "example", "assume", "we", "be", "work", "on", "a", "pretty_flower", "NUMBER", "jpg", "image", "process", "convert", "png", "after", "convert", "file", "retains", "NUMBER", "jpg", "extension", "process", "resize_to_fit", "NUMBER", "NUMBER", "rmagick", "converts", "back", "to", "a", "JPG", "when", "it", "writes", "out", "the", "file", "due", "to", "NUMBER", "jpg", "extension", "There", "be", "of", "course", "other", "ways", "to", "work", "around", "this", "limitation", "such", "as", "write", "a", "custom", "processor", "that", "just", "renames", "the", "file", "but", "was", "curious", "as", "to", "anyone", "else", "s", "thoughts", "NUMBER", "Yes", "I", "will", "make", "the", "mention", "change", "NUMBER", "This", "commit", "certainly", "isn", "t", "necessary", "although", "I", "find", "it", "interesting", "that", "the", "uploader", "file", "documented", "ImageScience", "and", "RMagick", "but", "not", "MiniMagick", "NUMBER", "It", "took", "me", "a", "long", "time", "before", "I", "realized", "it", "support", "MiniMagick", "NUMBER", "The", "point", "of", "this", "commit", "be", "just", "for", "slightly", "more", "consistent", "docs", "couldn", "t", "hurt", "right", "This", "seems", "to", "me", "to", "be", "a", "fundamentally", "broken", "feature", "NUMBER", "Unless", "I", "m", "completely", "miss", "the", "boat", "on", "this", "ruby", "user", "NUMBER", "avatar", "File", "NUMBER", "open", "image", "NUMBER", "png", "user", "NUMBER", "save", "user", "NUMBER", "avatar", "NUMBER", "file", "TAG", "user", "NUMBER", "attributes", "avatar", "image", "NUMBER", "png", "user", "NUMBER", "remove_avatar", "user", "NUMBER", "reload", "user", "NUMBER", "avatar", "NUMBER", "file", "TAG", "TAG", "false", "user", "NUMBER", "attributes", "avatar", "image", "NUMBER", "png", "TAG", "nil", "user", "NUMBER", "save", "user", "NUMBER", "read_attribute", "avatar", "image", "NUMBER", "png", "TAG", "true", "bcardarella", "I", "ve", "also", "be", "unable", "to", "reproduce", "this", "issue", "NUMBER", "If", "you", "provide", "a", "sample", "app", "or", "a", "fail", "test", "as", "Trevor", "request", "we", "can", "hopefully", "figure", "out", "what", "s", "happening", "NUMBER", "Hi", "I", "be", "having", "the", "same", "issue", "and", "add", "a", "fail", "spec", "LINK", "I", "notice", "that", "ruby", "event", "NUMBER", "remove_image", "true", "event", "NUMBER", "save", "works", "as", "expected", "and", "sets", "the", "value", "of", "the", "image", "column", "to", "the", "empty", "string", "NUMBER", "crhym", "NUMBER", "this", "be", "a", "close", "issue", "and", "you", "provide", "no", "additional", "information", "so", "NUMBER", "If", "you", "re", "having", "a", "problem", "you", "think", "might", "be", "relate", "to", "this", "please", "open", "a", "new", "issue", "provide", "as", "much", "detail", "as", "possible", "see", "the", "get", "help", "section", "in", "the", "wiki", "and", "reference", "this", "issue", "if", "you", "think", "that", "might", "help", "NUMBER", "yeah", "never", "mind", "NUMBER", "I", "just", "don", "t", "have", "time", "for", "this", "right", "now", "sorry", "NUMBER", "metal", "I", "m", "not", "holding", "my", "breathe", "on", "the", "team", "addressing", "this", "NUMBER", "I", "provide", "a", "pretty", "detailed", "bug", "report", "yes", "no", "fail", "test", "case", "and", "it", "was", "close", "as", "can", "t", "reproduce", "without", "even", "ask", "to", "start", "a", "conversation", "NUMBER", "Multiple", "users", "have", "chimed", "in", "and", "noted", "they", "be", "having", "the", "exact", "same", "problem", "at", "the", "very", "least", "this", "issue", "should", "be", "re", "opened", "rather", "than", "cast", "aside", "NUMBER", "Didn", "t", "you", "guys", "close", "the", "issue", "on", "the", "same", "day", "you", "declared", "you", "couldn", "t", "recreate", "it", "Aug", "NUMBER", "I", "was", "asked", "on", "July", "NUMBER", "to", "write", "a", "fail", "test", "case", "NUMBER", "So", "we", "re", "talking", "about", "NUMBER", "days", "or", "so", "NUMBER", "If", "that", "be", "forever", "that", "s", "fine", "NUMBER", "You", "guys", "also", "close", "the", "issue", "only", "NUMBER", "days", "after", "a", "NUMBER", "person", "confirmed", "the", "bug", "NUMBER", "But", "it", "s", "your", "project", "run", "it", "how", "you", "see", "fit", "NUMBER", "How", "s", "about", "I", "reopen", "this", "issue", "for", "a", "while", "and", "let", "s", "see", "if", "anyone", "steps", "up", "to", "help", "out", "NUMBER", "Obviously", "bensie", "and", "I", "weren", "t", "able", "to", "figure", "out", "what", "s", "wrong", "so", "here", "s", "hoping", "someone", "else", "can", "LINK", "failure", "rspec", "spec", "carrierwave_spec", "NUMBER", "rb", "I", "copied", "the", "code", "as", "I", "exactly", "entered", "in", "originally", "so", "I", "m", "not", "sure", "what", "it", "be", "you", "guys", "did", "differently", "NUMBER", "I", "confirm", "this", "misbehavior", "too", "use", "ActiveRecord", "NUMBER", "From", "the", "README", "LINK", "Removing_uploaded_files", "If", "you", "want", "to", "remove", "the", "file", "manually", "you", "can", "call", "remove_avatar", "Which", "of", "course", "be", "not", "wrong", "in", "itself", "but", "since", "it", "_is_", "expose", "to", "the", "ORM", "as", "a", "dynamic", "method", "one", "should", "expect", "that", "it", "would", "trigger", "the", "callbacks", "to", "clear", "the", "database", "column", "to", "reflect", "the", "new", "state", "which", "be", "emulated", "by", "manually", "doing", "what", "larskuhnt", "said", "obj", "NUMBER", "remove_image", "true", "obj", "NUMBER", "save", "NUMBER", "So", "I", "think", "the", "problem", "be", "the", "semantic", "of", "the", "API", "that", "be", "expose", "to", "the", "ORM", "NUMBER", "Since", "the", "user", "be", "dealing", "at", "the", "ORM", "level", "s", "he", "will", "expect", "the", "change", "to", "be", "reflected", "in", "the", "database", "too", "obj", "NUMBER", "remove_image", "should", "also", "perform", "obj", "NUMBER", "update_attribute", "image", "nil", "NUMBER", "Or", "be", "I", "wrong", "Just", "throw", "my", "NUMBER", "cents", "in", "here", "from", "an", "architecture", "standpoint", "NUMBER", "I", "believe", "the", "principal", "of", "least", "surprise", "be", "violated", "when", "doing", "this", "my_obj", "NUMBER", "update_attribute", "my_uploader", "nil", "executes", "this", "SQL", "UPDATE", "my_objs", "SET", "my_uploader", "the_current_file", "NUMBER", "jpg", "updated_at", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "WHERE", "my_objs", "NUMBER", "id", "NUMBER", "I", "have", "only", "just", "start", "to", "look", "into", "this", "project", "but", "here", "be", "my", "thoughts", "NUMBER", "bensie", "I", "would", "like", "to", "help", "but", "could", "you", "provide", "a", "bit", "more", "detail", "about", "how", "this", "should", "be", "fix", "Here", "be", "my", "understanding", "so", "far", "I", "m", "not", "sure", "if", "there", "be", "anything", "wrong", "with", "the", "code", "as", "such", "but", "the", "semantics", "may", "be", "confusing", "NUMBER", "There", "be", "two", "ways", "to", "remove", "the", "avatar", "in", "bcardarella", "s", "example", "a", "user", "NUMBER", "remove_avatar", "true", "user", "NUMBER", "save", "b", "user", "NUMBER", "remove_avatar", "Method", "a", "works", "as", "expected", "the", "file", "be", "delete", "and", "the", "column", "be", "cleared", "NUMBER", "In", "method", "b", "the", "file", "be", "remove", "but", "the", "column", "be", "not", "modify", "NUMBER", "So", "I", "guess", "the", "question", "be", "_Should_", "the", "column", "be", "cleared", "when", "calling", "remove_avatar", "The", "readme", "says", "If", "you", "want", "to", "remove", "the", "file", "manually", "you", "can", "call", "remove_avatar", "NUMBER", "And", "the", "rdoc", "says", "Removes", "the", "uploaded", "file", "from", "the", "filesystem", "NUMBER", "So", "the", "documentation", "makes", "no", "promise", "about", "the", "column", "be", "cleared", "NUMBER", "As", "I", "said", "I", "m", "just", "get", "start", "here", "so", "I", "may", "be", "miss", "something", "NUMBER", "I", "would", "like", "to", "get", "involved", "in", "the", "project", "so", "I", "would", "appreciate", "a", "bit", "of", "guidance", "NUMBER", "Thanks", "It", "seems", "reasonable", "to", "clear", "the", "column", "to", "me", "NUMBER", "The", "column", "be", "just", "an", "identifier", "for", "the", "uploaded", "file", "so", "if", "the", "file", "be", "gone", "it", "should", "be", "empty", "I", "d", "say", "NUMBER", "That", "s", "my", "feeling", "too", "NUMBER", "Patrick", "Paul", "Hus", "Sent", "with", "Sparrow", "LINK", "On", "Monday", "NUMBER", "April", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "Trevor", "Turk", "write", "It", "seems", "reasonable", "to", "clear", "the", "column", "to", "me", "NUMBER", "The", "column", "be", "just", "an", "identifier", "for", "the", "uploaded", "file", "so", "if", "the", "file", "be", "gone", "it", "should", "be", "empty", "I", "d", "say", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Sounds", "reasonable", "NUMBER", "But", "I", "guess", "we", "don", "t", "want", "to", "save", "the", "entire", "record", "just", "do", "an", "update_attribute", "in", "the", "case", "of", "AR", "NUMBER", "Right", "I", "m", "not", "sure", "if", "there", "s", "a", "ORM", "agnostic", "way", "of", "doing", "this", "but", "I", "ll", "look", "more", "into", "that", "NUMBER", "Yeah", "I", "think", "that", "s", "right", "NUMBER", "Please", "work", "up", "a", "pull", "request", "and", "we", "ll", "take", "a", "look", "NUMBER", "Added", "LINK", "Future", "Mongoid", "fix", "It", "be", "compatible", "with", "mongoid", "master", "where", "activemodel", "dirty", "track", "was", "include", "hmmm", "NUMBER", "do", "all", "the", "specs", "pass", "Actually", "if", "I", "did", "it", "like", "this", "it", "was", "because", "there", "was", "a", "problem", "with", "the", "colum", "_will_change", "method", "NUMBER", "Unfortunately", "I", "m", "unable", "to", "remember", "it", "NUMBER", "Yep", "all", "pass", "but", "only", "with", "mongoid", "cutting", "edge", "NUMBER", "It", "be", "not", "an", "actual", "patch", "just", "now", "it", "be", "for", "future", "mongoid", "release", "NUMBER", "Just", "look", "LINK", "The", "be", "no", "more", "setup_modifications", "method", "NUMBER", "Following", "RailsCast", "guide", "on", "carrierwave", "NUMBER", "I", "m", "trying", "to", "set", "up", "an", "image", "upload", "for", "my", "basic", "user", "model", "NUMBER", "I", "repeated", "the", "RailsCasts", "steps", "multiple", "times", "only", "to", "get", "uninitialized", "constant", "User", "ImageUploader", "in", "my", "users", "controller", "NUMBER", "With", "the", "bundle", "install", "setting", "up", "app", "uploaders", "image_uploader", "NUMBER", "rb", "correctly", "and", "the", "db", "migrate", "for", "an", "image", "column", "in", "the", "User", "model", "why", "would", "the", "controller", "not", "know", "ImageUploader", "RailsCasts", "never", "mentions", "any", "other", "steps", "in", "defining", "or", "setting", "up", "interface", "with", "Carrierwave", "NUMBER", "Mysterious", "NUMBER", "Are", "you", "sure", "you", "have", "CarrierWace", "in", "your", "Gemfile", "Perhaps", "the", "app", "uploaders", "directory", "isn", "t", "be", "required", "You", "could", "try", "this", "in", "config", "NUMBER", "environment", "NUMBER", "rb", "config", "NUMBER", "load_paths", "TAG", "can", "t", "convert", "String", "into", "Array", "TypeError", "from", "home", "bryanrogers", "Desktop", "digitalAugment", "da", "bv", "rails", "config", "application", "NUMBER", "rb", "NUMBER", "in", "module", "Bv", "from", "home", "bryanrogers", "Desktop", "digitalAugment", "da", "bv", "rails", "config", "application", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "require", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "tap", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "did", "you", "set", "the", "image", "as", "a", "string", "on", "your", "db", "migrate", "Here", "be", "the", "migration", "file", "class", "AddImageToGames", "TAG", "NUMBER", "actionpack", "NUMBER", "activemodel", "NUMBER", "activesupport", "NUMBER", "builder", "NUMBER", "erubis", "NUMBER", "i", "NUMBER", "n", "NUMBER", "rack", "NUMBER", "rack", "mount", "NUMBER", "rack", "test", "NUMBER", "tzinfo", "NUMBER", "activemodel", "NUMBER", "activesupport", "NUMBER", "builder", "NUMBER", "i", "NUMBER", "n", "NUMBER", "activerecord", "NUMBER", "activemodel", "NUMBER", "activesupport", "NUMBER", "arel", "NUMBER", "tzinfo", "NUMBER", "activeresource", "NUMBER", "activemodel", "NUMBER", "activesupport", "NUMBER", "activesupport", "NUMBER", "arel", "NUMBER", "builder", "NUMBER", "carrierwave", "NUMBER", "activesupport", "NUMBER", "configuration", "NUMBER", "erubis", "NUMBER", "abstract", "NUMBER", "excon", "NUMBER", "fog", "NUMBER", "builder", "excon", "NUMBER", "formatador", "NUMBER", "json", "mime", "types", "net", "scp", "NUMBER", "net", "ssh", "NUMBER", "nokogiri", "NUMBER", "ruby", "hmac", "formatador", "NUMBER", "haml", "NUMBER", "haml", "rails", "NUMBER", "actionpack", "NUMBER", "activesupport", "NUMBER", "haml", "NUMBER", "railties", "NUMBER", "heroku", "NUMBER", "launchy", "NUMBER", "rest", "client", "NUMBER", "term", "ansicolor", "NUMBER", "i", "NUMBER", "n", "NUMBER", "json", "NUMBER", "launchy", "NUMBER", "configuration", "NUMBER", "rake", "NUMBER", "mail", "NUMBER", "activesupport", "NUMBER", "i", "NUMBER", "n", "NUMBER", "mime", "types", "NUMBER", "treetop", "NUMBER", "mime", "types", "NUMBER", "mini_magick", "NUMBER", "subexec", "NUMBER", "net", "scp", "NUMBER", "net", "ssh", "NUMBER", "net", "ssh", "NUMBER", "newrelic_rpm", "NUMBER", "nokogiri", "NUMBER", "polyglot", "NUMBER", "rack", "NUMBER", "rack", "mount", "NUMBER", "rack", "NUMBER", "rack", "test", "NUMBER", "rack", "NUMBER", "rails", "NUMBER", "actionmailer", "NUMBER", "actionpack", "NUMBER", "activerecord", "NUMBER", "activeresource", "NUMBER", "activesupport", "NUMBER", "bundler", "NUMBER", "railties", "NUMBER", "railties", "NUMBER", "actionpack", "NUMBER", "activesupport", "NUMBER", "rake", "NUMBER", "rdoc", "NUMBER", "thor", "NUMBER", "rake", "NUMBER", "rdoc", "NUMBER", "rest", "client", "NUMBER", "mime", "types", "NUMBER", "ruby", "hmac", "NUMBER", "sass", "NUMBER", "sqlite", "NUMBER", "NUMBER", "squeel", "NUMBER", "activerecord", "NUMBER", "activesupport", "NUMBER", "subexec", "NUMBER", "term", "ansicolor", "NUMBER", "thor", "NUMBER", "tiny_mce", "NUMBER", "treetop", "NUMBER", "polyglot", "NUMBER", "tzinfo", "NUMBER", "PLATFORMS", "ruby", "DEPENDENCIES", "carrierwave", "fog", "haml", "haml", "rails", "heroku", "mini_magick", "newrelic_rpm", "rails", "sass", "sqlite", "NUMBER", "squeel", "tiny_mce", "bryanrogers", "perhaps", "you", "should", "try", "uploading", "a", "sample", "app", "to", "github", "as", "well", "NUMBER", "I", "cannot", "reproduce", "the", "error", "on", "a", "new", "app", "and", "the", "app", "I", "be", "work", "on", "be", "close", "source", "NUMBER", "I", "can", "get", "you", "access", "via", "iChat", "or", "something", "of", "the", "like", "to", "my", "computer", "if", "that", "be", "an", "option", "for", "you", "NUMBER", "Thanks", "NUMBER", "I", "m", "going", "to", "be", "out", "for", "a", "few", "hours", "but", "let", "me", "know", "if", "you", "see", "something", "in", "trbartel", "s", "app", "or", "if", "you", "want", "to", "schedule", "a", "time", "to", "get", "into", "my", "machine", "NUMBER", "Thanks", "again", "for", "the", "help", "I", "really", "appreciate", "it", "NUMBER", "OK", "thanks", "for", "looking", "bensie", "bensie", "would", "you", "be", "willing", "to", "do", "a", "remote", "session", "with", "my", "computer", "see", "if", "you", "can", "identify", "what", "be", "going", "on", "with", "my", "code", "It", "would", "be", "very", "much", "appreciated", "NUMBER", "Hey", "bensie", "with", "this", "commit", "LINK", "I", "think", "you", "re", "introduce", "a", "dependency", "on", "ActiveSupport", "Deprecation", "NUMBER", "I", "notice", "this", "while", "build", "this", "LINK", "carrierwave", "fog", "commit", "NUMBER", "a", "NUMBER", "a", "NUMBER", "e", "NUMBER", "dc", "NUMBER", "a", "NUMBER", "b", "NUMBER", "a", "NUMBER", "a", "NUMBER", "e", "NUMBER", "f", "NUMBER", "c", "NUMBER", "c", "NUMBER", "d", "NUMBER", "c", "NUMBER", "example", "app", "for", "an", "Engine", "Yard", "how", "to", "use", "CW", "with", "Fog", "post", "NUMBER", "I", "m", "able", "to", "work", "around", "it", "and", "I", "ve", "put", "a", "potential", "fix", "into", "CW", "already", "but", "I", "m", "wondering", "if", "you", "think", "there", "s", "a", "better", "way", "to", "accomplish", "what", "you", "re", "doing", "NUMBER", "Perhaps", "we", "don", "t", "need", "to", "silence", "I", "dunno", "NUMBER", "Lemme", "know", "what", "you", "think", "NUMBER", "I", "think", "that", "s", "good", "enough", "I", "just", "wanted", "to", "check", "in", "with", "you", "since", "I", "add", "that", "require", "NUMBER", "Thank", "you", "I", "m", "get", "failures", "like", "LINK", "when", "run", "the", "remote", "test", "as", "per", "the", "instructions", "at", "the", "bottom", "of", "the", "readme", "can", "someone", "else", "run", "and", "confirm", "if", "this", "be", "just", "a", "problem", "for", "me", "Damn", "NUMBER", "Hey", "geemus", "did", "you", "change", "something", "you", "can", "think", "might", "have", "impacted", "this", "trevorturk", "nothing", "off", "the", "top", "of", "my", "head", "I", "ll", "give", "it", "a", "shot", "on", "my", "end", "and", "see", "what", "I", "come", "up", "with", "NUMBER", "trevorturk", "that", "appears", "to", "fix", "it", "but", "its", "one", "of", "those", "things", "where", "looking", "at", "it", "I", "m", "not", "sure", "how", "it", "ever", "worked", "without", "that", "diff", "so", "I", "couldn", "t", "exactly", "put", "my", "finger", "on", "what", "introduce", "the", "issue", "NUMBER", "Anyway", "should", "be", "good", "to", "go", "again", "for", "now", "NUMBER", "Sweet", "NUMBER", "Thanks", "for", "looking", "at", "that", "When", "encountering", "a", "blank", "uploader", "carrierwave", "can", "halt", "other", "operations", "from", "finishing", "NUMBER", "I", "encountered", "this", "issue", "while", "use", "state_machine", "and", "carrierwave", "together", "rails", "NUMBER", "ruby", "NUMBER", "mongoid", "NUMBER", "NUMBER", "Unfortunately", "I", "was", "not", "able", "to", "reproduce", "the", "issue", "in", "carrierwave", "s", "specs", "NUMBER", "When", "use", "normal", "callback", "definitions", "the", "nil", "returned", "by", "store", "did", "not", "halt", "the", "chain", "or", "else", "I", "could", "not", "get", "the", "callback", "ordering", "correct", "so", "that", "the", "store", "method", "fired", "first", "NUMBER", "Any", "thoughts", "on", "how", "that", "callback", "could", "be", "actually", "test", "would", "be", "great", "otherwise", "explicitly", "returning", "true", "for", "the", "result", "of", "that", "operation", "do", "not", "seem", "out", "of", "line", "and", "all", "the", "current", "specs", "pass", "with", "the", "change", "NUMBER", "Thanks", "Dave", "I", "think", "this", "might", "be", "cause", "my", "validations", "to", "silently", "fail", "NUMBER", "Is", "there", "any", "way", "to", "trace", "the", "callback", "chain", "to", "track", "down", "where", "things", "be", "halting", "avishai", "be", "you", "saying", "you", "ve", "test", "this", "change", "and", "had", "problem", "hey", "i", "m", "use", "the", "latest", "release", "and", "i", "m", "having", "problem", "with", "this", "NUMBER", "im", "not", "sure", "that", "it", "has", "to", "do", "with", "carrierwave", "but", "the", "issue", "seems", "to", "have", "popped", "up", "since", "switching", "to", "carrierwave", "NUMBER", "avishai", "On", "Tue", "Jul", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "PM", "trevorturk", "TAG", "write", "avishai", "be", "you", "saying", "you", "ve", "test", "this", "change", "and", "had", "problem", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "Can", "you", "please", "try", "to", "be", "more", "clear", "I", "m", "not", "sure", "what", "you", "re", "talking", "about", "NUMBER", "Do", "you", "have", "a", "problem", "with", "this", "pull", "request", "or", "be", "you", "just", "having", "problem", "with", "CarrierWave", "in", "general", "Hey", "Unfortunately", "I", "think", "I", "didn", "t", "fully", "understand", "what", "was", "going", "on", "before", "open", "that", "issue", "NUMBER", "Sorry", "about", "that", "NUMBER", "Avishai", "On", "Wed", "Jul", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "bensie", "TAG", "write", "I", "m", "having", "trouble", "understanding", "what", "this", "fix", "NUMBER", "You", "said", "When", "use", "normal", "callback", "definitions", "the", "nil", "returned", "by", "store", "did", "not", "halt", "the", "chain", "Under", "what", "circumstance", "did", "it", "halt", "the", "chain", "Can", "you", "provide", "some", "sample", "code", "from", "your", "application", "to", "help", "me", "understand", "the", "use", "case", "Returning", "true", "from", "that", "method", "if", "the", "uploader", "be", "blank", "seems", "counter", "intuitive", "to", "me", "and", "without", "any", "comments", "or", "test", "the", "intent", "be", "unclear", "but", "maybe", "further", "explanation", "can", "clear", "this", "up", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "The", "normal", "statement", "was", "just", "when", "test", "against", "some", "additional", "simple", "callbacks", "that", "I", "was", "defining", "in", "the", "test", "but", "was", "able", "to", "consistently", "demonstrate", "the", "issue", "when", "run", "against", "a", "model", "use", "state_machine", "defined", "transitional", "callbacks", "with", "a", "mongoid", "document", "NUMBER", "Somewhere", "something", "be", "most", "likely", "incorrectly", "interpreting", "the", "nil", "returned", "when", "there", "be", "a", "blank", "uploader", "as", "something", "fail", "halt", "the", "callback", "chain", "NUMBER", "This", "was", "only", "intended", "to", "remove", "any", "vagueness", "of", "the", "result", "of", "this", "callback", "when", "there", "be", "a", "blank", "uploader", "just", "returning", "a", "successful", "true", "from", "the", "operation", "if", "there", "be", "nothing", "for", "it", "to", "act", "on", "NUMBER", "Yeah", "will", "be", "probably", "week", "and", "a", "half", "NUMBER", "Underneath", "a", "big", "project", "launch", "right", "now", "NUMBER", "I", "should", "be", "able", "to", "re", "test", "then", "and", "try", "to", "pull", "together", "a", "sample", "app", "and", "update", "this", "ticket", "NUMBER", "anyone", "else", "get", "be", "error", "when", "saving", "mongoid", "document", "with", "mounted", "uploader", "I", "just", "pull", "fresh", "master", "and", "start", "seeing", "this", "NUMBER", "undefined", "local", "variable", "or", "method", "setup_modifications", "I", "have", "an", "uploader", "for", "binary", "file", "therefore", "no", "image", "processing", "be", "defined", "NUMBER", "I", "m", "use", "rails", "NUMBER", "NUMBER", "stable", "mongoid", "master", "carrierwave", "master", "I", "have", "the", "same", "issue", "with", "rails", "NUMBER", "mongoid", "master", "and", "carrierwave", "NUMBER", "Reverting", "to", "carrierwave", "NUMBER", "fix", "the", "issue", "for", "me", "NUMBER", "I", "did", "some", "digging", "late", "lastnight", "looks", "like", "its", "relate", "to", "the", "dirty", "track", "monogoid", "master", "now", "implement", "the", "ActiveModel", "Dirty", "vs", "its", "previous", "methods", "setup_modification", "and", "modifications", "NUMBER", "Haven", "t", "had", "time", "to", "figure", "out", "what", "needs", "update", "yet", "to", "get", "this", "all", "work", "again", "NUMBER", "BTW", "we", "should", "consider", "fix", "this", "in", "the", "carrierwave", "mongoid", "gem", "if", "when", "we", "figure", "it", "out", "NUMBER", "Could", "someone", "explain", "to", "me", "why", "here", "LINK", "L", "NUMBER", "we", "be", "overwriting", "deafult", "mount_on", "option", "and", "saving", "into", "_filename", "NUMBER", "If", "we", "can", "back", "to", "default", "as", "it", "in", "AR", "than", "we", "can", "remove", "all", "hacks", "arround", "dirty", "attributes", "and", "it", "will", "work", "out", "of", "the", "box", "NUMBER", "Thanks", "Whenever", "mongoid", "support", "was", "add", "this", "was", "set", "as", "the", "default", "NUMBER", "You", "can", "see", "here", "LINK", "That", "seems", "like", "a", "mistake", "to", "me", "but", "here", "we", "be", "NUMBER", "Jonas", "an", "I", "discussed", "and", "didn", "t", "want", "to", "break", "backwards", "compatibility", "NUMBER", "If", "we", "extract", "mongoid", "support", "into", "a", "separate", "gem", "them", "maybe", "it", "s", "less", "of", "an", "issue", "people", "can", "upgrade", "carrierwave", "without", "upgrading", "carrierwave", "mongoid", "but", "I", "m", "not", "sure", "NUMBER", "Any", "ideas", "given", "that", "we", "d", "like", "to", "not", "break", "backwards", "compatibility", "For", "backwards", "compatibility", "folks", "may", "add", "mount_on", "image_filename", "but", "they", "won", "t", "have", "dirty", "attributes", "methods", "for", "image", "otherwise", "for", "image_filename", "as", "we", "have", "at", "the", "moment", "NUMBER", "I", "suppose", "we", "shouldn", "t", "move", "away", "of", "consistency", "with", "AR", "NUMBER", "Sorry", "I", "m", "not", "clear", "on", "what", "you", "re", "suggesting", "NUMBER", "Sorry", "for", "my", "poor", "English", "NUMBER", "I", "suggest", "to", "fix", "mount_on", "to", "default", "uploader", "name", "ex", "NUMBER", "pic", "image", "etc", "NUMBER", "and", "remove", "all", "that", "concerns", "with", "dirty", "attributes", "let", "mongoid", "worry", "about", "it", "NUMBER", "People", "who", "have", "already", "had", "old", "version", "of", "gem", "will", "be", "prompted", "about", "new", "behavior", "and", "they", "can", "change", "the", "field", "name", "NUMBER", "I", "think", "it", "s", "more", "simpler", "than", "other", "ways", "NUMBER", "Yeah", "I", "m", "not", "sure", "we", "should", "change", "backwards", "compatibility", "NUMBER", "Maybe", "others", "use", "Mongoid", "can", "decide", "I", "m", "not", "use", "it", "and", "perhaps", "it", "s", "not", "a", "big", "deal", "if", "it", "s", "do", "in", "the", "other", "new", "gem", "NUMBER", "I", "would", "have", "no", "problem", "with", "skyeagle", "s", "suggestion", "or", "a", "new", "gem", "NUMBER", "Well", "I", "m", "happy", "to", "discuss", "here", "or", "the", "Google", "Group", "but", "I", "d", "like", "to", "suggest", "we", "make", "change", "in", "the", "new", "gem", "because", "Mongoid", "support", "in", "this", "particular", "repo", "be", "going", "away", "soon", "NUMBER", "See", "LINK", "BTW", "this", "be", "not", "a", "slight", "about", "Mongoid", "support", "there", "be", "good", "reasons", "all", "around", "for", "separating", "this", "into", "a", "new", "gem", "as", "we", "did", "with", "Sequel", "and", "Datamapper", "NUMBER", "Please", "followup", "about", "this", "issue", "in", "the", "new", "carrierwave", "mongoid", "gem", "repo", "LINK", "mongoid", "We", "re", "going", "to", "remove", "mongoid", "support", "from", "this", "repo", "shortly", "NUMBER", "trevorturk", "Are", "users", "of", "Mongoid", "supposed", "to", "use", "carrierwave", "mongoid", "LINK", "mongoid", "I", "ask", "because", "carrierwave", "mongoid", "hasn", "t", "be", "update", "since", "May", "NUMBER", "NUMBER", "and", "CarrierWave", "still", "contains", "support", "for", "Mongoid", "NUMBER", "I", "m", "not", "sure", "sorry", "NUMBER", "I", "m", "hoping", "that", "gucki", "and", "jnicklas", "will", "sort", "things", "out", "NUMBER", "For", "now", "bensie", "has", "be", "merge", "things", "into", "this", "repo", "since", "we", "re", "waiting", "to", "get", "clarification", "about", "the", "new", "carrierwave", "mongoid", "repo", "and", "if", "we", "re", "keep", "it", "around", "get", "the", "newer", "stuff", "from", "this", "repo", "over", "there", "too", "NUMBER", "Thanks", "for", "the", "quick", "response", "Trevor", "NUMBER", "I", "ve", "get", "CarrierWave", "NUMBER", "work", "with", "Mongoid", "and", "without", "carrierwave", "mongoid", "NUMBER", "I", "ll", "keep", "my", "eye", "on", "carrierwave", "mongoid", "though", "Users", "have", "to", "use", "this", "gem", "till", "new", "version", "of", "mongoid", "not", "be", "release", "NUMBER", "It", "works", "with", "the", "latest", "mongoid", "stable", "release", "NUMBER", "I", "suppose", "there", "be", "the", "goal", "to", "make", "separated", "gem", "works", "with", "cutting", "edge", "of", "mongoid", "NUMBER", "But", "it", "s", "very", "unstable", "at", "the", "moment", "and", "we", "should", "not", "move", "forward", "so", "fast", "NUMBER", "Give", "me", "a", "few", "days", "guys", "and", "i", "will", "fix", "the", "separated", "gem", "for", "the", "edge", "mongoid", "NUMBER", "skyeagle", "Yeah", "Mongoid", "s", "change", "pretty", "quickly", "these", "days", "and", "I", "don", "t", "expect", "other", "gems", "to", "keep", "up", "with", "Mongoid", "HEAD", "NUMBER", "So", "I", "should", "use", "the", "latest", "version", "of", "CarrierWave", "and", "carrierwave", "mongoid", "rather", "than", "just", "CarrierWave", "NUMBER", "nickhoffman", "I", "don", "t", "know", "the", "state", "of", "the", "carrierwave", "mongoid", "gem", "at", "this", "moment", "NUMBER", "The", "carrierwave", "alone", "works", "with", "latest", "stable", "mongoid", "in", "my", "case", "it", "s", "the", "NUMBER", "version", "and", "edge", "for", "carrierwave", "NUMBER", "skyeagle", "Thanks", "for", "the", "info", "NUMBER", "Since", "I", "m", "use", "Mongoid", "HEAD", "I", "m", "going", "to", "stick", "with", "CarrierWave", "NUMBER", "NUMBER", "When", "Mongoid", "NUMBER", "be", "release", "and", "carrierwave", "mongoid", "be", "update", "to", "work", "with", "it", "I", "ll", "look", "into", "upgrading", "to", "the", "latest", "stable", "version", "of", "CarrierWave", "NUMBER", "Well", "I", "can", "confirm", "that", "CarrierWave", "NUMBER", "and", "Mongoid", "NUMBER", "be", "not", "work", "together", "switching", "back", "to", "carrier", "waver", "NUMBER", "too", "I", "m", "giving", "carrierwave", "mongoid", "a", "spin", "with", "skyeagle", "s", "latest", "master", "following", "the", "pull", "request", "thread", "LINK", "mongoid", "pull", "NUMBER", "and", "my", "test", "be", "passing", "and", "things", "be", "initially", "looking", "good", "NUMBER", "All", "that", "was", "needed", "was", "the", "specification", "of", "mount_on", "image_filename", "as", "noted", "above", "for", "backwards", "compatibility", "NUMBER", "trevorturk", "as", "a", "Mongoid", "user", "my", "opinion", "personally", "be", "to", "standardize", "going", "forward", "it", "s", "a", "small", "matter", "to", "add", "this", "option", "when", "update", "and", "ought", "to", "be", "caught", "in", "test", "if", "people", "fail", "to", "heed", "release", "note", "NUMBER", "Also", "I", "m", "not", "familiar", "with", "what", "Carrierwave", "be", "doing", "with", "dirty", "track", "but", "Mongoid", "NUMBER", "uses", "ActiveModel", "for", "this", "now", "and", "has", "a", "number", "of", "relate", "fix", "so", "hopefully", "that", "can", "help", "to", "clean", "up", "any", "Mongoid", "specific", "hacks", "NUMBER", "same", "problem", "undefined", "local", "variable", "or", "method", "setup_modifications", "this", "gems", "set", "work", "for", "me", "at", "NUMBER", "gem", "bson_ext", "gem", "carrierwave", "gem", "paperclip", "NUMBER", "gem", "mongoid", "paperclip", "require", "mongoid_paperclip", "gem", "carrierwave", "mongoid", "require", "carrierwave", "mongoid", "gem", "mongoid", "git", "git", "github", "NUMBER", "com", "pyromaniac", "mongoid", "NUMBER", "git", "Did", "you", "try", "bundle", "update", "No", "but", "I", "will", "do", "that", "later", "NUMBER", "Pyromaniac", "say", "to", "me", "just", "do", "that", "and", "I", "did", "When", "uploading", "a", "file", "on", "some", "deploys", "I", "get", "NoMethodError", "undefined", "method", "content_type", "for", "nil", "NilClass", "It", "s", "this", "comit", "that", "s", "at", "fault", "LINK", "On", "some", "systems", "it", "works", "NUMBER", "I", "propose", "this", "patch", "ruby", "def", "retrieve_from_cache", "cache_name", "with_callbacks", "retrieve_from_cache", "cache_name", "do", "self", "NUMBER", "cache_id", "self", "NUMBER", "original_filename", "cache_name", "NUMBER", "to_s", "NUMBER", "split", "NUMBER", "filename", "original_filename", "if", "File", "NUMBER", "exist", "cache_path", "defined", "MIME", "Types", "MIME", "Types", "NUMBER", "of", "File", "NUMBER", "basename", "cache_path", "NUMBER", "NUMBER", "present", "TAG", "cache_path", "filename", "filename", "content_type", "MIME", "Types", "NUMBER", "of", "File", "NUMBER", "basename", "cache_path", "NUMBER", "NUMBER", "content_type", "else", "file", "CarrierWave", "SanitizedFile", "NUMBER", "new", "cache_path", "end", "end", "end", "Yeah", "that", "looks", "good", "please", "try", "to", "come", "up", "with", "a", "pull", "request", "with", "test", "if", "possible", "Is", "this", "also", "whats", "cause", "recreate_versions", "to", "fail", "here", "inst", "ImageUploader", "NUMBER", "new", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "inst", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "inst", "NUMBER", "recreate_versions", "NoMethodError", "undefined", "method", "read", "for", "nil", "NilClass", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "whiny_nil", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache_stored_file", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "recreate_versions", "from", "irb", "NUMBER", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "houen", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "houen", "I", "can", "t", "read", "that", "NUMBER", "Can", "you", "paste", "into", "a", "gist", "Sure", "thing", "LINK", "I", "did", "however", "try", "to", "copy", "in", "clyfe", "s", "patch", "above", "and", "that", "didnt", "fix", "it", "No", "as", "far", "as", "I", "can", "tell", "it", "depends", "on", "the", "environment", "in", "which", "be", "run", "interpreter", "gems", "make", "MIME", "Types", "NUMBER", "of", "return", "different", "stuff", "NUMBER", "Given", "a", "test", "it", "would", "always", "pass", "or", "fail", "depending", "on", "the", "environment", "in", "which", "be", "executed", "NUMBER", "I", "m", "wondering", "if", "we", "should", "just", "remove", "this", "feature", "since", "we", "have", "this", "now", "LINK", "Thoughts", "I", "have", "the", "same", "issue", "as", "above", "NoMethodError", "undefined", "method", "content_type", "for", "nil", "NilClass", "Locally", "on", "my", "Mac", "it", "works", "and", "on", "my", "production", "servers", "with", "Ubuntu", "NUMBER", "Ruby", "NUMBER", "Rails", "NUMBER", "carrierwave", "NUMBER", "it", "be", "not", "work", "NUMBER", "Is", "there", "a", "official", "solution", "When", "CarrierWave", "raises", "CarrierWave", "ProcessingError", "it", "should", "not", "set", "the", "new", "image", "equal", "to", "the", "fail", "image", "name", "NUMBER", "Otherwise", "you", "end", "up", "with", "a", "bad", "image", "attribute", "for", "a", "file", "that", "doesn", "t", "exist", "and", "it", "shows", "up", "on", "the", "website", "as", "a", "bad", "image", "URL", "NUMBER", "I", "would", "recommend", "saving", "the", "state", "of", "the", "image", "field", "and", "rolling", "back", "if", "an", "exception", "be", "throw", "NUMBER", "If", "you", "can", "recommend", "a", "way", "to", "do", "this", "as", "a", "temporary", "fix", "I", "would", "greatly", "appreciate", "it", "since", "this", "be", "an", "ongoing", "issue", "with", "our", "site", "NUMBER", "Thanks", "guys", "Rob", "Have", "you", "set", "the", "configuration", "options", "to", "raise", "this", "exception", "LINK", "L", "NUMBER", "I", "m", "not", "NUMBER", "sure", "what", "you", "re", "suggesting", "a", "pull", "request", "expressing", "your", "idea", "might", "be", "helpful", "NUMBER", "Hey", "Trevor", "By", "default", "the", "configuration", "options", "raise", "the", "exception", "NUMBER", "What", "I", "was", "saying", "be", "that", "if", "that", "exception", "be", "raise", "why", "would", "CarrierWave", "go", "forward", "with", "replacing", "the", "old", "image", "with", "a", "new", "one", "that", "had", "a", "processing", "error", "raise", "on", "it", "You", "would", "think", "that", "CarrierWave", "should", "not", "replace", "the", "old", "image", "if", "ANY", "error", "was", "throw", "sort", "of", "like", "a", "transaction", "block", "NUMBER", "If", "something", "went", "wrong", "in", "the", "block", "roll", "back", "the", "state", "to", "what", "it", "was", "NUMBER", "If", "everything", "went", "as", "it", "should", "then", "replace", "the", "old", "image", "with", "the", "new", "one", "NUMBER", "I", "can", "look", "into", "the", "CarrierWave", "code", "but", "I", "m", "not", "sure", "I", "understand", "it", "well", "enough", "to", "easily", "change", "this", "NUMBER", "OK", "thanks", "for", "having", "a", "look", "bensie", "Here", "be", "the", "uploader", "pretty", "basic", "LINK", "It", "happens", "under", "all", "scenarios", "you", "listed", "use", "CarrierWave", "NUMBER", "An", "easy", "way", "to", "replicate", "the", "error", "would", "be", "to", "create", "a", "text", "document", "give", "it", "a", "NUMBER", "png", "extension", "and", "then", "pass", "it", "into", "the", "model", "object", "as", "a", "remote_url", "NUMBER", "You", "ll", "see", "that", "there", "will", "be", "a", "processing", "error", "but", "CarrierWave", "still", "replaces", "the", "model", "image", "attribute", "with", "the", "name", "of", "the", "new", "image", "even", "though", "it", "fail", "Please", "try", "out", "CW", "from", "master", "and", "report", "back", "if", "this", "issue", "persists", "NUMBER", "Sincerely", "sorry", "for", "the", "extremely", "delayed", "response", "NUMBER", "It", "appears", "that", "the", "above", "referenced", "commit", "LINK", "did", "not", "fix", "the", "ProcessingError", "issue", "NUMBER", "Carrierwave", "still", "continues", "to", "set", "the", "image", "attribute", "to", "the", "bad", "image", "value", "even", "though", "there", "was", "a", "processing", "error", "NUMBER", "I", "be", "use", "CW", "from", "the", "current", "master", "branch", "in", "my", "Gemfile", "NUMBER", "TAG", "The", "above", "steps", "be", "still", "valid", "for", "recreating", "the", "issue", "An", "easy", "way", "to", "replicate", "the", "error", "would", "be", "to", "create", "a", "text", "document", "give", "it", "a", "NUMBER", "png", "extension", "and", "then", "pass", "it", "into", "the", "model", "object", "as", "a", "remote_url", "NUMBER", "You", "ll", "see", "that", "there", "will", "be", "a", "processing", "error", "but", "CarrierWave", "still", "replaces", "the", "model", "image", "attribute", "with", "the", "name", "of", "the", "new", "image", "even", "though", "it", "fail", "Initially", "apply", "the", "remove", "old", "file", "function", "to", "the", "mongoid", "orm", "I", "merge", "my", "local", "mongoid", "branch", "with", "your", "master", "branch", "from", "the", "official", "repo", "NUMBER", "So", "it", "should", "suggest", "the", "merge", "automatically", "option", "NUMBER", "I", "also", "fix", "a", "tiny", "bug", "relate", "to", "the", "way", "the", "mongoid", "dirty", "module", "works", "NUMBER", "Hope", "it", "will", "be", "good", "now", "f", "ck", "I", "did", "the", "squash", "stuff", "for", "the", "commit", "okay", "if", "I", "try", "to", "do", "a", "rebase", "git", "include", "all", "the", "commit", "even", "the", "ones", "from", "the", "master", "branch", "NUMBER", "Any", "suggestions", "bensie", "thanks", "for", "work", "on", "this", "NUMBER", "Lemme", "know", "if", "you", "need", "any", "help", "NUMBER", "Good", "work", "did", "bensie", "Thanks", "man", "Looks", "like", "if", "I", "need", "help", "with", "git", "I", "know", "now", "an", "expert", "Awesome", "NUMBER", "I", "think", "we", "re", "ready", "enough", "for", "a", "gem", "release", "NUMBER", "bensie", "sound", "ok", "to", "you", "I", "ll", "handle", "the", "changelog", "release", "etc", "but", "just", "checking", "that", "you", "think", "the", "outstanding", "issue", "be", "not", "worth", "holding", "back", "a", "release", "NUMBER", "While", "investigating", "issue", "NUMBER", "I", "notice", "that", "an", "unmounted", "uploader", "handles", "version", "processing", "differently", "than", "one", "that", "be", "mounted", "NUMBER", "Specifically", "an", "unmounted", "uploader", "creates", "each", "version", "from", "the", "original", "image", "rather", "than", "any", "parent", "version", "a", "mounted", "uploader", "on", "the", "other", "hand", "creates", "each", "version", "use", "any", "parent", "version", "as", "the", "starting", "point", "NUMBER", "For", "example", "here", "be", "a", "FooUploader", "that", "should", "resize", "the", "incoming", "image", "to", "NUMBER", "x", "NUMBER", "create", "a", "standard", "version", "at", "NUMBER", "x", "NUMBER", "and", "then", "mirror", "the", "standard", "version", "NUMBER", "In", "the", "end", "the", "standard", "mirrored", "version", "should", "also", "be", "NUMBER", "x", "NUMBER", "ruby", "class", "FooUploader", "TAG", "NUMBER", "NUMBER", "version", "standard", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "version", "mirror", "do", "process", "flop", "false", "def", "flop", "foo", "manipulate", "img", "img", "NUMBER", "flop", "end", "end", "end", "end", "Assume", "we", "also", "have", "a", "Foo", "model", "that", "looks", "like", "this", "ruby", "class", "Foo", "TAG", "foo", "FooUploader", "NUMBER", "new", "TAG", "foo", "NUMBER", "ore", "File", "NUMBER", "open", "Users", "jcarlson", "Desktop", "DSC_", "NUMBER", "jpg", "store_versions", "ls", "al", "public", "uploads", "total", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "DS_Store", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "dsc_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_dsc_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_mirror_dsc_", "NUMBER", "jpg", "Notice", "that", "the", "standard_mirror", "version", "be", "the", "largest", "of", "the", "bunch", "in", "terms", "of", "filesize", "NUMBER", "Indeed", "inspecting", "the", "image", "reveals", "it", "be", "as", "large", "as", "the", "original", "image", "just", "mirrored", "NUMBER", "Now", "lets", "give", "it", "another", "go", "through", "the", "model", "this", "time", "foo", "Foo", "NUMBER", "create", "foo", "File", "NUMBER", "open", "Users", "jcarlson", "Desktop", "DSC_", "NUMBER", "jpg", "TAG", "ls", "al", "public", "uploads", "total", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "DS_Store", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "dsc_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_dsc_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_mirror_dsc_", "NUMBER", "jpg", "This", "time", "the", "standard_mirror", "version", "be", "nearly", "identical", "in", "size", "to", "the", "standard", "version", "NUMBER", "So", "you", "can", "see", "how", "version", "be", "handle", "differently", "based", "on", "how", "the", "uploader", "was", "use", "NUMBER", "Please", "let", "me", "know", "if", "I", "can", "provide", "additional", "information", "to", "help", "replicate", "this", "issue", "NUMBER", "Is", "this", "with", "the", "master", "branch", "I", "think", "you", "may", "have", "encountered", "an", "issue", "that", "was", "recently", "fix", "but", "I", "m", "not", "sure", "NUMBER", "That", "s", "a", "good", "question", "and", "I", "be", "use", "the", "latest", "release", "NUMBER", "version", "of", "the", "gem", "NUMBER", "I", "ll", "see", "if", "upgrading", "to", "master", "yields", "the", "same", "problem", "NUMBER", "jcarlson", "we", "re", "hoping", "to", "get", "a", "gem", "release", "out", "soon", "but", "this", "be", "worrying", "us", "a", "bit", "NUMBER", "Can", "you", "test", "with", "the", "master", "branch", "and", "report", "back", "when", "you", "have", "a", "chance", "Thanks", "I", "will", "do", "my", "best", "to", "test", "this", "later", "tonight", "NUMBER", "Stay", "tuned", "NUMBER", "As", "best", "I", "can", "tell", "this", "problem", "still", "exists", "when", "use", "the", "master", "branch", "commit", "NUMBER", "f", "NUMBER", "ce", "NUMBER", "b", "NUMBER", "d", "NUMBER", "db", "NUMBER", "c", "NUMBER", "e", "NUMBER", "ec", "NUMBER", "b", "NUMBER", "ac", "NUMBER", "c", "foo", "FooUploader", "NUMBER", "new", "TAG", "foo", "NUMBER", "ore", "File", "NUMBER", "open", "Users", "jcarlson", "Desktop", "DSC_", "NUMBER", "jpg", "store_versions", "ls", "al", "total", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "DS_Store", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "DSC_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_DSC_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_mirror_DSC_", "NUMBER", "jpg", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "tmp", "foo", "Foo", "NUMBER", "create", "foo", "File", "NUMBER", "open", "Users", "jcarlson", "Desktop", "DSC_", "NUMBER", "jpg", "TAG", "ls", "al", "total", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "DS_Store", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "DSC_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_DSC_", "NUMBER", "jpg", "rw", "r", "r", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "standard_mirror_DSC_", "NUMBER", "jpg", "drwxr", "xr", "x", "NUMBER", "jcarlson", "staff", "NUMBER", "Jun", "NUMBER", "NUMBER", "NUMBER", "tmp", "jcarlson", "thanks", "for", "checking", "NUMBER", "I", "think", "I", "ll", "go", "ahead", "with", "the", "release", "since", "this", "doesn", "t", "sound", "like", "a", "regression", "but", "we", "ll", "obviously", "leave", "this", "issue", "open", "until", "we", "figure", "out", "a", "solution", "NUMBER", "Any", "help", "would", "be", "most", "appreciated", "of", "course", "I", "fix", "the", "deletion", "stuff", "for", "the", "embedded", "documents", "mongoid", "NUMBER", "be", "careful", "the", "pull", "request", "also", "contains", "modification", "about", "the", "gemspec", "NUMBER", "revert", "to", "the", "gemspec", "version", "from", "the", "original", "repo", "bensie", "what", "s", "the", "purpose", "of", "a", "rebase", "in", "my", "case", "I", "m", "not", "a", "big", "git", "expert", "NUMBER", "Also", "waiting", "on", "not", "having", "any", "change", "to", "the", "gemspec", "NUMBER", "Thanks", "did", "Closing", "until", "we", "can", "get", "an", "automatic", "merge", "work", "NUMBER", "I", "ll", "work", "with", "did", "on", "that", "NUMBER", "As", "request", "LINK", "issuecomment", "NUMBER", "here", "s", "a", "new", "pull", "request", "with", "the", "commit", "from", "pull", "NUMBER", "LINK", "that", "creates", "a", "new", "CarrierWave", "MimeTypes", "file", "processor", "complete", "with", "specs", "NUMBER", "I", "m", "still", "having", "problem", "get", "jnicklas", "carrierwave", "HEAD", "to", "work", "with", "my", "app", "I", "ll", "submit", "a", "separate", "issue", "once", "I", "figure", "it", "out", "so", "I", "haven", "t", "be", "able", "to", "do", "any", "real", "world", "integration", "test", "on", "this", "with", "my", "app", "yet", "NUMBER", "Sounds", "good", "NUMBER", "I", "m", "work", "on", "it", "now", "NUMBER", "Alrighty", "as", "Trevor", "point", "out", "in", "the", "other", "issue", "I", "wasn", "t", "completely", "mocking", "S", "NUMBER", "with", "Fog", "properly", "in", "my", "specs", "no", "clue", "why", "it", "worked", "with", "rubygems", "though", "NUMBER", "Anyway", "test", "for", "the", "win", "I", "drop", "this", "baby", "in", "my", "app", "and", "it", "worked", "perfectly", "W", "NUMBER", "t", "thanks", "A", "W", "E", "S", "O", "M", "E", "Steve", "Thanks", "so", "much", "When", "be", "the", "next", "release", "planned", "I", "would", "expect", "carrierwave", "to", "do", "this", "for", "me", "NUMBER", "When", "I", "didn", "t", "the", "image", "was", "not", "converted", "and", "the", "file", "extension", "was", "not", "change", "NUMBER", "I", "be", "use", "rails_admin", "with", "the", "dragonfly_file", "partial", "for", "a", "file", "field", "NUMBER", "This", "gives", "me", "back", "an", "ActionDispatch", "Http", "UploadedFile", "which", "I", "have", "to", "change", "the", "original_filename", "attribute", "to", "match", "the", "new", "extension", "NUMBER", "If", "I", "don", "t", "it", "silently", "do", "not", "convert", "NUMBER", "I", "would", "expect", "some", "kind", "of", "error", "message", "to", "be", "logged", "NUMBER", "Looks", "like", "this", "be", "expected", "NUMBER", "The", "readme", "shows", "the", "extension", "be", "change", "NUMBER", "If", "you", "think", "the", "documentation", "could", "be", "further", "improved", "please", "submit", "a", "pull", "request", "or", "add", "something", "to", "the", "wiki", "NUMBER", "Thanks", "I", "don", "t", "think", "the", "convert", "method", "in", "the", "source", "stated", "that", "you", "were", "required", "to", "add", "a", "filename", "method", "and", "one", "cannot", "assume", "from", "the", "README", "either", "that", "the", "filename", "method", "be", "required", "from", "convert", "NUMBER", "I", "be", "not", "even", "sure", "if", "the", "documentation", "as", "be", "correct", "it", "uses", "super", "NUMBER", "png", "but", "I", "would", "expect", "it", "to", "be", "File", "NUMBER", "extname", "super", "NUMBER", "png", "Please", "re", "open", "this", "as", "a", "feature", "request", "because", "this", "be", "a", "clear", "violation", "of", "DRY", "and", "an", "ugly", "point", "in", "what", "be", "usually", "a", "very", "elegant", "API", "NUMBER", "Can", "you", "please", "sort", "out", "if", "extname", "be", "required", "and", "create", "a", "pull", "request", "and", "I", "ll", "merge", "that", "in", "NUMBER", "Thanks", "yes", "can", "you", "re", "open", "the", "ticket", "so", "I", "don", "t", "forget", "BTW", "extname", "was", "wrong", "it", "should", "probably", "be", "File", "NUMBER", "basename", "super", "NUMBER", "or", "super", "NUMBER", "chomp", "File", "NUMBER", "extname", "super", "Yeah", "it", "s", "open", "NUMBER", "I", "ll", "look", "out", "for", "a", "pull", "request", "NUMBER", "Thanks", "I", "sent", "a", "pull", "to", "fix", "the", "documentation", "NUMBER", "This", "ticket", "be", "still", "a", "feature", "request", "to", "automatically", "have", "the", "behavior", "of", "add", "the", "filename", "method", "when", "convert", "be", "use", "NUMBER", "gregwebs", "thanks", "Are", "you", "planning", "on", "work", "on", "this", "new", "feature", "If", "so", "I", "ll", "leave", "this", "open", "waiting", "for", "you", "for", "a", "while", "NUMBER", "If", "not", "I", "d", "suggest", "pinging", "the", "Google", "Group", "to", "see", "if", "anyone", "be", "interested", "in", "work", "on", "the", "feature", "NUMBER", "no", "I", "be", "not", "going", "to", "work", "on", "it", "NUMBER", "I", "be", "busy", "enough", "with", "other", "open", "source", "projects", "right", "now", "and", "content", "with", "my", "workarounds", "NUMBER", "Perhaps", "I", "will", "take", "a", "crack", "at", "it", "the", "next", "time", "I", "use", "carrierwave", "on", "a", "project", "NUMBER", "Any", "solution", "for", "this", "I", "d", "like", "to", "see", "a", "way", "to", "customize", "the", "generate", "filename", "for", "a", "given", "version", "NUMBER", "For", "example", "instead", "of", "filename", "NUMBER", "jpg", "and", "thumb_filename", "NUMBER", "jpg", "I", "d", "like", "to", "have", "filename_thumb", "NUMBER", "jpg", "NUMBER", "Is", "this", "as", "simple", "as", "exposing", "and", "overriding", "the", "full_filename", "method", "in", "uploader", "version", "NUMBER", "rb", "version", "thumb", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "def", "full_filename", "for_file", "model", "NUMBER", "logo", "NUMBER", "file", "model", "NUMBER", "random_key", "NUMBER", "file", "NUMBER", "extension", "end", "end", "images", "eec", "NUMBER", "c", "NUMBER", "a", "d", "NUMBER", "c", "NUMBER", "b", "eec", "NUMBER", "c", "NUMBER", "a", "NUMBER", "jpg", "thumbs", "eec", "NUMBER", "c", "NUMBER", "a", "d", "NUMBER", "c", "NUMBER", "b", "thumb_eec", "NUMBER", "c", "NUMBER", "a", "NUMBER", "jpg", "i", "dont", "get", "it", "why", "it", "still", "has", "that", "thumb_", "in", "the", "filename", "Just", "starting", "with", "cw", "and", "encountering", "this", "problem", "e", "NUMBER", "g", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "i", "File", "NUMBER", "new", "Users", "xxx", "Downloads", "foo", "NUMBER", "jpg", "TAG", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "f", "Asset", "NUMBER", "new", "file", "i", "title", "midsummers", "night", "TAG", "the", "file", "be", "properly", "cached", "in", "uploads", "tmp", "at", "this", "point", "then", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "f", "NUMBER", "save", "TAG", "Here", "the", "path", "seems", "correct", "in", "memory", "as", "per", "the", "inspect", "but", "the", "file", "column", "in", "the", "db", "be", "actually", "storing", "the", "tmp", "path", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "foo", "NUMBER", "jpg", "which", "seems", "wrong", "NUMBER", "And", "reading", "the", "record", "back", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "f", "Asset", "NUMBER", "find", "NUMBER", "TAG", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "f", "NUMBER", "file", "NUMBER", "url", "uploads", "assets", "file", "NUMBER", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "foo", "NUMBER", "jpg", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "The", "path", "be", "munged", "NUMBER", "Any", "idea", "what", "s", "going", "on", "or", "where", "to", "look", "I", "ve", "spent", "a", "lot", "of", "time", "trying", "to", "trace", "through", "the", "code", "and", "it", "seems", "incredibly", "convoluted", "for", "such", "a", "simple", "thing", "NUMBER", "Thanks", "tv", "I", "disagree", "NUMBER", "It", "s", "a", "reproducible", "bug", "NUMBER", "In", "this", "case", "the", "problem", "be", "that", "the", "column", "accessors", "be", "not", "symmetrical", "i", "NUMBER", "e", "NUMBER", "doing", "file", "foo", "NUMBER", "jpg", "do", "not", "then", "yield", "file", "foo", "NUMBER", "jpg", "NUMBER", "Therefore", "my", "custom", "ORM", "adapter", "be", "fetching", "the", "munged", "version", "of", "the", "attribute", "i", "NUMBER", "e", "NUMBER", "the", "path", "rather", "than", "the", "filename", "NUMBER", "I", "supposed", "the", "work", "around", "be", "to", "mount_on", "another", "attribute", "Unfortunately", "this", "kind", "of", "bug", "be", "only", "fixable", "by", "a", "redesign", "and", "rewrite", "and", "probably", "reducing", "the", "line", "count", "to", "NUMBER", "NUMBER", "or", "NUMBER", "NUMBER", "of", "current", "NUMBER", "In", "doing", "so", "I", "also", "suggest", "taking", "guidance", "from", "this", "article", "LINK", "dsls", "Check", "the", "know", "issue", "page", "linked", "from", "the", "get", "help", "section", "here", "LINK", "I", "m", "definitely", "open", "to", "more", "discussion", "around", "this", "but", "jnlickas", "and", "I", "discussed", "and", "didn", "t", "want", "to", "break", "backwards", "compatibility", "for", "this", "change", "NUMBER", "Maybe", "more", "documentation", "more", "info", "the", "the", "wiki", "etc", "would", "help", "NUMBER", "You", "re", "contributions", "be", "definitely", "welcome", "tribalvibes", "when", "trying", "to", "add", "a", "new", "or", "edit", "an", "upload", "via", "nested", "Post", "form", "top", "middle", "lower", "Post", "Album", "Upload", "activemodel", "NUMBER", "lib", "active_model", "attribute_methods", "NUMBER", "rb", "NUMBER", "in", "method_missing", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "NUMBER", "rb", "NUMBER", "in", "method_missing", "carrierwave", "NUMBER", "lib", "carrierwave", "orm", "activerecord", "NUMBER", "rb", "NUMBER", "in", "image", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "block", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "each", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "initialize", "activerecord", "NUMBER", "lib", "active_record", "reflection", "NUMBER", "rb", "NUMBER", "in", "new", "activerecord", "NUMBER", "lib", "active_record", "reflection", "NUMBER", "rb", "NUMBER", "in", "build_association", "activerecord", "NUMBER", "lib", "active_record", "associations", "association_collection", "NUMBER", "rb", "NUMBER", "in", "build_record", "activerecord", "NUMBER", "lib", "active_record", "associations", "association_collection", "NUMBER", "rb", "NUMBER", "in", "build", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "block", "in", "assign_nested_attributes_for_collection_association", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "each", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "assign_nested_attributes_for_collection_association", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "uploads_attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "block", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "each", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "assign_to_or_mark_for_destruction", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "block", "in", "assign_nested_attributes_for_collection_association", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "each", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "assign_nested_attributes_for_collection_association", "activerecord", "NUMBER", "lib", "active_record", "nested_attributes", "NUMBER", "rb", "NUMBER", "in", "albums_attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "block", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "each", "activerecord", "NUMBER", "lib", "active_record", "base", "NUMBER", "rb", "NUMBER", "in", "attributes", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "block", "in", "update_attributes", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "update_attributes", "app", "controllers", "admin", "posts_controller", "NUMBER", "rb", "NUMBER", "in", "update", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "in", "send_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__process_action__", "NUMBER", "__callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_process_action_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "block", "in", "action", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "recognize", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "optimized_each", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "recognize", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "catch", "warden", "NUMBER", "lib", "warden", "manager", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "in", "call", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "call", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection_pool", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_call_callbacks", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "internal", "prelude", "NUMBER", "in", "synchronize", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "omar", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "omar", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "Users", "omar", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "I", "remove", "the", "storage", "declaration", "from", "all", "of", "my", "uploaders", "and", "set", "it", "in", "the", "initializer", "NUMBER", "Carrierwave", "seems", "to", "ignore", "what", "I", "have", "set", "in", "my", "initalizer", "I", "still", "have", "to", "set", "the", "storage", "in", "each", "uploader", "NUMBER", "My", "Initializer", "RACKSPACE_CONFIG", "YAML", "NUMBER", "load_file", "Rails", "NUMBER", "root", "config", "rackspace", "NUMBER", "yml", "Rails", "NUMBER", "env", "CarrierWave", "NUMBER", "configure", "do", "config", "if", "Rails", "NUMBER", "env", "NUMBER", "test", "Rails", "NUMBER", "env", "NUMBER", "development", "config", "NUMBER", "orage", "file", "config", "NUMBER", "enable_processing", "false", "else", "config", "NUMBER", "fog_credentials", "provider", "Rackspace", "rackspace_username", "XXXXX", "rackspace_api_key", "XXXXXXXXX", "config", "NUMBER", "fog_directory", "RACKSPACE_CONFIG", "fog_directory", "config", "NUMBER", "fog_host", "RACKSPACE_CONFIG", "fog_host", "end", "end", "What", "I", "have", "to", "have", "in", "each", "uploader", "storage", "Rails", "NUMBER", "env", "NUMBER", "development", "Rails", "NUMBER", "env", "NUMBER", "test", "file", "fog", "I", "m", "run", "Rails", "NUMBER", "and", "Carrierwave", "NUMBER", "Keep", "in", "mind", "that", "if", "you", "want", "to", "set", "it", "in", "an", "initializer", "you", "should", "_not_", "also", "set", "it", "in", "an", "uploader", "NUMBER", "I", "ve", "use", "this", "technique", "a", "number", "of", "times", "and", "it", "s", "always", "worked", "for", "me", "NUMBER", "Yeah", "I", "didn", "t", "have", "it", "set", "in", "the", "uploader", "NUMBER", "I", "tried", "remove", "the", "conditional", "within", "the", "CarrierWave", "NUMBER", "configure", "block", "first", "to", "force", "it", "into", "Rackspace", "and", "that", "didn", "t", "work", "NUMBER", "So", "thats", "when", "I", "add", "the", "setting", "within", "the", "uploaders", "and", "it", "seem", "to", "pickup", "the", "fog", "config", "then", "NUMBER", "Great", "NUMBER", "yes", "I", "would", "be", "an", "idiot", "Problem", "sovled", "NUMBER", "Sorry", "for", "troubling", "you", "NUMBER", "We", "can", "t", "operate", "with", "modifications", "before", "we", "didn", "t", "setup", "it", "NUMBER", "In", "Mongoid", "setup_modifications", "LINK", "_modifications", "be", "run", "after", "attributes", "were", "assignment", "LINK", "process", "instance_method", "NUMBER", "Here", "be", "a", "workaround", "and", "spec", "NUMBER", "I", "think", "it", "also", "refers", "to", "the", "NUMBER", "issue", "NUMBER", "Each", "version", "creates", "a", "copy", "of", "its", "parent", "Uploader", "NUMBER", "The", "value", "of", "the", "version", "hash", "was", "inheritable", "which", "meant", "version", "were", "processing", "unrelated", "version", "NUMBER", "Uploader", "NUMBER", "version", "now", "defaults", "to", "an", "empty", "hash", "but", "be", "not", "inheritable", "NUMBER", "As", "far", "as", "I", "can", "tell", "there", "s", "no", "reason", "for", "a", "version", "to", "ever", "inherit", "version", "rather", "it", "should", "only", "be", "assigned", "any", "nested", "version", "it", "might", "have", "NUMBER", "Wasn", "t", "exactly", "sure", "how", "to", "test", "this", "NUMBER", "Locally", "I", "discover", "the", "issue", "when", "I", "notice", "that", "some", "thumbnails", "were", "clearly", "blown", "up", "version", "of", "smaller", "thumbnails", "e", "NUMBER", "g", "NUMBER", "a", "non", "nested", "version", "be", "processed", "based", "on", "a", "smaller", "version", "so", "I", "could", "test", "based", "on", "thumbnail", "dimensions", "but", "I", "test", "closer", "to", "the", "source", "and", "simply", "made", "sure", "a", "version", "hashes", "were", "be", "set", "correctly", "NUMBER", "Looks", "good", "to", "me", "thanks", "Completing", "revert", "the", "commit", "remove", "the", "specs", "I", "add", "which", "verify", "that", "the", "version", "hash", "be", "correct", "which", "be", "crucial", "to", "properly", "handle", "version", "NUMBER", "I", "acknowledge", "that", "the", "patch", "doesn", "t", "work", "should", "have", "figured", "too", "easy", "but", "nevertheless", "IMO", "those", "specs", "I", "add", "need", "to", "pass", "or", "the", "version", "functionality", "be", "more", "or", "less", "borked", "NUMBER", "Still", "work", "on", "it", "NUMBER", "Is", "it", "a", "rule", "to", "not", "commit", "fail", "specs", "This", "isn", "t", "a", "shiny", "new", "feature", "but", "rather", "the", "correct", "functionality", "for", "the", "gem", "NUMBER", "Word", "NUMBER", "Fair", "enough", "NUMBER", "Since", "the", "README", "was", "converted", "to", "github", "style", "markdown", "in", "this", "commit", "LINK", "I", "can", "no", "longer", "compile", "the", "gem", "or", "install", "from", "github", "as", "I", "get", "the", "following", "error", "from", "bundler", "carrierwave", "at", "clipped", "did", "not", "have", "a", "valid", "gemspec", "NUMBER", "This", "prevents", "bundler", "from", "installing", "bins", "or", "native", "extensions", "but", "that", "may", "not", "affect", "its", "functionality", "NUMBER", "The", "validation", "message", "from", "Rubygems", "was", "README", "NUMBER", "oc", "be", "not", "file", "So", "I", "just", "remove", "the", "rdoc", "references", "to", "README", "NUMBER", "oc", "from", "the", "gemspec", "and", "it", "works", "again", "NUMBER", "Oops", "no", "just", "an", "oversight", "NUMBER", "Fixed", "it", "now", "NUMBER", "This", "be", "comprised", "of", "two", "commit", "NUMBER", "Added", "methods", "for", "more", "control", "over", "file", "NUMBER", "content_type", "including", "the", "ability", "to", "set", "the", "content", "type", "manually", "with", "file", "NUMBER", "content_type", "blah", "blah", "and", "to", "access", "file", "NUMBER", "original_content_type", "which", "gets", "set", "to", "the", "previous", "content", "type", "whenever", "file", "NUMBER", "content_type", "be", "call", "NUMBER", "Specs", "be", "include", "for", "this", "in", "the", "sanitized_file_spec", "NUMBER", "rb", "and", "this", "commit", "could", "be", "pull", "in", "easily", "without", "the", "next", "NUMBER", "NUMBER", "A", "new", "processor", "to", "do", "more", "advance", "content", "and", "mime", "type", "processing", "NUMBER", "Right", "now", "this", "processor", "simply", "uses", "the", "mime", "types", "gem", "to", "more", "intelligently", "guess", "the", "file", "type", "use", "the", "process", "set_content_type", "processor", "NUMBER", "I", "add", "the", "CarrierWave", "MimeTypes", "processor", "mainly", "because", "I", "didn", "t", "want", "to", "make", "a", "hard", "dependency", "on", "the", "mime", "types", "gem", "considering", "CarrierWave", "already", "do", "a", "decent", "job", "at", "content", "type", "guessing", "and", "this", "seem", "analogous", "to", "the", "optional", "RMagick", "ImageScience", "etc", "dependencies", "NUMBER", "Also", "in", "the", "future", "we", "could", "maybe", "even", "do", "more", "cool", "stuff", "with", "file", "processing", "who", "knows", "The", "second", "commit", "doesn", "t", "necessarily", "require", "the", "first", "in", "order", "to", "work", "but", "it", "be", "more", "useful", "with", "the", "first", "NUMBER", "I", "created", "specs", "for", "all", "the", "functionality", "describe", "above", "however", "I", "have", "not", "yet", "gotten", "this", "work", "with", "my", "Rails", "NUMBER", "app", "because", "as", "soon", "as", "I", "start", "installing", "the", "gem", "from", "github", "even", "before", "I", "change", "anything", "just", "from", "the", "current", "jnicklas", "carrierwave", "master", "HEAD", "I", "start", "get", "other", "error", "I", "have", "yet", "to", "figure", "out", "NUMBER", "These", "two", "commit", "together", "would", "essentially", "solve", "Issue", "NUMBER", "Let", "me", "know", "what", "you", "guys", "think", "NUMBER", "why", "wouldn", "t", "we", "always", "set", "an", "original_content_type", "That", "s", "a", "good", "question", "NUMBER", "Honestly", "I", "just", "did", "it", "that", "way", "because", "since", "I", "m", "new", "to", "carrierwave", "I", "was", "trying", "to", "touch", "as", "little", "of", "the", "codebase", "as", "possible", "and", "I", "didn", "t", "want", "to", "add", "NUMBER", "entire", "lines", "to", "sanitize", "LINK", "_file", "NUMBER", "rb", "L", "NUMBER", "in", "SanitizedFile", "just", "to", "set", "a", "new", "global", "instance", "variable", "NUMBER", "Then", "I", "just", "add", "the", "test", "to", "make", "that", "behavior", "clear", "NUMBER", "But", "I", "think", "you", "re", "right", "that", "it", "would", "make", "more", "sense", "and", "be", "more", "consistent", "to", "always", "set", "it", "NUMBER", "I", "can", "make", "that", "change", "NUMBER", "Processors", "manipulate", "images", "NUMBER", "Would", "make", "documentation", "for", "processors", "inconsistent", "NUMBER", "This", "in", "my", "view", "be", "the", "inconsistent", "part", "NUMBER", "Carrierwave", "uploads", "file", "while", "processors", "only", "manipulate", "images", "NUMBER", "But", "if", "carrierwave", "uploads", "file", "shouldn", "t", "processors", "process", "file", "What", "s", "so", "special", "about", "images", "Just", "as", "you", "can", "now", "write", "process", "convert", "png", "with", "the", "CarrierWave", "MiniMagick", "processor", "what", "if", "you", "could", "write", "process", "convert", "pdf", "with", "the", "CarrierWave", "PDF", "processor", "or", "process", "set_content_type", "with", "the", "CarrierWave", "MimeTypes", "processor", "I", "was", "envisioning", "a", "collection", "of", "processors", "somewhat", "like", "processing", "images", "image_science", "NUMBER", "rb", "mini_magick", "NUMBER", "rb", "rmagick", "NUMBER", "rb", "file", "mime_types", "NUMBER", "rb", "But", "yeah", "if", "I", "m", "off", "base", "just", "let", "me", "know", "NUMBER", "You", "guys", "be", "doing", "awesome", "work", "with", "CarrierWave", "so", "I", "trust", "your", "judgement", "NUMBER", "Good", "deal", "NUMBER", "I", "had", "originally", "start", "with", "an", "attr_writer", "content_type", "sort", "of", "solution", "but", "I", "needed", "the", "original", "content", "type", "as", "well", "which", "be", "why", "I", "had", "do", "it", "this", "way", "NUMBER", "Yeah", "the", "original_content_type", "stuff", "seems", "a", "little", "unnecessary", "to", "me", "to", "NUMBER", "I", "m", "not", "NUMBER", "convinced", "that", "overriding", "methods", "in", "SanitizedFile", "be", "a", "good", "API", "I", "d", "rather", "there", "d", "be", "something", "more", "official", "than", "that", "NUMBER", "But", "this", "be", "fine", "for", "the", "time", "be", "NUMBER", "As", "for", "the", "processor", "I", "m", "okay", "with", "that", "actually", "it", "might", "be", "good", "to", "have", "something", "like", "that", "since", "it", "illustrates", "that", "processeors", "don", "t", "have", "to", "all", "be", "image", "relate", "NUMBER", "Awesome", "thanks", "Jonas", "NUMBER", "Yeah", "I", "needed", "the", "original_content_type", "stuff", "for", "my", "app", "but", "I", "can", "see", "how", "that", "d", "be", "only", "marginally", "useful", "NUMBER", "Would", "you", "like", "me", "to", "take", "out", "the", "original_content_type", "stuff", "so", "this", "can", "get", "pull", "in", "I", "can", "also", "write", "up", "an", "article", "and", "or", "add", "to", "the", "wiki", "documentation", "for", "the", "file", "processor", "NUMBER", "I", "m", "not", "certain", "this", "be", "a", "real", "issue", "yet", "but", "it", "certainly", "manifests", "that", "way", "on", "my", "machine", "since", "upgrading", "my", "NUMBER", "application", "to", "NUMBER", "rc", "NUMBER", "I", "have", "after", "each", "test", "run", "integration", "test", "I", "have", "an", "uploads", "directory", "full", "of", "empty", "date", "stamped", "directories", "sitting", "around", "in", "the", "Rails", "NUMBER", "root", "I", "also", "have", "be", "seeing", "this", "in", "my", "app", "ever", "since", "Rails", "NUMBER", "beta", "NUMBER", "Except", "in", "my", "app", "it", "s", "actually", "in", "public", "updloads", "NUMBER", "Not", "sure", "what", "code", "you", "need", "exactly", "but", "here", "be", "the", "basics", "for", "one", "of", "my", "setups", "NUMBER", "spec", "support", "mock_fog", "NUMBER", "rb", "Fog", "NUMBER", "mock", "Fog", "NUMBER", "credentials_path", "Rails", "NUMBER", "root", "NUMBER", "join", "config", "fog_credentials", "NUMBER", "yml", "connection", "Fog", "Storage", "NUMBER", "new", "provider", "AWS", "connection", "NUMBER", "directories", "NUMBER", "create", "key", "my", "bucket", "name", "app", "uploaders", "my_uploader", "NUMBER", "rb", "class", "MyUploader", "TAG", "UsersController", "Excon", "Errors", "Forbidden", "Expected", "NUMBER", "TAG", "Actual", "NUMBER", "Forbidden", "n", "reqMore", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "in", "request", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "put_object", "NUMBER", "rb", "NUMBER", "in", "put_object", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "file", "NUMBER", "rb", "NUMBER", "in", "save", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "collection", "NUMBER", "rb", "NUMBER", "in", "create", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "app", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "TAG", "My", "configuration", "be", "as", "follow", "initializers", "carrierwave", "NUMBER", "rb", "TAG", "CarrierWave", "S", "NUMBER", "config", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "SETTINGS", "Rails", "NUMBER", "env", "s", "NUMBER", "access_key_id", "required", "aws_secret_access_key", "SETTINGS", "Rails", "NUMBER", "env", "s", "NUMBER", "secret_access_key", "required", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "SETTINGS", "Rails", "NUMBER", "env", "bucket", "required", "config", "NUMBER", "fog_host", "s", "NUMBER", "amazonaws", "NUMBER", "com", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "false", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "TAG", "picture_uploader", "NUMBER", "rb", "TAG", "class", "PictureUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "mini", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "end", "TAG", "I", "ve", "be", "dealing", "with", "this", "issue", "since", "yesterday", "night", "trying", "to", "test", "everything", "NUMBER", "tarikjn", "in", "the", "Google", "Group", "post", "as", "much", "info", "as", "possible", "from", "the", "NUMBER", "there", "may", "be", "something", "helpful", "in", "there", "NUMBER", "Thanks", "bensie", "trevorturk", "I", "posted", "a", "thread", "in", "the", "Google", "Group", "and", "awaiting", "moderation", "to", "append", "the", "full", "request", "details", "NUMBER", "tarikjn", "Just", "a", "quick", "chime", "in", "based", "on", "my", "experience", "with", "this", "sort", "of", "error", "NUMBER", "You", "said", "you", "be", "use", "the", "same", "credentials", "but", "be", "you", "use", "the", "same", "bucket", "name", "My", "guess", "be", "that", "it", "be", "probably", "a", "bucket", "in", "production", "that", "you", "don", "t", "actually", "own", "or", "that", "doesn", "t", "yet", "exist", "NUMBER", "Anyway", "feel", "free", "to", "continue", "the", "discussion", "on", "the", "google", "group", "but", "I", "thought", "I", "would", "toss", "in", "my", "two", "cents", "NUMBER", "geemus", "yes", "I", "did", "suspect", "the", "bucket", "and", "so", "I", "ve", "test", "with", "the", "same", "bucket", "as", "well", "NUMBER", "Right", "now", "I", "ll", "create", "a", "Rails", "app", "from", "scratch", "and", "push", "it", "to", "Heroku", "to", "try", "to", "isolate", "the", "issue", "NUMBER", "FYI", "I", "ve", "posted", "the", "full", "request", "on", "the", "Google", "Group", "LINK", "_thread", "thread", "fc", "NUMBER", "edb", "NUMBER", "f", "tarikjn", "I", "ve", "responded", "pending", "moderation", "I", "ll", "just", "wait", "on", "that", "rather", "than", "having", "doubled", "discussions", "NUMBER", "Another", "piece", "of", "the", "puzzle", "NUMBER", "NUMBER", "bensie", "your", "fix", "be", "clearly", "better", "which", "points", "to", "me", "not", "fully", "understanding", "whats", "happening", "internally", "NUMBER", "Thanks", "for", "looking", "NUMBER", "In", "the", "current", "version", "of", "CarrierWave", "if", "you", "have", "an", "uploader", "defined", "like", "this", "ruby", "class", "LogoUploader", "TAG", "NUMBER", "NUMBER", "process", "convert", "png", "def", "filename", "small", "NUMBER", "png", "end", "end", "version", "icon", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "process", "convert", "png", "def", "filename", "icon", "NUMBER", "png", "end", "end", "NUMBER", "end", "and", "attach", "a", "file", "name", "somefile", "NUMBER", "jpg", "you", "will", "end", "up", "with", "file", "named", "original", "NUMBER", "jpg", "small_small", "NUMBER", "png", "and", "icon_icon", "NUMBER", "png", "respectively", "NUMBER", "The", "problem", "seems", "to", "be", "these", "two", "function", "defined", "in", "CarrierWave", "Uploader", "Versions", "ruby", "def", "full_filename", "for_file", "version_name", "super", "for_file", "NUMBER", "compact", "NUMBER", "join", "_", "end", "def", "full_original_filename", "version_name", "super", "NUMBER", "compact", "NUMBER", "join", "_", "end", "These", "will", "_ALWAYS_", "force", "the", "final", "file", "name", "to", "be", "version_name", "_", "filename", "NUMBER", "It", "turns", "out", "you", "can", "override", "that", "in", "your", "version", "but", "in", "a", "really", "cludgey", "way", "ruby", "def", "filename", "original", "NUMBER", "model", "NUMBER", "logo", "NUMBER", "file", "NUMBER", "extension", "if", "original_filename", "end", "version", "small", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "process", "convert", "png", "def", "full_filename", "for_file", "model", "NUMBER", "logo", "NUMBER", "file", "name", "small", "NUMBER", "png", "end", "end", "version", "icon", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "process", "convert", "png", "def", "full_filename", "for_file", "model", "NUMBER", "logo", "NUMBER", "file", "name", "icon", "NUMBER", "png", "end", "end", "IMO", "the", "original", "function", "from", "the", "Versions", "class", "should", "be", "update", "so", "that", "they", "return", "just", "the", "filename", "if", "that", "method", "be", "defined", "in", "the", "version", "NUMBER", "The", "software", "should", "assume", "that", "the", "user", "be", "responsible", "for", "avoiding", "naming", "conflict", "in", "that", "case", "NUMBER", "I", "will", "look", "into", "provide", "a", "patch", "as", "soon", "as", "I", "can", "wrap", "up", "the", "project", "I", "m", "use", "CW", "for", "NUMBER", "It", "probably", "would", "have", "be", "fine", "to", "let", "the", "version", "manage", "their", "own", "name", "but", "I", "already", "had", "a", "lot", "of", "attachments", "generate", "with", "Paperclip", "and", "I", "wanted", "to", "keep", "the", "naming", "conventions", "that", "I", "already", "had", "in", "place", "NUMBER", "LINK", "clyfe", "I", "will", "test", "your", "branch", "NUMBER", "Great", "stuff", "I", "was", "just", "looking", "into", "how", "to", "deal", "with", "the", "excess", "of", "tmp", "dirs", "in", "our", "project", "and", "boom", "it", "s", "be", "fix", "Looking", "forward", "to", "the", "next", "release", "NUMBER", "I", "be", "use", "Rails", "NUMBER", "RC", "and", "Carrierwave", "NUMBER", "Don", "t", "know", "if", "this", "be", "an", "issue", "with", "NUMBER", "I", "verify", "that", "the", "path", "and", "file", "exists", "LINK", "_name", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "unencoded", "users", "NUMBER", "photos", "test", "NUMBER", "gif", "in", "my", "S", "NUMBER", "bucket", "NUMBER", "When", "I", "do", "Photo", "NUMBER", "first", "NUMBER", "update_attributes", "job_state", "processing", "remote_attachment_url", "LINK", "_name", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "unencoded", "users", "NUMBER", "photos", "test", "NUMBER", "gif", "Error", "I", "get", "Errno", "ENOENT", "No", "such", "file", "or", "directory", "Users", "Chris", "Sites", "site_name", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "small_test", "NUMBER", "gif", "Why", "be", "Carrierwave", "trying", "to", "access", "the", "local", "dir", "instead", "of", "S", "NUMBER", "My", "initializer", "looks", "like", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "APP_CONFIG", "amazon_access_key_id", "required", "aws_secret_access_key", "APP_CONFIG", "amazon_secret_access_key", "required", "config", "NUMBER", "fog_directory", "bucket_name", "required", "config", "NUMBER", "fog_host", "LINK", "_name", "NUMBER", "com", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "true", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "My", "uploader", "class", "looks", "like", "encoding", "utf", "NUMBER", "class", "PhotoUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "medium", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "large", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "Add", "a", "white", "list", "of", "extensions", "which", "be", "allow", "to", "be", "uploaded", "NUMBER", "For", "images", "you", "might", "use", "something", "like", "this", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "LINK", "Heroku", "has", "a", "read", "only", "filesystem", "so", "uploads", "must", "be", "stored", "on", "S", "NUMBER", "and", "cannot", "be", "cached", "in", "the", "public", "directory", "NUMBER", "You", "can", "work", "around", "the", "caching", "limitation", "by", "setting", "the", "cache_dir", "in", "your", "Uploader", "classes", "to", "the", "tmp", "directory", "NUMBER", "def", "cache_dir", "Rails", "NUMBER", "root", "tmp", "uploads", "end", "end", "In", "my", "uploader", "class", "if", "I", "remove", "the", "version", "the", "upload", "succeeds", "without", "any", "error", "NUMBER", "Full", "stack", "trace", "Errno", "ENOENT", "No", "such", "file", "or", "directory", "Users", "Chris", "Sites", "site_name", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "small_test", "NUMBER", "gif", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "open", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "read", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store_versions", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "store_versions", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_callbacks", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "bundler", "gems", "carrierwave", "NUMBER", "d", "NUMBER", "e", "NUMBER", "ee", "NUMBER", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store_versions", "NUMBER", "NUMBER", "levels", "NUMBER", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "block", "in", "update_attributes", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "activerecord", "NUMBER", "rc", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "update_attributes", "from", "irb", "NUMBER", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "railties", "NUMBER", "rc", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "railties", "NUMBER", "rc", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Chris", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "railspre", "gems", "railties", "NUMBER", "rc", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "Does", "this", "happen", "if", "you", "re", "saving", "a", "new", "record", "Yes", "it", "do", "NUMBER", "The", "same", "problem", "here", "NUMBER", "Running", "rails", "NUMBER", "and", "uploading", "to", "S", "NUMBER", "Don", "t", "know", "why", "but", "carrierwave", "be", "always", "processing", "file", "locally", "in", "the", "folder", "public", "store_dir", "from", "uploader", "file", "and", "after", "a", "few", "processed", "version", "throw", "the", "exception", "shown", "by", "krzkrzkrz", "Actually", "correct", "me", "if", "I", "be", "wrong", "NUMBER", "Is", "it", "normal", "that", "it", "try", "to", "process", "the", "file", "locally", "first", "before", "sending", "to", "S", "NUMBER", "Hence", "why", "a", "tmp", "folder", "be", "be", "use", "NUMBER", "What", "I", "have", "observed", "so", "far", "be", "that", "the", "processed", "file", "small_test", "NUMBER", "gif", "medium_test", "NUMBER", "gif", "large_test", "NUMBER", "gif", "be", "be", "put", "in", "the", "tmp", "folder", "Users", "Chris", "Sites", "site_name", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "However", "I", "also", "notice", "that", "these", "file", "be", "be", "remove", "NUMBER", "Perhaps", "they", "be", "be", "remove", "too", "quickly", "before", "they", "sent", "to", "S", "NUMBER", "Hence", "the", "error", "Errno", "ENOENT", "No", "such", "file", "or", "directory", "Users", "Chris", "Sites", "site_name", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "small_test", "NUMBER", "gif", "You", "can", "see", "this", "in", "action", "by", "going", "to", "your", "tmp", "dir", "NUMBER", "In", "my", "case", "it", "was", "tmp", "NUMBER", "Run", "something", "like", "Photo", "NUMBER", "first", "NUMBER", "update_attributes", "job_state", "processing", "remote_attachment_url", "LINK", "_name", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "unencoded", "users", "NUMBER", "photos", "test", "NUMBER", "gif", "In", "tmp", "you", "will", "see", "that", "it", "will", "create", "the", "necessary", "tmp", "folders", "for", "the", "photo", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "Inside", "this", "folder", "you", "will", "the", "the", "NUMBER", "file", "small_test", "NUMBER", "gif", "medium_test", "NUMBER", "gif", "large_test", "NUMBER", "gif", "be", "created", "and", "then", "remove", "automatically", "by", "Carrierwave", "NUMBER", "You", "be", "right", "NUMBER", "I", "processes", "the", "file", "locally", "and", "then", "deletes", "them", "NUMBER", "Yea", "at", "this", "point", "I", "be", "thinking", "that", "Carrierwave", "deletes", "the", "tmp", "file", "too", "quickly", "before", "it", "can", "be", "sent", "to", "S", "NUMBER", "I", "suspect", "this", "be", "the", "reason", "NUMBER", "At", "least", "we", "ruled", "out", "the", "possibility", "that", "it", "may", "be", "a", "Rails", "NUMBER", "compatibility", "problem", "since", "the", "error", "be", "also", "showing", "up", "with", "Rails", "NUMBER", "krzkrzkrz", "I", "doubt", "that", "but", "happy", "to", "be", "proven", "wrong", "Please", "do", "investigate", "I", "d", "like", "to", "help", "but", "I", "be", "not", "familiar", "with", "the", "Carrierwave", "lib", "and", "all", "its", "relevant", "file", "NUMBER", "Only", "a", "few", "months", "into", "Ruby", "and", "Rails", "unfortunately", "NUMBER", "Not", "sure", "if", "this", "be", "somewhat", "relate", "to", "mini_magick", "LINK", "code", "NUMBER", "lighthouseapp", "NUMBER", "com", "projects", "NUMBER", "tickets", "NUMBER", "race", "condition", "with", "temp_file", "I", "don", "t", "think", "it", "be", "since", "I", "tried", "switching", "to", "rmagick", "and", "the", "problem", "be", "still", "there", "NUMBER", "A", "second", "suspect", "be", "this", "LINK", "line", "NUMBER", "which", "contains", "file", "NUMBER", "delete", "if", "delete_tmp_file_after_storage", "Perhaps", "Carrierwave", "be", "deleting", "the", "file", "before", "verifying", "its", "existence", "NUMBER", "This", "change", "between", "NUMBER", "and", "NUMBER", "Trying", "to", "pin", "down", "the", "exact", "cause", "NUMBER", "This", "might", "help", "LINK", "I", "believe", "it", "s", "relate", "to", "old", "s", "NUMBER", "config", "that", "hasn", "t", "be", "update", "to", "the", "new", "fog", "syntax", "NUMBER", "I", "m", "not", "sure", "what", "you", "mean", "NUMBER", "Hmmmm", "I", "don", "t", "know", "exactly", "what", "the", "problem", "be", "but", "I", "switched", "my", "gem", "file", "from", "gem", "carrierwave", "git", "LINK", "to", "gem", "carrierwave", "NUMBER", "The", "problem", "seems", "to", "have", "gone", "away", "NUMBER", "There", "be", "something", "definitely", "wrong", "with", "the", "master", "version", "NUMBER", "I", "m", "experience", "this", "issue", "as", "well", "NUMBER", "It", "seems", "to", "work", "fine", "for", "me", "if", "I", "only", "have", "NUMBER", "version", "but", "I", "encounter", "the", "problem", "when", "I", "try", "to", "do", "multiple", "version", "NUMBER", "I", "m", "just", "get", "familiar", "with", "CarrierWave", "but", "I", "was", "under", "the", "impression", "that", "the", "cache", "directory", "be", "use", "for", "post", "processing", "before", "uploading", "to", "S", "NUMBER", "but", "it", "looks", "like", "when", "I", "specify", "version", "that", "no", "file", "be", "get", "stored", "in", "my", "cache", "directory", "NUMBER", "So", "as", "soon", "as", "it", "try", "to", "do", "the", "processing", "it", "doesn", "t", "find", "that", "version", "_", "filename", "in", "my", "cache", "directory", "NUMBER", "Again", "if", "I", "specify", "just", "NUMBER", "version", "it", "works", "just", "fine", "NUMBER", "I", "will", "dig", "into", "the", "code", "a", "little", "more", "to", "see", "what", "I", "can", "find", "NUMBER", "Edit", "For", "what", "it", "s", "worth", "I", "m", "also", "use", "MiniMagick", "for", "processing", "NUMBER", "Apparently", "if", "you", "set", "this", "config", "value", "to", "false", "then", "everything", "will", "work", "ok", "ruby", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "I", "suppose", "this", "setting", "could", "make", "some", "sense", "but", "it", "seems", "by", "default", "that", "maybe", "it", "should", "work", "the", "other", "way", "set", "to", "false", "as", "default", "as", "I", "imagine", "that", "most", "uses", "of", "CarrierWave", "involve", "some", "sort", "of", "processing", "NUMBER", "I", "m", "also", "guessing", "that", "there", "be", "a", "race", "condition", "in", "any", "processing", "get", "do", "and", "it", "get", "stored", "to", "the", "eventual", "storage", "which", "be", "why", "NUMBER", "version", "seem", "to", "work", "for", "me", "I", "m", "guessing", "NUMBER", "I", "run", "into", "a", "similar", "problem", "with", "version", "NUMBER", "when", "I", "add", "the", "code", "from", "LINK", "to", "NUMBER", "A", "Delete", "cache", "garbage", "directories", "to", "my", "uploader", "class", "NUMBER", "I", "add", "this", "note", "to", "that", "page", "This", "method", "breaks", "uploaders", "that", "have", "more", "than", "one", "version", "defined", "NUMBER", "Your", "first", "version", "will", "be", "saved", "but", "afterwards", "the", "cleanup", "code", "will", "run", "and", "remove", "the", "tmp", "file", "that", "be", "use", "to", "generate", "additional", "version", "NUMBER", "In", "that", "case", "you", "be", "better", "off", "creating", "a", "rake", "task", "that", "cleans", "out", "the", "tmp", "folders", "periodically", "NUMBER", "It", "be", "likely", "that", "the", "same", "thing", "be", "happening", "with", "the", "new", "delete_tmp_file_after_storage", "configuration", "option", "NUMBER", "Ideally", "any", "post", "processing", "action", "that", "gets", "triggered", "should", "only", "happen", "after", "all", "of", "the", "version", "have", "be", "created", "NUMBER", "This", "might", "be", "problematic", "if", "processing", "be", "offloaded", "to", "Delayed", "Job", "et", "NUMBER", "al", "NUMBER", "I", "just", "did", "the", "opposite", "of", "krzkrzkrz", "and", "switched", "from", "use", "version", "NUMBER", "of", "the", "gem", "to", "use", "the", "github", "hosted", "edge", "version", "NUMBER", "However", "if", "I", "specify", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "in", "my", "initializer", "in", "order", "to", "work", "around", "the", "problem", "outlined", "here", "the", "temp", "file", "be", "still", "delete", "anyway", "NUMBER", "Apparently", "even", "if", "you", "set", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "unless", "you", "also", "set", "config", "NUMBER", "delete_cache_id_after_storage", "false", "then", "the", "temp", "file", "will", "be", "delete", "anyways", "because", "the", "delete_cache_id", "method", "calls", "FileUtils", "NUMBER", "rm_rf", "NUMBER", "This", "be", "really", "borked", "NUMBER", "Ideally", "the", "entire", "version", "process", "should", "take", "place", "inside", "a", "wrapper", "and", "that", "wrapper", "should", "be", "tasked", "with", "make", "sure", "that", "all", "version", "tasks", "have", "completed", "before", "any", "cleanup", "be", "do", "NUMBER", "Also", "in", "the", "present", "context", "delete_tmp_file_after_storage", "and", "delete_cache_id_after_storage", "seem", "to", "be", "redundant", "NUMBER", "It", "be", "unlikely", "that", "someone", "would", "want", "to", "delete", "the", "individual", "cache", "file", "but", "not", "the", "parent", "folder", "NUMBER", "Perhaps", "we", "should", "get", "rid", "of", "the", "former", "configuration", "option", "and", "keep", "only", "the", "latter", "NUMBER", "Yeah", "I", "think", "delete_cache_id_after_storage", "was", "just", "add", "and", "maybe", "we", "should", "change", "it", "so", "that", "delete_tmp_file_after_storage", "be", "the", "name", "but", "takes", "the", "functionality", "from", "delete_cache_id_after_storage", "NUMBER", "Your", "suggestions", "be", "smart", "and", "your", "help", "be", "definitely", "appreciated", "if", "you", "have", "ideas", "about", "how", "to", "fix", "this", "stuff", "I", "m", "just", "trying", "to", "get", "through", "this", "project", "but", "every", "step", "forward", "I", "try", "to", "take", "with", "CW", "ends", "up", "setting", "me", "two", "steps", "back", "Sorry", "to", "hear", "that", "I", "hope", "you", "can", "use", "CW", "but", "no", "worries", "if", "you", "need", "to", "switch", "to", "Paperclip", "or", "something", "else", "NUMBER", "I", "know", "there", "be", "still", "some", "rough", "spots", "in", "CW", "here", "and", "there", "NUMBER", "Chris", "I", "share", "the", "same", "sentiment", "NUMBER", "Issues", "I", "normally", "open", "up", "with", "CW", "be", "not", "easily", "solvable", "NUMBER", "Sometimes", "cause", "a", "bit", "of", "a", "delay", "in", "development", "NUMBER", "Just", "curious", "NUMBER", "What", "be", "you", "use", "now", "I", "m", "still", "use", "CW", "NUMBER", "Specifically", "the", "master", "version", "as", "it", "fix", "a", "number", "of", "bug", "that", "I", "was", "experience", "with", "NUMBER", "but", "I", "m", "nervous", "about", "use", "that", "in", "production", "and", "we", "re", "doing", "a", "soft", "go", "live", "in", "NUMBER", "days", "NUMBER", "I", "test", "it", "on", "our", "staging", "environment", "yesterday", "and", "everything", "looked", "OK", "NUMBER", "_fingers", "crossed_", "IMO", "with", "the", "caveat", "that", "this", "be", "my", "first", "production", "level", "Rails", "app", "and", "I", "ve", "only", "be", "work", "with", "CW", "et", "NUMBER", "al", "NUMBER", "for", "less", "than", "a", "month", "CW", "still", "has", "some", "benefits", "over", "Pc", "NUMBER", "I", "like", "the", "fact", "that", "you", "can", "DRY", "up", "your", "uploaders", "and", "re", "use", "them", "across", "different", "models", "NUMBER", "I", "ve", "also", "find", "test", "to", "be", "much", "simpler", "with", "CW", "and", "the", "build", "in", "remote", "upload", "be", "nice", "as", "oppose", "to", "the", "hacks", "that", "were", "necessary", "to", "get", "that", "to", "work", "with", "Pc", "NUMBER", "Plus", "the", "CW", "mailing", "list", "be", "infinitely", "more", "active", "and", "useful", "than", "the", "one", "for", "Pc", "NUMBER", "So", "I", "carry", "on", "and", "just", "have", "lots", "of", "comments", "in", "my", "uploader", "and", "initializers", "about", "temporary", "hacks", "to", "override", "the", "bug", "from", "issue", "X", "etc", "NUMBER", "I", "know", "I", "ve", "be", "pretty", "vocal", "on", "the", "issue", "and", "mailing", "lists", "lately", "but", "I", "hope", "it", "s", "not", "mistaken", "for", "complaining", "NUMBER", "I", "try", "to", "provide", "a", "workaround", "when", "possible", "and", "if", "nothing", "else", "provide", "constructive", "criticism", "NUMBER", "FWIW", "I", "think", "the", "time", "I", "spent", "switching", "from", "Pc", "to", "CW", "will", "be", "worth", "it", "in", "the", "long", "run", "NUMBER", "Still", "no", "update", "on", "this", "Been", "a", "while", "already", "NUMBER", "I", "ve", "fix", "this", "in", "our", "fork", "so", "it", "doesn", "t", "delete", "the", "cache", "dir", "until", "all", "version", "be", "processed", "but", "I", "accidentally", "applied", "from", "my", "stash", "into", "an", "older", "revision", "of", "the", "repo", "to", "what", "I", "made", "the", "edits", "on", "so", "the", "combination", "of", "my", "commit", "and", "then", "the", "merge", "of", "the", "miss", "revisions", "from", "origin", "looks", "really", "messy", "NUMBER", "I", "m", "not", "sure", "what", "a", "pull", "request", "would", "look", "like", "I", "ve", "be", "meaning", "to", "look", "into", "git", "to", "see", "how", "best", "to", "rebase", "it", "any", "advice", "appreciated", "on", "that", "NUMBER", "LINK", "I", "also", "mean", "to", "write", "a", "couple", "of", "test", "cases", "but", "we", "re", "flat", "out", "at", "the", "moment", "NUMBER", "OK", "I", "think", "we", "ve", "get", "a", "fix", "for", "the", "config", "options", "delete_tmp_file_after_storage", "delete_cache_id_after_storage", "Please", "test", "with", "the", "latest", "master", "and", "report", "back", "NUMBER", "I", "m", "release", "a", "new", "gem", "version", "today", "as", "well", "so", "that", "may", "also", "fix", "the", "issue", "NUMBER", "I", "m", "going", "to", "open", "a", "new", "issue", "about", "combining", "these", "two", "options", "as", "chrisbloom", "NUMBER", "suggested", "NUMBER", "chrisbloom", "NUMBER", "if", "you", "re", "still", "use", "CW", "perhaps", "you", "d", "be", "interested", "in", "looking", "into", "that", "LINK", "trevorturk", "Yes", "still", "use", "CW", "NUMBER", "Will", "take", "a", "look", "at", "the", "new", "ticket", "and", "poke", "at", "it", "if", "time", "permits", "NUMBER", "I", "also", "think", "the", "fix", "for", "NUMBER", "that", "be", "now", "in", "master", "and", "going", "out", "in", "NUMBER", "will", "fix", "this", "problem", "NUMBER", "For", "one", "even", "with", "delete_cache_id_after_storage", "set", "to", "true", "it", "will", "never", "delete", "the", "cache", "directories", "if", "they", "be", "not", "empty", "NUMBER", "So", "if", "you", "set", "delete_tmp_file_after_storage", "to", "false", "you", "will", "never", "get", "any", "of", "your", "temp", "file", "remove", "NUMBER", "scottwb", "would", "you", "take", "a", "look", "at", "issue", "NUMBER", "if", "you", "have", "time", "I", "m", "thinking", "there", "s", "no", "good", "reason", "for", "the", "NUMBER", "config", "options", "NUMBER", "Perhaps", "we", "could", "combine", "them", "into", "one", "So", "just", "to", "be", "clear", "was", "this", "particular", "issue", "ever", "patched", "in", "which", "temp", "file", "were", "be", "delete", "too", "quickly", "Is", "it", "in", "the", "latest", "gem", "or", "still", "just", "in", "master", "chrisbloom", "NUMBER", "I", "haven", "t", "test", "the", "patch", "from", "the", "guys", "but", "my", "fork", "has", "be", "work", "great", "for", "a", "few", "weeks", "NUMBER", "all", "i", "ll", "switch", "back", "to", "HEAD", "next", "week", "and", "try", "out", "the", "fix", "I", "just", "run", "into", "this", "issue", "in", "development", "NUMBER", "Rails", "NUMBER", "Ruby", "NUMBER", "p", "NUMBER", "postgres", "NUMBER", "carrierwave", "NUMBER", "mini_magick", "NUMBER", "store_dir", "set", "to", "uploads", "model", "NUMBER", "class", "NUMBER", "to_s", "NUMBER", "underscore", "mounted_as", "model", "NUMBER", "id", "set", "in", "application", "NUMBER", "rb", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "config", "NUMBER", "delete_cache_id_after_storage", "false", "Error", "reads", "Errno", "ENOENT", "in", "UsersController", "update", "No", "such", "file", "or", "directory", "identify", "ping", "var", "folders", "NUMBER", "l", "NUMBER", "lHpnfiYG", "NUMBER", "W", "NUMBER", "eePveOqk", "TI", "Tmp", "mini_magick", "NUMBER", "NUMBER", "NUMBER", "eei", "NUMBER", "s", "NUMBER", "jpg", "Any", "thoughts", "Oy", "I", "m", "having", "the", "same", "issue", "both", "on", "the", "latest", "release", "gem", "and", "also", "on", "head", "NUMBER", "I", "m", "also", "having", "the", "same", "issue", "NUMBER", "Correction", "I", "m", "a", "bit", "daft", "NUMBER", "Didn", "t", "have", "Imagemagick", "install", "NUMBER", "Installed", "it", "and", "it", "now", "works", "fine", "NUMBER", "havingoneofthosedays", "Oh", "good", "somebody", "else", "commented", "NUMBER", "I", "lost", "this", "thread", "Anywho", "I", "figured", "out", "my", "problem", "NUMBER", "I", "was", "run", "Rails", "via", "an", "IDE", "and", "it", "wasn", "t", "picking", "up", "my", "terminal", "environment", "settings", "including", "PATH", "NUMBER", "Since", "Imagemagick", "was", "install", "via", "brew", "it", "be", "all", "in", "usr", "local", "and", "that", "s", "not", "in", "the", "default", "NUMBER", "So", "to", "get", "around", "this", "I", "decided", "to", "add", "this", "line", "of", "code", "to", "application", "NUMBER", "rb", "ENV", "PATH", "usr", "local", "bin", "ENV", "PATH", "NUMBER", "and", "it", "worked", "lib", "carrierwave", "NUMBER", "rb", "line", "NUMBER", "require", "active_support", "core_ext", "class", "inheritable_attributes", "It", "s", "deprecate", "and", "remove", "in", "rails", "NUMBER", "It", "will", "be", "remove", "in", "rails", "NUMBER", "it", "be", "deprecate", "in", "NUMBER", "NUMBER", "NUMBER", "stable", "be", "the", "current", "NUMBER", "branch", "in", "rails", "core", "NUMBER", "Ah", "NUMBER", "Sorry", "NUMBER", "Looked", "on", "master", "branch", "NUMBER", "But", "anyway", "it", "s", "already", "remove", "in", "master", "and", "there", "be", "no", "reason", "in", "use", "inheritable", "attributes", "instead", "of", "class", "attributes", "Can", "we", "support", "Rails", "NUMBER", "and", "NUMBER", "somehow", "Pull", "request", "welcome", "NUMBER", "I", "ve", "tried", "but", "still", "have", "some", "issue", "with", "some", "specs", "NUMBER", "Ok", "NUMBER", "I", "need", "help", "NUMBER", "I", "ve", "start", "from", "processing", "NUMBER", "rb", "NUMBER", "Here", "be", "a", "diif", "LINK", "And", "NUMBER", "spec", "fail", "LINK", "Any", "suggestions", "will", "be", "appreciated", "NUMBER", "Thanks", "It", "s", "a", "long", "shot", "but", "maybe", "josevalim", "will", "have", "an", "idea", "for", "us", "NUMBER", "Actually", "it", "be", "not", "hard", "to", "fix", "NUMBER", "The", "only", "thing", "you", "need", "to", "keep", "in", "mind", "be", "that", "you", "should", "not", "modify", "things", "in", "place", "use", "class_attribute", "NUMBER", "With", "class_inheritable_accessor", "when", "you", "inherited", "all", "attributes", "were", "copied", "from", "parent", "to", "child", "NUMBER", "With", "class_attribute", "it", "doesn", "t", "happen", "class", "Foo", "class_attribute", "foo", "self", "NUMBER", "foo", "bar", "baz", "end", "class", "Bar", "TAG", "bar", "baz", "Bar", "NUMBER", "foo", "bar", "baz", "Bar", "NUMBER", "foo", "NUMBER", "delete", "bar", "Foo", "NUMBER", "foo", "Bar", "NUMBER", "foo", "So", "what", "to", "do", "instead", "Use", "NUMBER", "dup", "plus", "setters", "Foo", "NUMBER", "foo", "bar", "baz", "Bar", "NUMBER", "foo", "bar", "baz", "Bar", "NUMBER", "foo", "Bar", "NUMBER", "foo", "NUMBER", "dup", "NUMBER", "delete", "bar", "Foo", "NUMBER", "foo", "bar", "baz", "Bar", "NUMBER", "foo", "Besides", "that", "you", "will", "be", "fine", "and", "it", "should", "work", "from", "NUMBER", "x", "forward", "NUMBER", "Sweet", "Thanks", "for", "the", "super", "quick", "response", "bensie", "you", "want", "to", "take", "a", "shot", "at", "fix", "I", "don", "t", "think", "that", "dup", "can", "help", "because", "according", "to", "class_attribute", "docs", "use", "on", "array", "will", "not", "change", "parent", "attributes", "and", "children", "too", "NUMBER", "So", "this", "be", "same", "thing", "as", "use", "dup", "NUMBER", "Yes", "be", "also", "fine", "because", "you", "aren", "t", "modifying", "it", "in", "place", "NUMBER", "josevalim", "but", "this", "be", "a", "problem", "NUMBER", "TAG", "class", "A", "class_attribute", "x", "self", "NUMBER", "x", "end", "a", "NUMBER", "Class", "NUMBER", "new", "A", "a", "NUMBER", "x", "a", "a", "NUMBER", "Class", "NUMBER", "new", "a", "NUMBER", "a", "NUMBER", "x", "should", "be", "a", "TAG", "At", "least", "it", "worked", "so", "with", "inherited", "accessor", "That", "should", "also", "work", "with", "class_attribute", "NUMBER", "josevalim", "i", "ve", "update", "comment", "may", "be", "it", "because", "of", "self", "NUMBER", "x", "in", "class", "code", "hmm", "NUMBER", "let", "me", "try", "it", "once", "again", "NUMBER", "ok", "NUMBER", "i", "ve", "find", "the", "problem", "but", "not", "solution", "NUMBER", "in", "LINK", "_spec", "NUMBER", "rb", "L", "NUMBER", "if", "we", "delete", "lines", "NUMBER", "NUMBER", "version", "initialization", "then", "uploader", "NUMBER", "processors", "NUMBER", "should", "rotate", "nil", "test", "will", "pass", "but", "ofc", "it", "will", "fail", "un", "uploader", "NUMBER", "NUMBER", "so", "seems", "like", "new", "version", "initialization", "brokes", "processors", "array", "NUMBER", "version", "NUMBER", "rb", "line", "NUMBER", "version", "name", "uploader", "NUMBER", "processors", "NUMBER", "clear", "i", "think", "this", "be", "an", "issue", "Very", "likely", "never", "modify", "anything", "in", "place", "NUMBER", "Even", "an", "array", "inside", "a", "nested", "hash", "NUMBER", "LINK", "work", "diff", "NUMBER", "now", "need", "to", "replace", "rest", "inherited", "accessors", "I", "don", "t", "think", "that", "pull", "request", "will", "be", "usefull", "right", "now", "NUMBER", "There", "be", "NUMBER", "more", "inherited", "accessors", "left", "NUMBER", "Trying", "to", "deal", "with", "it", "too", "NUMBER", "Sure", "i", "will", "NUMBER", "If", "i", "will", "complete", "it", "first", "NUMBER", "Right", "now", "i", "change", "_storage", "inherited", "accessor", "and", "stuck", "on", "version", "and", "version_names", "NUMBER", "Ehrm", "NUMBER", "Seems", "like", "i", "need", "help", "with", "version", "and", "version_names", "NUMBER", "You", "can", "checkout", "my", "fork", "to", "use", "already", "fix", "_storage", "and", "processors", "version", "NUMBER", "My", "problem", "that", "when", "i", "tried", "to", "do", "something", "with", "version", "test", "fail", "with", "stack", "level", "too", "deep", "NUMBER", "I", "discover", "that", "it", "happens", "right", "on", "class", "NUMBER", "image", "some_image_object", "NUMBER", "I", "ll", "try", "to", "do", "something", "with", "it", "a", "few", "days", "later", "if", "someone", "won", "t", "fix", "it", "NUMBER", "Also", "NUMBER", "I", "have", "question", "to", "josevalim", "NUMBER", "Maybe", "it", "may", "help", "me", "NUMBER", "Using", "class_inheritable_accessor", "we", "have", "disabled", "instance_reader", "and", "created", "it", "manually", "LINK", "L", "NUMBER", "But", "use", "class_attribute", "this", "method", "not", "call", "NUMBER", "I", "think", "this", "method", "not", "overriding", "default", "instance", "reader", "NUMBER", "Can", "you", "tell", "where", "problem", "be", "Added", "pull", "request", "for", "version_names", "LINK", "Still", "looking", "at", "version", "NUMBER", "The", "main", "proble", "in", "LINK", "L", "NUMBER", "as", "i", "said", "before", "NUMBER", "It", "s", "never", "call", "use", "class_attribute", "NUMBER", "I", "ve", "tried", "to", "redefine", "method", "version", "as", "__versions", "and", "fix", "all", "call", "to", "it", "NUMBER", "So", "all", "test", "pass", "use", "class_inheritable_accessor", "but", "after", "change", "it", "to", "class_attribute", "with", "all", "fix", "relate", "to", "inplace", "modifying", "some", "test", "still", "gives", "stack", "level", "too", "deep", "NUMBER", "I", "still", "think", "that", "problem", "in", "overriding", "instance", "reader", "NUMBER", "Don", "t", "know", "why", "it", "not", "works", "NUMBER", "dmathieu", "implement", "in", "this", "pull", "LINK", "the", "Remove", "the", "cached", "file", "after", "storing", "it", "feature", "NUMBER", "But", "after", "removal", "of", "the", "file", "an", "empty", "directory", "with", "the", "upload", "timestamp", "be", "left", "behind", "filling", "the", "cache", "storage", "with", "empty", "directories", "NUMBER", "The", "Carrierwave", "NUMBER", "clean_cached_files", "feature", "helps", "a", "little", "but", "it", "would", "be", "nice", "to", "have", "these", "directories", "remove", "along", "with", "the", "file", "NUMBER", "I", "think", "this", "has", "be", "discussed", "before", "NUMBER", "Can", "you", "search", "around", "and", "see", "what", "you", "find", "There", "be", "discussions", "about", "deleting", "the", "cached", "file", "but", "nothing", "about", "the", "companion", "directory", "that", "goes", "along", "NUMBER", "As", "I", "said", "dmathieu", "s", "patch", "for", "remove", "cached", "file", "that", "have", "be", "moved", "to", "storage", "deletes", "only", "the", "file", "file", "NUMBER", "delete", "if", "delete_file_after_storage", "but", "not", "the", "companion", "directory", "say", "something", "like", "if", "delete_file_after_storage", "file", "NUMBER", "delete", "tmp", "uploads", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "myfile", "NUMBER", "txt", "TAG", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "TAG", "NUMBER", "end", "end", "I", "be", "not", "setup", "to", "run", "all", "the", "test", "cases", "but", "be", "happy", "to", "help", "get", "this", "resolve", "NUMBER", "Does", "anyone", "more", "familiar", "with", "this", "code", "have", "any", "suggestions", "as", "to", "whether", "or", "not", "this", "be", "a", "sane", "approach", "I", "was", "just", "looking", "into", "this", "actually", "NUMBER", "I", "m", "reopening", "this", "issue", "for", "now", "NUMBER", "Perhaps", "we", "should", "change", "the", "default", "NUMBER", "I", "m", "not", "sure", "if", "run", "through", "the", "cache_dir", "looking", "for", "file", "will", "be", "slow", "NUMBER", "Give", "it", "some", "thought", "and", "put", "something", "together", "if", "you", "have", "time", "NUMBER", "Thank", "you", "trevorturk", "Thanks", "NUMBER", "what", "do", "you", "think", "about", "use", "Dir", "NUMBER", "rmdir", "path", "instead", "of", "FileUtils", "NUMBER", "rm_rf", "path", "and", "then", "catching", "the", "specific", "exception", "for", "dir", "do", "not", "exist", "be", "not", "a", "dir", "and", "be", "not", "empty", "E", "NUMBER", "g", "NUMBER", "something", "like", "this", "ruby", "Deletes", "a", "cache", "id", "tmp", "dir", "in", "cache", "def", "delete_cache_id", "if", "cache_id", "path", "File", "NUMBER", "expand_path", "File", "NUMBER", "join", "cache_dir", "cache_id", "CarrierWave", "NUMBER", "root", "begin", "Dir", "NUMBER", "rmdir", "path", "rescue", "Errno", "ENOENT", "puts", "Cache", "dir", "do", "not", "exist", "path", "rescue", "Errno", "ENOTDIR", "puts", "Cache", "dir", "be", "not", "a", "dir", "path", "rescue", "Errno", "ENOTEMPTY", "puts", "Cache", "dir", "be", "not", "empty", "path", "end", "end", "end", "I", "tried", "this", "out", "by", "just", "hacking", "it", "into", "my", "install", "gem", "source", "and", "it", "seems", "to", "be", "doing", "exactly", "what", "I", "want", "NUMBER", "When", "I", "upload", "a", "new", "file", "with", "an", "uploader", "that", "has", "NUMBER", "version", "total", "I", "see", "this", "printed", "out", "Cache", "dir", "be", "not", "empty", "Users", "scottwb", "src", "potw", "site", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "Cache", "dir", "be", "not", "empty", "Users", "scottwb", "src", "potw", "site", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "Cache", "dir", "be", "not", "empty", "Users", "scottwb", "src", "potw", "site", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "and", "afterward", "that", "directory", "be", "gone", "NUMBER", "I", "also", "confirmed", "manually", "that", "the", "temp", "directory", "lives", "long", "enough", "to", "take", "advantage", "of", "the", "avatar_cache", "field", "for", "preserving", "the", "upload", "across", "form", "postings", "when", "a", "model", "validation", "fail", "NUMBER", "Using", "Dir", "NUMBER", "rmdir", "instead", "of", "FileUtils", "NUMBER", "rm_rf", "might", "also", "assuage", "jnicklas", "s", "concern", "about", "the", "user", "overriding", "cache_dir", "and", "unwittingly", "get", "an", "rm", "rf", "call", "on", "an", "important", "directory", "NUMBER", "Regarding", "performance", "NUMBER", "I", "haven", "t", "do", "any", "benchmarking", "nor", "be", "I", "familiar", "with", "the", "internals", "of", "Dir", "and", "File", "but", "my", "gut", "assumption", "would", "be", "that", "Dir", "NUMBER", "rmdir", "be", "executing", "native", "code", "e", "NUMBER", "g", "NUMBER", "C", "code", "calling", "POSIX", "API", "LINK", "almost", "directly", "and", "that", "system", "s", "build", "in", "checks", "would", "be", "more", "efficient", "than", "the", "two", "separate", "checks", "we", "already", "had", "there", "for", "File", "NUMBER", "exists", "and", "File", "NUMBER", "directory", "and", "would", "definitely", "be", "faster", "than", "the", "Dir", "NUMBER", "glob", "approach", "I", "mention", "earlier", "which", "could", "get", "unwieldy", "for", "large", "directories", "NUMBER", "I", "could", "whip", "this", "into", "a", "quick", "pull", "request", "if", "you", "like", "NUMBER", "If", "you", "could", "look", "into", "this", "a", "bit", "more", "and", "work", "up", "a", "pull", "request", "that", "you", "re", "confident", "in", "I", "d", "definitely", "appreciate", "it", "NUMBER", "You", "should", "be", "able", "to", "make", "a", "few", "specific", "test", "that", "would", "eliminate", "the", "concerns", "that", "jnicklas", "et", "al", "would", "be", "concerned", "about", "NUMBER", "Let", "me", "know", "if", "you", "run", "into", "any", "problem", "or", "have", "question", "but", "it", "sounds", "to", "me", "like", "you", "know", "what", "s", "going", "on", "well", "enough", "to", "give", "it", "a", "shot", "NUMBER", "Thank", "you", "I", "m", "taking", "a", "stab", "at", "this", "now", "NUMBER", "The", "first", "step", "I", "wanted", "to", "take", "be", "to", "fix", "up", "the", "specs", "surrounding", "this", "a", "bit", "so", "that", "they", "actually", "fail", "on", "the", "problem", "I", "was", "seeing", "when", "test", "in", "my", "app", "NUMBER", "I", "made", "a", "guess", "above", "that", "the", "specs", "for", "this", "pass", "because", "of", "a", "cwd", "assumption", "NUMBER", "It", "turns", "out", "the", "specs", "for", "this", "pass", "because", "the", "offending", "code", "was", "never", "call", "it", "was", "stubbed", "out", "NUMBER", "Here", "be", "a", "change", "I", "made", "just", "the", "spec", "that", "was", "passing", "when", "it", "shouldn", "t", "be", "LINK", "Note", "that", "I", "have", "departed", "a", "bit", "from", "the", "style", "of", "this", "spec", "NUMBER", "Instead", "of", "stubbing", "the", "call", "to", "delete_cache_id", "I", "let", "it", "get", "call", "and", "assert", "that", "the", "cache", "directory", "exists", "before", "store", "and", "do", "not", "exist", "after", "it", "NUMBER", "Also", "just", "to", "be", "explicit", "I", "confirm", "that", "its", "parent", "dir", "do", "NOT", "get", "delete", "NUMBER", "To", "do", "so", "I", "had", "to", "violate", "the", "black", "box", "nature", "of", "this", "spec", "a", "bit", "too", "in", "order", "to", "figure", "out", "the", "path", "to", "the", "cache", "directory", "we", "re", "test", "since", "that", "be", "privately", "encapsulated", "NUMBER", "I", "understand", "that", "this", "might", "be", "a", "bit", "of", "a", "maintenance", "hazard", "but", "I", "didn", "t", "have", "any", "better", "ideas", "that", "weren", "t", "a", "lot", "more", "disruptive", "NUMBER", "I", "m", "probably", "going", "to", "have", "to", "do", "stuff", "like", "this", "to", "fully", "test", "out", "what", "be", "and", "be", "not", "get", "delete", "and", "wanted", "to", "make", "sure", "you", "re", "on", "board", "with", "this", "philosophy", "of", "test", "before", "going", "too", "much", "further", "NUMBER", "Yeah", "just", "give", "it", "your", "best", "shot", "NUMBER", "If", "you", "re", "giving", "the", "test", "this", "much", "though", "then", "chances", "be", "they", "ll", "be", "good", "test", "NUMBER", "Sent", "pull", "request", "for", "this", "LINK", "Thanks", "I", "ll", "look", "at", "this", "ASAP", "unless", "someone", "else", "beats", "me", "to", "it", "NUMBER", "Thanks", "guys", "thumbsup", "Before", "I", "mount", "an", "uploader", "to", "my", "models", "file", "mount_uploader", "waveform", "ImageUploader", "I", "can", "use", "to_xml", "which", "works", "great", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "r", "NUMBER", "to_xml", "TAG", "n", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "_Fri_", "NUMBER", "NUMBER", "NUMBER", "TAG", "n", "TAG", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "TAG", "n", "TAG", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "NUMBER", "TAG", "n", "TAG", "LINK", "_project", "ogg", "NUMBER", "_Fri", "png", "NUMBER", "_Fri_", "NUMBER", "NUMBER", "NUMBER", "ogg", "NUMBER", "png", "TAG", "n", "TAG", "TAG", "n", "TAG", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "TAG", "n", "TAG", "NUMBER", "NUMBER", "NUMBER", "T", "NUMBER", "NUMBER", "NUMBER", "Z", "TAG", "n", "TAG", "TAG", "n", "TAG", "TAG", "n", "TAG", "n", "However", "when", "I", "mount", "an", "uploader", "I", "get", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "r", "NUMBER", "to_xml", "TypeError", "can", "t", "convert", "nil", "into", "String", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "block", "in", "method_missing", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "each", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "tag", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activesupport", "lib", "active_support", "xml_mini", "NUMBER", "rb", "NUMBER", "in", "to_tag", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activemodel", "lib", "active_model", "serializers", "xml", "NUMBER", "rb", "NUMBER", "in", "block", "in", "add_attributes_and_methods", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activemodel", "lib", "active_model", "serializers", "xml", "NUMBER", "rb", "NUMBER", "in", "each", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activemodel", "lib", "active_model", "serializers", "xml", "NUMBER", "rb", "NUMBER", "in", "add_attributes_and_methods", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activemodel", "lib", "active_model", "serializers", "xml", "NUMBER", "rb", "NUMBER", "in", "block", "in", "serialize", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "call", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "_nested_structures", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "usr", "local", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "builder", "NUMBER", "lib", "builder", "xmlbase", "NUMBER", "rb", "NUMBER", "in", "tag", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activemodel", "lib", "active_model", "serializers", "xml", "NUMBER", "rb", "NUMBER", "in", "serialize", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "activerecord", "lib", "active_record", "serializers", "xml_serializer", "NUMBER", "rb", "NUMBER", "in", "to_xml", "from", "irb", "NUMBER", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "railties", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "railties", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "home", "xanview", "NUMBER", "NUMBER", "bundler", "ruby", "NUMBER", "rails", "d", "NUMBER", "c", "NUMBER", "c", "NUMBER", "b", "railties", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "I", "was", "able", "to", "confirm", "and", "reproduce", "your", "issue", "by", "producing", "fail", "test", "here", "LINK", "We", "ll", "look", "into", "it", "thanks", "for", "the", "report", "NUMBER", "Thanks", "for", "the", "super", "fast", "reply", "and", "the", "new", "unit", "test", "for", "this", "Can", "t", "wait", "for", "a", "fix", "CarrierWave", "rules", "What", "be", "cause", "the", "issue", "seems", "kind", "of", "serious", "as", "all", "my", "views", "respond", "to", "xml", "request", "and", "if", "I", "use", "CarrierWave", "it", "breaks", "all", "of", "them", "hackeron", "we", "re", "not", "sure", "NUMBER", "I", "m", "going", "to", "reopen", "for", "now", "but", "I", "spent", "some", "time", "on", "this", "and", "couldn", "t", "sort", "it", "out", "either", "NUMBER", "Help", "wanted", "Hrm", "NUMBER", "I", "m", "not", "a", "huge", "fan", "NUMBER", "Do", "you", "think", "it", "s", "the", "only", "way", "to", "get", "around", "this", "I", "m", "not", "sure", "NUMBER", "maybe", "we", "can", "send", "nil", "if", "the", "uploader", "be", "blank", "somehow", "I", "can", "have", "a", "look", "eventually", "if", "you", "re", "sick", "of", "work", "on", "it", "NUMBER", "This", "bug", "was", "biting", "me", "big", "time", "NUMBER", "Placing", "this", "in", "the", "model", "made", "life", "sweet", "again", "mount_uploader", "logo", "LogoUploader", "def", "to_xml", "options", "options", "NUMBER", "merge", "except", "logo", "super", "options", "end", "Yeah", "that", "should", "work", "for", "now", "as", "long", "as", "it", "doesn", "t", "raise", "an", "exception", "anymore", "NUMBER", "as_json", "be", "generate", "from", "serializable_hash", "but", "to_xml", "be", "not", "and", "there", "s", "no", "such", "thing", "as", "as_xml", "NUMBER", "The", "docs", "on", "this", "be", "all", "pretty", "terrible", "with", "Rails", "see", "the", "inline", "docs", "at", "LINK", "_model", "serialization", "NUMBER", "rb", "Everything", "points", "to", "the", "fact", "that", "both", "XML", "and", "JSON", "use", "serializable_hash", "but", "sadly", "they", "re", "very", "inconsistent", "NUMBER", "Hopefully", "someone", "on", "the", "Google", "Group", "can", "help", "NUMBER", "Here", "s", "a", "hacktastic", "thought", "NUMBER", "I", "saw", "the", "hack", "to", "make", "to_xml", "return", "nil", "NUMBER", "What", "if", "you", "try", "make", "it", "something", "like", "ruby", "def", "to_xml", "options", "nil", "JSON", "NUMBER", "parse", "self", "NUMBER", "to_json", "NUMBER", "to_xml", "end", "I", "just", "did", "a", "quick", "test", "with", "my", "User", "model", "which", "uses", "CarrierWave", "to", "mount", "on", "a", "column", "named", "avatar", "that", "has", "a", "version", "named", "square", "NUMBER", "Check", "this", "out", "ree", "NUMBER", "NUMBER", "NUMBER", "puts", "JSON", "NUMBER", "parse", "User", "NUMBER", "first", "NUMBER", "to_json", "NUMBER", "to_xml", "TAG", "TAG", "TAG", "TAG", "Scott", "W", "NUMBER", "Bradley", "TAG", "TAG", "TAG", "LINK", "TAG", "TAG", "TAG", "LINK", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "me", "example", "NUMBER", "com", "TAG", "TAG", "TAG", "nil", "ree", "NUMBER", "NUMBER", "NUMBER", "I", "dunno", "if", "you", "d", "be", "happy", "committing", "this", "but", "it", "might", "be", "better", "than", "nil", "NUMBER", "or", "at", "least", "help", "out", "hackeron", "with", "his", "immediate", "problem", "NUMBER", "Yeah", "I", "ll", "take", "a", "shot", "at", "it", "NUMBER", "It", "might", "be", "a", "few", "days", "before", "I", "can", "really", "dive", "in", "so", "bump", "me", "if", "you", "don", "t", "hear", "from", "me", "in", "a", "week", "NUMBER", "Bump", "scottwb", "NUMBER", "Hitting", "this", "issue", "too", "NUMBER", "I", "have", "NUMBER", "condtitional", "version", "version", "photo_of_the_week", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "protected", "def", "landscape", "img", "is_landscape", "begin", "puts", "img", "pic", "Magick", "Image", "NUMBER", "read", "img", "NUMBER", "path", "NUMBER", "first", "pic", "NUMBER", "columns", "pic", "NUMBER", "rows", "end", "end", "def", "portrait", "img", "return", "landscape", "img", "end", "Once", "I", "call", "the", "recreate_versions", "method", "on", "the", "uploader", "this", "will", "output", "the", "following", "s", "NUMBER", "picture", "NUMBER", "recreate_versions", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "TAG", "nil", "So", "in", "addition", "of", "ask", "myself", "why", "the", "NIL", "be", "be", "pass", "I", "also", "wonder", "why", "we", "need", "the", "if", "condition", "be", "call", "so", "many", "times", "Is", "the", "gem", "not", "caching", "the", "value", "Tried", "to", "fix", "this", "in", "my", "own", "branch", "forked", "from", "gucki", "NUMBER", "Will", "ask", "him", "to", "check", "and", "reopen", "once", "this", "be", "confirmed", "to", "be", "work", "NUMBER", "So", "far", "my", "branch", "works", "well", "for", "me", "and", "I", "will", "come", "back", "with", "more", "info", "once", "deployed", "to", "the", "staging", "server", "where", "the", "function", "will", "be", "test", "by", "around", "NUMBER", "people", "for", "NUMBER", "days", "NUMBER", "The", "uploader", "configuration", "I", "m", "use", "encoding", "utf", "NUMBER", "require", "carrierwave", "processing", "mini_magick", "class", "SubmissionUploader", "TAG", "NUMBER", "NUMBER", "process", "convert", "jpg", "version", "photo_of_the_week", "if", "is_pow_and_landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "if_pow_and_portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "protected", "def", "is_pow_and_landscape", "img", "obj", "nil", "obj", "NUMBER", "is_photo_of_the_week", "and", "landscape", "img", "obj", "end", "def", "if_pow_and_portrait", "img", "obj", "nil", "obj", "NUMBER", "is_photo_of_the_week", "and", "portrait", "img", "obj", "end", "def", "landscape", "img", "obj", "nil", "is_landscape", "begin", "pic", "Magick", "Image", "NUMBER", "read", "img", "NUMBER", "path", "NUMBER", "first", "pic", "NUMBER", "columns", "pic", "NUMBER", "rows", "end", "end", "def", "portrait", "img", "obj", "nil", "return", "landscape", "img", "obj", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "I", "m", "pretty", "happy", "to", "add", "the", "obj", "as", "if", "argument", "now", "NUMBER", "Finally", "can", "save", "space", "NUMBER", "Would", "it", "be", "possible", "to", "set", "the", "file", "owner", "in", "addition", "to", "the", "permission", "somewhere", "in", "the", "initializer", "uploader", "I", "have", "the", "case", "that", "a", "downloader", "script", "be", "run", "as", "a", "certain", "user", "and", "needs", "the", "file", "to", "be", "write", "in", "the", "UID", "of", "the", "nginx", "user", "NUMBER", "Same", "be", "true", "for", "the", "system", "uploads", "sub", "folders", "NUMBER", "Would", "also", "start", "work", "on", "a", "patch", "just", "like", "to", "know", "whether", "this", "be", "a", "candiate", "to", "include", "NUMBER", "Hmm", "NUMBER", "maybe", "jnicklas", "has", "an", "opinion", "but", "I", "d", "think", "it", "would", "be", "smart", "for", "you", "to", "just", "run", "all", "of", "the", "parts", "of", "your", "app", "as", "the", "same", "user", "and", "then", "this", "wouldn", "t", "be", "an", "issue", "NUMBER", "Perhaps", "NUMBER", "Think", "I", "could", "use", "the", "after_save", "function", "in", "the", "model", "NUMBER", "Thanks", "for", "your", "support", "NUMBER", "Can", "you", "give", "an", "example", "for", "after_save", "Hi", "I", "ve", "Changed", "the", "path", "to", "store", "file", "images", "like", "home", "hamid", "Desktop", "uploads", "model", "NUMBER", "class", "NUMBER", "to_s", "NUMBER", "underscore", "mounted_as", "model", "NUMBER", "id", "it", "be", "storing", "well", "but", "when", "I", "try", "to", "retrieve", "it", "then", "it", "will", "not", "show", "those", "images", "instead", "of", "just", "showing", "their", "titles", "NUMBER", "e", "NUMBER", "g", "image", "NUMBER", "Thumb_image", "NUMBER", "Small_image", "NUMBER", "Tiny_image", "NUMBER", "And", "if", "I", "see", "the", "path", "via", "firebug", "of", "that", "image", "it", "be", "also", "correct", "NUMBER", "I", "be", "use", "ubuntu", "please", "let", "me", "know", "what", "be", "actually", "the", "problem", "thanks", "NUMBER", "src", "home", "hamid", "Desktop", "uploads", "user", "avatar", "NUMBER", "image", "NUMBER", "jpg", "I", "think", "your", "problem", "may", "be", "use", "the", "model", "NUMBER", "id", "LINK", "L", "NUMBER", "NUMBER", "but", "I", "m", "not", "sure", "NUMBER", "I", "doubt", "this", "be", "a", "bug", "in", "Carrierwave", "so", "if", "you", "continue", "to", "have", "trouble", "please", "try", "the", "Google", "Group", "NUMBER", "If", "you", "re", "sure", "it", "s", "an", "issue", "read", "the", "get", "help", "section", "of", "the", "Wiki", "so", "we", "can", "more", "easily", "help", "NUMBER", "It", "be", "saving", "accurate", "ids", "as", "per", "model", "and", "URL", "be", "also", "accurate", "so", "I", "think", "problem", "be", "with", "the", "carrierwave", "as", "when", "I", "paste", "the", "src", "s", "url", "in", "the", "browser", "then", "it", "give", "me", "image", "NUMBER", "Hi", "Jonas", "I", "m", "looking", "into", "putting", "together", "new", "relic", "instrumentation", "for", "Carrierwave", "following", "the", "one", "do", "for", "Paperclip", "LINK", "_contrib", "blob", "master", "lib", "rpm_contrib", "instrumentation", "paperclip", "NUMBER", "rb", "It", "looks", "simple", "enough", "Just", "not", "sure", "what", "exactly", "to", "trace", "in", "Carrierwave", "and", "would", "like", "to", "check", "with", "you", "first", "which", "methods", "would", "be", "good", "to", "get", "stats", "on", "thanks", "Oliver", "Added", "support", "for", "Padrino", "Framework", "I", "add", "ActiveRecord", "because", "Padrino", "be", "ORM", "Agnostic", "and", "can", "use", "also", "this", "other", "than", "DataMapper", "MongoMapper", "Mongoid", "MongoMapper", "Couchrest", "etc", "NUMBER", "I", "appreciate", "you", "work", "on", "this", "but", "I", "think", "this", "be", "better", "suited", "for", "an", "entry", "in", "the", "wiki", "NUMBER", "It", "s", "so", "simple", "to", "do", "the", "requiring", "yourself", "that", "I", "don", "t", "want", "to", "add", "the", "extra", "code", "into", "CarrierWave", "itself", "NUMBER", "Please", "consider", "add", "a", "section", "to", "the", "wiki", "NUMBER", "Thanks", "trevorturk", "sorry", "but", "you", "have", "code", "for", "sinatra", "and", "merb", "there", "be", "anyone", "that", "today", "uses", "merb", "That", "be", "perfectly", "simple", "as", "padrino", "NUMBER", "So", "why", "not", "remove", "all", "jnicklas", "LINK", "L", "NUMBER", "super", "simple", "NUMBER", "why", "Isn", "t", "Padrino", "based", "on", "Sinatra", "anyway", "I", "m", "just", "not", "really", "happy", "about", "add", "more", "stuff", "into", "Carrierwave", "about", "different", "frameworks", "ORMs", "etc", "when", "we", "re", "trying", "to", "extract", "things", "lately", "NUMBER", "I", "ll", "reopen", "and", "jnicklas", "can", "have", "a", "look", "as", "well", "NUMBER", "trevorturk", "thanks", "so", "much", "bensie", "and", "why", "should", "not", "be", "the", "same", "for", "a", "dead", "framework", "like", "merb", "Why", "shouldn", "t", "be", "the", "same", "for", "sinatra", "that", "require", "less", "lines", "than", "us", "Tell", "me", "NUMBER", "I", "m", "not", "NUMBER", "sure", "of", "my", "stance", "on", "this", "I", "agree", "with", "bensie", "that", "we", "don", "t", "want", "to", "give", "the", "impression", "of", "official", "support", "and", "lately", "we", "ve", "moved", "a", "lot", "of", "stuff", "out", "of", "CarrierWave", "which", "makes", "it", "seem", "strange", "to", "put", "a", "lot", "of", "new", "stuff", "in", "NUMBER", "It", "s", "worth", "noting", "that", "CarrierWave", "was", "originally", "call", "Merb", "Upload", "check", "the", "early", "commit", "it", "s", "true", "so", "there", "s", "a", "historical", "reason", "for", "the", "Merb", "support", "it", "use", "to", "_not_", "support", "Rails", "I", "m", "not", "sure", "the", "Sinatra", "stuff", "has", "ever", "really", "worked", "anyway", "so", "I", "m", "probably", "NUMBER", "on", "this", "request", "as", "well", "NUMBER", "DAddYE", "sorry", "about", "that", "Thanks", "for", "your", "interest", "in", "improving", "Carrierwave", "though", "NUMBER", "We", "definitely", "appreciate", "it", "NUMBER", "before", "NUMBER", "I", "just", "extracted", "mongoid", "to", "a", "separate", "gem", "and", "write", "jnicklas", "an", "email", "about", "it", "NUMBER", "Cool", "I", "think", "it", "might", "be", "smart", "to", "put", "into", "the", "jnicklas", "account", "but", "he", "can", "share", "commit", "access", "etc", "easily", "NUMBER", "Yeah", "that", "s", "one", "of", "the", "points", "I", "mention", "in", "my", "email", "to", "him", "gucki", "any", "movement", "on", "this", "I", "d", "like", "to", "get", "the", "Mongoid", "stuff", "living", "under", "github", "jnicklas", "for", "consistency", "but", "it", "s", "not", "necessarily", "necessary", "Ah", "awesome", "Anyone", "want", "to", "do", "the", "honors", "of", "remove", "Mongoid", "support", "from", "this", "repo", "and", "add", "a", "link", "to", "the", "readme", "wiki", "Damn", "you", "know", "NUMBER", "we", "re", "miss", "some", "DM", "stuff", "like", "what", "did", "made", "for", "remove", "previously", "stored", "file", "in", "NUMBER", "Any", "chance", "you", "can", "try", "to", "reconcile", "that", "gucki", "I", "m", "not", "sure", "actually", "NUMBER", "I", "didn", "t", "know", "LINK", "mongoid", "existed", "until", "you", "mention", "it", "NUMBER", "I", "ve", "pinged", "jnicklas", "and", "gucki", "and", "asked", "them", "what", "s", "up", "NUMBER", "gucki", "said", "he", "ll", "have", "free", "time", "again", "soon", "so", "I", "m", "hoping", "he", "ll", "sort", "things", "out", "NUMBER", "Re", "LINK", "jnicklas", "and", "josevalim", "let", "me", "know", "what", "you", "think", "about", "this", "NUMBER", "I", "did", "some", "work", "on", "the", "plane", "and", "I", "think", "it", "s", "nearly", "ready", "to", "merge", "NUMBER", "Sweet", "it", "looks", "good", "imo", "Is", "there", "something", "else", "I", "need", "to", "do", "How", "can", "I", "help", "And", "thanks", "a", "lot", "josevalim", "thanks", "for", "looking", "jnicklas", "can", "you", "give", "this", "a", "quick", "review", "and", "let", "me", "know", "what", "you", "think", "I", "just", "want", "one", "more", "sanity", "check", "before", "I", "merge", "into", "master", "trevorturk", "if", "I", "understand", "correctly", "you", "fetch", "the", "old", "record", "from", "the", "database", "memorize", "it", "and", "then", "call", "destroy", "on", "the", "uploaders", "if", "the", "update", "was", "successfull", "and", "the", "new", "path", "and", "old", "storage", "path", "be", "different", "NUMBER", "Imo", "this", "looks", "more", "like", "a", "hack", "than", "a", "proper", "solution", "to", "the", "problem", "NUMBER", "I", "think", "carrierwave", "should", "never", "to", "any", "querying", "on", "the", "database", "NUMBER", "Why", "not", "just", "remember", "the", "path", "instead", "of", "the", "whole", "model", "gucki", "I", "appreciate", "your", "concern", "but", "this", "issue", "has", "be", "around", "a", "long", "long", "time", "and", "nobody", "has", "find", "a", "better", "solution", "as", "far", "as", "I", "know", "NUMBER", "If", "you", "want", "to", "take", "another", "shot", "please", "fork", "this", "and", "or", "start", "up", "a", "new", "branch", "and", "improve", "the", "implementation", "and", "make", "sure", "the", "test", "pass", "then", "we", "can", "have", "a", "look", "at", "actual", "code", "alternatives", "instead", "of", "just", "chatting", "about", "it", "NUMBER", "trevorturk", "I", "think", "the", "patch", "looks", "good", "but", "just", "rembering", "the", "path", "and", "not", "the", "whole", "model", "would", "be", "enough", "NUMBER", "Can", "you", "easily", "make", "it", "this", "way", "If", "not", "I", "can", "try", "in", "my", "fork", "NUMBER", "gucki", "feel", "free", "to", "fork", "and", "try", "to", "improve", "You", "can", "also", "start", "a", "new", "temporary", "branch", "in", "the", "jnicklas", "repo", "NUMBER", "I", "like", "it", "work", "well", "here", "NUMBER", "Awesome", "Yeah", "improvement", "more", "than", "welcome", "I", "just", "wanted", "to", "get", "it", "work", "and", "well", "test", "NUMBER", "Perhaps", "someone", "will", "want", "to", "add", "this", "for", "mongoid", "too", "NUMBER", "If", "should", "work", "out", "of", "the", "box", "actually", "they", "d", "just", "need", "to", "add", "callbacks", "and", "test", "NUMBER", "Tks", "Trevor", "TAG", "git", "github", "NUMBER", "com", "jnicklas", "carrierwave", "NUMBER", "git", "NUMBER", "Mainly", "I", "m", "use", "the", "conditional", "version", "NUMBER", "I", "have", "a", "symptom", "that", "images", "be", "not", "created", "based", "on", "the", "original", "image", "but", "it", "seems", "they", "be", "created", "on", "a", "version", "themselves", "NUMBER", "Here", "be", "my", "complete", "uploader", "encoding", "utf", "NUMBER", "require", "carrierwave", "processing", "mini_magick", "class", "SubmissionUploader", "TAG", "NUMBER", "NUMBER", "version", "photo_of_the_week", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "protected", "def", "landscape", "img", "unless", "defined", "pic_is_landscape", "pic", "Magick", "Image", "NUMBER", "read", "img", "NUMBER", "path", "NUMBER", "first", "pic_is_landscape", "pic", "NUMBER", "columns", "pic", "NUMBER", "rows", "end", "pic_is_landscape", "end", "def", "portrait", "img", "return", "landscape", "img", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "I", "m", "not", "able", "to", "upload", "pictures", "to", "github", "to", "demonstrate", "though", "NUMBER", "Hmm", "NUMBER", "That", "s", "bad", "NUMBER", "Jonas", "or", "I", "will", "look", "as", "soon", "as", "we", "have", "time", "but", "if", "you", "care", "to", "dig", "into", "this", "yourself", "please", "do", "Sorry", "for", "the", "delay", "but", "I", "ve", "be", "real", "busy", "NUMBER", "I", "m", "going", "to", "work", "on", "this", "_now_", "gucki", "holler", "if", "when", "you", "run", "into", "any", "trouble", "on", "this", "NUMBER", "Thanks", "so", "much", "for", "looking", "at", "it", "ened", "I", "created", "a", "small", "rails", "NUMBER", "test", "application", "LINK", "test", "rails", "NUMBER", "and", "tried", "to", "reproduce", "your", "problem", "but", "for", "me", "everything", "works", "fine", "NUMBER", "The", "version", "be", "all", "generate", "from", "the", "correct", "scope", "original", "here", "and", "dont", "look", "blurry", "NUMBER", "To", "check", "clone", "the", "repository", "mention", "above", "NUMBER", "Then", "rails", "c", "u", "User", "NUMBER", "create", "u", "NUMBER", "image", "File", "NUMBER", "new", "public", "images", "test", "NUMBER", "jpg", "u", "NUMBER", "save", "Then", "go", "into", "public", "uploads", "and", "have", "a", "look", "at", "the", "generate", "file", "NUMBER", "You", "can", "safely", "remove", "anything", "in", "public", "uploads", "if", "you", "want", "to", "try", "again", "NUMBER", "Hi", "Gucki", "I", "tried", "with", "this", "uploader", "version", "photo_of_the_week", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "And", "the", "problem", "re", "occured", "even", "with", "your", "picture", "NUMBER", "Did", "you", "try", "it", "in", "a", "project", "of", "yours", "or", "with", "my", "demo", "project", "mention", "above", "I", "add", "the", "two", "photo_of_the_week", "version", "to", "my", "demo", "project", "but", "still", "everything", "works", "fine", "NUMBER", "So", "that", "I", "ll", "be", "able", "to", "reproduce", "the", "problem", "please", "clone", "my", "demo", "application", "make", "your", "needed", "change", "to", "reproduce", "the", "problem", "and", "then", "push", "it", "so", "that", "i", "can", "clone", "it", "NUMBER", "Thanks", "With", "yours", "NUMBER", "Please", "take", "a", "look", "at", "LINK", "test", "rails", "NUMBER", "In", "your", "Gemfile", "you", "be", "use", "the", "jnikclas", "version", "of", "carrierwave", "NUMBER", "With", "this", "one", "I", "get", "the", "same", "error", "NUMBER", "After", "change", "it", "to", "gucki", "carrierwave", "it", "works", "gucki", "do", "that", "mean", "there", "s", "a", "problem", "with", "jnicklas", "carrierwave", "If", "so", "please", "do", "fix", "It", "seems", "so", "NUMBER", "I", "just", "want", "to", "wait", "for", "jnicklas", "answer", "to", "my", "email", "so", "I", "can", "pull", "my", "master", "NUMBER", "I", "d", "then", "start", "work", "on", "the", "jnicklas", "repo", "itself", "from", "now", "on", "gucki", "confirming", "that", "it", "works", "with", "your", "branch", "yehaaa", "NUMBER", "gucki", "yeah", "I", "think", "jnicklas", "pull", "in", "your", "work", "but", "then", "there", "s", "this", "bug", "NUMBER", "So", "if", "you", "can", "figure", "out", "what", "s", "up", "that", "would", "be", "great", "NUMBER", "Thank", "you", "trevorturk", "yeah", "currentl", "I", "m", "not", "completely", "sure", "what", "s", "wrong", "with", "jnicklas", "master", "NUMBER", "But", "I", "ll", "figure", "it", "out", "once", "my", "fork", "be", "fully", "pull", "NUMBER", "I", "m", "closing", "this", "for", "now", "we", "can", "reopen", "if", "the", "error", "comes", "back", "after", "my", "fork", "has", "be", "fully", "pull", "NUMBER", "I", "think", "your", "fork", "be", "fully", "pull", "and", "jnicklas", "had", "to", "do", "some", "work", "to", "fix", "bug", "we", "run", "into", "NUMBER", "Leave", "this", "open", "for", "now", "NUMBER", "One", "of", "you", "be", "going", "to", "have", "to", "figure", "it", "out", "probably", "NUMBER", "If", "you", "want", "please", "consider", "open", "a", "pull", "request", "that", "suggested", "a", "change", "NUMBER", "I", "don", "t", "think", "jnicklas", "knows", "what", "else", "needs", "to", "be", "do", "NUMBER", "gucki", "be", "your", "fork", "containing", "only", "the", "version", "stuff", "Cuz", "I", "m", "in", "quite", "a", "need", "for", "the", "conditions", "NUMBER", "please", "don", "t", "close", "this", "issue", "yet", "btw", "NUMBER", "gucki", "any", "progress", "on", "this", "I", "think", "it", "s", "going", "to", "require", "help", "from", "you", "if", "possible", "trevortuk", "No", "not", "yet", "as", "I", "didnt", "get", "any", "reply", "from", "jnicklas", "yet", "NUMBER", "As", "I", "didnt", "do", "anything", "bad", "in", "my", "code", "I", "think", "so", "at", "least", "_g_", "be", "it", "ok", "if", "I", "pull", "my", "branch", "now", "and", "then", "try", "to", "fix", "all", "outstanding", "issue", "on", "master", "directly", "gucki", "I", "d", "prefer", "if", "you", "make", "a", "new", "temporary", "branch", "to", "work", "in", "just", "to", "avoid", "confusing", "things", "NUMBER", "Thanks", "for", "looking", "I", "definitely", "appreciate", "it", "gucki", "I", "think", "to", "have", "some", "more", "progress", "on", "this", "issue", "NUMBER", "When", "use", "the", "rails", "console", "to", "recreate", "the", "version", "it", "works", "fine", "NUMBER", "When", "use", "the", "controller", "to", "call", "recreate_versions", "on", "the", "picture", "it", "will", "create", "the", "blurred", "images", "NUMBER", "Trying", "to", "find", "the", "problem", "NUMBER", "crazy", "stuff", "NUMBER", "What", "the", "NUMBER", "Once", "I", "change", "the", "order", "of", "the", "version", "it", "seems", "to", "work", "fine", "NUMBER", "This", "be", "how", "the", "uploader", "reads", "now", "encoding", "utf", "NUMBER", "require", "carrierwave", "processing", "mini_magick", "class", "SubmissionUploader", "TAG", "NUMBER", "NUMBER", "process", "convert", "jpg", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week", "if", "is_pow_and_landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "if_pow_and_portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "protected", "def", "is_pow_and_landscape", "img", "obj", "nil", "obj", "NUMBER", "is_photo_of_the_week", "and", "landscape", "img", "obj", "end", "def", "if_pow_and_portrait", "img", "obj", "nil", "obj", "NUMBER", "is_photo_of_the_week", "and", "portrait", "img", "obj", "end", "def", "landscape", "img", "obj", "nil", "is_landscape", "begin", "pic", "Magick", "Image", "NUMBER", "read", "img", "NUMBER", "path", "NUMBER", "first", "pic", "NUMBER", "columns", "pic", "NUMBER", "rows", "end", "end", "def", "portrait", "img", "obj", "nil", "return", "landscape", "img", "obj", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "end", "So", "this", "might", "be", "a", "problem", "with", "some", "internal", "cache", "variable", "be", "carried", "over", "from", "the", "previous", "run", "function", "NUMBER", "I", "BET", "each", "file", "be", "created", "not", "based", "on", "the", "original", "but", "on", "the", "one", "returned", "by", "the", "call", "before", "NUMBER", "Each", "successive", "version", "inherits", "the", "version", "before", "it", "make", "the", "order", "seem", "important", "when", "it", "shouldn", "t", "be", "NUMBER", "line", "NUMBER", "of", "lib", "carrierwave", "uploader", "version", "NUMBER", "rb", "contains", "uploader", "Class", "NUMBER", "new", "self", "NUMBER", "As", "carrierwave", "iterates", "through", "the", "version", "you", "have", "specified", "in", "your", "uploader", "the", "version", "that", "have", "already", "be", "processed", "be", "add", "to", "the", "Uploader", "class", "that", "you", "be", "creating", "a", "copy", "of", "NUMBER", "The", "end", "result", "be", "the", "the", "last", "version", "creates", "itself", "as", "well", "any", "version", "preceding", "it", "chronologically", "in", "the", "Uploader", "source", "NUMBER", "I", "implement", "a", "ghetto", "patch", "locally", "that", "clears", "the", "version", "hash", "from", "each", "version", "s", "uploader", "but", "I", "don", "t", "know", "if", "that", "s", "a", "valid", "fix", "for", "all", "scenarios", "NUMBER", "gucki", "any", "ideas", "on", "this", "Every", "call", "to", "Uploader", "NUMBER", "version", "update", "the", "class", "s", "version", "hash", "NUMBER", "Each", "successive", "version", "uses", "that", "Uploader", "as", "a", "superclass", "and", "so", "takes", "on", "the", "now", "change", "version", "hash", "as", "well", "NUMBER", "This", "appears", "to", "be", "the", "intended", "functionality", "of", "activesupport", "s", "class_inheritable_accessor", "with", "which", "version", "be", "defined", "NUMBER", "Keep", "in", "mind", "that", "an", "instance", "s", "version", "method", "gets", "its", "version", "based", "on", "its", "class", "s", "version", "method", "NUMBER", "Processing", "ends", "up", "occurring", "n", "n", "NUMBER", "NUMBER", "times", "NUMBER", "In", "my", "case", "I", "notice", "that", "some", "larger", "thumbnails", "were", "actually", "blown", "up", "version", "of", "smaller", "cropped", "thumbnails", "NUMBER", "Given", "the", "right", "ordering", "process", "one", "might", "never", "even", "notice", "say", "for", "example", "if", "the", "version", "were", "thumbnails", "descending", "by", "size", "NUMBER", "Is", "there", "any", "reason", "for", "subclasses", "of", "an", "Uploader", "to", "have", "its", "superclass", "s", "value", "Not", "to", "nag", "but", "any", "word", "on", "a", "fix", "This", "be", "a", "fairly", "big", "problem", "with", "the", "gem", "NUMBER", "Eleo", "I", "feel", "your", "pain", "I", "just", "don", "t", "have", "time", "to", "work", "on", "it", "and", "it", "seems", "like", "nobody", "else", "do", "either", "hasn", "t", "be", "able", "to", "figure", "it", "out", "yet", "NUMBER", "Sorry", "If", "you", "think", "you", "can", "get", "it", "sorted", "a", "pull", "request", "would", "be", "more", "than", "welcome", "I", "also", "don", "t", "have", "time", "to", "contribute", "a", "patch", "ATM", "but", "perhaps", "I", "can", "after", "my", "current", "project", "settles", "down", "NUMBER", "Until", "then", "I", "will", "re", "iterate", "what", "I", "said", "in", "issue", "NUMBER", "LINK", "issuecomment", "NUMBER", "The", "version", "process", "really", "needs", "to", "be", "marshaled", "for", "a", "number", "of", "reasons", "NUMBER", "Processing", "of", "each", "version", "should", "happen", "in", "sequence", "with", "the", "source", "file", "always", "be", "the", "parent", "of", "that", "version", "i", "NUMBER", "e", "NUMBER", "another", "version", "if", "it", "be", "nested", "or", "the", "base", "uploader", "object", "if", "not", "NUMBER", "The", "marshalling", "object", "should", "also", "be", "tasked", "with", "ensuring", "any", "post", "processing", "tasks", "cleanup", "of", "temp", "file", "for", "example", "be", "triggered", "at", "the", "appropriate", "time", "and", "should", "allow", "for", "these", "tasks", "to", "be", "deferred", "until", "a", "later", "time", "or", "skipped", "all", "together", "in", "order", "to", "play", "well", "with", "offline", "processing", "jobs", "NUMBER", "I", "ll", "take", "a", "stab", "at", "it", "NUMBER", "LINK", "address", "only", "this", "issue", "directly", "haven", "t", "looked", "into", "NUMBER", "Eleo", "thanks", "a", "lot", "for", "the", "fix", "I", "ve", "merge", "it", "now", "could", "everyone", "especially", "ened", "check", "if", "this", "be", "work", "as", "expected", "now", "Unfortunately", "it", "causes", "subclasses", "of", "Uploaders", "to", "not", "inherit", "its", "superclass", "s", "version", "although", "I", "m", "not", "entirely", "sure", "why", "not", "NUMBER", "I", "would", "have", "thought", "that", "a", "subclass", "would", "run", "through", "the", "same", "version", "s", "defined", "in", "its", "superclass", "but", "it", "doesn", "t", "seem", "to", "work", "out", "that", "way", "NUMBER", "So", "either", "I", "m", "mistaken", "on", "how", "Ruby", "class", "inheritance", "works", "or", "there", "s", "something", "else", "I", "m", "miss", "NUMBER", "Eleo", "yeah", "the", "catch", "be", "that", "the", "version", "var", "be", "defined", "on", "the", "Uploader", "class", "object", "so", "the", "sub", "class", "object", "doesn", "t", "actually", "inherit", "anything", "NUMBER", "The", "instance", "of", "the", "sub", "class", "will", "inherit", "the", "instance", "attributes", "from", "the", "parent", "instance", "not", "class", "object", "instance", "but", "the", "actual", "instanciation", "but", "the", "two", "class", "objects", "themselves", "be", "singletons", "and", "only", "linked", "to", "indicate", "how", "the", "instances", "should", "inherit", "their", "data", "NUMBER", "It", "s", "the", "whole", "fun", "of", "classes", "be", "objects", "instances", "in", "Ruby", "NUMBER", "I", "think", "you", "need", "to", "keep", "version", "as", "a", "class_attribute", "as", "that", "do", "all", "the", "magic", "of", "checking", "up", "the", "chain", "of", "classes", "to", "get", "linked", "parent", "version", "and", "just", "have", "a", "different", "strategy", "for", "resetting", "version", "NUMBER", "I", "ve", "get", "it", "work", "on", "my", "local", "but", "I", "need", "to", "create", "some", "test", "cases", "etc", "NUMBER", "Having", "said", "that", "I", "think", "chrisbloom", "NUMBER", "be", "right", "there", "needs", "to", "be", "a", "more", "detached", "management", "of", "version", "I", "think", "NUMBER", "I", "might", "have", "more", "time", "to", "look", "at", "it", "at", "the", "start", "of", "our", "next", "iteration", "NUMBER", "For", "now", "we", "be", "only", "use", "one", "version", "and", "I", "ve", "get", "a", "nicely", "work", "version", "frozen", "NUMBER", "Right", "now", "the", "quickest", "fix", "be", "to", "undo", "my", "change", "and", "just", "do", "a", "uploader", "NUMBER", "version", "in", "the", "version", "method", "NUMBER", "I", "didn", "t", "go", "this", "route", "because", "it", "didn", "t", "feel", "right", "to", "copy", "the", "version", "and", "then", "reset", "them", "but", "I", "can", "t", "think", "of", "anything", "else", "that", "works", "NUMBER", "I", "guess", "that", "s", "why", "it", "was", "a", "class_inheritable_accessor", "to", "begin", "with", "NUMBER", "The", "entire", "version", "hash", "be", "a", "set", "of", "classes", "that", "be", "all", "just", "mutated", "copies", "of", "the", "base", "Uploader", "NUMBER", "Is", "this", "efficient", "Is", "there", "a", "better", "approach", "Something", "about", "it", "doesn", "t", "feel", "right", "to", "me", "it", "seems", "like", "a", "ton", "of", "repetitive", "data", "sitting", "around", "NUMBER", "From", "a", "configuration", "standpoint", "a", "version", "be", "typically", "one", "or", "more", "processes", "and", "maybe", "some", "overridden", "filenames", "directories", "but", "it", "spawns", "an", "entire", "Uploader", "in", "itself", "NUMBER", "I", "feel", "like", "there", "should", "be", "one", "class", "doing", "the", "heavy", "lifting", "and", "the", "version", "hash", "should", "contain", "much", "lighter", "weight", "objects", "that", "be", "use", "for", "instruction", "NUMBER", "Is", "this", "what", "chrisbloom", "NUMBER", "be", "alluding", "to", "But", "this", "be", "all", "philosophical", "NUMBER", "CarrierWave", "be", "pretty", "non", "trivial", "in", "its", "current", "state", "and", "it", "feels", "naive", "for", "me", "to", "second", "guess", "it", "NUMBER", "Screwing", "around", "with", "it", "be", "to", "presume", "that", "I", "understand", "why", "things", "be", "how", "they", "be", "which", "clearly", "I", "do", "not", "hence", "my", "bogus", "patch", "NUMBER", "Has", "anybody", "had", "a", "chance", "to", "test", "this", "yet", "I", "think", "it", "was", "the", "blocker", "for", "doing", "a", "point", "release", "which", "be", "overdue", "imo", "NUMBER", "Scheduled", "test", "for", "tomorrow", "NUMBER", "A", "little", "messy", "right", "now", "as", "I", "depend", "on", "guckis", "branch", "for", "my", "change", "that", "extend", "the", "conditional", "version", "NUMBER", "Not", "sure", "what", "you", "mean", "about", "that", "be", "there", "more", "you", "wanted", "to", "get", "into", "carrierwave", "If", "so", "please", "open", "a", "new", "issue", "NUMBER", "If", "you", "think", "things", "be", "good", "after", "test", "please", "let", "me", "know", "NUMBER", "I", "d", "like", "to", "get", "a", "release", "out", "even", "if", "it", "s", "not", "totally", "perfect", "as", "long", "as", "there", "be", "no", "major", "regressions", "if", "you", "know", "what", "I", "mean", "NUMBER", "Yeah", "there", "was", "NUMBER", "But", "it", "s", "based", "on", "guckis", "branch", "NUMBER", "I", "m", "willing", "to", "test", "any", "merge", "you", "do", "from", "his", "branch", "but", "as", "I", "forked", "his", "branch", "we", "need", "him", "to", "integrate", "my", "change", "first", "then", "continue", "right", "I", "d", "need", "a", "new", "pull", "request", "based", "on", "our", "master", "version", "with", "whatever", "additions", "you", "guys", "wanted", "then", "we", "could", "review", "NUMBER", "gucki", "any", "chance", "you", "could", "take", "a", "look", "into", "my", "stuff", "please", "then", "we", "can", "continue", "that", "trail", "NUMBER", "OK", "please", "do", "a", "new", "issue", "pull", "request", "for", "that", "stuff", "NUMBER", "For", "now", "though", "please", "do", "test", "that", "this", "issue", "has", "be", "resolve", "NUMBER", "Then", "we", "can", "get", "a", "new", "version", "out", "NUMBER", "My", "application", "test", "come", "out", "ok", "Trevor", "thanks", "for", "that", "NUMBER", "I", "hit", "a", "bunch", "of", "other", "issue", "and", "spent", "ages", "work", "out", "how", "to", "do", "the", "exact", "combination", "of", "things", "I", "want", "with", "version", "cleaning", "up", "temp", "dirs", "and", "inserting", "secure", "tokens", "into", "filenames", "but", "I", "ll", "try", "to", "update", "the", "wiki", "pages", "on", "that", "NUMBER", "I", "will", "also", "submit", "a", "pull", "request", "against", "another", "ticket", "which", "to", "do", "with", "cleaning", "up", "the", "cache_dir", "NUMBER", "matpowel", "awesome", "thanks", "for", "test", "and", "I", "look", "forward", "to", "your", "pull", "request", "and", "or", "wiki", "contributions", "Example", "image", "LINK", "Somehow", "it", "fail", "to", "upload", "NUMBER", "I", "ve", "had", "the", "same", "issue", "with", "other", "PNG", "images", "as", "well", "NUMBER", "I", "be", "use", "rmagick", "NUMBER", "version", "medium", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "What", "more", "do", "you", "need", "I", "gave", "the", "image", "and", "relevant", "uploader", "code", "NUMBER", "I", "don", "t", "use", "mailing", "lists", "and", "I", "have", "no", "intention", "to", "start", "use", "stone", "age", "technology", "NUMBER", "Thanks", "anyway", "NUMBER", "This", "pull", "request", "add", "support", "for", "conditional", "version", "NUMBER", "PS", "I", "d", "be", "very", "happy", "if", "all", "my", "pull", "request", "could", "be", "processed", "very", "soon", "so", "we", "dont", "get", "confused", "and", "too", "many", "merge", "conflict", "NUMBER", "Thanks", "I", "d", "love", "to", "test", "this", "NUMBER", "Having", "the", "same", "problem", "with", "conditional", "version", "here", "NUMBER", "Will", "checkout", "your", "branch", "NUMBER", "Great", "let", "me", "know", "how", "it", "works", "But", "how", "to", "use", "it", "Can", "you", "update", "the", "README", "NUMBER", "markdown", "and", "make", "it", "clear", "maybe", "Also", "how", "to", "reference", "the", "object", "itself", "etc", "from", "within", "the", "condition", "NUMBER", "I", "only", "update", "the", "rdoc", "inside", "the", "source", "NUMBER", "Here", "s", "an", "example", "use", "case", "class", "AttachmentUploader", "TAG", "image", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "process", "quality", "NUMBER", "process", "convert", "jpg", "end", "protected", "def", "image", "new_file", "extension", "new_file", "NUMBER", "extension", "NUMBER", "to_s", "w", "png", "jpg", "jpeg", "bmp", "gif", "tif", "tiff", "NUMBER", "include", "extension", "end", "end", "Ah", "thanks", "for", "that", "NUMBER", "I", "didn", "t", "know", "the", "file", "be", "pass", "as", "argument", "NUMBER", "Would", "be", "nice", "if", "you", "could", "document", "that", "nicely", "NUMBER", "So", "far", "it", "works", "as", "advertised", "NUMBER", "Good", "job", "Was", "about", "to", "fork", "the", "project", "to", "do", "exactly", "this", "NUMBER", "Would", "be", "awesome", "to", "get", "this", "pull", "it", "s", "a", "very", "useful", "feature", "NUMBER", "Sorry", "about", "the", "delay", "in", "work", "on", "these", "pull", "request", "NUMBER", "I", "m", "going", "to", "try", "and", "work", "with", "Jonas", "on", "this", "at", "RailsConf", "if", "we", "can", "find", "time", "NUMBER", "awesome", "Need", "to", "unvote", "this", "pull", "request", "NUMBER", "I", "m", "run", "into", "a", "bug", "that", "recreate_versions", "be", "not", "functional", "the", "version", "processing", "be", "somehow", "broken", "NUMBER", "I", "have", "version", "like", "this", "version", "photo_of_the_week", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "photo_of_the_week_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "thumb_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big", "if", "landscape", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "big_portrait", "if", "portrait", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "And", "the", "picture", "big", "and", "picture_of_the_week", "be", "very", "blurry", "NUMBER", "I", "find", "these", "pictures", "be", "created", "based", "on", "the", "thumb", "version", "not", "the", "original", "Please", "try", "to", "find", "a", "way", "please", "find", "it", "soon", "I", "m", "use", "the", "gucki", "master", "branch", "NUMBER", "HI", "ened", "I", "ll", "do", "my", "best", "and", "keep", "you", "update", "NUMBER", "Hi", "gucki", "any", "update", "Could", "save", "me", "quite", "some", "GB", "with", "that", "NUMBER", "That", "be", "indeed", "good", "news", "NUMBER", "Have", "you", "encounted", "a", "bug", "as", "I", "report", "thumbnail", "creation", "etc", "I", "will", "download", "and", "test", "NUMBER", "Awesome", "Congrats", "guys", "NUMBER", "Thanks", "for", "pulling", "this", "I", "ll", "test", "if", "everything", "works", "as", "expected", "from", "my", "side", "now", "File", "extensions", "do", "not", "work", "when", "the", "storage", "be", "set", "to", "s", "NUMBER", "via", "fog", "so", "I", "m", "attaching", "the", "snippet", "that", "can", "work", "for", "it", "version", "thumb", "if", "image", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "protected", "def", "image", "new_file", "new_file", "NUMBER", "content_type", "NUMBER", "include", "image", "end", "Thank", "you", "for", "the", "great", "feature", "mehigh", "that", "s", "great", "material", "for", "a", "section", "in", "the", "wiki", "btw", "trevorturk", "I", "ve", "add", "that", "to", "the", "Wiki", "NUMBER", "I", "m", "glad", "that", "you", "find", "that", "helpful", "NUMBER", "Before", "this", "patch", "the", "follwing", "was", "not", "possible", "class", "AttachmentUploader", "TAG", "jpg", "version", "thumbnail", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "end", "class", "EncryptedUploader", "TAG", "But", "when", "re", "enabling", "processing", "it", "only", "be", "set", "true", "for", "the", "uploader", "class", "and", "not", "the", "class", "object", "use", "for", "the", "version", "NUMBER", "Enable", "Processing", "be", "true", "for", "ImageUploader", "Enable", "Processing", "be", "false", "for", "TAG", "Leaving", "processing", "enable", "for", "the", "test", "works", "fine", "but", "the", "test", "be", "obviously", "much", "slower", "NUMBER", "I", "would", "send", "a", "patch", "for", "this", "but", "i", "m", "not", "too", "sure", "how", "I", "could", "obtain", "the", "classes", "for", "version", "and", "then", "disable", "processing", "on", "them", "when", "the", "configuration", "be", "set", "NUMBER", "Ideas", "Hmmm", "something", "like", "this", "would", "work", "NUMBER", "ImageUploader", "NUMBER", "version", "NUMBER", "each", "do", "key", "version", "version", "NUMBER", "enable_processing", "true", "end", "Can", "I", "contribute", "a", "readme", "patch", "to", "state", "that", "processing", "needs", "to", "be", "enable", "disabled", "for", "each", "version", "Or", "would", "it", "be", "best", "to", "alter", "carrierwaves", "behavior", "so", "that", "it", "sets", "the", "enable_config", "options", "for", "all", "version", "This", "seems", "like", "a", "bug", "to", "me", "NUMBER", "Care", "to", "work", "up", "a", "patch", "to", "make", "the", "behavior", "consistent", "trevorturk", "Awesome", "i", "ll", "come", "up", "with", "nice", "a", "patch", "soon", "to", "change", "the", "behavior", "NUMBER", "Great", "please", "close", "this", "issue", "when", "you", "create", "the", "pull", "request", "NUMBER", "Thanks", "Pull", "request", "be", "here", "LINK", "allow", "specify", "a", "process", "condition", "for", "processors", "without", "any", "argument", "too", "ex", "NUMBER", "process", "sepiatone", "if", "true", "Which", "pull", "request", "be", "this", "relate", "to", "Can", "you", "combine", "to", "make", "this", "easier", "to", "see", "We", "have", "a", "lot", "to", "look", "at", "right", "now", "Hm", "well", "the", "first", "two", "commit", "of", "this", "pull", "request", "be", "relate", "to", "my", "conditional", "processing", "patch", "which", "was", "already", "accepted", "NUMBER", "The", "other", "commit", "came", "in", "because", "of", "later", "work", "on", "the", "same", "branch", "and", "be", "pull", "in", "by", "other", "pull", "request", "again", "NUMBER", "Sorry", "for", "that", "Ah", "this", "one", "LINK", "Yep", "OK", "thanks", "NUMBER", "Just", "trying", "to", "get", "things", "straight", "and", "cleaned", "up", "a", "bit", "so", "it", "s", "easier", "to", "look", "at", "later", "NUMBER", "I", "just", "implement", "conditional", "processing", "as", "it", "s", "be", "discussed", "here", "LINK", "_thread", "thread", "NUMBER", "c", "NUMBER", "b", "NUMBER", "fe", "NUMBER", "c", "NUMBER", "Specs", "include", "Not", "sure", "if", "this", "be", "the", "best", "place", "to", "comment", "on", "this", "but", "how", "difficult", "would", "it", "be", "to", "extend", "the", "if", "conditional", "processing", "to", "the", "version", "NUMBER", "That", "way", "you", "can", "do", "something", "like", "ruby", "Create", "different", "version", "of", "your", "uploaded", "file", "version", "thumb", "if", "image", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "version", "lightbox", "if", "image", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "Currently", "I", "can", "add", "the", "if", "condition", "the", "the", "process", "and", "it", "will", "not", "try", "and", "resize", "something", "like", "a", "zip", "file", "which", "be", "good", "but", "I", "will", "get", "NUMBER", "duplicate", "copies", "of", "the", "zip", "file", "saved", "one", "for", "the", "thumb", "and", "one", "for", "the", "lightbox", "I", "like", "this", "feature", "request", "NUMBER", "I", "ll", "look", "into", "it", "and", "keep", "you", "update", "here", "NUMBER", "I", "ll", "start", "work", "on", "this", "as", "soon", "as", "my", "other", "patches", "be", "accepted", "so", "not", "to", "many", "merge", "conflict", "will", "happen", "and", "my", "pull", "request", "look", "nicer", "NUMBER", "Done", "LINK", "Currently", "carrierwave", "checks", "for", "the", "existance", "of", "the", "actual", "file", "when", "calling", "avatar", "or", "avatar", "NUMBER", "blank", "NUMBER", "Imo", "this", "be", "unecessary", "and", "can", "result", "in", "really", "bad", "performance", "depending", "on", "the", "environment", "NUMBER", "I", "d", "suggest", "to", "change", "the", "two", "methods", "to", "a", "simple", "nil", "check", "of", "the", "column", "value", "NUMBER", "The", "check", "if", "the", "underlying", "file", "object", "be", "really", "existant", "should", "be", "put", "into", "another", "method", "like", "avatar", "NUMBER", "consistent", "If", "you", "agree", "I", "d", "be", "happy", "to", "provide", "a", "patch", "I", "ll", "start", "work", "on", "this", "as", "soon", "as", "my", "other", "patches", "be", "accepted", "so", "not", "to", "many", "merge", "conflict", "will", "happen", "and", "my", "pull", "request", "look", "nicer", "NUMBER", "I", "was", "under", "the", "impression", "that", "this", "was", "implmented", "so", "that", "active", "model", "valdiations", "would", "work", "correctly", "with", "uploaders", "Would", "change", "the", "behavior", "break", "this", "and", "cause", "something", "like", "this", "to", "always", "return", "true", "validate_presence_of", "avatar", "mariovisic", "the", "way", "I", "m", "reading", "this", "that", "behavior", "wouldn", "t", "change", "NUMBER", "It", "s", "just", "that", "we", "could", "check", "the", "column", "value", "instead", "of", "seeing", "if", "the", "file", "actually", "exists", "NUMBER", "oh", "right", "sorry", "misread", "Yes", "that", "s", "how", "I", "thought", "it", "should", "work", "NUMBER", "I", "think", "this", "should", "help", "LINK", "but", "please", "let", "me", "know", "if", "not", "NUMBER", "Move", "the", "code", "that", "joins", "a", "version_name", "and", "a", "filename", "into", "one", "place", "to", "provide", "an", "easy", "place", "to", "override", "this", "logic", "in", "an", "Uploader", "NUMBER", "Please", "see", "my", "post", "in", "the", "group", "NUMBER", "The", "idea", "behind", "this", "be", "if", "you", "want", "to", "have", "a", "different", "method", "for", "forming", "the", "filenames", "NUMBER", "A", "good", "example", "be", "the", "convention", "for", "retina", "version", "of", "images", "NUMBER", "foo", "NUMBER", "png", "for", "non", "retina", "and", "foo", "NUMBER", "x", "NUMBER", "png", "for", "retina", "version", "NUMBER", "LINK", "_thread", "thread", "c", "NUMBER", "d", "NUMBER", "ab", "NUMBER", "b", "NUMBER", "f", "NUMBER", "ae", "afe", "NUMBER", "caba", "NUMBER", "c", "NUMBER", "lnk", "gst", "q", "retina", "afe", "NUMBER", "caba", "NUMBER", "c", "NUMBER", "Add", "option", "for", "version", "to", "fall", "back", "to", "the", "original", "pre", "processed", "image", "as", "a", "starting", "point", "for", "their", "processing", "NUMBER", "Usage", "class", "FooUploader", "TAG", "true", "end", "Useful", "if", "you", "have", "processing", "that", "doesn", "t", "need", "to", "be", "applied", "to", "all", "version", "NUMBER", "See", "this", "example", "LINK", "_thread", "thread", "NUMBER", "c", "NUMBER", "c", "NUMBER", "dbdb", "NUMBER", "Every", "time", "when", "I", "m", "trying", "to", "upload", "a", "file", "from", "irb", "file", "has", "content", "type", "binary", "octet", "stream", "NUMBER", "Is", "there", "any", "possible", "way", "to", "force", "change", "of", "content", "type", "to", "correct", "one", "before", "saving", "the", "file", "I", "m", "assuming", "you", "mean", "when", "it", "s", "uploading", "to", "S", "NUMBER", "There", "s", "an", "open", "issue", "relate", "to", "this", "actually", "LINK", "I", "think", "you", "can", "make", "a", "new", "CarrierWave", "SanitizedFile", "to", "set", "everything", "manually", "NUMBER", "See", "how", "that", "works", "here", "LINK", "L", "NUMBER", "FWIW", "In", "fog", "if", "you", "don", "t", "specify", "a", "content", "type", "it", "uses", "the", "content", "type", "gem", "to", "try", "and", "guess", "one", "NUMBER", "The", "guess", "be", "based", "entirely", "on", "file", "extension", "if", "I", "remember", "correctly", "NUMBER", "So", "if", "you", "have", "the", "proper", "file", "extensions", "it", "should", "all", "just", "work", "NUMBER", "Barring", "that", "explicitly", "passing", "one", "ought", "to", "work", "soo", "also", "those", "other", "tickets", "though", "sounds", "like", "there", "may", "be", "some", "relate", "bug", "NUMBER", "So", "if", "i", "install", "content_type", "it", "will", "work", "That", "part", "should", "already", "be", "do", "due", "to", "dependency", "resolution", "actually", "NUMBER", "If", "you", "change", "the", "filenames", "of", "the", "things", "you", "be", "uploading", "it", "should", "probably", "do", "the", "right", "thing", "or", "at", "least", "raw", "fog", "ought", "to", "if", "that", "value", "doesn", "t", "correctly", "make", "its", "way", "through", "carrierwave", "then", "we", "have", "other", "issue", "NUMBER", "Well", "I", "don", "t", "have", "content_type", "gem", "in", "fact", "it", "fail", "to", "build", "because", "I", "don", "t", "have", "libmagic", "so", "this", "extension", "determinate", "content", "type", "based", "on", "magic", "number", "NUMBER", "The", "problem", "be", "there", "be", "no", "NUMBER", "content_type", "method", "for", "File", "provide", "NUMBER", "Oh", "sorry", "I", "was", "wrong", "NUMBER", "Sorry", "I", "mis", "spoke", "it", "be", "the", "mime", "types", "gem", "that", "do", "this", "NUMBER", "And", "fog", "requires", "it", "so", "if", "you", "have", "fog", "you", "should", "also", "have", "mime", "types", "NUMBER", "I", "have", "that", "gem", "but", "content", "type", "be", "wrong", "NUMBER", "I", "also", "use", "fog", "to", "upload", "my", "jekyll", "website", "and", "all", "file", "has", "correct", "content", "type", "NUMBER", "I", "forget", "to", "specified", "that", "I", "m", "use", "ruby", "NUMBER", "p", "NUMBER", "Please", "see", "my", "initial", "comment", "NUMBER", "I", "think", "you", "ll", "have", "to", "use", "CarrierWave", "SanitizedFile", "to", "set", "the", "content_type", "NUMBER", "I", "actually", "don", "t", "get", "what", "you", "suggested", "NUMBER", "I", "had", "this", "problem", "so", "I", "put", "this", "in", "my", "PageUploader", "i", "NUMBER", "e", "NUMBER", "the", "particular", "uploader", "I", "created", "require", "mime", "types", "class", "PageUploader", "TAG", "Actual", "NUMBER", "Forbidden", "NUMBER", "response", "TAG", "n", "TAG", "TAG", "SignatureDoesNotMatch", "TAG", "TAG", "The", "request", "signature", "we", "calculated", "do", "not", "match", "the", "signature", "you", "provide", "NUMBER", "Check", "your", "key", "and", "signing", "method", "NUMBER", "TAG", "NUMBER", "EDIT", "The", "good", "news", "at", "least", "be", "that", "I", "inspected", "the", "request", "sent", "by", "Fog", "and", "it", "do", "indeed", "include", "Content", "Type", "text", "html", "NUMBER", "So", "I", "m", "closer", "NUMBER", "I", "m", "guessing", "some", "sort", "of", "checksum", "signature", "be", "get", "generate", "for", "the", "request", "before", "the", "new", "content", "type", "be", "be", "set", "so", "that", "once", "it", "be", "set", "change", "it", "no", "longer", "matches", "the", "checksum", "NUMBER", "But", "I", "be", "new", "to", "Fog", "CarrierWave", "so", "I", "don", "t", "know", "NUMBER", "Woo", "figured", "it", "out", "It", "looks", "like", "my", "above", "solution", "actually", "do", "work", "but", "for", "one", "small", "change", "NUMBER", "I", "needed", "to", "add", "NUMBER", "to_s", "to", "the", "following", "MIME", "Types", "NUMBER", "type_for", "original_filename", "NUMBER", "first", "To", "make", "it", "MIME", "Types", "NUMBER", "type_for", "original_filename", "NUMBER", "first", "NUMBER", "to_s", "And", "that", "did", "the", "trick", "NUMBER", "Now", "my", "content_types", "be", "uploading", "and", "get", "set", "properly", "in", "my", "S", "NUMBER", "bucket", "NUMBER", "I", "will", "try", "that", "NUMBER", "Thx", "NUMBER", "JangoSteve", "thanks", "for", "the", "suggestion", "but", "unfortunately", "that", "method", "stops", "work", "as", "soon", "as", "you", "have", "something", "like", "this", "in", "in", "your", "uploader", "ruby", "process", "convert", "png", "This", "be", "due", "to", "the", "fact", "that", "the", "temp", "file", "retains", "to", "original", "file", "name", "including", "the", "original", "extension", "which", "the", "mime", "type", "gem", "uses", "to", "determine", "the", "content", "type", "NUMBER", "Even", "if", "you", "have", "a", "filename", "method", "that", "renames", "the", "file", "to", "whatever", "NUMBER", "png", "the", "file", "isn", "t", "actually", "renamed", "until", "it", "be", "copied", "from", "the", "temp", "folder", "to", "the", "final", "destination", "NUMBER", "chrisbloom", "NUMBER", "I", "m", "confused", "NUMBER", "If", "you", "know", "you", "re", "converting", "the", "file", "to", "a", "png", "why", "not", "just", "set", "the", "content_type", "to", "png", "instead", "of", "use", "the", "mime", "type", "gem", "class", "PageUploader", "TAG", "NUMBER", "NUMBER", "end", "Create", "a", "cropped", "version", "use", "interesting", "parts", "NUMBER", "def", "smart_crop", "width", "height", "manipulate", "do", "img", "pp", "img", "img", "end", "end", "Will", "show", "home", "NUMBER", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "thumb_default", "NUMBER", "png", "PNG", "NUMBER", "x", "NUMBER", "NUMBER", "x", "NUMBER", "NUMBER", "x", "NUMBER", "NUMBER", "NUMBER", "DirectClass", "NUMBER", "bit", "home", "NUMBER", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "thumb_default", "NUMBER", "png", "PNG", "NUMBER", "x", "NUMBER", "NUMBER", "x", "NUMBER", "NUMBER", "x", "NUMBER", "NUMBER", "NUMBER", "DirectClass", "NUMBER", "bit", "It", "could", "be", "due", "to", "mu", "setup", "but", "AFAIK", "I", "followed", "the", "readme", "and", "documentation", "NUMBER", "Do", "you", "manipulate", "the", "main", "file", "in", "some", "way", "as", "well", "CarrierWave", "will", "run", "that", "manipulation", "before", "run", "the", "version", "NUMBER", "I", "have", "no", "processors", "for", "the", "main", "file", "if", "that", "be", "what", "you", "mean", "NUMBER", "Also", "if", "I", "put", "a", "counter", "in", "that", "method", "it", "be", "clearly", "run", "twice", "NUMBER", "Also", "interesting", "be", "that", "for", "muliple", "_versions_", "they", "will", "be", "call", "as", "such", "version_one", "version_two", "version_three", "version_one", "second", "round", "version_two", "version_three", "extlib_inheritable_accessor", "_before_callbacks", "_after_callbacks", "do", "a", "shallow", "copy", "of", "the", "Hash", "NUMBER", "Callbacks", "that", "be", "add", "to", "the", "contained", "Array", "will", "be", "shared", "across", "all", "Uploaders", "NUMBER", "CarrierWave", "Uploader", "Base", "and", "its", "descendants", "store", "callbacks", "in", "a", "Hash", "of", "Array", "s", "keyed", "by", "callback", "type", "NUMBER", "The", "hash", "be", "accessed", "stored", "via", "the", "_", "before", "after", "_callbacks", "methods", "NUMBER", "These", "methods", "be", "created", "via", "the", "Class", "extlib_inheritable_accessor", "method", "part", "of", "CarrierWave", "s", "core", "ext", "NUMBER", "If", "the", "_", "before", "after", "_callbacks", "detect", "that", "they", "re", "be", "call", "from", "a", "subclass", "they", "ll", "dup", "the", "underlying", "callback", "hash", "NUMBER", "The", "problem", "be", "dup", "preforms", "a", "shallow", "copy", "so", "while", "the", "hash", "_is_", "duplicate", "the", "underlying", "callback", "arrays", "remain", "the", "same", "NUMBER", "Therefore", "any", "callbacks", "add", "by", "a", "subclass", "be", "inadvertently", "add", "to", "all", "other", "classes", "holding", "references", "to", "the", "array", "NUMBER", "Here", "s", "an", "example", "irb", "main", "NUMBER", "NUMBER", "MovieUploader", "Class", "NUMBER", "new", "CarrierWave", "Uploader", "Base", "before", "cache", "make_gif", "MovieUploader", "irb", "main", "NUMBER", "NUMBER", "AvatarUploader", "Class", "NUMBER", "new", "CarrierWave", "Uploader", "Base", "AvatarUploader", "irb", "main", "NUMBER", "NUMBER", "AvatarUploader", "NUMBER", "_before_callbacks", "cache", "check_whitelist", "make_gif", "irb", "main", "NUMBER", "NUMBER", "AvatarUploader", "NUMBER", "_before_callbacks", "NUMBER", "object_id", "NUMBER", "irb", "main", "NUMBER", "NUMBER", "CarrierWave", "Uploader", "Base", "NUMBER", "_before_callbacks", "NUMBER", "object_id", "NUMBER", "irb", "main", "NUMBER", "NUMBER", "AvatarUploader", "NUMBER", "_before_callbacks", "cache", "NUMBER", "object_id", "NUMBER", "irb", "main", "NUMBER", "NUMBER", "CarrierWave", "Uploader", "Base", "NUMBER", "_before_callbacks", "cache", "NUMBER", "object_id", "NUMBER", "The", "problem", "do", "not", "exist", "in", "the", "master", "branch", "NUMBER", "Merged", "NUMBER", "Thanks", "Would", "be", "a", "good", "idea", "to", "update", "the", "readme", "info", "on", "S", "NUMBER", "storage", "config", "quite", "out", "of", "date", "Hey", "sorry", "didn", "t", "mean", "to", "be", "obtuse", "NUMBER", "the", "readme", "rdoc", "on", "github", "has", "this", "code", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "xxx", "required", "aws_secret_access_key", "yyy", "required", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "name_of_directory", "required", "config", "NUMBER", "fog_host", "LINK", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "false", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "NUMBER", "which", "you", "soon", "discover", "doesn", "t", "work", "digging", "into", "the", "gem", "source", "the", "code", "be", "nicely", "documented", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "xxxxxx", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "xxxxxx", "config", "NUMBER", "s", "NUMBER", "_bucket", "my_bucket_name", "end", "NUMBER", "etc", "NUMBER", "Just", "thought", "it", "might", "be", "a", "good", "idea", "to", "update", "the", "readme", "since", "unfortunately", "not", "everyone", "would", "unpack", "the", "gem", "and", "have", "a", "look", "for", "themselves", "NUMBER", "I", "know", "people", "should", "just", "check", "the", "rdoc", "but", "I", "was", "just", "thinking", "that", "it", "might", "scare", "people", "off", "NUMBER", "feel", "free", "to", "ignore", "me", "if", "I", "m", "be", "a", "pain", "in", "the", "ass", "tho", "Ok", "ignore", "me", "I", "seem", "to", "have", "miss", "that", "the", "config", "change", "NUMBER", "I", "m", "an", "idiot", "NUMBER", "Weird", "I", "m", "use", "NUMBER", "and", "I", "even", "unpacked", "the", "gem", "and", "checked", "needed", "the", "old", "config", "NUMBER", "I", "ve", "applied", "a", "fix", "here", "LINK", "stable", "NUMBER", "Actually", "I", "see", "it", "s", "fix", "in", "the", "current", "HEAD", "though", "it", "s", "based", "on", "ActiveSupport", "NUMBER", "X", "code", "NUMBER", "Initially", "I", "didn", "t", "see", "the", "GitHub", "option", "that", "allows", "one", "to", "select", "the", "base", "branch", "didn", "t", "want", "to", "open", "the", "request", "against", "master", "NUMBER", "I", "see", "it", "now", "NUMBER", "Currently", "we", "have", "to", "base", "our", "file", "naming", "scheme", "on", "IDs", "but", "we", "would", "like", "to", "base", "it", "on", "somewhat", "unique", "names", "or", "slugs", "eg", "NUMBER", "mona_lisa", "NUMBER", "The", "user", "uploads", "images", "we", "give", "them", "a", "temporary", "name", "then", "rename", "them", "NUMBER", "During", "rename", "we", "also", "need", "to", "move", "the", "image", "file", "since", "the", "slug", "change", "NUMBER", "Having", "problem", "setting", "up", "the", "s", "NUMBER", "storage", "when", "i", "try", "to", "save", "the", "image", "i", "get", "the", "error", "message", "NoMethodError", "undefined", "method", "reject", "for", "Symbol", "NUMBER", "x", "NUMBER", "df", "NUMBER", "e", "my", "configs", "look", "like", "Intializer", "looks", "like", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "MYKET", "required", "aws_secret_access_key", "MYSECRET", "required", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "BUKET", "required", "config", "NUMBER", "fog_host", "LINK", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "false", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "and", "uploader", "file", "class", "TileUploader", "TAG", "NUMBER", "NUMBER", "def", "scale", "width", "height", "do", "something", "end", "Create", "different", "version", "of", "your", "uploaded", "file", "version", "icon", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "Add", "a", "white", "list", "of", "extensions", "which", "be", "allow", "to", "be", "uploaded", "NUMBER", "For", "images", "you", "might", "use", "something", "like", "this", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "Override", "the", "filename", "of", "the", "uploaded", "file", "def", "filename", "something", "NUMBER", "jpg", "if", "original_filename", "end", "end", "the", "gemlists", "be", "fog", "NUMBER", "carrierwave", "NUMBER", "remove", "the", "comments", "from", "initializer", "didnt", "help", "NUMBER", "ygoldshtrakh", "could", "you", "put", "the", "stacktrace", "in", "a", "gist", "or", "something", "and", "link", "it", "That", "would", "make", "track", "down", "why", "this", "was", "occurring", "much", "simpler", "NUMBER", "Thanks", "here", "be", "a", "full", "log", "NoMethodError", "undefined", "method", "reject", "for", "TAG", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "fog", "NUMBER", "lib", "fog", "core", "service", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "fog", "NUMBER", "lib", "fog", "storage", "NUMBER", "rb", "NUMBER", "in", "new", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "connection", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "connection", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "directory", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_tile", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "in", "create_or_update", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "in", "save", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "save", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "save", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "rollback_active_record_state", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "save", "from", "irb", "NUMBER", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "railties", "NUMBER", "lib", "rails", "commands", "console", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "yuriy", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "myapp", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "Have", "you", "created", "a", "file", "at", "NUMBER", "fog", "If", "so", "do", "it", "have", "only", "a", "symbol", "in", "it", "rather", "than", "a", "hash", "of", "credentials", "The", "error", "I", "m", "seeing", "here", "would", "seem", "to", "imply", "that", "if", "you", "just", "remove", "that", "file", "you", "should", "probably", "be", "good", "to", "go", "NUMBER", "You", "be", "absolutely", "correct", "remove", "NUMBER", "fog", "file", "fix", "the", "problem", "NUMBER", "Thank", "you", "It", "probably", "comes", "from", "holding", "a", "socket", "open", "beyond", "the", "keep", "alive", "value", "NUMBER", "In", "general", "the", "default", "be", "to", "keep", "use", "the", "same", "socket", "for", "performance", "NUMBER", "Could", "you", "try", "add", "persistent", "false", "to", "your", "fog_credentials", "and", "see", "if", "the", "problem", "goes", "away", "I", "m", "guessing", "that", "it", "will", "and", "perhaps", "we", "should", "start", "add", "this", "as", "the", "default", "NUMBER", "Also", "get", "this", "error", "when", "use", "Excon", "NUMBER", "I", "could", "fix", "the", "issue", "by", "downgrading", "to", "fog", "NUMBER", "and", "excon", "NUMBER", "Furthermore", "I", "get", "connections", "that", "weren", "t", "close", "properly", "cause", "my", "app", "on", "Heroku", "to", "become", "unavailable", "when", "all", "dynos", "were", "use", "up", "NUMBER", "yeah", "also", "as", "fbjork", "point", "out", "the", "issue", "seems", "specifically", "to", "be", "excon", "NUMBER", "I", "think", "I", "know", "what", "the", "regression", "was", "probably", "cause", "by", "but", "I", "d", "like", "to", "also", "add", "test", "to", "ensure", "it", "doesn", "t", "recur", "in", "the", "future", "NUMBER", "Regardless", "I", "think", "a", "new", "version", "of", "excon", "can", "likely", "finish", "this", "without", "persistent", "false", "NUMBER", "I", "ll", "let", "you", "know", "hopefully", "will", "have", "some", "kind", "of", "answer", "in", "the", "next", "couple", "hours", "NUMBER", "I", "believe", "this", "revert", "should", "fix", "the", "issue", "LINK", "I", "have", "a", "couple", "other", "commit", "to", "review", "and", "possibly", "merge", "but", "I", "should", "hopefully", "have", "a", "NUMBER", "for", "you", "later", "today", "NUMBER", "I", "just", "release", "excon", "NUMBER", "which", "I", "believe", "should", "solve", "these", "issue", "NUMBER", "Please", "reopen", "if", "problem", "continue", "we", "may", "want", "to", "update", "the", "dependency", "too", "but", "figured", "I", "d", "give", "you", "all", "a", "chance", "to", "try", "it", "out", "before", "we", "call", "it", "fix", "NUMBER", "Hi", "there", "Im", "seeing", "the", "Excon", "Errors", "SocketError", "EOFError", "issue", "with", "dragonfly", "NUMBER", "on", "an", "app", "deployed", "to", "heroku", "NUMBER", "this", "be", "with", "excon", "NUMBER", "and", "fog", "NUMBER", "and", "seems", "to", "happen", "about", "NUMBER", "of", "the", "time", "usr", "ruby", "NUMBER", "lib", "ruby", "NUMBER", "openssl", "buffering", "NUMBER", "rb", "NUMBER", "in", "readline", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "response", "NUMBER", "rb", "NUMBER", "inparse", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "inrequest", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "in", "request", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "get_bucket_location", "NUMBER", "rb", "NUMBER", "inget_bucket_location", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "dragonfly", "NUMBER", "lib", "dragonfly", "data_storage", "s", "NUMBER", "data_store", "NUMBER", "rb", "NUMBER", "in", "bucket_exists", "NUMBER", "bundle", "gems", "ruby", "NUMBER", "gems", "dragonfly", "NUMBER", "lib", "dragonfly", "data_storage", "s", "NUMBER", "data_store", "NUMBER", "rb", "NUMBER", "inensure_bucket_initialized", "some", "more", "details", "on", "the", "dragonfly", "thread", "here", "LINK", "would", "really", "appreciate", "any", "ideas", "you", "may", "have", "cheer", "trevorturk", "fyi", "I", "followed", "up", "back", "on", "the", "dragonfly", "issue", "so", "you", "can", "probably", "skip", "worrying", "about", "this", "one", "for", "now", "NUMBER", "Hi", "NUMBER", "I", "have", "just", "install", "the", "gem", "and", "after", "uploading", "an", "image", "when", "trying", "to", "access", "it", "through", "the", "NUMBER", "url", "method", "I", "get", "a", "NUMBER", "error", "NUMBER", "Is", "this", "something", "with", "the", "permissions", "that", "CW", "sets", "on", "the", "file", "Since", "it", "s", "in", "the", "public", "directory", "and", "all", "other", "file", "there", "be", "accessible", "as", "should", "be", "the", "file", "should", "be", "accessible", "Emil", "The", "CarrierWave", "Mount", "mount_uploader", "parameter", "defaults", "to", "nil", "in", "case", "you", "want", "to", "use", "an", "anonymous", "uploader", "supplied", "as", "a", "block", "NUMBER", "The", "orm", "specific", "mount", "modules", "do", "not", "reflect", "this", "forcing", "you", "to", "explicitly", "supply", "nil", "if", "you", "want", "to", "use", "an", "anonymous", "uploader", "NUMBER", "My", "apologies", "for", "be", "unclear", "NUMBER", "The", "CarrierWave", "Mount", "mount_uploader", "method", "implies", "that", "you", "can", "use", "an", "anonymous", "uploader", "block", "for", "which", "the", "uploader", "class", "parameter", "will", "default", "to", "nil", "like", "so", "class", "Test", "mount_uploader", "file", "do", "anonymous", "uploader", "block", "end", "end", "However", "in", "the", "orm", "specific", "mount", "modules", "the", "uploader", "class", "parameter", "do", "not", "default", "to", "nil", "so", "you", "will", "have", "to", "explicitly", "supply", "nil", "for", "the", "uploader", "class", "with", "a", "specific", "orm", "uploader", "class", "Test", "TAG", "config", "initializers", "carrierwave", "NUMBER", "rb", "require", "Rails", "NUMBER", "root", "config", "initializers", "load_app_config", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "root", "Rails", "NUMBER", "root", "tmp", "config", "NUMBER", "fog_credentials", "provider", "AWS", "required", "aws_access_key_id", "APP_CONFIG", "aws_access_key", "required", "aws_secret_access_key", "APP_CONFIG", "aws_secret", "required", "region", "eu", "west", "NUMBER", "optional", "defaults", "to", "us", "east", "NUMBER", "config", "NUMBER", "fog_directory", "APP_CONFIG", "s", "NUMBER", "_bucket_name", "required", "config", "NUMBER", "fog_host", "LINK", "optional", "defaults", "to", "nil", "config", "NUMBER", "fog_public", "false", "optional", "defaults", "to", "true", "config", "NUMBER", "fog_attributes", "Cache", "Control", "max", "age", "NUMBER", "optional", "defaults", "to", "end", "TAG", "Hey", "I", "just", "switched", "to", "a", "pure", "S", "NUMBER", "config", "w", "o", "fog", "TAG", "require", "Rails", "NUMBER", "root", "config", "initializers", "load_app_config", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "root", "Rails", "NUMBER", "root", "tmp", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "APP_CONFIG", "aws_access_key", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "APP_CONFIG", "aws_secret", "config", "NUMBER", "s", "NUMBER", "_bucket", "APP_CONFIG", "s", "NUMBER", "_bucket_name", "end", "TAG", "And", "it", "s", "blazing", "fast", "Isn", "t", "it", "odd", "that", "fog", "slows", "down", "that", "process", "Should", "we", "initialize", "fog", "outside", "of", "CW", "Sorry", "about", "the", "confusion", "NUMBER", "This", "has", "be", "fix", "on", "master", "here", "LINK", "But", "we", "be", "work", "out", "a", "couple", "other", "kinks", "before", "we", "release", "it", "NUMBER", "I", "believe", "that", "commit", "fix", "your", "issue", "though", "I", "made", "a", "pretty", "obvious", "error", "that", "someone", "else", "had", "point", "out", "so", "I", "m", "going", "to", "close", "this", "and", "hopefully", "we", "ll", "get", "that", "release", "for", "you", "soon", "NUMBER", "This", "has", "not", "be", "fix", "NUMBER", "I", "be", "use", "fog", "NUMBER", "carrierwave", "NUMBER", "and", "non", "authenticated", "urls", "be", "really", "slow", "to", "generate", "NUMBER", "NUMBER", "images", "take", "NUMBER", "seconds", "NUMBER", "Will", "be", "happy", "to", "provide", "more", "info", "if", "interested", "NUMBER", "Using", "storage", "s", "NUMBER", "be", "instant", "NUMBER", "Seems", "to", "me", "it", "be", "pulling", "info", "from", "s", "NUMBER", "to", "determine", "the", "urls", "NUMBER", "Confirmed", "by", "uploading", "a", "file", "deleting", "it", "directly", "from", "s", "NUMBER", "and", "then", "reloading", "the", "record", "from", "the", "db", "Excon", "Errors", "NotFound", "without", "even", "calling", "attachment", "NUMBER", "url", "NUMBER", "Currently", "fog", "be", "cautious", "and", "try", "to", "verify", "that", "the", "file", "be", "publicly", "accessible", "before", "returning", "a", "url", "ie", "it", "ers", "on", "the", "side", "of", "correctness", "rather", "than", "performance", "NUMBER", "That", "said", "the", "provider", "in", "carrierwave", "already", "has", "a", "switch", "that", "will", "allow", "you", "to", "prefer", "speed", "over", "correctness", "NUMBER", "If", "you", "would", "like", "to", "do", "this", "you", "can", "specify", "a", "fog_host", "in", "your", "configuration", "in", "your", "case", "you", "probably", "will", "want", "something", "like", "LINK", "bucket_name", "NUMBER", "s", "NUMBER", "amazonaws", "NUMBER", "com", "or", "perhaps", "whatever", "CNAME", "you", "have", "setup", "for", "your", "assets", "NUMBER", "If", "you", "provide", "this", "value", "it", "will", "assume", "your", "file", "be", "setup", "and", "just", "return", "a", "string", "ie", "no", "API", "calls", "back", "to", "AWS", "NUMBER", "Otherwise", "it", "try", "to", "ensure", "the", "file", "exists", "and", "be", "public", "prior", "to", "returning", "a", "url", "that", "would", "be", "invalid", "NUMBER", "Interesting", "API", "choice", "to", "default", "to", "SLOW", "NUMBER", "In", "NUMBER", "of", "cases", "I", "would", "think", "it", "wouldn", "t", "be", "mission", "critical", "to", "verify", "the", "file", "exists", "NUMBER", "In", "fact", "as", "stated", "above", "you", "can", "t", "even", "load", "a", "record", "if", "the", "file", "doesn", "t", "exist", "NUMBER", "Maybe", "at", "least", "document", "this", "in", "the", "read", "me", "NUMBER", "Thanks", "for", "your", "help", "and", "the", "hard", "work", "BTW", "NUMBER", "Hmm", "NUMBER", "I", "might", "agree", "with", "lardawge", "about", "the", "default", "behavior", "NUMBER", "I", "guess", "I", "don", "t", "see", "the", "advantage", "of", "double", "checking", "that", "the", "URL", "be", "valid", "NUMBER", "In", "the", "case", "of", "a", "locally", "stored", "file", "we", "d", "just", "return", "a", "busted", "URL", "right", "I", "don", "t", "think", "there", "s", "a", "check", "for", "File", "NUMBER", "exist", "or", "anything", "NUMBER", "I", "m", "definitely", "open", "to", "more", "discussion", "though", "NUMBER", "I", "m", "going", "to", "re", "open", "the", "issue", "NUMBER", "I", "think", "we", "should", "change", "the", "behavior", "or", "recommend", "something", "in", "the", "docs", "about", "fog_host", "at", "least", "NUMBER", "The", "difficulty", "comes", "in", "make", "it", "work", "across", "providers", "properly", "NUMBER", "Each", "has", "their", "own", "url", "generation", "strategy", "but", "they", "also", "have", "their", "own", "ways", "for", "make", "file", "public", "accessible", "NUMBER", "So", "it", "isn", "t", "just", "the", "presence", "check", "that", "matters", "it", "be", "also", "the", "accessibility", "check", "NUMBER", "I", "did", "this", "be", "fog", "itself", "because", "I", "felt", "it", "best", "to", "have", "correct", "non", "confusing", "info", "instead", "of", "knowing", "that", "a", "file", "existed", "but", "finding", "request", "the", "url", "was", "a", "NUMBER", "Examples", "of", "run", "into", "this", "would", "be", "creating", "things", "in", "rackspace", "but", "not", "cdn", "enabling", "the", "container", "or", "make", "an", "s", "NUMBER", "bucket", "public", "but", "not", "make", "it", "s", "file", "public", "NUMBER", "Either", "of", "those", "be", "pretty", "easy", "to", "do", "and", "can", "result", "in", "a", "pretty", "confusing", "state", "of", "things", "NUMBER", "As", "such", "I", "tried", "to", "eliminate", "several", "error", "categories", "by", "remove", "the", "possibility", "of", "returning", "a", "link", "to", "something", "for", "which", "it", "wouldn", "t", "work", "NUMBER", "Unfortunately", "this", "be", "slower", "NUMBER", "So", "the", "question", "becomes", "did", "I", "make", "the", "wrong", "decision", "in", "the", "general", "case", "or", "be", "it", "just", "the", "wrong", "decision", "for", "the", "carrierwave", "use", "case", "NUMBER", "ie", "should", "I", "fix", "this", "by", "rewriting", "the", "public_url", "logic", "in", "fog", "or", "should", "we", "just", "do", "our", "own", "thing", "here", "NUMBER", "If", "it", "be", "something", "to", "be", "fix", "in", "fog", "then", "we", "ought", "to", "open", "the", "ticket", "there", "instead", "I", "imagine", "NUMBER", "If", "instead", "it", "be", "still", "best", "to", "be", "accurate", "but", "provide", "a", "way", "to", "optimize", "for", "speed", "then", "we", "should", "definitely", "note", "that", "in", "the", "docs", "instead", "NUMBER", "geemus", "I", "m", "leaning", "towards", "thinking", "that", "you", "made", "the", "right", "decision", "for", "fog", "but", "this", "do", "seem", "like", "a", "bug", "in", "CarrierWave", "NUMBER", "I", "think", "the", "default", "behavior", "should", "be", "generating", "the", "URLs", "as", "quickly", "as", "possible", "and", "people", "can", "deal", "with", "miss", "images", "etc", "on", "their", "own", "NUMBER", "Give", "it", "a", "little", "thought", "that", "let", "me", "know", "where", "you", "come", "down", "though", "NUMBER", "trevorturk", "that", "be", "also", "more", "or", "less", "what", "I", "was", "thinking", "NUMBER", "In", "carrierwave", "I", "just", "use", "the", "fog", "methods", "because", "it", "was", "convenient", "and", "hadn", "t", "properly", "considered", "the", "performance", "implications", "NUMBER", "That", "be", "said", "it", "should", "be", "fairly", "simple", "to", "fix", "by", "centralizing", "some", "of", "that", "logic", "NUMBER", "I", "ll", "try", "to", "have", "a", "patch", "for", "you", "just", "shortly", "NUMBER", "fog", "optimize", "public_url", "for", "AWS", "and", "Google", "Much", "faster", "no", "api", "calls", "url", "generation", "at", "the", "possibly", "cost", "of", "get", "back", "urls", "even", "when", "the", "file", "be", "private", "or", "do", "not", "exist", "NUMBER", "This", "may", "cause", "confusion", "during", "setup", "but", "that", "seems", "more", "desirable", "than", "cause", "a", "performance", "hit", "at", "run", "time", "NUMBER", "Closed", "by", "NUMBER", "b", "NUMBER", "c", "NUMBER", "b", "NUMBER", "c", "NUMBER", "c", "NUMBER", "db", "NUMBER", "d", "NUMBER", "ba", "NUMBER", "Nice", "NUMBER", "Thanks", "for", "work", "that", "out", "NUMBER", "I", "totally", "agree", "that", "at", "the", "level", "of", "carrierwave", "this", "be", "the", "best", "choice", "NUMBER", "Awesome", "thank", "you", "Great", "thanks", "guys", "I", "delete", "a", "few", "file", "with", "fog", "and", "it", "was", "really", "slow", "NUMBER", "Changed", "to", "storage", "s", "NUMBER", "and", "it", "was", "really", "quick", "NUMBER", "I", "have", "not", "do", "any", "extensive", "test", "but", "it", "was", "slow", "when", "deleting", "NUMBER", "file", "with", "fog", "and", "was", "really", "quick", "deleting", "NUMBER", "file", "with", "s", "NUMBER", "Using", "latest", "master", "of", "Carrierwave", "on", "Heroku", "NUMBER", "Please", "open", "a", "new", "issue", "NUMBER", "espen", "I", "think", "this", "should", "help", "LINK", "Man", "i", "m", "glad", "I", "find", "this", "was", "driving", "me", "crazy", "NUMBER", "Just", "switched", "to", "s", "NUMBER", "and", "things", "be", "fast", "again", "NUMBER", "I", "can", "t", "quite", "tell", "if", "this", "be", "supposed", "to", "be", "fix", "in", "the", "latest", "version", "available", "or", "what", "but", "I", "m", "use", "carrierwave", "NUMBER", "and", "fog", "NUMBER", "and", "things", "were", "slow", "til", "switching", "to", "s", "NUMBER", "So", "NUMBER", "should", "it", "be", "ok", "now", "and", "i", "m", "just", "not", "up", "to", "date", "I", "think", "the", "speed", "optimizations", "be", "in", "master", "but", "not", "yet", "release", "as", "a", "gem", "NUMBER", "We", "should", "probably", "do", "a", "gem", "release", "soon", "NUMBER", "ok", "sweet", "thanks", "trevor", "appreciate", "it", "NUMBER", "and", "yeah", "i", "think", "that", "d", "be", "a", "good", "idea", "the", "current", "reality", "be", "a", "bit", "of", "a", "blocker", "imho", "NUMBER", "Agreed", "NUMBER", "I", "ll", "try", "to", "get", "something", "out", "today", "NUMBER", "On", "Friday", "May", "NUMBER", "NUMBER", "jackdempsey", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "ok", "sweet", "thanks", "trevor", "appreciate", "it", "NUMBER", "and", "yeah", "i", "think", "that", "d", "be", "a", "good", "idea", "the", "current", "reality", "be", "a", "bit", "of", "a", "blocker", "imho", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "comment_", "NUMBER", "geemus", "thanks", "it", "seems", "to", "be", "normal", "now", "NUMBER", "Hope", "it", "can", "be", "release", "as", "a", "gem", "so", "I", "dont", "have", "to", "fetch", "from", "github", "in", "my", "app", "NUMBER", "there", "was", "a", "problem", "but", "it", "was", "totally", "my", "mistake", "Got", "this", "as", "my", "filename", "for", "a", "FileUploader", "def", "filename", "model", "NUMBER", "id", "original_filename", "NUMBER", "join", "_", "NUMBER", "png", "end", "Which", "for", "uploading", "first", "NUMBER", "png", "generate", "file", "as", "anticipated", "first", "NUMBER", "png", "thumb_", "NUMBER", "_first", "NUMBER", "png", "Stores", "in", "the", "database", "as", "follows", "Shouldn", "t", "it", "be", "original_filename", "_first", "NUMBER", "png", "However", "when", "I", "call", "the", "following", "resource", "NUMBER", "file", "NUMBER", "umb", "NUMBER", "url", "It", "returns", "the", "following", "without", "the", "ID", "portion", "thumb__first", "NUMBER", "png", "NUMBER", "Things", "NUMBER", "Shouldn", "t", "it", "store", "the", "original_filename", "I", "d", "prefer", "that", "NUMBER", "I", "d", "imagine", "I", "d", "have", "to", "overwrite", "a", "before_save", "no", "biggie", "NUMBER", "NUMBER", "Would", "I", "need", "to", "override", "the", "url", "method", "to", "include", "the", "model", "NUMBER", "id", "I", "looked", "in", "the", "rdoc", "s", "at", "all", "the", "urls", "and", "the", "stores", "to", "get", "a", "hint", "at", "how", "it", "works", "but", "can", "t", "conclusive", "say", "what", "needs", "to", "be", "overridden", "NUMBER", "Are", "these", "even", "bug", "NUMBER", "Great", "Gem", "Thanks", "NUMBER", "The", "docs", "say", "quite", "clearly", "say", "not", "to", "put", "the", "model", "id", "into", "the", "filename", "Trust", "me", "just", "don", "t", "NUMBER", "NUMBER", "It", "s", "theoretically", "possible", "to", "tell", "CarrierWave", "to", "use", "the", "original", "filename", "by", "overriding", "the", "identifier", "method", "in", "your", "uploader", "I", "have", "no", "idea", "what", "the", "effect", "of", "this", "be", "though", "most", "likely", "you", "d", "need", "to", "make", "some", "change", "to", "the", "storage", "adapter", "NUMBER", "NUMBER", "The", "URL", "should", "work", "jsut", "fine", "as", "long", "as", "you", "don", "t", "include", "the", "model", "id", "in", "the", "filename", "NUMBER", "NUMBER", "Thanks", "Did", "I", "mention", "not", "to", "put", "the", "model", "id", "into", "the", "filename", "No", "Well", "don", "t", "put", "the", "model", "id", "into", "the", "filename", "NUMBER", "My", "apologizes", "I", "made", "sure", "I", "googled", "search", "issue", "before", "creating", "NUMBER", "Guess", "I", "miss", "that", "note", "I", "notice", "it", "doesn", "t", "work", "with", "a", "datestamp", "either", "NUMBER", "I", "guess", "I", "ll", "just", "rethink", "my", "logic", "I", "was", "storing", "all", "Photos", "under", "an", "Album", "directory", "so", "wanted", "to", "prevent", "the", "possibility", "of", "overwriting", "a", "file", "with", "the", "same", "name", "NUMBER", "I", "ll", "just", "change", "the", "store_dir", "to", "put", "photos", "back", "in", "each", "model", "NUMBER", "id", "subdirectory", "NUMBER", "Thanks", "again", "Alright", "I", "will", "dig", "in", "now", "NUMBER", "Not", "sure", "what", "would", "have", "change", "to", "effect", "this", "but", "I", "ll", "try", "to", "get", "to", "the", "bottom", "of", "it", "ASAP", "NUMBER", "When", "I", "made", "change", "to", "facilitate", "use", "reset_data", "to", "reset", "the", "mocks", "I", "was", "overly", "aggressive", "NUMBER", "I", "mistakenly", "change", "it", "such", "that", "whenever", "you", "made", "a", "new", "mock", "connection", "it", "would", "reset", "the", "data", "as", "I", "thought", "this", "would", "reduce", "code", "duplication", "NUMBER", "Of", "course", "it", "be", "common", "to", "create", "a", "connection", "in", "something", "like", "a", "before", "each", "as", "carrierwave", "do", "NUMBER", "In", "any", "event", "it", "was", "an", "easy", "fix", "and", "should", "work", "alright", "after", "this", "LINK", "I", "have", "a", "couple", "other", "bug", "report", "and", "patches", "to", "look", "through", "but", "should", "hopefully", "be", "able", "to", "get", "out", "a", "NUMBER", "with", "this", "for", "you", "later", "today", "or", "I", "d", "say", "tomorrow", "at", "worst", "NUMBER", "Sorry", "for", "the", "confusion", "delay", "unfortunately", "the", "fog", "test", "tend", "to", "create", "a", "connection", "and", "reuse", "it", "a", "lot", "instead", "of", "recreating", "a", "new", "connection", "for", "each", "test", "so", "this", "kind", "of", "fell", "through", "the", "cracks", "NUMBER", "I", "believe", "this", "be", "now", "solve", "with", "NUMBER", "I", "ve", "encountered", "this", "bug", "in", "Windows", "NUMBER", "x", "NUMBER", "not", "sure", "if", "it", "affects", "other", "platforms", "NUMBER", "Lack", "of", "complaints", "find", "after", "searching", "suggests", "perhaps", "not", "NUMBER", "The", "change", "be", "quite", "miniscule", "NUMBER", "Using", "the", "block", "form", "of", "File", "NUMBER", "open", "ensures", "that", "the", "file", "be", "automatically", "_closed_", "after", "execution", "NUMBER", "This", "change", "was", "necessary", "to", "make", "sure", "that", "the", "temporary", "file", "can", "be", "delete", "NUMBER", "Otherwise", "the", "File", "NUMBER", "unlink", "method", "gives", "a", "Errno", "EACCES", "Permission", "denied", "error", "sometimes", "often", "always", "I", "suppose", "because", "Windows", "considers", "the", "file", "to", "still", "be", "in", "use", "and", "thus", "unable", "to", "be", "delete", "NUMBER", "class", "ImageUploader", "TAG", "NUMBER", "NUMBER", "end", "end", "end", "end", "I", "cannot", "create", "the", "new", "version", "it", "tells", "me", "that", "version", "be", "undefined", "for", "class", "ImageUploader", "NUMBER", "And", "when", "I", "do", "ImageUploader", "NUMBER", "version", "thumb", "do", "it", "tells", "me", "that", "there", "be", "no", "version", "named", "thumb", "NUMBER", "The", "above", "method", "works", "to", "upload", "images", "and", "non", "image", "assets", "pretty", "nicely", "without", "a", "lot", "of", "fuss", "NUMBER", "If", "only", "I", "could", "get", "the", "thumb", "version", "to", "work", "and", "process", "we", "d", "be", "good", "to", "go", "NUMBER", "Any", "thoughts", "You", "re", "calling", "a", "class", "method", "from", "an", "instance", "method", "NUMBER", "Jonas", "On", "Wed", "Mar", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "mtmcfarl", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "class", "ImageUploader", "TAG", "include", "CarrierWave", "RMagick", "storage", "file", "def", "store_dir", "uploads", "model", "NUMBER", "class", "NUMBER", "to_s", "NUMBER", "underscore", "mounted_as", "model", "NUMBER", "id", "end", "process", "check_content_type", "def", "check_content_type", "if", "file", "NUMBER", "content_type", "NUMBER", "include", "image", "self", "NUMBER", "version", "thumb", "do", "process", "resize_to_fit", "NUMBER", "NUMBER", "end", "end", "end", "end", "I", "cannot", "create", "the", "new", "version", "it", "tells", "me", "that", "version", "be", "undefined", "for", "class", "ImageUploader", "NUMBER", "And", "when", "I", "do", "ImageUploader", "NUMBER", "version", "thumb", "do", "it", "tells", "me", "that", "there", "be", "no", "version", "named", "thumb", "NUMBER", "The", "above", "method", "works", "to", "upload", "images", "and", "non", "image", "assets", "pretty", "nicely", "without", "a", "lot", "of", "fuss", "NUMBER", "If", "only", "I", "could", "get", "the", "thumb", "version", "to", "work", "and", "process", "we", "d", "be", "good", "to", "go", "NUMBER", "Any", "thoughts", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "Hrrmm", "NUMBER", "if", "the", "version", "directive", "be", "outside", "of", "the", "check_content_type", "method", "then", "the", "version", "directive", "works", "inside", "the", "method", "it", "fail", "NUMBER", "Does", "the", "process", "directive", "change", "the", "scoping", "Trying", "to", "figure", "out", "how", "this", "thing", "works", "NUMBER", "Thanks", "for", "the", "patience", "NUMBER", "No", "NUMBER", "check_content_type", "be", "an", "instance", "method", "version", "be", "a", "class", "method", "NUMBER", "You", "re", "calling", "a", "class", "method", "from", "an", "instance", "method", "NUMBER", "Version", "be", "expected", "to", "be", "call", "on", "the", "class", "and", "it", "be", "static", "in", "the", "sense", "that", "you", "cannot", "create", "a", "version", "per", "uploaded", "file", "NUMBER", "Think", "of", "it", "like", "a", "has_many", "declaration", "in", "Rails", "NUMBER", "If", "this", "makes", "no", "sense", "to", "you", "grab", "the", "pickaxe", "book", "you", "need", "to", "brush", "up", "on", "your", "Ruby", "NUMBER", "Great", "thanks", "for", "the", "explanation", "NUMBER", "I", "m", "the", "first", "to", "admit", "I", "need", "to", "brush", "on", "my", "Ruby", "for", "sure", "NUMBER", "Makes", "sense", "now", "NUMBER", "I", "just", "wanted", "to", "use", "one", "uploader", "for", "any", "file", "type", "NUMBER", "I", "m", "having", "trouble", "reproducing", "this", "do", "you", "have", "an", "example", "of", "a", "fail", "test", "Running", "off", "of", "master", "I", "m", "trying", "this", "it", "preserves", "the", "content", "type", "do", "original", "uploader", "NUMBER", "file", "NUMBER", "content_type", "uploader", "NUMBER", "cache_stored_file", "uploader", "NUMBER", "ore", "new_file", "storage", "NUMBER", "retrieve", "uploader", "NUMBER", "identifier", "new_file", "NUMBER", "content_type", "NUMBER", "should", "original", "end", "This", "happens", "in", "the", "fog_helper", "NUMBER", "rb", "file", "for", "AWS", "and", "Google", "and", "it", "pass", "both", "NUMBER", "Oh", "I", "completely", "understand", "the", "problem", "now", "NUMBER", "It", "seems", "to", "me", "like", "the", "content_type", "of", "cached", "file", "should", "also", "be", "cached", "somewhere", "as", "well", "if", "we", "don", "t", "want", "to", "rely", "on", "the", "mime", "types", "gem", "NUMBER", "Maybe", "we", "could", "have", "some", "sort", "of", "global", "hash", "on", "the", "CarrierWave", "object", "of", "cache", "ids", "to", "content", "types", "Or", "maybe", "just", "an", "entire", "hash", "of", "attributes", "for", "file", "needed", "as", "well", "NUMBER", "It", "seems", "a", "bit", "icky", "to", "do", "this", "but", "without", "this", "I", "think", "it", "s", "impossible", "to", "get", "the", "content", "type", "without", "the", "mime", "types", "gem", "NUMBER", "This", "isn", "t", "really", "specific", "to", "fog", "as", "well", "it", "s", "just", "a", "bug", "that", "crops", "up", "when", "the", "file", "be", "retrieved", "from", "the", "cache", "because", "in", "this", "case", "the", "file", "has", "no", "content", "type", "to", "start", "off", "of", "NUMBER", "Regardless", "your", "code", "pass", "all", "the", "specs", "for", "me", "NUMBER", "Do", "you", "wanna", "try", "and", "pursue", "a", "cache", "on", "the", "CarrierWave", "class", "Yeah", "that", "s", "a", "good", "point", "NUMBER", "I", "think", "that", "the", "mime", "types", "gem", "be", "the", "way", "to", "go", "then", "NUMBER", "Might", "as", "well", "add", "it", "to", "the", "dependencies", "as", "well", "while", "you", "re", "at", "it", "NUMBER", "In", "that", "case", "it", "looks", "like", "your", "branch", "works", "just", "fine", "This", "problem", "will", "happen", "for", "any", "storage", "solution", "though", "NUMBER", "Even", "if", "you", "re", "just", "use", "the", "filesystem", "the", "content", "type", "will", "be", "blown", "away", "upon", "retrieve_from_cache", "That", "seems", "like", "the", "way", "to", "go", "I", "think", "Rails", "depends", "on", "mime", "types", "anyway", "NUMBER", "It", "s", "probably", "not", "too", "huge", "a", "gem", "and", "I", "can", "t", "really", "think", "of", "any", "other", "way", "to", "do", "this", "NUMBER", "I", "be", "currently", "test", "Carrierwave", "w", "Mongoid", "in", "Rails", "NUMBER", "NUMBER", "file", "storage", "Everything", "seems", "OK", "accorfding", "to", "documentation", "examples", "but", "I", "get", "an", "error", "TypeError", "can", "t", "dump", "File", "Is", "it", "relate", "to", "your", "discussion", "about", "the", "pending", "bug", "here", "be", "the", "params", "send", "in", "the", "request", "when", "submit", "the", "form", "picture", "class", "TAG", "size", "NUMBER", "filename", "hash_merging", "NUMBER", "rtf", "r", "nContent", "Type", "text", "rtf", "r", "n", "tempfile", "File", "var", "folders", "NK", "NKfWCW", "NUMBER", "eEVCg", "NUMBER", "ERnpPsnME", "TI", "Tmp", "RackMultipart", "NUMBER", "NUMBER", "iqgqi", "NUMBER", "This", "stops", "work", "as", "soon", "as", "you", "have", "something", "like", "this", "in", "in", "your", "uploader", "ruby", "process", "convert", "png", "This", "be", "due", "to", "the", "fact", "that", "the", "temp", "file", "retains", "to", "original", "file", "name", "including", "the", "original", "extension", "which", "the", "mime", "type", "lookup", "uses", "to", "determine", "the", "content", "type", "NUMBER", "Even", "if", "you", "have", "a", "filename", "method", "that", "renames", "the", "file", "to", "whatever", "NUMBER", "png", "the", "file", "isn", "t", "actually", "renamed", "until", "it", "be", "copied", "from", "the", "temp", "folder", "to", "the", "final", "destination", "NUMBER", "Running", "on", "master", "with", "NUMBER", "After", "uploading", "I", "can", "t", "retrieve", "the", "upload", "file", "name", "tried", "use", "both", "fog", "and", "file", "storage", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "Photo", "NUMBER", "first", "NUMBER", "image", "NUMBER", "filename", "nil", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "Photo", "NUMBER", "first", "NUMBER", "image", "NUMBER", "path", "photos", "NUMBER", "NUMBER", "_itswood_", "NUMBER", "x", "NUMBER", "jpg", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "Photo", "NUMBER", "first", "NUMBER", "image", "NUMBER", "url", "LINK", "dev", "photos", "NUMBER", "NUMBER", "_itswood_", "NUMBER", "x", "NUMBER", "jpg", "AWSAccessKeyId", "AKIxxxYA", "Signature", "NUMBER", "FxxxExpires", "NUMBER", "Essentially", "this", "and", "LINK", "issue", "NUMBER", "be", "symptoms", "of", "the", "same", "problem", "it", "s", "simply", "a", "bad", "idea", "for", "the", "column", "storing", "the", "filename", "and", "the", "mounter", "column", "to", "have", "the", "same", "name", "NUMBER", "If", "they", "were", "different", "this", "problem", "would", "be", "moot", "because", "we", "could", "simply", "call", "mounted_on_filename", "or", "whatever", "and", "get", "the", "name", "NUMBER", "Can", "t", "give", "much", "info", "NUMBER", "When", "use", "the", "minimagick", "with", "rails", "I", "receive", "unhelpful", "processing", "error", "NUMBER", "No", "trace", "no", "add", "info", "where", "it", "went", "wrong", "just", "processing", "fail", "NUMBER", "Doesn", "t", "even", "mention", "minimagick", "NUMBER", "Switching", "to", "image_science", "fix", "the", "problem", "NUMBER", "It", "s", "possible", "I", "m", "reading", "the", "docs", "wrong", "and", "minimagick", "be", "no", "longer", "support", "My", "issue", "be", "not", "that", "minimagick", "be", "fail", "but", "that", "the", "error", "message", "I", "m", "get", "be", "so", "useless", "NUMBER", "No", "trace", "nothing", "NUMBER", "Is", "there", "a", "hook", "I", "m", "miss", "because", "at", "the", "moment", "there", "be", "no", "way", "for", "me", "to", "debug", "the", "issue", "myself", "NUMBER", "On", "Mar", "NUMBER", "NUMBER", "at", "NUMBER", "NUMBER", "AM", "trevorturk", "write", "I", "m", "not", "sure", "honestly", "I", "d", "suggest", "use", "image_science", "that", "seems", "to", "be", "work", "for", "you", "NUMBER", "I", "m", "going", "to", "close", "this", "issue", "b", "c", "I", "believe", "others", "be", "use", "minimagick", "successfully", "NUMBER", "You", "might", "double", "check", "by", "ask", "the", "Google", "Group", "if", "anyone", "be", "use", "minimagick", "though", "if", "you", "re", "so", "inclined", "NUMBER", "If", "it", "turns", "out", "to", "be", "a", "widespread", "problem", "we", "can", "investigate", "more", "deeply", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "comment_", "NUMBER", "Indeed", "you", "d", "want", "to", "set", "ignore_processing_errors", "to", "false", "to", "get", "a", "stack", "trace", "NUMBER", "By", "default", "CarrierWave", "will", "let", "these", "fail", "silently", "and", "then", "add", "a", "validation", "error", "on", "the", "model", "NUMBER", "please", "ignore", "NUMBER", "did", "not", "first", "grok", "how", "version", "were", "use", "NUMBER", "Adding", "carrierwave", "to", "an", "empty", "Rails", "project", "causes", "the", "active_record", "framework", "to", "be", "eagerly", "loaded", "NUMBER", "This", "patch", "leverages", "the", "on_load", "API", "available", "in", "Railties", "to", "determine", "when", "to", "load", "NUMBER", "This", "keep", "things", "lazy", "loaded", "NUMBER", "While", "the", "ActiveRecord", "module", "be", "defined", "none", "of", "the", "modules", "or", "classes", "inside", "ActiveRecord", "be", "loaded", "NUMBER", "At", "the", "bottom", "of", "orm", "active_record", "NUMBER", "rb", "when", "it", "calls", "ActiveRecord", "Base", "NUMBER", "extend", "it", "triggers", "all", "of", "active_record", "to", "get", "loaded", "NUMBER", "LINK", "NUMBER", "stable", "activerecord", "lib", "active_record", "NUMBER", "rb", "Running", "individual", "test", "and", "starting", "a", "rails", "server", "in", "development", "mode", "be", "faster", "NUMBER", "Sure", "a", "typical", "request", "hits", "the", "full", "stack", "and", "in", "this", "case", "there", "be", "no", "benefit", "NUMBER", "In", "other", "cases", "I", "m", "use", "carrier_wave", "with", "cassandra", "or", "run", "an", "individual", "view", "helper", "test", "that", "do", "not", "require", "active", "record", "NUMBER", "Basically", "anything", "run", "with", "cache_classes", "set", "to", "false", "should", "only", "load", "the", "ruby", "file", "required", "for", "execution", "NUMBER", "A", "couple", "test", "show", "that", "simply", "add", "carrierwave", "to", "an", "empty", "rails", "project", "change", "the", "rails", "s", "start", "time", "from", "NUMBER", "seconds", "to", "NUMBER", "seconds", "NUMBER", "I", "assume", "that", "s", "how", "long", "it", "takes", "for", "active_record", "to", "load", "NUMBER", "This", "doesn", "t", "add", "any", "functionality", "so", "I", "can", "t", "say", "I", "need", "this", "NUMBER", "I", "have", "however", "gotten", "some", "other", "gems", "such", "as", "will_paginate", "and", "thinking_sphinx", "to", "use", "it", "NUMBER", "Thanks", "a", "lot", "NUMBER", "It", "s", "a", "great", "gem", "class", "Document", "TAG", "error", "As", "I", "said", "this", "can", "be", "avoided", "by", "use", "mount_on", "to", "mount", "on", "a", "different", "key", "that", "the", "DB", "column", "name", "NUMBER", "I", "wonder", "if", "anything", "can", "be", "do", "in", "carrierwave", "to", "avoid", "this", "assignment", "uploader", "db", "value", "to", "improve", "the", "project", "NUMBER", "The", "problem", "stems", "from", "doing", "r", "NUMBER", "attributes", "r", "NUMBER", "attributes", "on", "two", "records", "NUMBER", "We", "could", "override", "the", "attributes", "method", "on", "our", "model", "like", "def", "attributes", "attrs", "attribute_names", "NUMBER", "each", "name", "attrs", "name", "name", "file", "self", "NUMBER", "file", "read_attribute", "name", "attrs", "end", "I", "m", "not", "sure", "if", "that", "breaks", "anything", "NUMBER", "Anyway", "I", "think", "it", "s", "a", "best", "practice", "to", "mount", "on", "a", "different", "name", "there", "seems", "to", "be", "quite", "a", "few", "cross", "cuts", "if", "one", "mounts", "on", "the", "same", "key", "name", "NUMBER", "ActiveRecord", "has", "the", "attributes", "getter", "and", "setter", "to", "work", "with", "attributes", "all", "at", "once", "the", "problem", "be", "that", "the", "getter", "uses", "read_attribute", "attr", "and", "the", "setter", "uses", "the", "AR", "dynamically", "generate", "setters", "attr", "NUMBER", "If", "one", "overrides", "the", "setter", "for", "the", "file", "column", "the", "accessor", "that", "use", "to", "set", "get", "DB", "values", "now", "set", "gets", "the", "uploader", "the", "AR", "API", "contract", "might", "break", "like", "in", "the", "attributes", "case", "NUMBER", "Mounting", "the", "uploader", "on", "a", "different", "key", "like", "mount_uploader", "file", "FileUploader", "mount_on", "name", "instead", "mount_uploader", "file", "FileUploader", "ensures", "that", "we", "don", "t", "interfere", "with", "AR", "s", "usual", "attribute", "logic", "NUMBER", "I", "guess", "either", "of", "these", "NUMBER", "NUMBER", "File", "a", "bug", "report", "in", "AR", "for", "use", "for", "attributes", "accessor", "read_attribute", "attr", "in", "the", "getter", "and", "attr", "in", "the", "setter", "they", "should", "both", "be", "the", "same", "I", "think", "don", "t", "know", "the", "inner", "details", "of", "AR", "NUMBER", "Monkey", "patch", "AR", "attributes", "accessor", "from", "carrierwave", "adapter", "when", "mounting", "NUMBER", "Raise", "mount", "overriding", "error", "if", "trying", "to", "mount", "on", "the", "same", "key", "regard", "NUMBER", "both", "always", "use", "mount_on", "always", "mount", "on", "different", "key", "I", "ve", "be", "thinking", "for", "a", "long", "time", "that", "we", "should", "probably", "change", "CarrierWave", "to", "default", "to", "use", "mount_column_filename", "or", "something", "instead", "of", "just", "mount_column", "it", "s", "a", "hugely", "breaking", "change", "though", "essentially", "breaking", "NUMBER", "of", "applications", "use", "CarrierWave", "NUMBER", "It", "should", "be", "do", "but", "I", "m", "reluctant", "to", "do", "it", "NUMBER", "What", "do", "you", "guys", "think", "In", "that", "case", "we", "could", "raise", "an", "error", "when", "trying", "to", "mount", "on", "a", "column", "with", "the", "same", "name", "as", "the", "uploader", "NUMBER", "Just", "realized", "that", "technically", "it", "s", "not", "the", "filename", "we", "re", "storing", "but", "rather", "what", "we", "ve", "be", "calling", "identifier", "in", "CarrierWave", "NUMBER", "mount_column_identifier", "sounds", "a", "bit", "weird", "and", "might", "trip", "some", "people", "up", "NUMBER", "Hmmm", "NUMBER", "Just", "thought", "I", "d", "mention", "to", "anyone", "run", "into", "this", "bug", "the", "workaround", "be", "to", "rename", "field", "in", "database", "and", "specify", "mount_on", "option", "when", "mounting", "uploader", "NUMBER", "For", "me", "this", "happened", "when", "use", "form", "with", "nested", "models", "NUMBER", "For", "example", "I", "had", "Avatar", "model", "accepting", "nested", "attributes", "for", "AvatarImages", "AvatarImage", "has", "uploader", "mounted", "NUMBER", "The", "error", "happened", "every", "time", "when", "form", "with", "invalid", "data", "be", "submitted", "NUMBER", "I", "think", "it", "s", "strange", "that", "noone", "notice", "this", "before", "as", "what", "I", "m", "doing", "seems", "pretty", "common", "to", "me", "NUMBER", "I", "spoke", "with", "Jonas", "about", "this", "in", "depth", "and", "we", "agreed", "that", "this", "be", "a", "shitty", "situation", "NUMBER", "On", "the", "one", "hand", "we", "know", "there", "s", "a", "problem", "and", "want", "to", "fix", "it", "NUMBER", "On", "the", "other", "hand", "we", "don", "t", "want", "to", "break", "everyone", "s", "applications", "by", "make", "a", "huge", "change", "NUMBER", "So", "I", "d", "like", "to", "ask", "you", "guys", "to", "work", "up", "a", "new", "section", "on", "the", "wiki", "that", "explains", "the", "situation", "and", "suggests", "that", "people", "use", "the", "mount_on", "option", "if", "when", "they", "run", "into", "issue", "like", "this", "NUMBER", "Would", "one", "of", "you", "like", "to", "volunteer", "for", "that", "Jonas", "and", "I", "aren", "t", "having", "the", "problem", "so", "I", "don", "t", "think", "we", "re", "the", "best", "people", "to", "do", "a", "write", "up", "NUMBER", "Thanks", "so", "much", "I", "m", "sorry", "about", "this", "messy", "situation", "NUMBER", "I", "ve", "add", "a", "quick", "section", "stub", "about", "this", "to", "the", "wiki", "NUMBER", "Please", "do", "consider", "add", "more", "detail", "if", "possible", "Active", "Record", "provides", "attr_changed", "attr_was", "that", "show", "if", "the", "attribute", "was", "change", "and", "also", "show", "the", "old", "value", "of", "the", "attribute", "NUMBER", "LINK", "It", "would", "be", "nice", "if", "the", "carrierwave", "column", "would", "also", "answer", "this", "cases", "NUMBER", "Regarding", "attr_changed", "it", "s", "easy", "to", "implement", "by", "looking", "at", "the", "cache", "def", "attr_changed", "attr", "NUMBER", "cached", "end", "i", "be", "use", "webrick", "server", "with", "rails", "NUMBER", "and", "ruby", "NUMBER", "to", "develop", "a", "simple", "upload", "test", "use", "carrierwave", "NUMBER", "On", "submit", "this", "form", "form_for", "institution", "html", "multipart", "true", "do", "f", "my", "webrick", "server", "throw", "a", "NUMBER", "internal", "server", "error", "NUMBER", "console", "says", "Started", "POST", "testupload", "NUMBER", "for", "NUMBER", "at", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "TypeError", "can", "t", "convert", "nil", "into", "Integer", "Error", "during", "failsafe", "response", "ActionView", "Template", "Error", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "whiny_nil", "NUMBER", "rb", "NUMBER", "in", "method_missing", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "http", "parameters", "NUMBER", "rb", "NUMBER", "in", "parameters", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "template", "rescues", "diagnostics", "NUMBER", "erb", "NUMBER", "in", "__home_txterm__rvm_rubies_ruby_______p__lib_ruby_gems_______gems_actionpack_______lib_action_dispatch_middleware_templates_rescues_diagnostics_erb___", "NUMBER", "_", "NUMBER", "__", "NUMBER", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_view", "template", "NUMBER", "rb", "NUMBER", "in", "block", "in", "render", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_view", "template", "NUMBER", "rb", "NUMBER", "in", "render", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_view", "render", "rendering", "NUMBER", "rb", "NUMBER", "in", "block", "in", "_render_template", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_view", "render", "rendering", "NUMBER", "rb", "NUMBER", "in", "_render_template", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_view", "render", "rendering", "NUMBER", "rb", "NUMBER", "in", "render", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "haml", "NUMBER", "lib", "haml", "helpers", "action_view_mods", "NUMBER", "rb", "NUMBER", "in", "render_with_haml", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "rescue_action_locally", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "render_exception", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "rescue", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "home", "tbotxtermhr", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "TAG", "NUMBER", "in", "synchronize", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "Rendered", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "template", "rescues", "diagnostics", "NUMBER", "erb", "within", "rescues", "layout", "NUMBER", "ms", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "gems", "NUMBER", "gems", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "home", "txterm", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "same", "project", "as", "LINK", "example", "app", "my", "os", "be", "ubuntu", "NUMBER", "be", "perhaps", "webtrick", "the", "problem", "See", "for", "discussion", "on", "this", "issue", "LINK", "issue", "NUMBER", "Note", "This", "be", "my", "first", "pull", "request", "ever", "and", "I", "be", "only", "busy", "for", "a", "couple", "of", "months", "in", "Ruby", "so", "if", "things", "don", "t", "seem", "right", "or", "unconventional", "it", "s", "because", "of", "that", "I", "test", "it", "on", "Rails", "NUMBER", "Ruby", "NUMBER", "but", "its", "a", "minor", "change", "I", "don", "t", "expect", "it", "to", "break", "things", "don", "t", "we", "all", "Added", "a", "spec", "hope", "this", "will", "suffice", "NUMBER", "See", "my", "comments", "in", "the", "commit", "LINK", "Great", "thanks", "to", "you", "too", "When", "rendering", "a", "model", "with", "a", "mounted", "uploader", "I", "can", "reference", "a", "version", "like", "so", "user", "NUMBER", "avatar", "NUMBER", "umb", "NUMBER", "url", "However", "when", "use", "render", "json", "user", "only", "user", "NUMBER", "avatar", "NUMBER", "url", "be", "available", "in", "the", "rendered", "hash", "I", "just", "looked", "in", "uploader", "url", "NUMBER", "rb", "to", "see", "what", "you", "mean", "with", "what", "be", "set", "as", "as_json", "NUMBER", "However", "user", "NUMBER", "to_json", "returns", "only", "the", "avatar", "NUMBER", "url", "Just", "tried", "to", "do", "a", "puts", "user", "NUMBER", "to_json", "and", "it", "would", "only", "give", "me", "user", "avatar", "url", "LINK", "I", "think", "the", "NUMBER", "to_json", "also", "responds", "to", "as_json", "in", "this", "particular", "case", "not", "only", "for", "a", "call", "to", "render", "json", "NUMBER", "So", "maybe", "version", "support", "should", "be", "add", "to", "the", "as_json", "method", "in", "uploader", "url", "NUMBER", "rb", "I", "be", "not", "really", "that", "competent", "yet", "in", "Ruby", "but", "I", "think", "that", "would", "be", "a", "solution", "NUMBER", "I", "be", "use", "CanCan", "to", "get", "the", "model", "itself", "that", "s", "the", "only", "modification", "NUMBER", "This", "can", "t", "be", "the", "problem", "tho", "else", "I", "wouldn", "t", "be", "able", "to", "get", "the", "NUMBER", "url", "at", "all", "Sorry", "will", "try", "to", "give", "more", "information", "Running", "Rails", "NUMBER", "app", "on", "Ruby", "NUMBER", "Using", "CanCan", "gem", "to", "get", "User", "model", "NUMBER", "Using", "Carrierwave", "gem", "NUMBER", "Using", "model", "call", "User", "mounted", "uploader", "on", "avatar", "with", "a", "version", "thumb", "Calling", "a", "users", "NUMBER", "json", "on", "my", "app", "calls", "render", "json", "user", "or", "user", "NUMBER", "to_json", "no", "difference", "Expected", "output", "user", "avatar", "url", "LINK", "thumb", "url", "LINK", "Actual", "output", "user", "avatar", "url", "LINK", "yes", "sorry", "left", "the", "common", "id", "and", "updated_at", "etc", "out", "for", "unneed", "clutter", "so", "yes", "user", "NUMBER", "to_json", "Also", "just", "remove", "CanCan", "for", "that", "particular", "Model", "action", "just", "to", "take", "away", "possible", "causes", "NUMBER", "Still", "the", "same", "NUMBER", "Trevor", "no", "that", "s", "not", "the", "issue", "NUMBER", "Issue", "be", "user", "NUMBER", "to_json", "doesn", "t", "include", "any", "of", "the", "version", "NUMBER", "re", "your", "last", "comment", "NUMBER", "Ok", "clear", "will", "try", "to", "see", "if", "I", "can", "put", "together", "my", "first", "pull", "request", "NUMBER", "First", "have", "to", "figure", "out", "how", "to", "run", "the", "master", "instead", "of", "the", "gem", "tells", "a", "lot", "about", "my", "Rails", "experience", "Thanks", "for", "your", "help", "anyway", "it", "s", "a", "great", "gem", "Ok", "add", "a", "pull", "request", "see", "LINK", "Hi", "there", "I", "don", "t", "know", "if", "it", "s", "a", "bug", "but", "I", "think", "so", "NUMBER", "I", "couldn", "t", "find", "a", "solution", "for", "my", "problem", "NUMBER", "My", "uploader", "uses", "SecureRandom", "NUMBER", "hex", "for", "the", "filename", "NUMBER", "I", "ve", "add", "a", "new", "version", "and", "call", "asset", "NUMBER", "recreate_versions", "on", "every", "asset", "currently", "stored", "in", "the", "database", "NUMBER", "The", "new", "version", "be", "created", "BUT", "the", "problem", "be", "the", "new", "version", "gets", "a", "completly", "new", "filename", "NUMBER", "Example", "I", "upload", "an", "image", "it", "gets", "an", "filename", "like", "NUMBER", "jpg", "NUMBER", "Then", "when", "I", "run", "recreate_versions", "on", "this", "image", "the", "version", "s", "filename", "look", "like", "version_", "NUMBER", "jpg", "NUMBER", "Therefore", "if", "I", "want", "to", "retrieve", "a", "specific", "version", "of", "the", "image", "the", "image", "can", "not", "be", "find", "NUMBER", "I", "think", "it", "would", "be", "better", "if", "recreate_versions", "do", "not", "rename", "or", "generate", "new", "filenames", "or", "the", "new", "filename", "has", "to", "be", "stored", "in", "the", "database", "NUMBER", "Regards", "Martin", "i", "be", "having", "an", "issue", "returning", "an", "uploader", "class", "object", "from", "cache", "NUMBER", "i", "have", "tried", "ProductImageUploader", "NUMBER", "new", "NUMBER", "retrieve_from_cache", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "screen", "NUMBER", "png", "however", "it", "only", "returns", "an", "array", "of", "retrieve_versions_from_cache", "i", "confirmed", "that", "the", "cache_name", "be", "valid", "and", "exists", "in", "the", "cache_dir", "NUMBER", "be", "i", "use", "this", "method", "incorrectly", "Hi", "guys", "In", "development", "when", "trying", "to", "upload", "to", "s", "NUMBER", "I", "m", "get", "Segmentation", "fault", "TAG", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "BUG", "Segmentation", "fault", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "control", "frame", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "connect", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "put_object", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "s", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "s", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_s", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "web_projects", "FSRGlobal", "app", "controllers", "admin", "mail_templates_controller", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "e", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "a", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "call", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "haml", "NUMBER", "lib", "sass", "plugin", "rack", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "query_cach", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "e", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "TAG", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "fe", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "TOP", "Ruby", "level", "backtrace", "information", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "TAG", "NUMBER", "in", "synchronize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_call_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection_pool", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "haml", "NUMBER", "lib", "sass", "plugin", "rack", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "recognize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "optimized_each", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "recognize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "block", "in", "action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "in", "process", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_process_action_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__process_action__", "NUMBER", "__callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "in", "send_action", "Users", "Jonas", "web_projects", "FSRGlobal", "app", "controllers", "admin", "mail_templates_controller", "NUMBER", "rb", "NUMBER", "in", "create", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "rollback_active_record_state", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "in", "create_or_update", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_attachment", "NUMBER", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "s", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "storage", "s", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "put_object", "NUMBER", "rb", "NUMBER", "in", "put_object", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "C", "level", "backtrace", "information", "NOTE", "You", "may", "have", "encountered", "a", "bug", "in", "the", "Ruby", "interpreter", "or", "extension", "libraries", "NUMBER", "Bug", "report", "be", "welcome", "NUMBER", "For", "details", "LINK", "lang", "NUMBER", "org", "bugreport", "NUMBER", "html", "Abort", "trap", "TAG", "My", "S", "NUMBER", "initializer", "TAG", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "NUMBER", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "NUMBER", "config", "NUMBER", "s", "NUMBER", "_bucket", "NUMBER", "config", "NUMBER", "s", "NUMBER", "_region", "eu", "west", "NUMBER", "end", "TAG", "The", "uploader", "be", "obviously", "set", "to", "storage", "s", "NUMBER", "and", "works", "fine", "with", "file", "I", "didn", "t", "notice", "any", "other", "issue", "with", "this", "and", "it", "doesn", "t", "seem", "to", "be", "describe", "anywhere", "so", "as", "you", "might", "imagine", "pretty", "unexpect", "NUMBER", "Any", "ideas", "what", "might", "be", "wrong", "Thanks", "Yeah", "I", "m", "get", "the", "same", "error", "with", "the", "master", "branch", "NUMBER", "Since", "I", "haven", "t", "had", "any", "success", "connecting", "to", "s", "NUMBER", "I", "m", "not", "NUMBER", "this", "be", "work", "perfectly", "NUMBER", "However", "I", "guess", "it", "shouldn", "t", "cause", "segmentation", "fault", "NUMBER", "Please", "let", "me", "know", "if", "there", "be", "a", "reasonable", "way", "to", "debug", "it", "the", "gem", "seems", "really", "nice", "NUMBER", "Gemfile", "gem", "carrierwave", "git", "LINK", "branch", "master", "Initializer", "TAG", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "Hidden", "aws_access_key_id", "Hidden", "aws_secret_access_key", "Hidden", "region", "eu", "west", "NUMBER", "config", "NUMBER", "fog_directory", "fsrglobal", "end", "TAG", "System", "fog", "NUMBER", "carrierwave", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "Error", "TAG", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "BUG", "Segmentation", "fault", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "control", "frame", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "connect", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "b", "NUMBER", "d", "NUMBER", "b", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "get_bucket", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "directories", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "e", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "b", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_s", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "b", "NUMBER", "d", "NUMBER", "b", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "b", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "web_projects", "FSRGlobal", "app", "controllers", "admin", "mail_templates_controller", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "b", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "b", "NUMBER", "d", "NUMBER", "b", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "call", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "haml", "NUMBER", "lib", "sass", "plugin", "rack", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "query_cach", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "TAG", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "TOP", "Ruby", "level", "backtrace", "information", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "Users", "Jonas", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "TAG", "NUMBER", "in", "synchronize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_call_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "connection_pool", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "query_cache", "NUMBER", "rb", "NUMBER", "in", "cache", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "query_cache", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "haml", "NUMBER", "lib", "sass", "plugin", "rack", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "recognize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "optimized_each", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "recognize", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "block", "in", "action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "dispatch", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "in", "process", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_process_action_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__process_action__", "NUMBER", "__callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process_action", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "in", "send_action", "Users", "Jonas", "web_projects", "FSRGlobal", "app", "controllers", "admin", "mail_templates_controller", "NUMBER", "rb", "NUMBER", "in", "create", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "rollback_active_record_state", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "with_transaction_returning_status", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "transaction", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "connection_adapters", "abstract", "database_statements", "NUMBER", "rb", "NUMBER", "in", "transaction", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "in", "with_transaction_returning_status", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "transactions", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "attribute_methods", "dirty", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "validations", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "persistence", "NUMBER", "rb", "NUMBER", "in", "save", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activerecord", "NUMBER", "lib", "active_record", "callbacks", "NUMBER", "rb", "NUMBER", "in", "create_or_update", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_attachment", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "store", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "bundler", "gems", "carrierwave", "NUMBER", "a", "NUMBER", "c", "NUMBER", "d", "NUMBER", "lib", "carrierwave", "storage", "fog", "NUMBER", "rb", "NUMBER", "in", "directory", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "directories", "NUMBER", "rb", "NUMBER", "in", "get", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "get_bucket", "NUMBER", "rb", "NUMBER", "in", "get_bucket", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "C", "level", "backtrace", "information", "NOTE", "You", "may", "have", "encountered", "a", "bug", "in", "the", "Ruby", "interpreter", "or", "extension", "libraries", "NUMBER", "Bug", "report", "be", "welcome", "NUMBER", "For", "details", "LINK", "lang", "NUMBER", "org", "bugreport", "NUMBER", "html", "Abort", "trap", "TAG", "Yeah", "segmentation", "faults", "be", "always", "a", "bit", "shocking", "and", "unexpect", "NUMBER", "This", "one", "be", "on", "a", "Socket", "connect", "which", "be", "pretty", "core", "to", "things", "work", "in", "general", "NUMBER", "Are", "you", "able", "to", "make", "other", "http", "request", "ie", "with", "Net", "HTTP", "from", "this", "machine", "How", "about", "use", "fog", "directly", "I", "just", "setup", "this", "same", "ruby", "fog", "excon", "version", "on", "my", "machine", "and", "tried", "some", "basic", "request", "and", "didn", "t", "have", "any", "luck", "reproducing", "so", "any", "additional", "details", "would", "be", "great", "to", "help", "narrow", "it", "down", "NUMBER", "Thanks", "wes", "Ok", "so", "I", "get", "a", "bit", "closer", "to", "the", "origin", "of", "the", "error", "NUMBER", "A", "gem", "I", "write", "for", "the", "app", "seems", "to", "be", "cause", "some", "issue", "NUMBER", "I", "suspect", "it", "to", "be", "something", "with", "the", "dependencies", "among", "those", "em", "http", "request", "NUMBER", "By", "requiring", "the", "carrierwave", "gem", "after", "the", "other", "gem", "I", "get", "rid", "of", "the", "segmentation", "fault", "NUMBER", "I", "did", "however", "run", "into", "another", "issue", "I", "m", "consistently", "get", "WARN", "fog", "the", "specified", "s", "NUMBER", "bucket", "name", "be", "not", "a", "valid", "dns", "name", "which", "will", "negatively", "impact", "performance", "NUMBER", "For", "details", "see", "LINK", "A", "google", "search", "indicated", "that", "other", "people", "have", "had", "similar", "issue", "with", "the", "eu", "west", "NUMBER", "region", "NUMBER", "Can", "anybody", "confirm", "this", "issue", "Perhaps", "even", "point", "towards", "a", "solution", "Thanks", "for", "all", "the", "help", "it", "s", "really", "appreciated", "If", "I", "had", "to", "guess", "your", "bucket", "name", "probably", "has", "an", "underscore", "in", "it", "NUMBER", "Basically", "you", "can", "address", "buckets", "in", "amazon", "one", "of", "two", "ways", "via", "subdomains", "or", "via", "path", "NUMBER", "If", "you", "have", "something", "that", "be", "a", "valid", "subdomain", "it", "will", "use", "it", "which", "be", "faster", "and", "if", "you", "have", "something", "that", "be", "not", "a", "valid", "subdomain", "it", "will", "use", "the", "path", "method", "which", "be", "slower", "NUMBER", "You", "be", "evidently", "not", "following", "one", "of", "the", "rules", "of", "valid", "subdomains", "you", "can", "see", "the", "whole", "list", "at", "that", "s", "NUMBER", "url", "but", "_", "be", "probably", "the", "most", "likely", "culprit", "NUMBER", "Ok", "a", "couple", "of", "update", "NUMBER", "In", "an", "attempt", "to", "try", "out", "the", "release", "gem", "the", "segmentation", "fault", "returned", "and", "unfortunately", "it", "stayed", "around", "after", "switching", "back", "to", "the", "master", "branch", "NUMBER", "I", "tried", "different", "things", "upgrading", "to", "ruby", "NUMBER", "p", "NUMBER", "remove", "and", "reinstalling", "gemsets", "and", "without", "knowing", "exactly", "what", "cause", "it", "the", "segmentation", "fault", "be", "now", "gone", "again", "NUMBER", "I", "notice", "that", "fog", "uses", "Nokogiri", "which", "has", "cause", "segmentation", "faults", "for", "me", "previously", "NUMBER", "I", "doubt", "it", "s", "cause", "it", "though", "NUMBER", "Regarding", "the", "bucket", "name", "I", "m", "pretty", "sure", "it", "s", "valid", "fsrglobal", "I", "ve", "tried", "others", "as", "well", "NUMBER", "When", "use", "fog", "directly", "I", "can", "create", "read", "and", "upload", "to", "buckets", "NUMBER", "TAG", "fog", "Welcome", "to", "fog", "interactive", "default", "provides", "AWS", "directory", "AWS", "NUMBER", "directories", "NUMBER", "create", "key", "lotsofblondesinhere", "TAG", "file", "directory", "NUMBER", "file", "NUMBER", "create", "key", "Gemfile", "body", "File", "NUMBER", "read", "Gemfile", "TAG", "got_dir", "AWS", "NUMBER", "directories", "NUMBER", "get", "lotsofblondesinhere", "TAG", "got_dir", "AWS", "NUMBER", "directories", "NUMBER", "get", "fsrglobal", "WARN", "fog", "followed", "redirect", "to", "fsrglobal", "NUMBER", "s", "NUMBER", "external", "NUMBER", "amazonaws", "NUMBER", "com", "connecting", "to", "the", "matching", "region", "will", "be", "more", "performant", "TAG", "TAG", "As", "you", "can", "see", "I", "can", "even", "get", "the", "eu", "version", "bucket", "NUMBER", "I", "guess", "that", "means", "I", "just", "have", "my", "fog", "configuration", "wrong", "Can", "anyone", "show", "an", "example", "of", "an", "eu", "west", "NUMBER", "configuration", "with", "the", "access", "key", "hidden", "If", "there", "s", "something", "essential", "that", "I", "m", "get", "wrong", "please", "let", "me", "know", "NUMBER", "If", "there", "be", "I", "ll", "put", "together", "something", "to", "make", "sure", "it", "doesn", "t", "happen", "to", "other", "people", "NUMBER", "I", "took", "a", "break", "looked", "at", "it", "with", "fresh", "eyes", "and", "realized", "that", "my", "uploader", "wasn", "t", "set", "to", "fog", "NUMBER", "Fog", "I", "also", "find", "the", "source", "of", "the", "segmentation", "fault", "at", "least", "on", "this", "machine", "the", "mysql", "gem", "NUMBER", "I", "ve", "uploaded", "an", "example", "project", "demonstrating", "the", "issue", "LINK", "mysql", "problem", "tree", "The", "master", "branch", "be", "work", "use", "sqlite", "NUMBER", "The", "two", "other", "branch", "with", "mysql", "and", "mysql", "NUMBER", "goes", "segmentation", "berserk", "NUMBER", "Can", "you", "reproduce", "it", "I", "m", "sorry", "this", "thread", "seems", "endless", "but", "I", "just", "tried", "update", "my", "entire", "system", "and", "the", "issue", "be", "exactly", "the", "same", "NUMBER", "Updated", "xcode", "reinstall", "rvm", "with", "all", "gems", "mysql", "NUMBER", "I", "ve", "also", "tried", "these", "rubies", "ruby", "NUMBER", "p", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "System", "Rails", "NUMBER", "mysql", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "rvm", "NUMBER", "Gems", "mysql", "NUMBER", "NUMBER", "fog", "NUMBER", "carrierwave", "NUMBER", "master", "OpenSSL", "NUMBER", "d", "NUMBER", "Feb", "NUMBER", "I", "m", "kind", "of", "loosing", "my", "breath", "on", "this", "one", "NUMBER", "I", "m", "sure", "it", "s", "something", "fishy", "at", "least", "different", "with", "my", "dev", "setup", "but", "I", "have", "no", "clue", "how", "to", "move", "forward", "from", "here", "I", "think", "so", "yeah", "NUMBER", "I", "backtracked", "the", "excon", "source", "code", "indicating", "that", "it", "s", "an", "issue", "with", "OpenSSL", "SSL", "SSLSocket", "NUMBER", "geemus", "any", "help", "would", "be", "massively", "appreciated", "NUMBER", "Reading", "through", "this", "and", "subsequently", "reading", "through", "the", "mysql", "NUMBER", "source", "didn", "t", "really", "give", "me", "any", "leads", "NUMBER", "Also", "the", "reproduction", "case", "repository", "be", "gone", "now", "so", "I", "didn", "t", "get", "a", "chance", "to", "really", "look", "into", "that", "NUMBER", "I", "guess", "it", "be", "possible", "that", "it", "would", "have", "to", "do", "with", "the", "openssl", "version", "as", "well", "but", "this", "seems", "unlikely", "if", "it", "works", "without", "the", "presence", "of", "the", "mysql", "NUMBER", "gem", "NUMBER", "So", "unfortunately", "I", "be", "also", "drawing", "blanks", "NUMBER", "Thanks", "for", "all", "the", "efforts", "geemus", "and", "trevorturk", "NUMBER", "Is", "this", "the", "repository", "you", "was", "referring", "to", "LINK", "mysql", "problem", "Yep", "the", "tree", "version", "of", "the", "url", "from", "above", "NUMBER", "s", "for", "me", "NUMBER", "Looked", "over", "that", "a", "bit", "too", "still", "nothing", "jumping", "out", "at", "me", "I", "m", "afraid", "NUMBER", "I", "guess", "it", "s", "not", "my", "day", "P", "Can", "you", "clone", "this", "LINK", "mysql", "problem", "NUMBER", "git", "Otherwise", "here", "s", "a", "zip", "of", "the", "app", "directory", "LINK", "Oh", "sorry", "I", "was", "unclear", "there", "NUMBER", "After", "you", "gave", "the", "link", "I", "could", "get", "to", "the", "code", "just", "fine", "I", "just", "was", "not", "able", "to", "find", "anything", "that", "seem", "likely", "to", "be", "cause", "the", "problem", "NUMBER", "No", "problem", "If", "there", "s", "anything", "I", "can", "do", "to", "try", "and", "locate", "the", "bug", "please", "let", "me", "know", "NUMBER", "Paperclip", "be", "just", "not", "this", "cool", "NUMBER", "I", "be", "having", "the", "exact", "same", "problem", "within", "a", "rake", "task", "to", "backup", "a", "file", "NUMBER", "Error", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "BUG", "Segmentation", "fault", "ruby", "NUMBER", "p", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "revision", "NUMBER", "x", "NUMBER", "_", "NUMBER", "darwin", "NUMBER", "control", "frame", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "connect", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "d", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "get_bucket", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "directories", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "Kf", "lbd", "lib", "tasks", "s", "NUMBER", "_upload", "NUMBER", "rake", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "call", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "each", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "monitor", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "each", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "BLOCK", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "METHOD", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "TOP", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "bin", "rake", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "CFUNC", "load", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "EVAL", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "bin", "rake", "NUMBER", "c", "NUMBER", "p", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "d", "NUMBER", "FINISH", "c", "NUMBER", "p", "NUMBER", "s", "NUMBER", "b", "NUMBER", "l", "NUMBER", "e", "NUMBER", "d", "NUMBER", "e", "NUMBER", "TOP", "Ruby", "level", "backtrace", "information", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "bin", "rake", "NUMBER", "in", "TAG", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "bin", "rake", "NUMBER", "in", "load", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "bin", "rake", "NUMBER", "in", "TAG", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "run", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "standard_exception_handling", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "top_level", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "standard_exception_handling", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "block", "in", "top_level", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "each", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "top_level", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "invoke_task", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "invoke", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "invoke_with_call_chain", "Users", "ruddick", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "monitor", "NUMBER", "rb", "NUMBER", "in", "mon_synchronize", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "block", "in", "invoke_with_call_chain", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "execute", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "each", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "block", "in", "execute", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "rake", "NUMBER", "lib", "rake", "NUMBER", "rb", "NUMBER", "in", "call", "Users", "ruddick", "Kf", "lbd", "lib", "tasks", "s", "NUMBER", "_upload", "NUMBER", "rake", "NUMBER", "in", "block", "in", "TAG", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "models", "aws", "directories", "NUMBER", "rb", "NUMBER", "in", "get", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "request", "aws", "get_bucket", "NUMBER", "rb", "NUMBER", "in", "get_bucket", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "storage", "aws", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "fog", "NUMBER", "lib", "fog", "core", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "request", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "socket", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "Users", "ruddick", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "gems", "excon", "NUMBER", "lib", "excon", "connection", "NUMBER", "rb", "NUMBER", "in", "connect", "C", "level", "backtrace", "information", "NOTE", "You", "may", "have", "encountered", "a", "bug", "in", "the", "Ruby", "interpreter", "or", "extension", "libraries", "NUMBER", "Bug", "report", "be", "welcome", "NUMBER", "For", "details", "LINK", "lang", "NUMBER", "org", "bugreport", "NUMBER", "html", "Abort", "trap", "My", "rake", "task", "be", "pretty", "simple", "desc", "Upload", "to", "S", "NUMBER", "test", "task", "s", "NUMBER", "_upload", "environment", "do", "name", "test", "NUMBER", "txt", "aws_connection", "Fog", "Storage", "NUMBER", "new", "provider", "AWS", "aws_access_key_id", "ENV", "aws_access_key_id", "aws_secret_access_key", "ENV", "aws_secret_access_key", "bucket", "aws_connection", "NUMBER", "directories", "NUMBER", "get", "test", "kf", "bucket", "NUMBER", "file", "NUMBER", "create", "key", "name", "body", "File", "NUMBER", "open", "tmp", "name", "system", "rm", "tmp", "name", "end", "Using", "excon", "NUMBER", "and", "fog", "NUMBER", "NUMBER", "JonasNielsen", "did", "you", "ever", "figure", "it", "out", "An", "update", "putting", "the", "fog", "gem", "before", "the", "pg", "gem", "in", "the", "Gemfile", "makes", "it", "work", "NUMBER", "mrjogo", "nice", "To", "be", "explicit", "this", "gemfile", "works", "TAG", "gem", "fog", "gem", "mysql", "NUMBER", "gem", "carrierwave", "git", "LINK", "branch", "master", "TAG", "Good", "point", "thanks", "Same", "problem", "use", "mysql", "NUMBER", "gem", "version", "NUMBER", "Worked", "as", "JonasNielsen", "mentions", "NUMBER", "Adding", "the", "fog", "gem", "before", "the", "mysql", "NUMBER", "gem", "seems", "to", "do", "the", "work", "NUMBER", "Can", "t", "believe", "the", "order", "of", "gems", "listed", "in", "Gemfile", "can", "solve", "this", "Thanks", "for", "your", "great", "work", "guys", "I", "had", "the", "same", "error", "but", "the", "gem", "load", "order", "wasn", "t", "the", "issue", "NUMBER", "I", "was", "on", "ruby", "head", "currently", "NUMBER", "something", "NUMBER", "Switching", "to", "NUMBER", "fix", "it", "Hi", "I", "see", "that", "you", "accepted", "a", "pull", "to", "remove", "temp", "file", "but", "why", "the", "temp", "folders", "be", "keep", "The", "ext", "NUMBER", "OS", "limit", "be", "NUMBER", "k", "folders", "when", "you", "reach", "that", "bad", "things", "happen", "file", "can", "t", "be", "uploaded", "NUMBER", "The", "workaround", "be", "to", "set", "a", "cron", "to", "delete", "the", "folders", "every", "month", "day", "hour", "but", "I", "think", "that", "after", "a", "file", "be", "uploaded", "there", "be", "no", "need", "to", "keep", "its", "folder", "as", "there", "isn", "t", "for", "the", "temp", "file", "itself", "For", "remove", "temp", "folder", "I", "choosed", "to", "remove", "the", "tmp", "folder", "and", "all", "your", "subdirectories", "NUMBER", "I", "be", "not", "sure", "if", "this", "be", "the", "best", "way", "or", "practice", "for", "doing", "this", "but", "it", "be", "work", "for", "me", "NUMBER", "Add", "a", "callback", "to", "after_destroy", "remove_tmp_directory", "in", "your", "desired", "model", "NUMBER", "and", "private", "def", "remove_tmp_directory", "path_to_be_deleted", "Rails", "NUMBER", "root", "public", "uploads", "tmp", "FileUtils", "NUMBER", "remove_dir", "path_to_be_deleted", "force", "true", "end", "Its", "a", "problem", "with", "the", "rackspace", "implementation", "in", "fog", "NUMBER", "It", "would", "pass", "implicit", "content", "type", "but", "not", "explicit", "LINK", "That", "said", "I", "m", "also", "get", "an", "error", "on", "the", "Local", "store", "it", "says", "it", "be", "just", "plain", "text", "instead", "of", "jpeg", "when", "run", "test", "Alright", "local", "fix", "LINK", "So", "this", "and", "the", "region", "ticket", "should", "be", "closable", "with", "the", "next", "fog", "release", "NUMBER", "Probably", "not", "today", "but", "should", "be", "able", "to", "get", "it", "out", "early", "next", "week", "fwiw", "NUMBER", "Upon", "yet", "more", "scrutiny", "I", "think", "it", "be", "a", "granularity", "problem", "NUMBER", "Rackspace", "do", "stuff", "at", "the", "directory", "level", "rather", "than", "file", "NUMBER", "And", "the", "test", "were", "trying", "to", "reuse", "the", "same", "directory", "with", "public", "and", "private", "file", "and", "that", "just", "doesn", "t", "work", "NUMBER", "So", "instead", "I", "m", "trying", "to", "get", "it", "going", "with", "separate", "directories", "created", "for", "public", "private", "NUMBER", "Should", "have", "a", "patch", "soon", "NUMBER", "fog", "fix", "rackspace", "public", "test", "close", "by", "NUMBER", "c", "NUMBER", "bcc", "NUMBER", "e", "NUMBER", "e", "NUMBER", "c", "NUMBER", "caf", "NUMBER", "c", "NUMBER", "cdf", "Steps", "that", "illustrate", "the", "problem", "class", "Document", "TAG", "name", "validates", "file", "presence", "true", "end", "f", "File", "NUMBER", "open", "path", "to", "file", "d", "Document", "NUMBER", "new", "file", "f", "d", "NUMBER", "save", "true", "all", "ok", "till", "now", "HERE", "S", "THE", "PROBLEM", "result", "d", "NUMBER", "update_attributes", "remove_file", "true", "should", "fail", "I", "validate", "presence", "p", "result", "true", "oh", "noes", "p", "d", "NUMBER", "file", "nil", "oh", "noes", "it", "was", "saved", "even", "tough", "I", "validate", "presence", "I", "think", "if", "you", "change", "mount_on", "then", "you", "need", "to", "validate_presence_of", "name", "or", "maybe", "even", "both", "NUMBER", "Sorry", "never", "mind", "me", "Trevor", "be", "right", "NUMBER", "Was", "this", "close", "Fixed", "Invalid", "It", "appears", "to", "be", "in", "the", "close", "tab", "not", "in", "open", "and", "I", "can", "t", "tell", "the", "resolution", "to", "it", "NUMBER", "Im", "use", "Rails", "NUMBER", "In", "my", "gem", "file", "I", "have", "TAG", "TAG", "gem", "carrierwave", "git", "LINK", "gem", "mini_magick", "git", "LINK", "_magick", "NUMBER", "git", "gem", "fog", "TAG", "TAG", "I", "keep", "get", "Attachment", "fail", "to", "be", "processed", "when", "I", "upload", "an", "image", "NUMBER", "Here", "be", "my", "uploader", "class", "encoding", "utf", "NUMBER", "class", "PhotoUploader", "TAG", "NUMBER", "NUMBER", "end", "version", "medium", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "large", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "Add", "a", "white", "list", "of", "extensions", "which", "be", "allow", "to", "be", "uploaded", "NUMBER", "For", "images", "you", "might", "use", "something", "like", "this", "def", "extension_white_list", "w", "jpg", "jpeg", "gif", "png", "end", "Override", "the", "filename", "of", "the", "uploaded", "file", "def", "filename", "something", "NUMBER", "jpg", "if", "original_filename", "end", "end", "If", "I", "remove", "the", "code", "block", "below", "the", "file", "be", "uploaded", "without", "any", "problem", "NUMBER", "version", "small", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "medium", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "large", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "What", "be", "going", "on", "Trevorturk", "here", "be", "the", "application", "NUMBER", "Its", "a", "bare", "bone", "Rails", "app", "NUMBER", "With", "Rails", "NUMBER", "a", "simple", "model", "call", "product", "with", "NUMBER", "columns", "title", "and", "attachment", "NUMBER", "I", "be", "run", "on", "MacOSX", "Snow", "Leopard", "NUMBER", "With", "the", "following", "gems", "pg", "carrierwave", "NUMBER", "mini_magick", "NUMBER", "from", "LINK", "_magick", "NUMBER", "git", "at", "master", "NUMBER", "LINK", "After", "run", "rails", "s", "NUMBER", "In", "LINK", "if", "you", "select", "a", "file", "and", "submit", "the", "form", "renders", "with", "NUMBER", "error", "prohibited", "this", "product", "from", "be", "saved", "Attachment", "fail", "to", "be", "processed", "If", "I", "remove", "the", "version", "on", "my", "uploader", "LINK", "_uploader", "NUMBER", "rb", "the", "file", "uploads", "without", "any", "problem", "version", "small", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "medium", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "version", "large", "do", "process", "resize_to_fill", "NUMBER", "NUMBER", "end", "Ok", "had", "to", "install", "imagemagic", "on", "the", "system", "first", "and", "then", "install", "the", "gems", "brew", "instal", "imagemagick", "sudo", "gem", "install", "rmagick", "sudo", "gem", "install", "mini_magick", "Works", "now", "Yeap", "add", "at", "LINK", "Notes", "I", "m", "get", "below", "error", "when", "setting", "up", "my", "initializer", "Rails", "NUMBER", "carrierwave", "NUMBER", "ruby", "NUMBER", "p", "NUMBER", "TAG", "rails", "s", "Booting", "WEBrick", "Rails", "NUMBER", "application", "starting", "in", "development", "on", "LINK", "Call", "with", "d", "to", "detach", "Ctrl", "C", "to", "shutdown", "server", "Exiting", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "initializers", "carrier_wave", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "undefined", "method", "fog_credentials", "for", "CarrierWave", "Uploader", "Base", "Class", "NoMethodError", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "configuration", "NUMBER", "rb", "NUMBER", "in", "configure", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "fsrglobal", "gems", "carrierwave", "NUMBER", "lib", "carrierwave", "NUMBER", "rb", "NUMBER", "in", "configure", "from", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "initializers", "carrier_wave", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "load", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "load_dependency", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "new_constants_in", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load_dependency", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "block", "NUMBER", "levels", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "engine", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "instance_exec", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "run", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "block", "in", "run_initializers", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "each", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "initializable", "NUMBER", "rb", "NUMBER", "in", "run_initializers", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "from", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "environment", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "require", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "require", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "block", "in", "load_dependency", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "new_constants_in", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "load_dependency", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "activesupport", "NUMBER", "lib", "active_support", "dependencies", "NUMBER", "rb", "NUMBER", "in", "require", "from", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "NUMBER", "ru", "NUMBER", "in", "block", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "builder", "NUMBER", "rb", "NUMBER", "in", "instance_eval", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "builder", "NUMBER", "rb", "NUMBER", "in", "initialize", "from", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "NUMBER", "ru", "NUMBER", "in", "new", "from", "Users", "Jonas", "web_projects", "FSRGlobal", "config", "NUMBER", "ru", "NUMBER", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "builder", "NUMBER", "rb", "NUMBER", "in", "eval", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "builder", "NUMBER", "rb", "NUMBER", "in", "parse_file", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "server", "NUMBER", "rb", "NUMBER", "in", "app", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "server", "NUMBER", "rb", "NUMBER", "in", "wrapped_app", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "rack", "NUMBER", "lib", "rack", "server", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "server", "NUMBER", "rb", "NUMBER", "in", "start", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "block", "in", "TAG", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "tap", "from", "Users", "Jonas", "NUMBER", "rvm", "gems", "ruby", "NUMBER", "p", "NUMBER", "global", "gems", "railties", "NUMBER", "lib", "rails", "commands", "NUMBER", "rb", "NUMBER", "in", "TAG", "from", "script", "rails", "NUMBER", "in", "require", "from", "script", "rails", "NUMBER", "in", "TAG", "TAG", "initializers", "carrier_wave", "NUMBER", "rb", "TAG", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "fog_credentials", "provider", "AWS", "aws_access_key_id", "HIDDEN", "aws_secret_access_key", "hidden", "region", "eu", "west", "NUMBER", "config", "NUMBER", "fog_directory", "hidden", "end", "TAG", "I", "miss", "that", "thanks", "hey", "i", "be", "facing", "the", "same", "problem", "how", "did", "you", "resolve", "this", "problem", "NUMBER", "Hi", "I", "write", "about", "it", "at", "the", "forum", "but", "i", "guess", "problem", "was", "not", "explained", "well", "or", "not", "understood", "at", "all", "NUMBER", "The", "problem", "appears", "when", "you", "try", "to", "use", "url", "with", "redirects", "NUMBER", "So", "for", "example", "when", "you", "try", "to", "take", "a", "picture", "from", "facebook", "profile", "NUMBER", "The", "problem", "exactly", "in", "this", "method", "LINK", "def", "file", "if", "file", "NUMBER", "blank", "file", "Kernel", "NUMBER", "open", "uri", "NUMBER", "to_s", "in", "this", "method", "file", "file", "NUMBER", "is_a", "String", "StringIO", "NUMBER", "new", "file", "file", "end", "file", "end", "that", "be", "use", "in", "detecting", "image", "size", "Here", "be", "stack", "trace", "home", "bob", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "open", "uri", "NUMBER", "rb", "NUMBER", "in", "open_loop", "home", "bob", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "open", "uri", "NUMBER", "rb", "NUMBER", "in", "open_uri", "home", "bob", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "open", "uri", "NUMBER", "rb", "NUMBER", "in", "open", "home", "bob", "NUMBER", "rvm", "rubies", "ruby", "NUMBER", "p", "NUMBER", "lib", "ruby", "NUMBER", "open", "uri", "NUMBER", "rb", "NUMBER", "in", "open", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "NUMBER", "in", "file", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "NUMBER", "in", "respond_to", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "size", "carrierwave", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "empty", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "cache", "NUMBER", "rb", "NUMBER", "in", "cache", "carrierwave", "NUMBER", "lib", "carrierwave", "uploader", "download", "NUMBER", "rb", "NUMBER", "in", "download", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "remote_url", "carrierwave", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "remote_image_url", "So", "facebook", "use", "redirects", "from", "https", "to", "http", "path", "for", "a", "picture", "and", "open", "uri", "lib", "has", "method", "NUMBER", "redirectable", "wich", "restricts", "that", "kind", "of", "redirection", "NUMBER", "That", "gives", "us", "this", "error", "redirection", "forbidden", "uri", "NUMBER", "uri", "NUMBER", "yep", "code", "inserted", "badly", "This", "be", "rails", "stack", "LINK", "I", "guess", "not", "to", "use", "open", "uri", "would", "be", "ok", "NUMBER", "Maybe", "something", "else", "insted", "NUMBER", "Failing", "that", "I", "d", "suggest", "trying", "to", "get", "the", "redirects", "out", "of", "the", "URL", "before", "giving", "it", "to", "Carrierwave", "NUMBER", "You", "suggest", "fetch", "url", "and", "then", "use", "that", "url", "To", "reproduce", "this", "bug", "try", "to", "do", "this", "User", "NUMBER", "create", "remote_image_url", "LINK", "_profile_name", "picture", "but", "this", "time", "it", "will", "fail", "with", "NUMBER", "bad", "request", "error", "but", "still", "it", "will", "fail", "NUMBER", "ah", "ok", "will", "try", "this", "out", "In", "case", "it", "s", "not", "obvious", "to", "others", "having", "this", "problem", "you", "an", "just", "add", "an", "s", "to", "the", "regex", "in", "a", "monkey", "patch", "to", "get", "this", "work", "module", "OpenURI", "def", "self", "NUMBER", "redirectable", "uri", "NUMBER", "uri", "NUMBER", "uri", "NUMBER", "scheme", "NUMBER", "downcase", "uri", "NUMBER", "scheme", "NUMBER", "downcase", "A", "https", "ftp", "z", "i", "uri", "NUMBER", "scheme", "A", "https", "ftp", "z", "i", "uri", "NUMBER", "scheme", "end", "end", "fog", "fix", "content_type", "handle", "Closed", "by", "NUMBER", "edbdd", "NUMBER", "e", "NUMBER", "c", "NUMBER", "bae", "NUMBER", "dda", "NUMBER", "afd", "NUMBER", "e", "NUMBER", "f", "Closed", "by", "NUMBER", "edbdd", "NUMBER", "e", "NUMBER", "c", "NUMBER", "bae", "NUMBER", "dda", "NUMBER", "afd", "NUMBER", "e", "NUMBER", "f", "fog", "fix", "content_type", "handle", "Closed", "by", "NUMBER", "edbdd", "NUMBER", "e", "NUMBER", "c", "NUMBER", "bae", "NUMBER", "dda", "NUMBER", "afd", "NUMBER", "e", "NUMBER", "f", "Closed", "by", "NUMBER", "edbdd", "NUMBER", "e", "NUMBER", "c", "NUMBER", "bae", "NUMBER", "dda", "NUMBER", "afd", "NUMBER", "e", "NUMBER", "f", "Hi", "work", "with", "the", "NUMBER", "stable", "branch", "in", "Rails", "NUMBER", "and", "ree", "NUMBER", "production", "environment", "I", "notice", "that", "depending", "on", "how", "ruby", "sorted", "the", "mappings", "hash", "the", "id_partition", "was", "correctly", "interpolated", "or", "not", "NUMBER", "If", "the", "id", "interpolation", "comes", "before", "the", "id_partition", "interpolation", "whooops", "We", "should", "ensure", "this", "doesn", "t", "happen", "NUMBER", "I", "ve", "replaced", "the", "mappings", "hash", "by", "an", "array", "containing", "arrays", "with", "the", "symbol", "and", "its", "interpolation", "and", "implement", "a", "very", "simple", "example", "to", "test", "this", "case", "NUMBER", "Hope", "it", "helps", "Mari", "NUMBER", "Sort", "of", "NUMBER", "Technically", "it", "would", "have", "just", "worked", "but", "you", "wouldn", "t", "have", "be", "able", "to", "specify", "with", "just", "the", "region", "key", "NUMBER", "I", "just", "add", "that", "though", "LINK", "Not", "sure", "how", "quick", "I", "ll", "release", "though", "NUMBER", "I", "add", "a", "similar", "config", "option", "to", "the", "S", "NUMBER", "storage", "but", "I", "m", "unsure", "if", "this", "be", "how", "this", "should", "be", "handle", "in", "Fog", "so", "I", "figured", "geemus", "or", "someone", "might", "know", "better", "NUMBER", "Also", "if", "someone", "can", "come", "up", "with", "some", "way", "of", "test", "this", "that", "d", "be", "excellent", "Just", "depends", "what", "you", "want", "to", "test", "NUMBER", "The", "outputted", "url", "will", "display", "the", "expiry", "as", "a", "query", "param", "I", "believe", "so", "you", "could", "check", "that", "this", "was", "ok", "NUMBER", "And", "if", "you", "wanted", "to", "check", "functionality", "I", "guess", "you", "could", "set", "it", "to", "NUMBER", "or", "something", "small", "and", "then", "try", "to", "request", "expecting", "it", "would", "fail", "NUMBER", "That", "said", "it", "be", "a", "pretty", "simple", "thing", "so", "maybe", "additional", "test", "isn", "t", "needed", "NUMBER", "Should", "probably", "add", "a", "note", "to", "the", "docs", "about", "the", "option", "though", "just", "in", "case", "NUMBER", "Hi", "The", "root", "variable", "was", "nil", "when", "accessed", "from", "CarrierWave", "Uploader", "Url", "url", "in", "ruby", "ruby", "NUMBER", "NUMBER", "So", "i", "had", "to", "write", "the", "full", "CarrierWave", "NUMBER", "root", "for", "it", "to", "work", "on", "my", "Sinatra", "project", "NUMBER", "I", "test", "my", "patch", "on", "ruby", "NUMBER", "and", "all", "the", "test", "be", "still", "passing", "NUMBER", "But", "on", "ruby", "NUMBER", "i", "get", "this", "error", "when", "run", "the", "test", "LINK", "NUMBER", "So", "i", "can", "t", "seem", "to", "test", "on", "my", "side", "but", "feel", "free", "tu", "pull", "if", "on", "your", "side", "the", "test", "be", "still", "passing", "NUMBER", "Let", "me", "know", "if", "there", "s", "something", "wrong", "with", "my", "fix", "NUMBER", "Thanks", "for", "CarrierWave", "Julien", "Hi", "I", "think", "I", "had", "a", "very", "similar", "problem", "but", "I", "went", "with", "the", "way", "to", "define", "my", "own", "root", "method", "in", "the", "model", "and", "it", "start", "work", "NUMBER", "By", "the", "way", "I", "was", "use", "padrino", "framework", "and", "I", "didn", "t", "notice", "any", "problem", "when", "I", "use", "Rails", "NUMBER", "Thanks", "Ivan", "Povalyukhin", "Ah", "well", "seems", "like", "it", "s", "work", "now", "without", "my", "fix", "NUMBER", "Please", "ignore", "this", "pull", "request", "NUMBER", "I", "guess", "i", "needed", "more", "sleep", "Just", "wanted", "to", "point", "out", "too", "that", "the", "fix", "be", "actually", "broken", "NUMBER", "There", "s", "a", "point", "to", "calling", "root", "on", "the", "instance", "instead", "of", "from", "CarrierWave", "NUMBER", "root", "this", "be", "so", "that", "in", "theory", "different", "uploaders", "can", "have", "different", "roots", "NUMBER", "This", "be", "consistent", "with", "how", "all", "other", "settings", "be", "configurable", "on", "a", "per", "uploader", "basis", "NUMBER", "def", "url", "if", "file", "NUMBER", "respond_to", "url", "and", "not", "file", "NUMBER", "url", "NUMBER", "blank", "file", "NUMBER", "url", "elsif", "current_path", "File", "NUMBER", "expand_path", "current_path", "NUMBER", "gsub", "File", "NUMBER", "expand_path", "root", "end", "end", "File", "NUMBER", "expand_path", "root", "raises", "an", "error", "since", "root", "be", "nil", "if", "I", "don", "t", "define", "the", "root", "method", "in", "my", "model", "NUMBER", "I", "was", "use", "the", "padrino", "framework", "sequel", "NUMBER", "I", "suspect", "that", "I", "need", "to", "supply", "some", "additional", "configuration", "hash", "but", "it", "was", "not", "obvious", "for", "me", "why", "it", "didn", "t", "work", "by", "default", "NUMBER", "If", "this", "be", "my", "configuration", "issue", "probably", "it", "worth", "mentioning", "in", "the", "docs", "the", "need", "for", "some", "additional", "config", "NUMBER", "options", "NUMBER", "Thanks", "Ivan", "Povalyukhin", "This", "try", "to", "solve", "the", "long", "standing", "issue", "in", "Carrierwave", "that", "update", "a", "column", "do", "not", "remove", "the", "previous", "file", "NUMBER", "I", "have", "add", "the", "code", "just", "for", "ActiveRecord", "which", "relies", "on", "ActiveModel", "Dirty", "NUMBER", "Support", "for", "other", "ORMs", "could", "be", "add", "on", "demand", "and", "then", "refactored", "to", "a", "common", "place", "NUMBER", "I", "kind", "of", "dislike", "the", "fact", "that", "this", "be", "ActiveRecord", "only", "NUMBER", "It", "seems", "like", "we", "want", "to", "push", "as", "little", "logic", "as", "possible", "into", "the", "ORM", "adapters", "if", "we", "need", "to", "recreated", "this", "for", "every", "ORM", "out", "there", "we", "ll", "end", "up", "producing", "a", "lot", "of", "unnecessary", "duplicate", "code", "NUMBER", "I", "can", "refactor", "the", "code", "above", "into", "an", "API", "contract", "and", "move", "it", "to", "the", "mounter", "but", "I", "still", "believe", "that", "track", "dirty", "attributes", "be", "an", "ORM", "responsibility", "NUMBER", "I", "don", "t", "think", "Carrierwave", "should", "be", "concerned", "about", "it", "NUMBER", "There", "we", "go", "push", "a", "new", "commit", "NUMBER", "ORMs", "just", "need", "to", "implement", "the", "read_previous_uploader", "method", "and", "everything", "should", "work", "like", "a", "charm", "NUMBER", "This", "be", "pretty", "awesome", "I", "like", "the", "read_previous_uploader", "thing", "NUMBER", "I", "suppose", "Didier", "and", "I", "could", "add", "that", "for", "Mongoid", "NUMBER", "I", "think", "we", "d", "still", "need", "to", "test", "for", "uploaders", "with", "version", "uploaders", "with", "dynamic", "store", "paths", "like", "this", "kind", "of", "thing", "LINK", "L", "NUMBER", "R", "NUMBER", "I", "can", "t", "think", "of", "anything", "else", "at", "the", "moment", "NUMBER", "Jonas", "what", "do", "you", "think", "BTW", "I", "think", "this", "would", "also", "impact", "a", "bunch", "of", "stuff", "listed", "in", "the", "wiki", "due", "to", "column", "_will_change", "be", "add", "NUMBER", "It", "s", "a", "shame", "we", "don", "t", "have", "better", "integration", "test", "in", "CarrierWave", "NUMBER", "It", "s", "hard", "to", "know", "what", "impact", "this", "will", "have", "without", "people", "actually", "trying", "it", "NUMBER", "The", "pull", "request", "looks", "really", "good", "good", "job", "Jos\u00e9", "One", "tiny", "nit", "pick", "would", "be", "that", "this", "seems", "to", "ignore", "the", "mount_on", "option", "which", "can", "be", "set", "for", "mount_uploader", "though", "I", "m", "not", "sure", "if", "anyone", "actually", "uses", "that", "NUMBER", "Still", "might", "be", "worth", "investigating", "NUMBER", "I", "m", "generally", "in", "favour", "of", "merge", "if", "you", "agree", "Trevor", "Yeah", "I", "really", "like", "this", "technique", "NUMBER", "So", "I", "guess", "there", "be", "NUMBER", "outstanding", "issue", "before", "merge", "NUMBER", "test", "for", "uploaders", "with", "version", "test", "for", "uploaders", "with", "dynamic", "store", "paths", "based", "on", "model", "attributes", "test", "for", "respecting", "the", "mount_on", "option", "Then", "I", "could", "work", "with", "Didier", "on", "add", "support", "for", "mongoid", "Jos\u00e9", "let", "me", "know", "if", "you", "have", "time", "for", "any", "of", "that", "or", "if", "you", "d", "prefer", "for", "me", "to", "work", "on", "it", "NUMBER", "As", "for", "better", "integration", "test", "what", "do", "you", "guys", "think", "about", "having", "add", "a", "dummy", "rails", "app", "with", "enginex", "I", "thought", "that", "might", "be", "a", "smart", "way", "to", "have", "full", "stack", "test", "for", "complicated", "stuff", "like", "this", "NUMBER", "I", "don", "t", "know", "if", "it", "s", "worth", "the", "effort", "or", "not", "though", "NUMBER", "Trevor", "please", "don", "t", "wait", "for", "me", "NUMBER", "In", "general", "something", "like", "Enginex", "be", "worth", "the", "effort", "NUMBER", "The", "nested", "attributes", "bug", "we", "discussed", "yesterday", "would", "be", "really", "easy", "to", "reproduce", "in", "a", "structure", "like", "Enginex", "NUMBER", "The", "only", "thing", "a", "bit", "annoying", "be", "that", "you", "need", "to", "setup", "different", "load", "paths", "for", "each", "ORM", "NUMBER", "Continuing", "the", "OT", "How", "about", "a", "Sinatra", "app", "for", "integration", "test", "Rails", "might", "be", "a", "bit", "overkill", "imo", "NUMBER", "I", "ll", "make", "some", "time", "ASAP", "but", "don", "t", "wait", "for", "me", "either", "I", "m", "doing", "a", "lot", "of", "traveling", "lately", "since", "my", "time", "living", "in", "London", "be", "ending", "soon", "NUMBER", "OT", "I", "think", "Enginex", "with", "Rails", "could", "have", "Active", "Record", "and", "Mongoid", "in", "one", "app", "NUMBER", "Then", "maybe", "a", "Sinatra", "app", "for", "DataMapper", "I", "think", "having", "Rails", "would", "be", "smart", "since", "it", "s", "probably", "widely", "use", "NUMBER", "I", "don", "t", "know", "though", "I", "shouldn", "t", "talk", "so", "much", "about", "this", "without", "having", "code", "anything", "If", "when", "I", "do", "that", "I", "ll", "put", "it", "in", "a", "branch", "and", "we", "can", "discuss", "then", "NUMBER", "Even", "if", "the", "path", "be", "dynamic", "isn", "t", "it", "stored", "in", "the", "database", "Wouldn", "t", "it", "be", "just", "a", "question", "of", "storing", "this", "path", "in", "a", "variable", "like", "initial_path", "when", "the", "uploader", "be", "loaded", "Just", "push", "a", "commit", "to", "my", "fork", "with", "a", "possible", "solution", "to", "the", "problem", "NUMBER", "About", "the", "ability", "to", "turn", "off", "the", "feature", "I", "would", "suggest", "to", "do", "it", "by", "passing", "an", "option", "when", "mounting", "the", "uploader", "NUMBER", "Then", "we", "just", "don", "t", "add", "the", "callbacks", "for", "that", "specific", "uploader", "NUMBER", "Awesome", "thanks", "Trevor", "for", "your", "work", "OK", "so", "I", "made", "a", "lot", "of", "progress", "on", "this", "a", "while", "ago", "but", "then", "left", "it", "for", "dead", "in", "a", "branch", "NUMBER", "If", "anyone", "cares", "to", "pick", "it", "up", "again", "and", "flesh", "out", "all", "these", "test", "etc", "please", "feel", "free", "LINK", "In", "the", "mean", "time", "I", "m", "closing", "this", "pull", "request", "NUMBER", "Sorry", "I", "ve", "let", "you", "all", "down", "Hey", "trevorturk", "I", "be", "interested", "in", "finishing", "this", "NUMBER", "What", "needs", "to", "be", "do", "If", "you", "see", "the", "gist", "I", "posted", "I", "think", "the", "functionality", "should", "be", "work", "and", "I", "made", "descriptive", "test", "stubs", "NUMBER", "So", "you", "could", "review", "those", "test", "stubs", "and", "fill", "them", "in", "where", "you", "think", "it", "makes", "sense", "NUMBER", "That", "would", "be", "it", "unless", "you", "run", "into", "problem", "along", "the", "way", "NUMBER", "If", "so", "let", "me", "know", "and", "I", "can", "help", "out", "NUMBER", "On", "Sunday", "May", "NUMBER", "NUMBER", "josevalim", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "Hey", "trevorturk", "I", "be", "interested", "in", "finishing", "this", "NUMBER", "What", "needs", "to", "be", "do", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "BTW", "the", "test", "should", "be", "very", "easy", "to", "run", "now", "but", "if", "you", "have", "trouble", "with", "Ruby", "Inline", "see", "this", "pull", "request", "LINK", "I", "just", "made", "that", "change", "to", "my", "own", "local", "gems", "to", "work", "around", "it", "NUMBER", "It", "may", "be", "smart", "to", "change", "the", "gem", "deps", "to", "use", "a", "fork", "with", "this", "fix", "I", "m", "not", "sure", "if", "when", "they", "ll", "ever", "pull", "that", "in", "NUMBER", "It", "s", "be", "a", "long", "run", "problem", "NUMBER", "Shit", "did", "I", "merge", "this", "Nah", "I", "haven", "t", "NUMBER", "It", "be", "a", "github", "bug", "because", "I", "have", "change", "the", "original", "branch", "NUMBER", "P", "I", "almost", "had", "a", "heart", "attack", "NUMBER", "Trevor", "do", "you", "happen", "to", "have", "your", "work", "still", "in", "a", "branch", "The", "patch", "no", "longer", "applies", "so", "I", "need", "to", "know", "the", "last", "commit", "in", "your", "branch", "so", "I", "can", "rollback", "and", "rebase", "NUMBER", "lol", "Jonas", "Jose", "sorry", "I", "should", "have", "left", "the", "old", "branch", "there", "NUMBER", "I", "think", "I", "have", "the", "branch", "locally", "but", "won", "t", "have", "access", "to", "push", "it", "back", "up", "until", "tomorrow", "NUMBER", "I", "ll", "post", "a", "comment", "when", "I", "do", "otherwise", "you", "d", "have", "to", "figure", "out", "what", "to", "do", "with", "that", "diff", "probably", "not", "fun", "NUMBER", "On", "Sunday", "May", "NUMBER", "NUMBER", "josevalim", "reply", "reply", "NUMBER", "github", "NUMBER", "com", "write", "Trevor", "do", "you", "happen", "to", "have", "your", "work", "still", "in", "a", "branch", "The", "patch", "no", "longer", "applies", "so", "I", "need", "to", "know", "the", "last", "commit", "in", "your", "branch", "so", "I", "can", "rollback", "and", "rebase", "NUMBER", "Reply", "to", "this", "email", "directly", "or", "view", "it", "on", "GitHub", "LINK", "issuecomment", "NUMBER", "See", "LINK", "First", "thanks", "for", "this", "excellent", "gem", "it", "just", "works", "great", "and", "it", "be", "very", "easy", "to", "set", "up", "and", "use", "NUMBER", "The", "issue", "be", "that", "everything", "works", "perfect", "until", "I", "try", "to", "use", "several", "version", "of", "the", "uploaded", "file", "when", "I", "be", "use", "s", "NUMBER", "as", "the", "kind", "of", "storage", "it", "raise", "a", "Permission", "denied", "error", "just", "test", "so", "far", "in", "Windows", "NUMBER", "Configuration", "Windows", "XP", "SP", "NUMBER", "ImageMagick", "NUMBER", "Q", "NUMBER", "Gems", "gem", "rails", "NUMBER", "gem", "carrierwave", "git", "git", "github", "NUMBER", "com", "jnicklas", "carrierwave", "NUMBER", "git", "gem", "mini_magick", "gem", "fog", "git", "git", "github", "NUMBER", "com", "geemus", "fog", "NUMBER", "git", "avatar_uploader", "NUMBER", "rb", "file", "storage", "s", "NUMBER", "process", "resize_to_fit", "NUMBER", "NUMBER", "version", "main", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "version", "thumb", "do", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "Thanks", "for", "any", "help", "about", "PS", "It", "do", "this", "process", "resize_to_fit", "NUMBER", "NUMBER", "just", "fine", "and", "uploads", "the", "file", "to", "the", "Amazon", "S", "NUMBER", "server", "so", "the", "issue", "seems", "to", "be", "when", "it", "try", "to", "generate", "the", "other", "version", "NUMBER", "Hmm", "NUMBER", "this", "really", "should", "be", "work", "NUMBER", "Have", "you", "tried", "the", "s", "NUMBER", "_access_policy", "config", "option", "It", "s", "documented", "in", "the", "s", "NUMBER", "module", "NUMBER", "You", "should", "also", "consider", "use", "the", "release", "gem", "version", "of", "carrierwave", "and", "fog", "just", "in", "case", "NUMBER", "Can", "you", "give", "this", "another", "try", "with", "the", "s", "NUMBER", "_access_policy", "option", "Also", "if", "you", "could", "make", "a", "sample", "app", "for", "me", "to", "test", "I", "can", "try", "to", "reproduce", "NUMBER", "Hello", "Trevor", "thanks", "for", "your", "answer", "as", "you", "suggested", "I", "add", "the", "s", "NUMBER", "_access_policy", "public_read", "sentence", "everywhere", "gradually", "but", "sadly", "it", "did", "not", "work", "NUMBER", "I", "did", "not", "add", "it", "before", "because", "it", "be", "set", "to", "public_read", "as", "default", "according", "to", "the", "documentation", "NUMBER", "Now", "my", "config", "initializers", "carrierwave", "NUMBER", "rb", "file", "be", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "permissions", "NUMBER", "config", "NUMBER", "s", "NUMBER", "_access_policy", "public_read", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "s", "NUMBER", "_access_key_id", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "s", "NUMBER", "_secret_access_key", "config", "NUMBER", "s", "NUMBER", "_bucket", "my", "bucket", "for", "test", "carrierwave", "end", "And", "my", "avatar_uploader", "NUMBER", "rb", "file", "be", "s", "NUMBER", "_access_policy", "public_read", "storage", "s", "NUMBER", "process", "resize_to_fit", "NUMBER", "NUMBER", "version", "main", "do", "s", "NUMBER", "_access_policy", "public_read", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "version", "thumb", "do", "s", "NUMBER", "_access_policy", "public_read", "process", "resize_to_limit", "NUMBER", "NUMBER", "end", "Regarding", "to", "the", "gem", "version", "I", "worked", "with", "it", "also", "for", "fog", "yesterday", "I", "change", "today", "to", "the", "git", "version", "due", "to", "this", "issue", "with", "the", "Permission", "Denied", "I", "thought", "that", "maybe", "was", "an", "issue", "with", "the", "gem", "version", "NUMBER", "The", "full", "error", "message", "be", "Permission", "denied", "E", "RubyApps", "rails", "NUMBER", "mongodb", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "openid", "NUMBER", "png", "It", "refers", "to", "the", "file", "stored", "in", "the", "tmp", "folder", "maybe", "the", "process", "to", "deal", "with", "the", "version", "try", "to", "use", "this", "file", "when", "it", "be", "be", "uploaded", "to", "the", "Amazon", "S", "NUMBER", "server", "NUMBER", "Thanks", "for", "your", "help", "Can", "you", "post", "a", "full", "backtrace", "It", "seems", "like", "maybe", "the", "original", "file", "can", "t", "be", "read", "on", "your", "filesystem", "NUMBER", "I", "ve", "seen", "another", "report", "I", "think", "about", "a", "problem", "with", "Windows", "NUMBER", "Maybe", "something", "be", "going", "on", "here", "with", "the", "permissions", "NUMBER", "A", "full", "backtrace", "might", "be", "helpful", "NUMBER", "Sure", "here", "be", "the", "Full", "Trace", "Errno", "EACCES", "in", "ClientsController", "create", "Permission", "denied", "E", "RubyApps", "rails", "NUMBER", "mongodb", "public", "uploads", "tmp", "NUMBER", "NUMBER", "NUMBER", "NUMBER", "sshot", "NUMBER", "png", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "unlink", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "block", "in", "remove_file", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "platform_support", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "remove_file", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "remove_file", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "block", "in", "rm", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "each", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "fileutils", "NUMBER", "rb", "NUMBER", "in", "rm", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "sanitized_file", "NUMBER", "rb", "NUMBER", "in", "delete", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "block", "in", "store", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "uploader", "callbacks", "NUMBER", "rb", "NUMBER", "in", "with_callbacks", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "uploader", "store", "NUMBER", "rb", "NUMBER", "in", "store", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store", "C", "Ruby", "NUMBER", "lib", "ruby", "gems", "NUMBER", "bundler", "gems", "carrierwave", "NUMBER", "fd", "NUMBER", "c", "NUMBER", "ffc", "NUMBER", "lib", "carrierwave", "mount", "NUMBER", "rb", "NUMBER", "in", "store_avatar", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_save_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "mongoid", "NUMBER", "rc", "NUMBER", "lib", "mongoid", "persistence", "insert", "NUMBER", "rb", "NUMBER", "in", "persist", "mongoid", "NUMBER", "rc", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "insert", "mongoid", "NUMBER", "rc", "NUMBER", "lib", "mongoid", "persistence", "NUMBER", "rb", "NUMBER", "in", "upsert", "app", "controllers", "clients_controller", "NUMBER", "rb", "NUMBER", "in", "block", "in", "create", "actionpack", "NUMBER", "lib", "action_controller", "metal", "mime_responds", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_controller", "metal", "mime_responds", "NUMBER", "rb", "NUMBER", "in", "retrieve_response_from_mimes", "actionpack", "NUMBER", "lib", "action_controller", "metal", "mime_responds", "NUMBER", "rb", "NUMBER", "in", "respond_to", "app", "controllers", "clients_controller", "NUMBER", "rb", "NUMBER", "in", "create", "actionpack", "NUMBER", "lib", "action_controller", "metal", "implicit_render", "NUMBER", "rb", "NUMBER", "in", "send_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rendering", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run__", "NUMBER", "__process_action__", "NUMBER", "__callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_process_action_callbacks", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "run_callbacks", "actionpack", "NUMBER", "lib", "abstract_controller", "callbacks", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "process_action", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "block", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "instrumenter", "NUMBER", "rb", "NUMBER", "in", "instrument", "activesupport", "NUMBER", "lib", "active_support", "notifications", "NUMBER", "rb", "NUMBER", "in", "instrument", "actionpack", "NUMBER", "lib", "action_controller", "metal", "instrumentation", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rescue", "NUMBER", "rb", "NUMBER", "in", "process_action", "actionpack", "NUMBER", "lib", "abstract_controller", "base", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "abstract_controller", "rendering", "NUMBER", "rb", "NUMBER", "in", "process", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "rack_delegation", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_controller", "metal", "NUMBER", "rb", "NUMBER", "in", "block", "in", "action", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "dispatch", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "block", "in", "recognize", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "optimized_each", "rack", "mount", "NUMBER", "lib", "rack", "mount", "code_generation", "NUMBER", "rb", "NUMBER", "in", "recognize", "rack", "mount", "NUMBER", "lib", "rack", "mount", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "routing", "route_set", "NUMBER", "rb", "NUMBER", "in", "call", "haml", "NUMBER", "lib", "sass", "plugin", "rack", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "best_standards_support", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "head", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "methodoverride", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "params_parser", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "flash", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "session", "abstract_store", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "cookies", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "callbacks", "NUMBER", "rb", "NUMBER", "in", "_run_call_callbacks", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "callbacks", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "sendfile", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "remote_ip", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "show_exceptions", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "rack", "logger", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "runtime", "NUMBER", "rb", "NUMBER", "in", "call", "activesupport", "NUMBER", "lib", "active_support", "cache", "strategy", "local_cache", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "block", "in", "call", "TAG", "NUMBER", "in", "synchronize", "rack", "NUMBER", "lib", "rack", "lock", "NUMBER", "rb", "NUMBER", "in", "call", "actionpack", "NUMBER", "lib", "action_dispatch", "middleware", "static", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "call", "railties", "NUMBER", "lib", "rails", "application", "NUMBER", "rb", "NUMBER", "in", "method_missing", "railties", "NUMBER", "lib", "rails", "rack", "log_tailer", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "content_length", "NUMBER", "rb", "NUMBER", "in", "call", "rack", "NUMBER", "lib", "rack", "handler", "webrick", "NUMBER", "rb", "NUMBER", "in", "service", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "service", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "httpserver", "NUMBER", "rb", "NUMBER", "in", "run", "C", "Ruby", "NUMBER", "lib", "ruby", "NUMBER", "webrick", "server", "NUMBER", "rb", "NUMBER", "in", "block", "in", "start_thread", "Yeah", "so", "here", "you", "can", "see", "that", "fileutils", "be", "cause", "the", "error", "which", "isn", "t", "relate", "to", "with", "s", "NUMBER", "I", "think", "maybe", "it", "s", "just", "a", "simple", "permissions", "issue", "where", "you", "re", "allow", "to", "write", "file", "but", "not", "to", "delete", "them", "NUMBER", "I", "m", "not", "sure", "how", "to", "troubleshoot", "that", "with", "Windows", "honestly", "NUMBER", "I", "see", "that", "we", "have", "the", "option", "to", "disable", "the", "deleting", "of", "the", "tmp", "file", "though", "which", "might", "help", "you", "in", "this", "situation", "NUMBER", "The", "delete_tmp_file_after_storage", "option", "can", "be", "set", "to", "false", "within", "CarrierWave", "NUMBER", "configure", "do", "config", "etc", "NUMBER", "Give", "that", "a", "shot", "and", "see", "if", "it", "helps", "NUMBER", "I", "guess", "having", "tmp", "file", "laying", "around", "wouldn", "t", "hurt", "too", "bad", "NUMBER", "Perfect", "it", "be", "work", "like", "a", "charm", "thank", "you", "very", "much", "for", "your", "help", "Trevor", "the", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "Worked", "for", "me", "on", "windows", "and", "solve", "temporally", "this", "issue", "and", "as", "you", "said", "having", "tmp", "file", "laying", "around", "wouldn", "t", "hurt", "too", "bad", "That", "s", "great", "NUMBER", "If", "you", "have", "the", "time", "please", "do", "consider", "trying", "to", "get", "to", "the", "bottom", "of", "the", "problem", "NUMBER", "I", "think", "it", "may", "be", "affecting", "more", "than", "just", "you", "perhaps", "something", "to", "do", "with", "Windows", "NUMBER", "I", "gave", "a", "look", "to", "this", "and", "it", "seems", "that", "the", "delete", "method", "be", "call", "too", "soon", "I", "mean", "it", "seems", "that", "the", "file", "be", "be", "uploaded", "when", "the", "FileUtils", "NUMBER", "rm", "sentence", "be", "call", "NUMBER", "After", "the", "process", "to", "upload", "the", "file", "to", "the", "Amazon", "S", "NUMBER", "server", "finish", "I", "be", "able", "to", "use", "FileUtils", "NUMBER", "rm", "without", "problem", "NUMBER", "Is", "it", "any", "way", "to", "call", "the", "method", "asynchronously", "Or", "be", "call", "after", "be", "sure", "that", "the", "file", "be", "free", "to", "be", "remove", "Any", "ideas", "Thanks", "Here", "LINK", "you", "can", "find", "the", "sources", "for", "the", "app", "where", "I", "be", "test", "CarrierWave", "NUMBER", "Now", "I", "be", "trying", "to", "make", "it", "work", "with", "delayed_job", "LINK", "_job", "in", "order", "to", "upload", "the", "file", "asynchronously", "NUMBER", "Any", "idea", "Thanks", "I", "don", "t", "think", "it", "s", "be", "call", "at", "the", "wrong", "time", "but", "I", "d", "consider", "a", "pull", "request", "if", "you", "think", "that", "there", "s", "a", "better", "way", "to", "do", "it", "NUMBER", "As", "for", "uploading", "file", "asynchronously", "that", "s", "a", "question", "for", "the", "Google", "Group", "NUMBER", "I", "ve", "get", "the", "same", "issue", "and", "I", "ve", "debugged", "it", "NUMBER", "I", "think", "this", "issue", "should", "be", "re", "opened", "NUMBER", "If", "storage", "file", "all", "be", "work", "fine", "when", "storage", "fog", "there", "be", "no", "error", "in", "new_file", "storage", "NUMBER", "ore", "file", "file", "NUMBER", "delete", "if", "delete_tmp_file_after_storage", "move_to_store", "new_file", "storage", "NUMBER", "ore", "file", "be", "still", "holding", "a", "handle", "on", "the", "tmp", "file", "and", "hence", "the", "delete", "be", "fail", "NUMBER", "If", "you", "try", "to", "delete", "manually", "it", "will", "also", "fail", "NUMBER", "The", "only", "way", "to", "delete", "the", "tmp", "file", "be", "to", "stop", "your", "rails", "server", "NUMBER", "config", "NUMBER", "delete_tmp_file_after_storage", "false", "be", "a", "workaround", "however", "do", "not", "solve", "the", "issue", "NUMBER", "CarrierWave", "still", "holds", "on", "the", "temp", "file", "NUMBER", "Well", "it", "do", "not", "look", "the", "same", "to", "me", "Please", "remove", "the", "forced", "downcase", "call", "here", "LINK", "_file", "NUMBER", "rb", "L", "NUMBER", "What", "I", "m", "work", "on", "requires", "that", "the", "uploaded", "file", "can", "be", "downloaded", "again", "with", "the", "exact", "same", "name", "NUMBER", "Hi", "Jason", "I", "d", "be", "happy", "to", "review", "a", "pull", "request", "with", "test", "that", "add", "this", "as", "a", "configuration", "option", "NUMBER", "If", "you", "re", "interested", "and", "need", "help", "just", "let", "me", "know", "NUMBER", "Thanks", "I", "was", "hoping", "to", "tackle", "this", "one", "with", "my", "other", "sanitize", "change", "as", "well", "in", "another", "pull", "request", "NUMBER", "Is", "there", "a", "reason", "file", "get", "downcased", "My", "current", "work", "change", "the", "default", "behavior", "and", "remove", "the", "downcasing", "NUMBER", "Will", "you", "only", "accept", "it", "as", "a", "configuration", "option", "I", "think", "it", "s", "for", "security", "NUMBER", "I", "really", "don", "t", "know", "NUMBER", "Sorry", "Can", "you", "research", "and", "decide", "what", "you", "think", "be", "best", "Maybe", "Jonas", "or", "someone", "else", "knows", "NUMBER", "jnicklas", "Can", "you", "chime", "in", "on", "this", "I", "ve", "add", "this", "pull", "request", "to", "remove", "the", "forced", "downcasing", "LINK", "If", "extension_white_list", "needs", "to", "be", "case", "insensitive", "then", "make", "that", "method", "case", "insensitive", "NUMBER", "When", "it", "comes", "to", "file", "names", "and", "downloads", "case", "sensitivity", "of", "the", "entire", "file", "name", "_does_", "matter", "which", "be", "why", "I", "originally", "opened", "this", "ticket", "NUMBER", "I", "still", "don", "t", "quite", "understand", "your", "reasoning", "behind", "leaving", "this", "in", "place", "NUMBER", "jameskilton", "I", "suppose", "we", "can", "just", "temporarily", "downcase", "the", "extension", "when", "checking", "it", "in", "the", "extension_white_list", "That", "way", "we", "d", "have", "the", "security", "and", "not", "have", "to", "force", "downcasing", "anything", "NUMBER", "Alright", "I", "ll", "get", "that", "add", "to", "my", "pull", "request", "and", "make", "sure", "there", "s", "a", "test", "include", "for", "the", "extension_white_list", "jnicklas", "Gotcha", "thanks", "for", "clarifying", "NUMBER", "This", "should", "be", "fix", "in", "master", "now", "NUMBER", "Please", "holler", "if", "not", "NUMBER", "This", "be", "another", "good", "feature", "of", "paperclip", "I", "really", "use", "and", "need", "to", "have", "in", "carrierwave", "NUMBER", "How", "difficult", "it", "would", "be", "to", "implement", "Do", "you", "have", "any", "plan", "on", "it", "This", "has", "be", "propose", "a", "few", "times", "NUMBER", "I", "don", "t", "like", "how", "much", "more", "complex", "this", "makes", "the", "interaction", "between", "model", "and", "uploader", "NUMBER", "The", "desired", "result", "can", "be", "achieved", "with", "roughly", "three", "lines", "of", "code", "which", "I", "think", "makes", "this", "not", "worth", "it", "as", "a", "feature", "NUMBER", "I", "m", "open", "to", "a", "discussion", "though", "NUMBER", "Sounds", "interestingly", "NUMBER", "Could", "you", "please", "give", "me", "a", "suggestion", "what", "these", "NUMBER", "lines", "would", "look", "like", "As", "I", "know", "for", "now", "content", "type", "and", "size", "support", "be", "implement", "through", "Rack", "by", "make", "filesystem", "calls", "aren", "t", "they", "When", "all", "we", "need", "be", "just", "to", "show", "the", "size", "and", "type", "of", "one", "upload", "the", "Rack", "be", "good", "and", "simple", "NUMBER", "But", "what", "about", "performance", "issue", "in", "case", "of", "repository", "with", "lots", "of", "file", "I", "ask", "about", "it", "also", "because", "I", "didn", "t", "test", "Rack", "on", "this", "use", "case", "and", "so", "I", "don", "t", "know", "it", "s", "real", "speed", "NUMBER", "May", "be", "it", "can", "suite", "for", "this", "may", "be", "not", "NUMBER", "But", "in", "some", "usual", "use", "cases", "we", "may", "need", "search", "and", "or", "sort", "uploads", "by", "size", "and", "or", "content", "type", "NUMBER", "How", "could", "one", "implement", "search", "without", "having", "these", "values", "in", "database", "And", "how", "fast", "be", "Rack", "in", "handle", "this", "cases", "Wouldn", "t", "it", "rather", "be", "better", "to", "store", "these", "values", "in", "database", "even", "with", "rather", "complexing", "the", "carrierwave", "In", "model", "mount_uploader", "avatar", "AvatarUploader", "before_save", "set_content_type", "def", "set_content_type", "self", "NUMBER", "content_type", "avatar", "NUMBER", "file", "NUMBER", "content_type", "if", "avatar", "NUMBER", "file", "NUMBER", "content_type", "NUMBER", "present", "end", "That", "s", "off", "the", "top", "of", "my", "head", "so", "it", "might", "be", "somewhat", "wrong", "NUMBER", "You", "should", "also", "be", "able", "to", "do", "this", "in", "the", "uploader", "to", "make", "it", "more", "reusable", "if", "you", "want", "NUMBER", "Thanks", "Jonas", "NUMBER", "This", "really", "helps", "me", "much", "with", "this", "userspace", "like", "approach", "I", "can", "do", "with", "my", "models", "even", "more", "than", "I", "thought", "before", "NUMBER", "Now", "I", "really", "like", "carrierwave", "korobkov", "please", "do", "consider", "update", "the", "wiki", "with", "example", "code", "that", "you", "d", "come", "up", "with", "NUMBER", "That", "way", "other", "people", "can", "benefit", "from", "what", "you", "ve", "learned", "Sorry", "but", "I", "m", "a", "very", "newbie", "in", "rails", "NUMBER", "So", "my", "code", "be", "not", "of", "wiki", "like", "quality", "NUMBER", "May", "be", "someone", "with", "more", "skills", "in", "rails", "can", "do", "it", "NUMBER", "I", "just", "add", "two", "columns", "in", "my", "model", "for", "content_type", "and", "file_size", "then", "in", "the", "model", "itself", "just", "add", "a", "before_save", "callback", "and", "drop", "in", "your", "code", "there", "NUMBER", "In", "model", "mount_uploader", "asset", "AssetUploader", "before_save", "update_model_attrs", "def", "update_model_attrs", "self", "NUMBER", "content_type", "asset", "NUMBER", "file", "NUMBER", "content_type", "self", "NUMBER", "file_size", "asset", "NUMBER", "file", "NUMBER", "size", "end", "trevorturk", "it", "has", "be", "add", "to", "the", "wiki", "as", "a", "new", "section", "on", "the", "home", "page", "NUMBER", "Hope", "it", "helps", "others", "NUMBER", "Current", "sanitizing", "of", "a", "filename", "LINK", "_file", "NUMBER", "rb", "L", "NUMBER", "sure", "enough", "converts", "non", "latin", "such", "as", "cyrillic", "filenames", "into", "______", "NUMBER", "jpg", "NUMBER", "It", "would", "be", "nice", "to", "set", "regular", "expression", "for", "sanitizing", "in", "a", "public", "method", "NUMBER", "I", "ve", "add", "this", "feature", "in", "master", "NUMBER", "Feedback", "more", "than", "welcome", "NUMBER", "I", "m", "not", "sure", "if", "this", "be", "the", "right", "way", "to", "do", "this", "kind", "of", "thing", "NUMBER", "Oh", "and", "if", "when", "you", "use", "this", "feature", "can", "you", "please", "add", "a", "section", "to", "the", "wiki", "that", "describes", "how", "to", "do", "so", "This", "would", "help", "other", "people", "that", "be", "run", "into", "the", "same", "problem", "in", "the", "future", "NUMBER", "Thank", "you", "Thanks", "Trevor", "Please", "review", "my", "pull", "request", "it", "fix", "downcasing", "I", "didn", "t", "dig", "into", "code", "for", "what", "reason", "filenames", "be", "downcased", "though", "NUMBER", "I", "ll", "add", "the", "wiki", "explanation", "a", "little", "later", "NUMBER", "Something", "strange", "it", "do", "nothing", "I", "did", "all", "as", "be", "write", "in", "wiki", "but", "seems", "that", "it", "just", "ignores", "overriding", "NUMBER", "def", "sanitize_regexp", "NUMBER", "NUMBER", "word", "NUMBER", "end", "be", "OK", "I", "even", "don", "t", "know", "how", "to", "properly", "override", "it", "doing", "as", "in", "wiki", "isn", "t", "considered", "properly", "by", "sanitized_file", "NUMBER", "Please", "help", "NUMBER", "trevorturk", "thanks", "NUMBER", "I", "think", "it", "should", "be", "all", "work", "NUMBER", "May", "be", "it", "s", "only", "my", "bug", "NUMBER", "But", "what", "it", "could", "be", "a", "bug", "in", "these", "NUMBER", "lines", "May", "be", "I", "need", "to", "think", "more", "and", "have", "a", "rest", "but", "for", "now", "I", "really", "don", "t", "understand", "why", "it", "s", "refuse", "to", "work", "NUMBER", "Please", "mark", "as", "invalid", "NUMBER", "I", "ve", "debugged", "that", "it", "s", "not", "carrierwave", "specific", "something", "strange", "be", "happening", "with", "other", "methods", "too", "NUMBER", "So", "it", "s", "a", "someone", "else", "s", "bug", "may", "be", "my", "who", "knows", "NUMBER", "NUMBER", "Thanks", "and", "my", "regrets", "for", "spending", "your", "time", "NUMBER", "The", "way", "to", "override", "sanitize_regexp", "suggested", "in", "the", "wiki", "be", "not", "work", "for", "me", "either", "NUMBER", "The", "method", "in", "the", "Uploader", "be", "simply", "not", "call", "NUMBER", "I", "had", "to", "override", "it", "in", "a", "monkey", "patch", "for", "CarrierWave", "SanitizedFile", "but", "then", "I", "had", "another", "error", "in", "LINK", "L", "NUMBER", "After", "adjusting", "the", "regexp", "there", "and", "fix", "another", "bug", "in", "ActionDispatch", "Http", "UploadedFile", "as", "report", "here", "LINK", "actiondispatchhttpparameters", "force", "encoding", "of", "all", "params", "but", "filename", "of", "an", "uploaded", "file", "it", "finally", "worked", "for", "me", "NUMBER", "Holy", "cow", "charsets", "cause", "trouble", "everywhere", "NUMBER", "But", "the", "ActionDispatch", "thing", "seems", "really", "embarrasing", "in", "my", "eyes", "NUMBER", "Using", "GridFS", "storage", "by", "the", "way", "NUMBER", "I", "m", "going", "to", "re", "open", "NUMBER", "I", "ll", "need", "some", "help", "to", "track", "this", "down", "though", "I", "m", "pretty", "busy", "at", "the", "moment", "NUMBER", "Closing", "in", "favor", "of", "LINK", "please", "correct", "me", "if", "I", "m", "wrong", "but", "it", "looks", "like", "they", "re", "relate", "NUMBER", "I", "just", "upgrade", "to", "NUMBER", "and", "I", "get", "a", "permission", "denied", "error", "trying", "to", "read", "from", "the", "tmp", "directory", "when", "uploading", "to", "s", "NUMBER", "Everything", "else", "works", "fine", "including", "creation", "of", "thumbnails", "NUMBER", "I", "imagine", "this", "be", "a", "windows", "specific", "issue", "with", "carrierwave", "trying", "to", "move", "an", "opened", "file", "NUMBER", "Hmm", "NUMBER", "any", "way", "you", "could", "provide", "some", "more", "help", "in", "track", "this", "one", "down", "A", "backtrace", "example", "app", "or", "maybe", "you", "could", "point", "to", "the", "commit", "change", "that", "you", "think", "be", "a", "likely", "culprit", "Closing", "due", "to", "lack", "of", "feedback", "NUMBER", "I", "have", "the", "same", "error", "NUMBER", "My", "Carrierwave", "config", "CarrierWave", "NUMBER", "configure", "do", "config", "config", "NUMBER", "permissions", "NUMBER", "config", "NUMBER", "s", "NUMBER", "_access_key_id", "secret_access_key_id", "config", "NUMBER", "s", "NUMBER", "_secret_access_key", "secret_access_key", "config", "NUMBER", "s", "NUMBER", "_bucket", "backet_name", "end", "In", "CarrierWave", "uploader", "class", "AssetUploader", "TAG", "ChildClass", "And", "then", "the", "before_save", "after_save", "hooks", "could", "be", "wired", "up", "to", "the", "parent", "but", "act", "on", "the", "children", "NUMBER", "I", "m", "not", "entirely", "sure", "how", "to", "accomplish", "this", "though", "this", "be", "just", "a", "thought", "NUMBER", "Well", "why", "not", "add", "an", "before", "save", "hook", "to", "the", "parent", "object", "that", "calls", "all", "the", "embedded", "children", "objects", "save", "command", "which", "really", "should", "do", "nothing", "maybe", "run", "validations", "except", "that", "s", "what", "I", "m", "assuming", "CarrierWave", "alias", "NUMBER", "Not", "really", "sure", "how", "CarrierWave", "works", "when", "it", "comes", "to", "saving", "an", "object", "NUMBER", "It", "add", "NUMBER", "hooks", "to", "the", "model", "s", "save", "delete", "events", "after_save", "store_", "column", "NUMBER", "to_sym", "before_save", "write_", "column", "_identifier", "NUMBER", "to_sym", "after_destroy", "remove_", "column", "NUMBER", "to_sym", "The", "parent", "could", "execute", "these", "on", "it", "s", "children", "directly", "you", "d", "just", "need", "to", "loop", "over", "them", "send", "those", "particular", "message", "to", "each", "instance", "NUMBER", "I", "m", "not", "sure", "what", "you", "mean", "by", "this", "NUMBER", "What", "be", "The", "Model", "you", "re", "referring", "to", "a", "parent", "or", "child", "In", "our", "case", "this", "be", "the", "child", "object", "NUMBER", "But", "if", "we", "add", "another", "method", "on", "the", "parent", "that", "would", "execute", "these", "methods", "store_", "column", "etc", "on", "each", "child", "I", "think", "it", "would", "work", "NUMBER", "I", "would", "rather", "see", "it", "in", "the", "child", "as", "the", "parent", "shouldn", "t", "care", "that", "a", "child", "would", "have", "a", "file", "or", "not", "also", "developers", "won", "t", "know", "to", "look", "in", "the", "parent", "for", "a", "child", "s", "function", "NUMBER", "So", "we", "need", "a", "way", "for", "the", "parent", "to", "always", "fire", "a", "method", "when", "it", "s", "be", "saved", "and", "embedding", "it", "s", "children", "then", "attached", "save_", "column", "to", "that", "NUMBER", "or", "ask", "the", "mongoid", "folks", "if", "there", "s", "a", "way", "for", "an", "embedded", "document", "to", "get", "notified", "when", "the", "parent", "be", "saved", "NUMBER", "actually", "I", "think", "we", "re", "saying", "the", "same", "thing", "I", "ve", "add", "the", "issue", "to", "Mongoid", "LINK", "issue", "NUMBER", "The", "main", "issue", "here", "be", "that", "the", "callbacks", "on", "the", "children", "be", "not", "firing", "in", "mongoid", "anymore", "if", "you", "call", "save", "on", "the", "parent", "NUMBER", "If", "you", "call", "save", "on", "the", "embedded", "document", "it", "will", "properly", "save", "as", "callbacks", "bubble", "up", "but", "not", "down", "NUMBER", "this", "be", "by", "design", "NUMBER", "I", "be", "trying", "to", "figure", "out", "a", "workaround", "for", "this", "that", "I", "can", "put", "in", "Mongoid", "NUMBER", "More", "info", "as", "I", "get", "there", "NUMBER", "Makes", "sense", "but", "hoping", "for", "a", "workaround", "for", "these", "scenarios", "NUMBER", "Thanks", "durran", "While", "I", "be", "looking", "into", "this", "your", "current", "workaround", "be", "to", "make", "the", "save", "call", "on", "the", "embedded", "document", "itself", "NUMBER", "That", "will", "save", "the", "file", "NUMBER", "For", "example", "if", "you", "have", "a", "person", "that", "embeds", "many", "address", "and", "you", "have", "an", "uploader", "mounted", "on", "address", "calling", "save", "on", "the", "address", "will", "save", "the", "file", "NUMBER", "Calling", "save", "on", "person", "will", "not", "NUMBER", "I", "created", "a", "hack", "to", "bubble", "down", "the", "callbacks", "from", "the", "parent", "model", "to", "the", "embedded", "associations", "of", "a", "mongoid", "document", "NUMBER", "I", "created", "this", "to", "get", "Carrierwave", "work", "correctly", "NUMBER", "Here", "be", "quick", "example", "of", "what", "I", "did", "LINK", "CAUTION", "only", "test", "it", "locally", "use", "Rails", "NUMBER", "Hack", "from", "zerobearing", "NUMBER", "doesn", "t", "work", "for", "me", "since", "the", "prototype", "of", "function", "run_callbacks", "in", "the", "snippet", "be", "different", "from", "run_callbacks", "kind", "args", "block", "in", "ActiveSupport", "Callbacks", "NUMBER", "Also", "validation", "callbacks", "be", "not", "support", "this", "way", "since", "they", "be", "triggered", "directly", "by", "the", "valid", "method", "NUMBER", "Here", "i", "ve", "change", "the", "gist", "from", "zerobearing", "NUMBER", "to", "fit", "my", "needs", "LINK", "Rails", "NUMBER", "MongoID", "NUMBER", "beta", "NUMBER", "mcasimir", "you", "should", "be", "able", "to", "add", "validates_associated", "name_of_assocation", "to", "the", "parent", "model", "and", "have", "it", "then", "validate", "each", "association", "when", "the", "parent", "be", "validated", "NUMBER", "thanks", "for", "fix", "the", "run_callback", "method", "signature", "too", "i", "ve", "update", "my", "hack", "locally", "and", "works", "nicely", "NUMBER", "cheer", "It", "seems", "i", "ve", "discover", "another", "issue", "NUMBER", "When", "i", "use", "mount_uploader", "in", "embedded", "documents", "upload", "works", "nice", "and", "attachments", "be", "saved", "correctly", "but", "for", "some", "reason", "filename", "remains", "blank", "NUMBER", "be", "there", "anyone", "that", "has", "experienced", "the", "same", "issue", "Is", "this", "still", "an", "issue", "I", "d", "like", "to", "close", "if", "possible", "NUMBER", "Let", "me", "know", "NUMBER", "mcasimir", "it", "sounds", "like", "you", "ve", "identified", "another", "separate", "issue", "could", "be", "good", "to", "create", "a", "new", "ticket", "NUMBER", "Thanks", "Yes", "i", "think", "it", "s", "a", "different", "issue", "i", "m", "tring", "to", "understand", "if", "this", "affects", "only", "s", "NUMBER", "uploaders", "or", "not", "NUMBER", "I", "ll", "open", "a", "new", "ticket", "anyway", "NUMBER", "I", "ve", "change", "idea", "I", "think", "the", "new", "issue", "identified", "depends", "strictly", "on", "this", "issue", "and", "on", "the", "solution", "purposed", "in", "zerobearing", "gist", "be", "it", "ok", "to", "reference", "this", "issue", "into", "the", "new", "ticket", "i", "ve", "solve", "that", "with", "an", "after_save", "callback", "in", "embedded", "document", "model", "after_save", "extract_filename", "def", "extract_filename", "self", "NUMBER", "class", "NUMBER", "skip_callback", "save", "after", "extract_filename", "photo_original_filename", "photo", "NUMBER", "instance_variable_get", "original_filename", "if", "photo_original_filename", "NUMBER", "present", "self", "NUMBER", "update_attributes", "photo_filename", "photo_original_filename", "end", "self", "NUMBER", "class", "NUMBER", "set_callback", "save", "after", "extract_filename", "end", "NUMBER", "but", "i", "suppose", "that", "this", "still", "remains", "an", "issue", "be", "it", "correct", "It", "seems", "that", "carrierwave", "actually", "writes", "nil", "into", "the", "filename", "attribute", "since", "if", "i", "use", "before_save", "instead", "of", "after_save", "filename", "be", "set", "correctly", "at", "the", "end", "of", "the", "callback", "but", "then", "it", "turns", "back", "to", "blank", "after", "save", "NUMBER", "I", "can", "t", "find", "a", "better", "solution", "since", "looking", "into", "the", "sources", "i", "can", "t", "figure", "out", "where", "and", "how", "uploader", "filenames", "be", "set", "NUMBER", "That", "s", "all", "please", "tell", "me", "if", "it", "s", "needed", "to", "open", "another", "ticket", "NUMBER", "Maurizio", "After", "NUMBER", "months", "it", "be", "still", "issue", "for", "me", "NUMBER", "Uploader", "doesent", "work", "in", "embeded", "document", "but", "if", "I", "save", "object", "manualy", "upload", "works", "but", "dosen", "t", "set", "proper", "filename", "Does", "the", "author", "have", "any", "input", "on", "this", "issue", "I", "haven", "t", "had", "a", "need", "to", "get", "this", "fix", "myself", "NUMBER", "IMHO", "it", "s", "more", "about", "an", "architectural", "decision", "in", "mongoid", "that", "may", "not", "be", "the", "best", "NUMBER", "If", "someone", "can", "find", "an", "elegant", "workaround", "I", "d", "love", "to", "accept", "a", "patch", "but", "it", "s", "not", "likely", "that", "I", "ll", "invest", "my", "time", "to", "fix", "this", "NUMBER", "Sorry", "NUMBER", "I", "m", "closing", "this", "issue", "as", "it", "seems", "settled", "NUMBER", "From", "what", "I", "gather", "there", "be", "a", "workaround", "for", "this", "know", "limitation", "as", "mention", "by", "durran", "NUMBER", "I", "m", "add", "that", "information", "to", "the", "wiki", "now", "NUMBER", "I", "d", "appreciate", "it", "if", "someone", "would", "look", "at", "the", "wiki", "and", "possibly", "provide", "some", "code", "examples", "etc", "to", "help", "others", "who", "may", "be", "hit", "with", "the", "same", "limitation", "NUMBER", "If", "there", "s", "concern", "about", "this", "information", "be", "easily", "find", "I", "can", "add", "a", "note", "to", "the", "readme", "as", "well", "NUMBER", "I", "m", "add", "a", "link", "to", "the", "wiki", "to", "the", "top", "of", "the", "readme", "now", "NUMBER", "If", "someone", "would", "like", "take", "a", "shot", "at", "provide", "a", "pull", "request", "to", "improve", "Carrierwave", "we", "can", "have", "another", "look", "NUMBER", "Since", "this", "issue", "ranks", "pretty", "highly", "on", "Google", "I", "d", "like", "to", "add", "that", "this", "gem", "LINK", "_misc", "patches", "this", "perfectly", "and", "gets", "embedded", "Mongoid", "documents", "to", "play", "nice", "with", "CarrierWave", "NUMBER", "Hope", "this", "helps", "someone", "NUMBER", "This", "issue", "be", "pretty", "easily", "solve", "use", "cascade_callbacks", "NUMBER", "See", "LINK", "for", "the", "pull", "request", "NUMBER", "All", "you", "need", "to", "do", "be", "ruby", "embeds_many", "photos", "cascade_callbacks", "true", "I", "had", "a", "little", "trouble", "get", "random", "filenames", "to", "work", "by", "defining", "the", "filename", "method", "NUMBER", "I", "ended", "up", "finding", "a", "workaround", "but", "I", "thought", "it", "might", "be", "worth", "mentioning", "in", "any", "case", "LINK", "I", "dug", "around", "in", "the", "gem", "but", "I", "couldn", "t", "seem", "to", "figure", "out", "if", "why", "the", "filename", "was", "be", "set", "twice", "in", "my", "app", "NUMBER", "This", "seems", "like", "good", "practice", "anyhow", "there", "be", "no", "reason", "CarrierWave", "should", "call", "the", "filename", "only", "once", "memoizing", "the", "random", "value", "be", "the", "right", "thing", "to", "do", "imho", "NUMBER", "how", "would", "I", "go", "about", "wanting", "different", "version", "of", "a", "file", "with", "that", "same", "filename", "right", "now", "I", "end", "up", "with", "the", "original", "image", "having", "a", "different", "hex", "file", "name", "then", "the", "NUMBER", "thumbs", "it", "creates", "NUMBER", "Please", "see", "the", "wiki", "for", "a", "technique", "that", "should", "work", "NUMBER", "In", "any", "case", "please", "direct", "question", "like", "this", "to", "the", "Google", "Group", "in", "the", "future", "NUMBER", "I", "be", "use", "that", "example", "it", "calls", "the", "filename", "function", "for", "every", "other", "version", "again", "thus", "generating", "a", "new", "hex", "NUMBER", "re", "question", "direction", "sorry", "about", "that", "should", "I", "move", "this", "to", "the", "google", "group", "for", "reference", "Oh", "I", "see", "sorry", "that", "must", "not", "work", "with", "version", "Please", "direct", "this", "conversation", "to", "the", "google", "group", "as", "it", "s", "not", "really", "a", "bug", "NUMBER", "If", "you", "figure", "it", "out", "please", "do", "consider", "update", "the", "wiki", "so", "other", "people", "can", "benefit", "What", "be", "the", "correct", "solution", "that", "works", "with", "version", "I", "tried", "both", "solutions", "on", "the", "wiki", "but", "I", "always", "end", "up", "with", "new", "random", "values", "for", "each", "version", "NUMBER", "The", "following", "works", "for", "me", "ruby", "class", "ImageUploader", "CarrierWave", "Uploader", "Base", "def", "filename", "secure_token", "NUMBER", "NUMBER", "file", "NUMBER", "extension", "if", "original_filename", "NUMBER", "present", "end", "protected", "def", "secure_token", "length", "NUMBER", "var", "mounted_as", "_secure_token", "model", "NUMBER", "instance_variable_get", "var", "or", "model", "NUMBER", "instance_variable_set", "var", "SecureRandom", "NUMBER", "hex", "length", "NUMBER", "end", "end", "Edit", "now", "that", "I", "check", "the", "wiki", "this", "be", "the", "exactly", "the", "NUMBER", "example", "NUMBER"], "text_count": [0, 34952, 9328, 4989, 3759, 240, 3899, 21, 99, 4334, 4514, 9047, 4655, 3440, 3672, 1890, 0, 0, 0, 0, 9943, 2782, 1453, 1273, 2617, 1300, 0, 0, 0, 0, 20458, 12244, 8320, 324, 4764, 1141, 0, 0, 0, 0, 24608, 134, 11615, 10967, 6014, 0, 0, 0, 0, 0, 5813, 2261, 3175, 1648, 2589, 1153, 2677, 0, 0, 0, 20156, 1912, 15868, 1239, 0, 0, 0, 0, 0, 0, 13363, 1421, 9465, 4085, 1800, 0, 0, 0, 0, 0, 28302, 12474, 2035, 12553, 1110, 1091, 0, 0, 0, 0, 1541, 6569, 647, 0, 0, 0, 0, 0, 0, 0, 22552, 5031, 13772, 5019, 0, 0, 0, 0, 0, 0, 44566, 76612, 938, 4666, 1350, 1287, 0, 0, 0, 0, 112553, 262, 80741, 764, 15719, 28730]}]